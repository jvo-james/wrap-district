<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wrap District — Mobile</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ----------------------------
  APPETIZING COLOR THEME — Food-focused
  Replace the original :root and body background rules with this block.
  ---------------------------- */
:root{
  /* Primary palette — warm & appetizing */
  --accent-1: #FF6A00;        /* vibrant orange - primary CTA */
  --accent-2: #FFD166;        /* warm golden yellow - highlight */
  --accent-3: #78C267;        /* fresh green - freshness / success */
  --accent-4: #D96A2B;        /* secondary orange (for subtle contrast) */

  /* Neutral / text */
  --bg-start: #0b0b0b;        /* deep charcoal for dramatic food photography */
  --bg-end:   #20140d;        /* warm deep brown tint */
  --muted:    #E6E1DC;        /* off-white for readable small text */
  --muted-2:  rgba(230,225,220,0.78);
  --text:     #FFF9F6;        /* main content text */

  /* Glass / cards */
  --glass: rgba(255,255,255,0.03);
  --glass-2: rgba(255,255,255,0.02);
  --glass-border: rgba(255,255,255,0.04);

  /* Shadows / radii */
  --card-shadow: 0 12px 40px rgba(0,0,0,0.65);
  --accent-shadow: 0 10px 30px rgba(255,106,0,0.12);
  --radius-lg: 14px;
  --radius-sm: 10px;

  --max-width: 420px;
  --safe-top: env(safe-area-inset-top, 12px);
}

/* Page background — warm, slightly textured gradient to make food photos pop */
body {
  background: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);
  color: var(--text);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  margin: 0;
  -webkit-text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Small tweaks to key UI pieces to match the palette */
.logo-mark{
  background: linear-gradient(135deg, var(--accent-1), var(--accent-4));
  color: #111; /* dark text on bright badge gives premium stamp look */
  font-weight:900;
  padding:6px 10px;
  border-radius:8px;
  font-size:16px;
  letter-spacing:1px;
  box-shadow: 0 8px 26px rgba(217,106,43,0.10), inset 0 -2px 0 rgba(0,0,0,0.06);
}

.logo-name{
  color: var(--accent-2);
  font-weight:700;
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:1px;
}

/* CTAs — primary and ghost tuned for better contrast */
.btn.primary{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: var(--accent-shadow);
  border: 0;
}
.btn.ghost{
  background: rgba(255,255,255,0.03);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* Slide eyebrow & titles tuned */
.eyebrow{ color: var(--accent-2); font-weight: 800; }
.slide-title{ color: var(--text); text-shadow: 0 10px 30px rgba(0,0,0,0.6); }
.slide-sub{ color: var(--muted-2); }

/* Accent icon colors used around slides */
.art-icon{ color: rgba(255,230,200,0.95); }

/* Cart badge uses the same appetizing gradient */
.cart-count, .cart-mini-count {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  box-shadow: var(--accent-shadow);
}

/* Menu cards: slightly warmer surfaces to read as food cards */
.menu-item{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: var(--radius-lg);
  padding: 10px;
  box-shadow: var(--card-shadow);
  border: 1px solid var(--glass-border);
}

/* Price chips: make them pop without feeling loud */
.menu-item::after{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  padding:6px 10px;
  border-radius:999px;
}

/* Promo badges */
.badge, .promo-badge, .promo-badge-small{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:900;
}

/* Cart lines warm accent for quantities */
.line-qty{ color: var(--accent-2); font-weight:900; }

/* Promo countdown chip tuned */
.promo-countdown-chip{ background: linear-gradient(90deg, var(--accent-1), var(--accent-2)); color:#111; }

/* Modal inner highlight for promo */
.entry-promo .modal-inner{
  background: linear-gradient(90deg, rgba(255,106,0,0.07), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,204,51,0.08);
}

/* Small accessibility improvement: ensure links on dark backgrounds are readable */
a { color: var(--accent-2); text-decoration: none; }



/* ---------- STICKY HEADER ---------- */
.sticky-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: calc(56px + var(--safe-top));
  padding-top: var(--safe-top);
  z-index: 1200;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(8px) saturate(130%);
  background: linear-gradient(180deg, rgba(10,10,10,0.6), rgba(10,10,10,0.45));
  border-bottom: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 6px 18px rgba(0,0,0,0.45);
}

/* header inner row */
.header-inner{
  width: 100%;
  max-width: var(--max-width);
  display:flex;
  align-items:center;
  gap:12px;
  padding:8px 14px;
  box-sizing: border-box;
}

/* Logo (left) */
.logo{
  display:flex;
  align-items:center;
  gap:8px;
  flex: 1 1 auto;
  cursor: default;
  user-select: none;
}
.logo-mark{
  background: linear-gradient(135deg, var(--accent-1), #ff8c2b);
  color: #111;
  font-weight:900;
  padding:6px 10px;
  border-radius:8px;
  font-size:16px;
  letter-spacing:1px;
  box-shadow: 0 6px 18px rgba(255,106,0,0.12), inset 0 -2px 0 rgba(0,0,0,0.08);
}
.logo-name{
  color: var(--accent-2);
  font-weight:700;
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:1px;
}

/* Icon buttons (cart, hamburger) */
.icon-btn{
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:20px;
  line-height:1;
  padding:8px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
  -webkit-tap-highlight-color: transparent;
}
.icon-btn:active{ transform: translateY(1px) scale(.995); }

/* Cart button specifically */
.cart-btn{
  position: relative;
  margin-right: 6px;
  color: var(--accent-2);
  font-size:20px;
  min-width:44px;
  min-height:44px;
  display:inline-grid;
  place-items:center;
}

/* cart count badge */
.cart-count{
  position: absolute;
  top: 6px;
  right: 6px;
  transform: translate(25%, -10%);
  background: linear-gradient(180deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  font-size:12px;
  padding:4px 6px;
  border-radius:999px;
  box-shadow: 0 6px 16px rgba(255,106,0,0.14);
  border: 2px solid rgba(255,255,255,0.05);
  min-width: 22px;
  text-align:center;
}

/* Hamburger on far right */
.ham-btn{
  color: var(--muted);
  font-size:20px;
  width:44px;
  height:44px;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* Ensure header elements are keyboard-focusable and visible */
.icon-btn:focus{ outline: 3px solid rgba(255,204,51,0.12); outline-offset: 3px; }

/* ---------- HERO SLIDESHOW (mobile-first, full-bleed) ---------- */
.hero-slideshow{
  margin-top: calc(56px + var(--safe-top)); /* push content under fixed header */
  width: 100%;
  max-width: var(--max-width);
  margin-left: auto;
  margin-right: auto;
  position: relative;
  overflow: visible;
  padding-bottom: 10px;
}

/* Slide wrapper */
.slides{
  position: relative;
  width: 100%;
  height: 66vh; /* large visual on phones */
  max-height: 560px;
  min-height: 360px;
  border-bottom-left-radius: 22px;
  border-bottom-right-radius: 22px;
  overflow: clip;
  box-shadow: var(--card-shadow);
}

/* Each slide - JS toggles display:block/none; keep transitions for overlay */
.slide{
  position: absolute;
  inset: 0;
  display: none; /* JS will set block for active one */
  will-change: opacity, transform;
}

/* full-bleed image */
.slide-img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  -webkit-user-drag: none;
  transform-origin: center center;
  transition: transform 900ms cubic-bezier(.2,.9,.3,1);
  filter: saturate(1.05) contrast(1.02);
  transform: scale(1.02);
}

/* subtle parallax on active slide */
.slide[style*="display: block"] .slide-img {
  transform: scale(1);
}

/* gradient overlay + frosted glass content */
.slide-overlay{
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(10,10,10,0.08) 0%, rgba(0,0,0,0.55) 70%);
  display: flex;
  align-items: flex-end;
  padding: 18px;
  box-sizing: border-box;
}

/* Slide content container (frosted card) */
.slide-content{
  width: 100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: 14px;
  padding: 14px;
  backdrop-filter: blur(6px) saturate(120%);
  border: 1px solid var(--glass-border);
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  display: flex;
  flex-direction: column;
  gap:8px;
  transform: translateY(8px);
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease;
}
/* ===== Header: larger cart icon, smaller badge ===== */
.cart-btn{
  position: relative;
  margin-right: 6px;
  color: var(--accent-2);
  /* made the icon visually larger and a bit more tappable */
  font-size: 26px;        /* was 20px */
  min-width:52px;        /* increased tap area */
  min-height:52px;
  display:inline-grid;
  place-items:center;
  border-radius:12px;
}
/* ---------- HERO IMAGE IMPROVEMENT (replace existing .slide-img block) ---------- */

/* show full image without aggressive cropping; keeps it centered and avoids upscaling */
.slide-img{
  width: 100%;
  height: 100%;
  object-fit: contain;        /* show the whole image (no crop) */
  object-position: center;    /* keeps the subject centered */
  display: block;
  -webkit-user-drag: none;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), filter 300ms ease;
  filter: saturate(1.03) contrast(1.02);
  transform: scale(1);        /* remove the intentional zoom */
  background-color: #000;     /* hides any tiny gaps with a neutral background */
}

/* keep slide-content animation behavior but no scale-change on active state */
.slide[style*="display: block"] .slide-img {
  transform: scale(1);
}

  .slide-img{
  width:100%;
  height:100%;
  object-fit: cover;   /* still fills container */
  object-position: center;
  transform: scale(0.98);   /* slight zoom-out to reduce aggressive cropping */
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), filter 300ms ease;
  filter: saturate(1.03) contrast(1.02);
}
.slide[style*="display: block"] .slide-img { transform: scale(0.98); }
  
/* cart count badge — smaller, tighter, and repositioned */
.cart-count{
  position: absolute;
  top: 6px;
  right: 6px;
  transform: translate(35%, -35%); /* nudged so it sits nicely on a bigger icon */
  background: linear-gradient(180deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  font-size:10px;        /* reduced from 12px */
  padding:3px 5px;       /* reduced padding for compactness */
  border-radius:999px;
  box-shadow: 0 6px 16px rgba(255,106,0,0.14);
  border: 2px solid rgba(255,255,255,0.05);
  min-width: 18px;       /* slightly smaller */
  text-align:center;
  line-height:1;
}

/* Keep the badge readable on very small screens */
@media (max-width:360px){
  .cart-btn{ font-size:24px; min-width:48px; min-height:48px; }
  .cart-count{ font-size:9px; padding:2px 5px; min-width:16px; transform: translate(35%, -40%); }
}
/* When slide is active, lift the card a bit */
.slide[style*="display: block"] .slide-content {
  transform: translateY(0);
  opacity: 1;
}

/* Eyebrow small label */
.eyebrow{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:12px;
  color: var(--accent-2);
  font-weight:700;
  text-transform:uppercase;
}

/* Headline */
.slide-title{
  font-size:20px;
  line-height:1.05;
  margin:0;
  color: #fff;
  text-shadow: 0 8px 30px rgba(0,0,0,0.6);
  letter-spacing: -0.2px;
  font-weight:800;
}

/* sub text */
.slide-sub{
  font-size:13px;
  color: rgba(255,255,255,0.86);
  margin:0;
}

/* CTA Buttons inside slides */
.slide-ctas{
  display:flex;
  gap:8px;
  margin-top:6px;
  flex-wrap:wrap;
}

/* Buttons style (used across site) */
.btn{
  border: 0;
  padding:10px 12px;
  border-radius: 12px;
  font-weight:700;
  font-size:13px;
  display:inline-flex;
  gap:8px;
  align-items:center;
  justify-content:center;
  min-height:44px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
}
.btn.primary{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
}
.btn.ghost{
  background: rgba(255,255,255,0.03);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* small / tiny */
.btn.small{ padding:8px 10px; font-size:13px; border-radius:10px; min-height:36px; }

/* decorative art icons floating around slide content */
.slide-art{
  position: absolute;
  right: 14px;
  top: 12px;
  display:flex;
  gap:8px;
  z-index: 15;
  pointer-events: none;
}
.art-icon{
  font-size:20px;
  color: rgba(255,255,255,0.9);
  opacity: 0.95;
  transform-origin: center;
  filter: drop-shadow(0 6px 20px rgba(0,0,0,0.4));
  animation: float 6s ease-in-out infinite;
}
.art-icon:nth-child(2){ animation-delay: 1.2s; transform: scale(.92); }

/* slide promo specific look */
.slide-promo .slide-content{
  border: 1px solid rgba(255,204,51,0.12);
  background: linear-gradient(180deg, rgba(255,106,0,0.06), rgba(255,255,255,0.02));
}

/* slideshow controls (bottom center) */
.slideshow-controls{
  position: absolute;
  left: 0;
  right: 0;
  bottom: 8px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:12px;
  z-index: 30;
  pointer-events: none;
}
.slideshow-controls .icon-btn { pointer-events: auto; background: rgba(0,0,0,0.45); color: #fff; border-radius: 10px; padding:8px; }

/* dots */
.slide-dots{
  display:flex;
  gap:8px;
  align-items:center;
  pointer-events: auto;
}
.dot{
  width:10px;
  height:10px;
  border-radius:999px;
  background: rgba(255,255,255,0.18);
  border: 1px solid rgba(255,255,255,0.04);
  padding:0;
}
.dot.is-active{
  width:34px;
  border-radius:999px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  box-shadow: 0 8px 20px rgba(255,106,0,0.14);
}

/* ---------- Accessibility / touch improvements ---------- */
.icon-btn, .btn { touch-action: manipulation; -webkit-user-select: none; user-select: none; }
.slide .slide-content a, .slide .slide-content button { -webkit-tap-highlight-color: transparent; }

/* ---------- Animations ---------- */
@keyframes float{
  0% { transform: translateY(0) rotate(-2deg); opacity: .95; }
  50% { transform: translateY(-8px) rotate(2deg); opacity: 1; }
  100% { transform: translateY(0) rotate(-2deg); opacity: .95; }
}

/* ---------- Responsive tweaks for very small phones ---------- */
@media (max-width:360px){
  .slide-title { font-size:18px; }
  .slide-sub { font-size:12px; }
  .slide-content { padding: 12px; border-radius: 12px; }
  .slides { height: 62vh; min-height: 320px; }
}

/* ---------- Desktop (wider) graceful scale (won't be used as primary) ---------- */
@media (min-width: 640px){
  .hero-slideshow{ margin-top: calc(64px + var(--safe-top)); }
  .slides { height: 56vh; }
  .slide-title { font-size: 28px; }
  .slide-sub { font-size: 15px; }
}

/* ---------- Tiny utility classes used in body markup ---------- */
.hidden { display: none !important; }
.container-small { padding: 14px; max-width: var(--max-width); margin: 0 auto; box-sizing: border-box; }

</style>
  <style>
/* =========================
   Wrap District — Cart / Cart Drawer Styling (Mobile-first, gorgeous)
   Complements header & hero styles. Drop into your stylesheet.
   ========================= */

/* Reuse theme variables from earlier; provide fallbacks */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --bg-card: rgba(17,17,17,0.85);
  --glass-strong: rgba(255,255,255,0.04);
  --glass-soft: rgba(255,255,255,0.02);
  --shadow-xl: 0 22px 50px rgba(0,0,0,0.6);
  --radius-lg: 16px;
  --radius-sm: 10px;
  --cart-header-h: 72px;
  --cart-footer-h: 96px;
  --max-width: 420px;
}

/* ---------- CART DRAWER (off-canvas) ---------- */
.cart-drawer{
  position: fixed;
  top: 0;
  right: 0;
  width: 94%;
  max-width: var(--max-width);
  height: 100vh;
  background: linear-gradient(180deg, rgba(12,12,12,0.96), rgba(8,8,8,0.98));
  box-shadow: -28px 0 60px rgba(0,0,0,0.65);
  z-index: 1400;
  transform: translateX(110%);
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 300ms ease;
  opacity: 0;
  display: none; /* JS toggles block + aria-hidden */
  border-left: 1px solid rgba(255,255,255,0.03);
  overflow: hidden;
  border-top-left-radius: 18px;
  border-bottom-left-radius: 18px;
}

/* When visible (JS sets aria-hidden="false" and display:block) */
.cart-drawer[aria-hidden="false"]{
  transform: translateX(0);
  opacity: 1;
  display: block;
}

/* ---------- Cart header ---------- */
.cart-header{
  height: var(--cart-header-h);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 14px 14px;
  gap:10px;
  box-sizing: border-box;
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-bottom: 1px solid rgba(255,255,255,0.03);
  position: relative;
  backdrop-filter: blur(6px) saturate(120%);
}
.cart-header h3{
  margin:0;
  font-size:16px;
  letter-spacing: .2px;
  color: var(--accent-2);
  font-weight:800;
  display:flex;
  align-items:center;
  gap:10px;
}
.cart-header .cart-mini-count{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color:#111;
  font-weight:900;
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  box-shadow: 0 8px 30px rgba(255,106,0,0.12);
  border: 2px solid rgba(255,255,255,0.04);
}

/* close button */
#cart-close{
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:18px;
  padding:8px;
  border-radius:10px;
}
#cart-close:focus{ outline: 3px solid rgba(255,204,51,0.10); outline-offset:2px; }

/* ---------- Cart body (scrollable) ---------- */
.cart-body{
  padding: 12px;
  height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h));
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

    /* ---------- Cart: thumbnails + sticky footer polish (add after your cart styles) ---------- */

/* thumbnail inside cart line */
.cart-thumb{
  width:64px;
  height:56px;
  object-fit: cover;
  border-radius:8px;
  flex: 0 0 64px;
  margin-right:12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  border: 1px solid rgba(255,255,255,0.03);
}

/* adjust cart-line left area to align image + text nicely */
.cart-line .line-left{
  display:flex;
  align-items:center;
  gap:12px;
}

/* make footer sticky and slightly elevated */
.cart-footer{
  position: sticky;
  bottom: 0;
  z-index: 60;
  height: var(--cart-footer-h);
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(6,6,6,0.96), rgba(8,8,8,0.98));
  backdrop-filter: blur(6px) saturate(120%);
  box-shadow: 0 -8px 28px rgba(0,0,0,0.6);
  box-sizing: border-box;
}

/* give cart-body bottom padding so content never hides under sticky footer */
.cart-body{
  padding-bottom: calc(var(--cart-footer-h) + 18px);
}

/* small condensed summary inside footer for immediate totals */
.cart-footer .footer-summary{
  display:flex;
  align-items:center;
  gap:12px;
  min-width: 0;
  flex: 1 1 auto;
}
.cart-footer .footer-summary .total-label{ color: rgba(255,255,255,0.85); font-weight:800; font-size:13px; }
.cart-footer .footer-summary .total-value{ font-weight:900; font-size:16px; color: var(--accent-2); }

/* make checkout/clear buttons share space nicely on small screens */
.cart-footer .footer-actions{
  display:flex;
  gap:8px;
  width: 48%;
  min-width: 160px;
  justify-content: flex-end;
}

/* ensure cart-drawer content height calculation still works on larger screens */
@media (min-width: 640px) {
  .cart-body{ height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h)); }
}
    
/* Nice custom scrollbar (WebKit) */
.cart-body::-webkit-scrollbar{ width:8px; }
.cart-body::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,0.3);
}

/* Empty cart message */
.cart-items .empty{
  padding: 28px 12px;
  text-align: center;
  color: rgba(255,255,255,0.75);
  font-weight:700;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius: 12px;
  margin: 6px 0 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.45) inset;
}

/* ---------- Cart line items ---------- */
.cart-items{ list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:10px; }

.cart-line{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 8px 28px rgba(0,0,0,0.45);
}

/* Free promo lines look lighter and friendly */
.cart-line.cart-free{
  background: linear-gradient(180deg, rgba(34,34,34,0.65), rgba(20,20,20,0.6));
  border: 1px dashed rgba(255,204,51,0.09);
  color: var(--accent-2);
}

/* left area - title & meta */
.line-left{
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width: 0;
  flex: 1 1 auto;
}
.line-title{
  font-size:14px;
  font-weight:800;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.line-meta{
  color: rgba(255,255,255,0.66);
  font-size:13px;
  font-weight:700;
}

/* right area - controls */
.line-controls{
  display:flex;
  align-items:center;
  gap:8px;
  flex: 0 0 auto;
}

/* round quantity controls */
.icon-btn.cart-increase, .icon-btn.cart-decrease, .icon-btn.cart-remove {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.04);
  width:40px;
  height:40px;
  display:inline-grid;
  place-items:center;
  border-radius:10px;
  color: var(--muted);
  font-size:16px;
  transition: transform 150ms ease, background 180ms ease, color 180ms ease;
}
.icon-btn.cart-increase:hover, .icon-btn.cart-decrease:hover {
  transform: translateY(-3px);
  color: var(--accent-2);
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
}
.icon-btn.cart-remove{ color: rgba(255,140,100,0.95); border-color: rgba(255,140,100,0.06); }
.icon-btn.cart-remove:hover{ transform: translateY(-3px); color: #ff6a00; }

/* quantity number inside meta (if present) */
.line-qty{ font-weight:900; color: var(--accent-2); }

/* ---------- Promo / discount block ---------- */
.cart-promo{
  margin-top: 12px;
  padding: 12px;
  border-radius: 12px;
  background: linear-gradient(90deg, rgba(255,204,51,0.06), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,204,51,0.08);
  display:flex;
  flex-direction:column;
  gap:8px;
}
.promo-applied{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.promo-label{ font-weight:800; color: #fff; }
.promo-value{ font-weight:900; color: #111; background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); padding:6px 10px; border-radius:999px; }

/* helper row */
.promo-cta{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:6px; }
#add-missing{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:8px 10px;
  border-radius:10px;
  border:0;
  font-weight:800;
  min-width:120px;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
}
.promo-cta small{ color: rgba(255,255,255,0.78); font-weight:700; }

/* ---------- Cart summary ---------- */
.cart-summary{
  margin-top: 14px;
  padding: 12px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  display:flex;
  flex-direction:column;
  gap:8px;
}
.summary-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  color: rgba(255,255,255,0.9);
  font-weight:700;
  font-size:15px;
  padding:6px 0;
}
.summary-row.total{
  font-size:18px;
  color:#fff;
  font-weight:900;
  border-top: 1px dashed rgba(255,255,255,0.04);
  padding-top:10px;
}

/* ---------- Cart footer (checkout actions) ---------- */
.cart-footer{
  height: var(--cart-footer-h);
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,0.03);
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:space-between;
  background: linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.04));
  box-sizing: border-box;
}
.btn.fullwidth{ width: 100%; padding: 14px; font-size:16px; border-radius:12px; }
.btn.primary.fullwidth{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  box-shadow: 0 12px 36px rgba(255,106,0,0.14);
}
.btn.ghost.fullwidth{
  background: transparent;
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* small / tiny btn used in promo helper */
.btn.tiny{ padding:8px 10px; border-radius:10px; font-weight:800; }

/* ---------- Utility & focus ---------- */
.cart-drawer :focus { outline: none; }
.cart-drawer button:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 3px; border-radius: 10px; }

/* ---------- Micro animations ---------- */
.cart-line { transition: transform 250ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease; }
.cart-line:hover { transform: translateY(-3px); box-shadow: 0 30px 60px rgba(0,0,0,0.55); }

/* ---------- Responsive tweaks ---------- */
@media (min-width: 640px){
  .cart-drawer{
    width: 420px;
  }
  .cart-body{ height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h)); }
  .cart-header h3{ font-size:18px; }
  .cart-line{ padding:14px; }
}

/* ---------- Small polish: badges used inside cart if any ---------- */
.badge-inline{
  background: rgba(255,204,51,0.08);
  color: var(--accent-2);
  font-weight:800;
  padding:6px 8px;
  border-radius: 999px;
  font-size:12px;
  border: 1px solid rgba(255,204,51,0.08);
}

/* ---------- End of cart styles ---------- */
</style>

  <style>
/* =========================
   Wrap District — Menu Section Styling (Mobile-first, ultra-appealing & appetizing)
   Use with the existing header / hero / cart styles. Focused on:
   - bold food photography cards
   - clear pricing tiers & CTA
   - tasty color palette, gradients, micro-anim
   ========================= */

/* Fallback theme variables (will reuse if already defined) */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --card-bg: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  --glass: rgba(255,255,255,0.03);
  --shadow-lg: 0 18px 40px rgba(0,0,0,0.6);
  --radius-lg: 14px;
  --radius-md: 12px;
  --max-width: 420px;
}

/* Container for menu section */
.menu-section{
  width: 100%;
  max-width: var(--max-width);
  margin: 12px auto 28px;
  padding: 0 14px;
  box-sizing: border-box;
}

/* Section heading */
.section-title{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:18px;
  color: var(--accent-2);
  font-weight:900;
  margin-bottom:8px;
  text-transform: none;
}
.section-sub{
  color: rgba(255,255,255,0.78);
  font-size:13px;
  margin-bottom:12px;
}

/* Menu grid (vertical list on mobile) */
.menu-grid{
  display:flex;
  flex-direction:column;
  gap:14px;
}

    /* ------- Menu container & tabs polish (add after menu styles) ------- */
.menu-container {
  padding: 12px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(6,6,6,0.92), rgba(12,12,12,0.95));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.55);
}

/* tabs */
.menu-tabs {
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding: 8px 4px 12px;
  -webkit-overflow-scrolling: touch;
}
.menu-tabs .tab-btn {
  white-space:nowrap;
  flex:0 0 auto;
  border:0;
  padding:8px 12px;
  border-radius: 999px;
  background: rgba(255,255,255,0.02);
  color: var(--muted);
  font-weight:900;
  font-size:13px;
  cursor:pointer;
  outline: none;
  border: 1px solid rgba(255,255,255,0.02);
}
.menu-tabs .tab-btn.is-active {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: 0 12px 36px rgba(255,106,0,0.10);
}

/* visually distinct card: left accent + stronger contrast */
.menu-item {
  position: relative;
  padding: 12px;
  border-radius: 12px;
  display:block;
  transition: transform 220ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease;
  border-left: 6px solid transparent;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
}
.menu-item:focus,
.menu-item:hover {
  transform: translateY(-6px);
  box-shadow: 0 36px 80px rgba(0,0,0,0.6);
  border-left-color: rgba(255,106,0,0.95);
  outline: none;
}

/* larger, rounder thumbnail so items are easier to distinguish */
.item-thumb {
  width:110px;
  height:86px;
  border-radius:12px;
  flex:0 0 110px;
  object-fit: cover;
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 8px 28px rgba(0,0,0,0.45);
}

/* stronger title contrast */
.item-title { font-size:16px; color:#fff; }

/* small spacing improvements */
.menu-grid { display:flex; flex-direction:column; gap:14px; }

/* On larger widths show two-column grid */
@media (min-width: 540px) {
  .menu-grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
}

/* increase hit-target for add/remove on mobile */
.action-row .btn { min-width:48px; padding:10px 14px; }

/* small focus ring for keyboard users */
.menu-item:focus { box-shadow: 0 8px 30px rgba(0,0,0,0.55), 0 0 0 3px rgba(255,204,51,0.06); }
    
/* Each menu card */
.menu-item{
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 10px;
  box-shadow: var(--shadow-lg);
  border: 1px solid rgba(255,255,255,0.03);
  overflow: hidden;
  transition: transform 240ms cubic-bezier(.2,.9,.3,1), box-shadow 240ms ease;
}

/* Lift on hover/tap */
.menu-item:active,
.menu-item:hover{
  transform: translateY(-6px);
  box-shadow: 0 36px 80px rgba(0,0,0,0.6);
}

/* Top row: image + meta */
.item-top{
  display:flex;
  gap:12px;
  align-items:flex-start;
}

/* Round-edge image thumb */
.item-thumb{
  width:94px;
  height:84px;
  object-fit:cover;
  border-radius:12px;
  flex: 0 0 94px;
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 10px 30px rgba(0,0,0,0.45);
  transform-origin: center;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1);
}

/* Zoom subtle on hover */
.menu-item:hover .item-thumb{ transform: scale(1.03) rotate(-0.5deg); }

/* Title + desc area */
.item-meta{
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width: 0;
}
.item-title{
  font-size:16px;
  color: #fff;
  font-weight:900;
  line-height:1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  display:flex;
  align-items:center;
  gap:8px;
}
.item-desc{
  color: rgba(255,255,255,0.78);
  font-size:13px;
  margin-top:2px;
}

/* Badges (promo, small) */
.badge, .promo-badge, .promo-badge-small{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  font-size:11px;
  padding:6px 8px;
  border-radius:999px;
  box-shadow: 0 10px 26px rgba(255,106,0,0.12);
  border: 1px solid rgba(255,255,255,0.04);
  display:inline-flex;
  align-items:center;
  gap:8px;
}

/* Smaller badge variant */
.promo-badge-small{ padding:4px 6px; font-size:11px; font-weight:800; background: rgba(255,255,255,0.03); color: var(--accent-2); border:1px solid rgba(255,255,255,0.03); box-shadow:none; }

/* Item config area (selects, addons) */
.item-config{
  margin-top:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Labels */
.label{ font-size:12px; color: var(--muted); font-weight:800; text-transform:uppercase; letter-spacing: .8px; }

/* Custom styled select (appearance: none replacement) */
.select{
  appearance: none;
  -webkit-appearance: none;
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border: 1px solid rgba(255,255,255,0.04);
  color: #fff;
  font-weight:800;
  font-size:14px;
  outline: none;
  box-shadow: 0 6px 20px rgba(0,0,0,0.45) inset;
  background-image: linear-gradient(45deg, rgba(255,255,255,0.06) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.06) 75%, transparent 75%, transparent);
  background-size: 12px 12px;
  background-position: right 12px center;
}

/* Add-ons row */
.addons-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* Styled addon checkbox label */
.addon{
  display:flex;
  gap:8px;
  align-items:center;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  padding:8px 10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.03);
  font-weight:800;
  color: var(--muted);
  font-size:13px;
  cursor: pointer;
  transition: transform 180ms ease, box-shadow 200ms ease;
}

/* Hide native checkbox visually but keep accessible */
.addon input[type="checkbox"]{
  appearance:none;
  -webkit-appearance:none;
  width:18px;
  height:18px;
  border-radius:6px;
  border:2px solid rgba(255,255,255,0.06);
  background: transparent;
  margin:0;
  display:inline-block;
}

/* Checked state */
.addon input[type="checkbox"]:checked{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  border-color: rgba(255,255,255,0.02);
  box-shadow: 0 6px 18px rgba(255,106,0,0.12);
}

/* Text near checkbox */
.addon span{ font-weight:800; color: rgba(255,255,255,0.9); font-size:13px; }

/* Actions row: price + buttons */
.item-actions{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-top:8px;
}

/* Price display */
.price-row{
  display:flex;
  flex-direction:column;
  gap:4px;
  align-items:flex-start;
}
.price-label{ font-size:12px; color: var(--muted); font-weight:800; }
.item-price{ font-size:16px; font-weight:900; color: var(--accent-2); }

/* Action buttons */
.action-row{ display:flex; gap:8px; align-items:center; }
.add-btn, .remove-btn{
  border:0;
  padding:10px 12px;
  border-radius:12px;
  font-weight:900;
  font-size:13px;
  min-height:44px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
  transition: transform 160ms ease, box-shadow 200ms ease;
}
.add-btn{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
  border: 1px solid rgba(255,255,255,0.02);
}
.remove-btn{
  background: rgba(255,255,255,0.02);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.03);
}

/* Hidden utility */
.hidden{ display:none !important; }

/* Micro interactions */
.add-btn:active, .remove-btn:active{ transform: translateY(1px) scale(.995); }
.menu-item:hover .add-btn{ transform: translateY(-3px); }

/* Price chip inside card for quick glance (top-right) */
.menu-item::after{
  content: attr(data-price);
  position: absolute;
  right: 18px;
  top: 12px;
  font-size:12px;
  font-weight:900;
  color:#111;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  padding:6px 10px;
  border-radius:999px;
  box-shadow: 0 10px 26px rgba(255,106,0,0.12);
  display:none; /* hidden by default; optional */
}

/* Promo microcopy when tapping eligible item (small note area) */
.menu-item .promo-note{
  margin-top:8px;
  background: rgba(255,255,255,0.02);
  padding:8px 10px;
  border-radius:10px;
  color: rgba(255,255,255,0.86);
  font-size:13px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

/* "Add missing items" small CTA inside menu (non-blocking) */
.menu-item .promo-cta-small{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:6px 8px;
  border-radius:8px;
  font-weight:900;
  font-size:12px;
}

/* Accessibility & touch improvements */
.select, .add-btn, .remove-btn, .addon, .item-thumb { -webkit-tap-highlight-color: transparent; touch-action: manipulation; }

/* Responsive adjustments */
@media (min-width: 420px){
  .menu-grid{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:16px;
  }
  .item-thumb{ width:120px; height:100px; flex:0 0 120px; border-radius:14px; }
  .item-title{ font-size:17px; }
}

/* Small polish: shimmer on price value when user changes options */
.item-price .price-value {
  display:inline-block;
  transition: transform 220ms cubic-bezier(.2,.9,.3,1);
}
.item-price.updated .price-value { transform: translateY(-4px); }

    /* ==========================
   Preorder Modal Styles
   Matches site variables (uses --accent-1 / --accent-2)
   Mobile-first, accessible, animated, with sticky CTA bar
   ========================== */

.preorder-modal { /* overlay wrapper */
  position: fixed;
  inset: 0;
  display: none; /* JS toggles display / aria-modal */
  align-items: flex-end; /* slide-up from bottom on mobile */
  justify-content: center;
  z-index: 2200;
  background: rgba(6,6,6,0.6);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  padding: 12px;
  box-sizing: border-box;
}

/* show when aria-modal true */
.preorder-modal[aria-modal="true"] {
  display: flex;
  animation: preorder-overlay-in 260ms cubic-bezier(.2,.9,.3,1);
}

/* inner card */
.preorder-modal .modal-inner-preorder {
  width: 100%;
  max-width: 420px;
  border-radius: 14px 14px 8px 8px;
  background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(8,8,8,0.98));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  transform: translateY(18px);
  animation: preorder-card-in 360ms cubic-bezier(.2,.9,.3,1) forwards;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* header row */
.preorder-modal .preorder-header {
  display:flex;
  gap:12px;
  align-items:center;
  padding: 14px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
}
.preorder-modal .preorder-header .thumb {
  width:72px;
  height:64px;
  border-radius:10px;
  object-fit:cover;
  flex: 0 0 72px;
  border:1px solid rgba(255,255,255,0.04);
  box-shadow: 0 8px 30px rgba(0,0,0,0.45);
}
.preorder-modal .preorder-header .meta {
  flex: 1 1 auto;
  min-width:0;
}
.preorder-modal .preorder-header .meta .title {
  font-size:16px;
  font-weight:900;
  color:#fff;
  margin:0 0 4px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.preorder-modal .preorder-header .meta .subtitle {
  font-size:13px;
  color: rgba(255,255,255,0.82);
  margin:0;
}

/* countdown / weekday chip */
.preorder-modal .preorder-when {
  display:flex;
  gap:8px;
  align-items:center;
  padding: 12px 14px;
  border-bottom: 1px dashed rgba(255,255,255,0.02);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
}
.preorder-modal .countdown-chip {
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:8px 10px;
  border-radius:999px;
  font-weight:900;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color:#111;
  box-shadow: 0 12px 30px rgba(255,106,0,0.12);
  font-size:13px;
}

/* form area */
.preorder-modal .preorder-body {
  padding: 12px 14px 84px; /* bottom padding to allow for sticky CTA bar */
  display:flex;
  flex-direction:column;
  gap:12px;
  max-height: calc(100vh - 220px);
  overflow:auto;
}

/* qty + extras row */
.preorder-modal .row {
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:space-between;
}

/* quantity control */
.preorder-modal .qty-control {
  display:flex;
  gap:8px;
  align-items:center;
}
.preorder-modal .qty-control button {
  width:40px;
  height:40px;
  border-radius:10px;
  border:0;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  color:var(--muted);
  font-weight:900;
  font-size:18px;
}
.preorder-modal .qty-control .qty-value {
  min-width:36px;
  text-align:center;
  font-weight:900;
  color: var(--accent-2);
}

/* date/time picker row */
.preorder-modal .datetime {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.preorder-modal .datetime input[type="date"],
.preorder-modal .datetime input[type="time"],
.preorder-modal .datetime select,
.preorder-modal .datetime .prefetch-select {
  padding:10px 12px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:800;
  font-size:14px;
  box-sizing:border-box;
}

/* extras list */
.preorder-modal .extras {
  display:flex;
  flex-direction:column;
  gap:8px;
}
.preorder-modal .extras label {
  display:flex;
  gap:10px;
  align-items:center;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  cursor:pointer;
  font-weight:800;
  color: var(--muted);
}
.preorder-modal .extras input[type="checkbox"] {
  width:18px;
  height:18px;
  border-radius:6px;
  border:2px solid rgba(255,255,255,0.06);
  appearance:none;
  -webkit-appearance:none;
}
.preorder-modal .extras input[type="checkbox"]:checked {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  border-color: rgba(255,255,255,0.02);
}

/* contact inputs */
.preorder-modal .contact-row {
  display:flex;
  gap:8px;
  flex-direction:column;
}
.preorder-modal .contact-row input[type="text"],
.preorder-modal .contact-row input[type="tel"],
.preorder-modal .contact-row input[type="email"] {
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:800;
  font-size:14px;
  box-sizing:border-box;
}

/* small helper text */
.preorder-modal .helper {
  font-size:13px;
  color: rgba(255,255,255,0.75);
  margin-top:2px;
}

/* sticky CTA bar (fixed to modal bottom) */
.preorder-modal .preorder-cta {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 12px;
  box-sizing: border-box;
  background: linear-gradient(180deg, rgba(8,8,8,0.00), rgba(0,0,0,0.6));
  border-top: 1px solid rgba(255,255,255,0.03);
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:space-between;
}
.preorder-modal .preorder-cta .price {
  font-weight:900;
  font-size:16px;
  color: var(--accent-2);
  min-width:120px;
  text-align:left;
}
.preorder-modal .preorder-cta .btn {
  min-width: 140px;
  padding:12px 14px;
  border-radius:12px;
  font-weight:900;
}

/* disabled state for submit */
.preorder-modal .btn[disabled] {
  opacity: 0.4;
  transform: none;
  pointer-events: none;
}

/* small close button top-right */
.preorder-modal .preorder-close {
  position:absolute;
  right: 10px;
  top: 8px;
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:18px;
  padding:8px;
  z-index: 10;
}

/* success state/shimmer for confirmation */
.preorder-modal .success {
  display:none;
  padding:18px;
  text-align:center;
  color: var(--accent-2);
  font-weight:900;
}
.preorder-modal.success-visible .success { display:block; }
.preorder-modal.success-visible .modal-inner-preorder { opacity: 0.2; pointer-events: none; }

/* Animations */
@keyframes preorder-overlay-in {
  from { opacity: 0; } to { opacity: 1; }
}
@keyframes preorder-card-in {
  from { transform: translateY(22px); opacity: 0; } to { transform: translateY(0); opacity: 1; }
}

/* Responsive tweaks for larger screens */
@media (min-width: 640px) {
  .preorder-modal { align-items: center; padding: 30px; }
  .preorder-modal .modal-inner-preorder { width: 560px; border-radius: 12px; }
  .preorder-modal .preorder-body { padding-bottom: 16px; max-height: calc(100vh - 160px); }
  .preorder-modal .preorder-cta { position: relative; background: transparent; border-top: none; }
}
/* End of menu styles */
</style>
  <style>
    /* -------------------------
   INPUT VISIBILITY FIX — paste after your other styles
   Applies to #checkout-page (Complete Order) and menu controls (.select, .addon)
   ------------------------- */

:root{
  /* fallback highlight when needed */
  --input-bg: rgba(255,255,255,0.03);
  --input-border: rgba(255,255,255,0.10);
  --placeholder: rgba(255,255,255,0.72);
  --input-focus: rgba(255,204,51,0.16);
}

/* Generic inputs / textareas used in checkout & preorders */
#checkout-page .input,
#preorder-modal .input,
#checkout-full-modal .input,
.input, input[type="text"], input[type="tel"], input[type="email"], textarea,
.select {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  /* slightly brighter so it sits above the page background */
  border: 1px solid var(--input-border);
  color: #fff !important;
  padding: 10px 12px;
  border-radius: 10px;
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.45);
  -webkit-appearance: none;
  appearance: none;
  outline: none;
}

/* Ensure placeholder text is readable */
input::placeholder, textarea::placeholder, .input::placeholder,
.select::placeholder {
  color: var(--placeholder) !important;
  opacity: 1;
}

/* Stronger focus state for accessibility */
#checkout-page .input:focus,
#preorder-modal .input:focus,
.input:focus,
.select:focus,
select:focus {
  box-shadow: 0 6px 24px var(--input-focus), inset 0 2px 6px rgba(0,0,0,0.5);
  border-color: rgba(255,204,51,0.22);
  outline: none;
  transform: translateZ(0);
}

/* Selects: show custom arrow and make the arrow visible on dark background */
.select, select {
  background-image:
    linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)),
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24'%3E%3Cpath fill='%23FFFFFF' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 14px;
  padding-right: 38px; /* room for arrow */
  cursor: pointer;
}

/* Make select text bold & clear */
.select, select { font-weight:800; color:#fff; }

/* Checkbox / addon styling — uses markup: <label class="addon"><input type="checkbox"/><span>Label</span></label> */
.addon {
  --box-size: 18px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color: rgba(255,255,255,0.92);
  cursor: pointer;
}

/* Visually hide native checkbox but keep accessible — we style a clear square instead */
.addon input[type="checkbox"] {
  -webkit-appearance: none;
  appearance: none;
  width: var(--box-size);
  height: var(--box-size);
  min-width: var(--box-size);
  display:inline-grid;
  place-items: center;
  border-radius: 6px;
  border: 2px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.02);
  margin: 0;
  transition: background 180ms ease, border-color 180ms ease, box-shadow 180ms ease, transform 120ms ease;
}

/* Unchecked: subtle contrast */
.addon input[type="checkbox"] + span { position: relative; padding-left: 0; }

/* Checked state: gradient + subtle checkmark */
.addon input[type="checkbox"]:checked {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  border-color: rgba(255,255,255,0.02);
  box-shadow: 0 8px 24px rgba(255,106,0,0.12);
  transform: translateY(-1px);
}

/* place a checkmark using adjacent span ::before for crisp vector-free rendering */
.addon input[type="checkbox"]:checked + span::before {
  content: '✔';
  position: absolute;
  left: -26px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 13px;
  color: #111;
  font-weight: 900;
  line-height: 1;
  /* give it a circle-like padding so it sits within the checkbox area visually */
  width: var(--box-size);
  height: var(--box-size);
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* ensure the text next to checkbox remains readable */
.addon span { color: rgba(255,255,255,0.95); font-weight:800; }

/* When the checkbox is focused via keyboard, show clear ring */
.addon input[type="checkbox"]:focus {
  outline: 3px solid rgba(255,204,51,0.14);
  outline-offset: 2px;
}

/* Make radio / hidden inputs / small selects visible inside modal / checkout too */
#checkout-page select, #checkout-page .input, #checkout-page textarea { color: #fff !important; }

/* Print/Save as PDF hints:
   - When printing we want input values to be visible (browser may hide backgrounds).
   - This rule brightens inputs when printing.
*/
@media print {
  input, textarea, select { background: #ffffff !important; color: #000 !important; -webkit-print-color-adjust: exact; }
  .addon input[type="checkbox"] { background: #000 !important; color:#fff !important; }
}
  </style>
  <style>
/* =========================
   Wrap District — Remaining UI: Modals, Promo Details, Mobile Nav, Entry Modal,
   Contact/Footer, Global utilities and finishing touches.
   Mobile-first, polished, accessible.
   Drop into your stylesheet after other styles.
   ========================= */

/* Reuse / fallback variables */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --glass: rgba(255,255,255,0.03);
  --glass-strong: rgba(255,255,255,0.06);
  --bg-dark: #071013;
  --card-shadow: 0 12px 40px rgba(0,0,0,0.6);
  --max-width: 420px;
  --safe-top: env(safe-area-inset-top, 12px);
  --radius-lg: 14px;
}

/* ---------- GLOBAL / UTILITIES ---------- */
.container-small{ max-width:var(--max-width); margin:0 auto; padding:0 14px; box-sizing:border-box; }
.muted{ color: rgba(255,255,255,0.6); }
.small{ font-size:12px; color: rgba(255,255,255,0.7); }
.lead{ color: rgba(255,255,255,0.9); font-weight:700; }

/* subtle glass card */
.glass-card{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  border-radius: 12px;
  box-shadow: var(--card-shadow);
  padding: 12px;
}

/* Links */
a { color: var(--accent-2); text-decoration: none; }
a:focus, button:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 2px; }

/* ---------- MOBILE NAV (OFF-CANVAS) ---------- */
.mobile-nav{
  position: fixed;
  top: calc(56px + var(--safe-top));
  right: 0;
  left: 0;
  bottom: 0;
  background: linear-gradient(180deg, rgba(6,6,6,0.98), rgba(4,4,4,0.98));
  z-index: 1300;
  display: none;
  padding: 20px 14px;
  box-sizing: border-box;
  overflow-y: auto;
}
.mobile-nav[aria-hidden="false"]{ display:block; }
.mobile-nav-inner{ max-width: var(--max-width); margin: 0 auto; }
.mobile-nav .nav-list{ list-style:none; padding:0; margin: 20px 0; display:flex; flex-direction:column; gap:12px; }
.mobile-nav .nav-link{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 14px;
  border-radius: 10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border: 1px solid rgba(255,255,255,0.03);
  color: #fff;
  font-weight:800;
}
.mobile-nav .nav-link i{ width:20px; text-align:center; color: var(--accent-2); }

/* ---------- MODALS (generic) ---------- */
.modal{
  position: fixed;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1600;
  padding: 20px;
  background: rgba(3,3,3,0.6);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}
.modal[aria-modal="true"]{ display:flex; }

.modal .modal-inner{
  width: 100%;
  max-width: 420px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(6,6,6,0.98));
  border: 1px solid rgba(255,255,255,0.03);
  padding: 14px;
  box-shadow: 0 30px 80px rgba(0,0,0,0.65);
  transform: translateY(12px);
  transition: transform 260ms cubic-bezier(.2,.9,.3,1), opacity 240ms ease;
}
.modal .modal-inner .modal-body{ padding: 6px 2px; }
.modal .modal-close{ position:absolute; right:14px; top:12px; background:transparent; border:0; color:var(--muted); font-size:18px; }

/* small CTA in modal */
.modal .modal-actions{ display:flex; gap:10px; margin-top:10px; align-items:center; justify-content:flex-start; }

/* ---------- ENTRY PROMO STYLE (slide-in modal variant) ---------- */
.entry-promo.modal .modal-inner{
  background: linear-gradient(90deg, rgba(255,106,0,0.09), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,204,51,0.08);
}
.entry-promo .lead{ font-size:15px; color:#fff; }

/* "Don't show again" label */
.dont-show{ display:flex; gap:8px; align-items:center; font-size:13px; color: rgba(255,255,255,0.8); margin-top:10px; }
.dont-show input{ width:18px; height:18px; }

/* ---------- PROMO DETAILS SECTION (in-page) ---------- */
.promo-detail{
  width: 100%;
  max-width: var(--max-width);
  margin: 6px auto 18px;
  padding: 0 14px;
  box-sizing: border-box;
}
.promo-copy{
  margin-top:8px;
  display:flex;
  gap:12px;
  flex-direction:column;
}
.promo-copy p{ margin: 6px 0; color: rgba(255,255,255,0.9); font-weight:700; }
.promo-help{ margin-top:8px; color: rgba(255,255,255,0.78); font-size:13px; }

/* Promo countdown inline chip used elsewhere */
.promo-countdown-chip{
  display:inline-flex;
  gap:8px;
  align-items:center;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:8px 10px;
  border-radius: 999px;
  font-weight:900;
  box-shadow: 0 12px 30px rgba(255,106,0,0.12);
}

/* ---------- PROMO DETAILS - HELPFUL MICROCOPY ---------- */
.promo-note-inline{
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:space-between;
  background: rgba(255,255,255,0.02);
  padding:10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.02);
  color: rgba(255,255,255,0.9);
}

/* ---------- CONTACT / FOOTER ---------- */
.site-footer{
  width:100%;
  max-width: var(--max-width);
  margin: 20px auto 40px;
  padding: 12px 14px;
  box-sizing: border-box;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
}
.footer-row{
  display:flex;
  gap:12px;
  justify-content:space-between;
  align-items:flex-start;
  flex-direction:row;
}
.footer-left, .footer-right{ flex:1 1 50%; }
.footer-left h4, .footer-right h4{ margin:0 0 6px; color: var(--accent-2); font-weight:900; }
.footer-left p, .footer-right p{ margin:6px 0; color: rgba(255,255,255,0.8); font-weight:700; }
.footer-bottom{ margin-top:12px; text-align:center; color: rgba(255,255,255,0.6); font-size:12px; }

/* Footer small screen layout */
@media (max-width:520px){
  .footer-row{ flex-direction:column; gap:10px; }
}

/* ---------- TOAST / TEMP FEEDBACK (inline) ---------- */
.toast {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 14px;
  z-index: 1800;
  background: rgba(0,0,0,0.7);
  color: #fff;
  padding: 10px 14px;
  border-radius: 999px;
  font-weight:800;
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  display:none;
}
.toast.show{ display:block; animation: toast-in 320ms cubic-bezier(.2,.9,.3,1); }
@keyframes toast-in { from { opacity:0; transform: translateX(-50%) translateY(8px); } to { opacity:1; transform: translateX(-50%) translateY(0); } }

/* ---------- FORMS / INPUTS (if used in future) ---------- */
.input, input[type="text"], input[type="tel"], textarea {
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:700;
  box-sizing: border-box;
}

/* ---------- SMALL POLISH: focus ring for keyboard users ---------- */
:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset:2px; border-radius:8px; }

/* ---------- PRINT & REDUCTION (if user prints) ---------- */
@media print {
  body * { visibility: hidden; }
  #cart-drawer, #cart-drawer * { visibility: visible; }
}
/* -------------------------
   Premium Mobile-First Footer
   Paste this after existing styles (overrides old .site-footer)
   ------------------------- */
.site-footer {
  width: 100%;
  max-width: 420px;
  margin: 18px auto 34px;
  box-sizing: border-box;
  padding: 14px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(18,18,18,0.98), rgba(8,8,8,0.95));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  color: #fff;
  font-weight: 700;
  -webkit-font-smoothing: antialiased;
}

/* Top callout */
.footer-top {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}
.footer-brand {
  display:flex;
  gap:10px;
  align-items:center;
}
.footer-brand .logo-mark { font-size:14px; padding:6px 10px; border-radius:10px; }
.footer-brand .tagline { font-size:13px; color: rgba(255,255,255,0.88); font-weight:900; }

/* CTA group */
.footer-ctas { display:flex; gap:8px; align-items:center; }
.btn-footer {
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:12px;
  font-weight:900;
  font-size:14px;
  border:0;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
}
.btn-order {
  background: linear-gradient(90deg, var(--accent-1, #FF6A00), var(--accent-2, #FFD166));
  color:#111;
  box-shadow: 0 12px 36px rgba(255,106,0,0.12);
}
.btn-wa {
  background: rgba(255,255,255,0.03);
  color: var(--accent-2, #FFD166);
  border: 1px solid rgba(255,255,255,0.04);
}

/* Footer content layout */
.footer-grid {
  display:flex;
  gap:12px;
  margin-top:6px;
  align-items:flex-start;
  justify-content:space-between;
  flex-direction:column;
}
.footer-row {
  display:flex;
  gap:10px;
  align-items:flex-start;
  justify-content:space-between;
  width:100%;
}
.footer-left, .footer-right {
  width:100%;
}

/* contact list */
.contact-list { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
.contact-row { display:flex; gap:10px; align-items:center; color: rgba(255,255,255,0.9); font-weight:800; font-size:14px; }
.contact-row i { color: var(--accent-2, #FFD166); min-width:22px; text-align:center; }

/* small meta blocks */
.meta-block { margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:space-between; }
.meta-block .hours { color: rgba(255,255,255,0.85); font-weight:800; }
.meta-block .delivery { color: rgba(255,255,255,0.78); font-weight:700; font-size:14px; }

/* pickup / map small row */
.pickup {
  margin-top:10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.03);
  display:flex;
  align-items:center;
  gap:10px;
  color: rgba(255,255,255,0.88);
  font-weight:800;
  font-size:13px;
}

/* bottom legal line */
.footer-bottom {
  margin-top:12px;
  font-size:12px;
  color: rgba(255,255,255,0.6);
  text-align:center;
}

/* responsive layout — two columns on wider phones */
@media (min-width: 420px) {
  .footer-grid { flex-direction: row; }
  .footer-left, .footer-right { width: 50%; }
  .footer-top { gap: 18px; }
}

/* small accessibility */
.site-footer a { color: inherit; text-decoration: none; }
.site-footer button:focus, .site-footer a:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 3px; border-radius:10px; }
    
/* ---------- END of remaining UI styles ---------- */
</style>
</head>
<body>
  <!-- STICKY HEADER (mobile-first: only logo, cart with badge, hamburger) -->
  <header id="site-header" class="sticky-header" role="banner" aria-live="polite">
    <div class="header-inner">
      <!-- Logo (left) -->
      <div class="logo" aria-label="Wrap District logo">
        <span class="logo-mark">WRAP</span>
        <span class="logo-name">District</span>
      </div>

      <!-- Cart (center/right) -->
      <button id="cart-toggle" class="icon-btn cart-btn" aria-haspopup="dialog" aria-controls="cart-drawer" aria-label="Open cart">
        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
        <span id="cart-count" class="cart-count" aria-live="polite">0</span>
      </button>

      <!-- Hamburger -->
      <button id="hamburger" class="icon-btn ham-btn" aria-expanded="false" aria-controls="mobile-nav" aria-label="Open menu">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </div>
  </header>

  <!-- MOBILE NAV (off-canvas) -->
  <nav id="mobile-nav" class="mobile-nav" aria-hidden="true">
    <div class="mobile-nav-inner">
      <button id="nav-close" class="icon-btn" aria-label="Close menu"><i class="fa fa-times"></i></button>
      <ul class="nav-list">
        <li><a href="#hero" class="nav-link"><i class="fa fa-home"></i> Home</a></li>
        <li><a href="#menu" class="nav-link"><i class="fa fa-list"></i> Menu</a></li>
        <li><a href="#promo" class="nav-link"><i class="fa fa-bullhorn"></i> Promo</a></li>
        <li><a href="#contact" class="nav-link"><i class="fa fa-map-marker"></i> Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- HERO: Mobile-first slideshow with 3 slides -->
  <main id="main">
    <section id="hero" class="hero-slideshow" aria-roledescription="carousel" aria-label="Hero slideshow">
      <div class="slides" id="slides">
        <!-- Slide 1: Business introduction (wraps & brand) -->
        <article class="slide" data-slide-index="0" aria-hidden="false">
          <img class="slide-img" src="hero-shawarma-large.jpg" alt="Close up shawarma wrap">
          <div class="slide-overlay">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-fire"></i> Fresh & Hot</p>
              <h1 class="slide-title">Shawarma & Wraps — Made to Order</h1>
              <p class="slide-sub">Premium fillings, house sauces, and fast delivery to Tema Community 25.</p>
              <div class="slide-ctas">
                <a href="#menu" class="btn primary"><i class="fa fa-utensils"></i> See Menu</a>
                <button class="btn ghost" data-action="order-now" data-feature="shawarma"><i class="fa fa-phone"></i> Order via WhatsApp</button>
              </div>
              <!-- decorative icons/artwork -->
              <div class="slide-art">
                <i class="fa fa-leaf art-icon"></i>
                <i class="fa fa-star art-icon"></i>
              </div>
            </div>
          </div>
        </article>

        <!-- Slide 2: Business highlight (fries & rice) -->
        <article class="slide" data-slide-index="1" aria-hidden="true">
          <img class="slide-img" src="hero-fries-large.jpg" alt="Loaded fries">
          <div class="slide-overlay">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-thumbs-up"></i> Crowd Favorite</p>
              <h2 class="slide-title">Loaded Fries • Fried Rice • Angwamo</h2>
              <p class="slide-sub">Generous portions, tasty toppings, and affordable tiers.</p>
              <div class="slide-ctas">
                <a href="#menu" class="btn primary"><i class="fa fa-list-alt"></i> Explore Portions</a>
                <a href="#promo" class="btn ghost"><i class="fa fa-gift"></i> Current Deals</a>
              </div>
              <div class="slide-art">
                <i class="fa fa-bolt art-icon"></i>
                <i class="fa fa-heart art-icon"></i>
              </div>
            </div>
          </div>
        </article>

        <!-- Slide 3: Promo -->
        <article class="slide" data-slide-index="2" aria-hidden="true">
          <img class="slide-img" src="promo-shawarma.jpg" alt="Promo: buy 2 get 1">
          <div class="slide-overlay slide-promo">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-clock"></i> Limited Time</p>
              <h2 class="slide-title">Tuesday Promo — Buy 2 Shawarmas, Get 1 Free</h2>
              <p class="slide-sub">Loaded Fries come with a free Coke when ordered during promo hours.</p>

           <!-- inside your Slide 3 slide-content where promo-cta-row exists -->
<div class="promo-cta-row">
  <button class="btn primary" data-action="apply-promo" data-promo-code="TUES-B2G1">
    <i class="fa fa-tag"></i> Claim Promo
  </button>

  <button class="btn ghost" data-action="learn-more" aria-controls="promo-details">
    <i class="fa fa-info-circle"></i> Details
  </button>

  <!-- NEW: Preorder button for the upcoming promo -->
  <button class="btn primary" data-action="preorder-promo" id="promo-preorder-btn">
    <i class="fa fa-calendar-check"></i> Preorder for next promo
  </button>
</div>

              <div class="promo-urgency">
                <span class="promo-countdown" id="promo-countdown" aria-live="polite">Promo ends in: <strong id="promo-timer">—</strong></span>
                <small class="promo-note">Next promo: Tuesdays • Add 2 Shawarmas to auto-apply.</small>
              </div>
            </div>
          </div>
        </article>
      </div>

      <!-- slideshow controls -->
      <div class="slideshow-controls">
        <button class="slide-prev icon-btn" aria-label="Previous slide"><i class="fa fa-chevron-left"></i></button>
        <div id="slide-dots" class="slide-dots" role="tablist" aria-label="Slide dots">
          <button class="dot is-active" data-index="0" aria-label="Slide 1"></button>
          <button class="dot" data-index="1" aria-label="Slide 2"></button>
          <button class="dot" data-index="2" aria-label="Slide 3"></button>
        </div>
        <button class="slide-next icon-btn" aria-label="Next slide"><i class="fa fa-chevron-right"></i></button>
      </div>
    </section>

    <!-- MENU: mobile-friendly, card-based, not a long table -->
<!-- MENU: mobile-friendly, card-based, improved -->
<section id="menu" class="menu-section" aria-labelledby="menu-heading">
  <div class="container-small">
    <h2 id="menu-heading" class="section-title"><i class="fa fa-utensils"></i> Menu</h2>
    <p class="section-sub">Tap an item to configure size, protein and add-ons. Use the tabs to filter quickly.</p>

    <!-- Category tabs (mobile horizontal scroll) -->
    <div class="menu-tabs" role="tablist" aria-label="Menu categories">
      <button class="tab-btn is-active" data-cat="all" role="tab" aria-selected="true">All</button>
      <button class="tab-btn" data-cat="wraps" role="tab">Wraps</button>
      <button class="tab-btn" data-cat="fries" role="tab">Fries</button>
      <button class="tab-btn" data-cat="rice" role="tab">Rice</button>
      <button class="tab-btn" data-cat="angwamo" role="tab">Angwamo</button>
      <button class="tab-btn" data-cat="noodles" role="tab">Noodles</button>
    </div>

    <!-- visual container for menu items -->
    <div class="menu-container glass-card">
      <div class="menu-grid" id="menu-grid">
        <!-- Shawarma (structured pricing tiers) -->
        <article class="menu-item" id="item-shawarma" data-item-id="shawarma" data-category="wraps" data-promo="buy2get1" tabindex="0">
          <!-- ...same inner markup as before (keeps selects/addons) ... -->
          <div class="item-top">
            <img class="item-thumb" src="thumb-shawarma.jpg" alt="Shawarma thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Shawarma <span class="badge promo-badge">Buy 2 → 1 Free</span></h3>
              <p class="item-desc">Choose size, then protein. Clear pricing tiers.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Size</label>
            <select class="select size-select" name="shawarma-size" aria-label="Shawarma size" data-item="shawarma">
              <option value="45" data-size-key="lite">Lite — GHC 45</option>
              <option value="55" data-size-key="classic">Classic — GHC 55</option>
              <option value="70" data-size-key="district-max">District Max — GHC 70</option>
            </select>

            <label class="label">Protein</label>
            <select class="select protein-select" name="shawarma-protein" aria-label="Shawarma protein" data-item="shawarma">
              <option value="0" data-protein="none">No meat (Veg) — +GHC 0</option>
              <option value="5" data-protein="chicken">Chicken — +GHC 5</option>
              <option value="10" data-protein="beef">Beef — +GHC 10</option>
              <option value="15" data-protein="mixed">Mixed — +GHC 15</option>
            </select>

            <div class="item-addons">
              <label class="label">Extras</label>
              <div class="addons-row">
                <label class="addon">
                  <input type="checkbox" class="addon-checkbox" value="5" data-addon-key="extra-sauce" />
                  <span>Extra Sauce (+GHC 5)</span>
                </label>
                <label class="addon">
                  <input type="checkbox" class="addon-checkbox" value="10" data-addon-key="cheese" />
                  <span>Extra Cheese (+GHC 10)</span>
                </label>
              </div>
            </div>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">45</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="shawarma">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="shawarma">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Loaded Fries -->
        <article class="menu-item" id="item-fries" data-item-id="loaded-fries" data-category="fries" data-promo="freecoke" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="thumb-fries.jpg" alt="Loaded fries thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Loaded Fries <span class="badge promo-badge-small">Free Coke</span></h3>
              <p class="item-desc">Choose portion & add protein/cheese.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Portion</label>
            <select class="select portion-select" name="fries-portion" aria-label="Fries portion" data-item="loaded-fries">
              <option value="55" data-size="regular">Regular — GHC 55</option>
              <option value="65" data-size="large">Large — GHC 65</option>
            </select>

            <label class="label">Toppings</label>
            <div class="addons-row">
              <label class="addon">
                <input type="checkbox" class="addon-checkbox" value="15" data-addon-key="extra-chicken" />
                <span>Extra Chicken (+GHC 15)</span>
              </label>
              <label class="addon">
                <input type="checkbox" class="addon-checkbox" value="10" data-addon-key="extra-cheese" />
                <span>Extra Cheese (+GHC 10)</span>
              </label>
            </div>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">55</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="loaded-fries">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="loaded-fries">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Fried Rice -->
        <article class="menu-item" id="item-fried-rice" data-item-id="fried-rice" data-category="rice" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="hero-friedrice-large.jpg" alt="Fried rice thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Fried Rice</h3>
              <p class="item-desc">Classic spiced fried rice — choose protein.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Choice</label>
            <select class="select protein-select" name="rice-protein" aria-label="Fried rice protein" data-item="fried-rice">
              <option value="60" data-protein="chicken">Classic (+Chicken) — GHC 60</option>
              <option value="60" data-protein="beef">Beef (+Beef) — GHC 60</option>
              <option value="60" data-protein="gizzard">Gizzard (+Gizzard) — GHC 60</option>
            </select>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">60</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="fried-rice">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="fried-rice">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Loaded Angwamo -->
        <article class="menu-item" id="item-angwamo" data-item-id="loaded-angwamo" data-category="angwamo" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="hero-angwamo-large.jpg" alt="Angwamo thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Loaded Angwamo</h3>
              <p class="item-desc">Tiered: Basic / Classic / Max</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Tier</label>
            <select class="select tier-select" name="angwamo-tier" aria-label="Angwamo tier" data-item="loaded-angwamo">
              <option value="55" data-tier="basic">Basic — GHC 55</option>
              <option value="60" data-tier="classic">Classic — GHC 60</option>
              <option value="70" data-tier="max">Max — GHC 70</option>
            </select>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">55</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="loaded-angwamo">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="loaded-angwamo">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Noodles -->
        <article class="menu-item" id="item-noodles" data-item-id="noodles" data-category="noodles" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="thumb-noodle.jpg" alt="Noodles thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Noodles</h3>
              <p class="item-desc">Assorted proteins available — GHC 50</p>
            </div>
          </div>

          <div class="item-config">
            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Price</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">50</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="noodles">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="noodles">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

      </div> <!-- .menu-grid -->
    </div> <!-- .menu-container -->
  </div>
</section>

    <!-- PROMO DETAILS (collapsible region referenced by the slide CTA) -->
    <section id="promo" class="promo-detail" aria-labelledby="promo-heading">
      <div class="container-small">
        <h2 id="promo-heading" class="section-title"><i class="fa fa-gift"></i> Promo</h2>
        <div id="promo-details" class="promo-copy">
          <p><strong>Buy 2 Shawarmas, Get 1 Free (Tuesdays)</strong> — Promo applies automatically at checkout. Add two qualifying shawarmas and the third will be discounted to free.</p>
          <p><strong>Loaded Fries</strong> — Get a free Coke when purchasing during promo hours. Free item will appear in cart once qualifying product is added.</p>
         <!-- somewhere inside #promo-details (promo-copy) -->
<div style="margin-top:10px;">
  <button class="btn primary" data-action="preorder-promo">Preorder for next Tuesday Promo</button>
</div>
          <div class="promo-help">
            <small id="promo-helper" class="muted">Tip: use the "Add missing items" button in cart to reach a promo threshold instantly.</small>
          </div>
        </div>
      </div>
    </section>

    <!-- CART DRAWER (off-canvas, mobile-friendly) -->
    <aside id="cart-drawer" class="cart-drawer" role="dialog" aria-label="Shopping cart" aria-hidden="true">
      <div class="cart-header">
        <h3>Your Cart <span class="cart-mini-count" id="cart-mini-count">0</span></h3>
        <button class="icon-btn" id="cart-close" aria-label="Close cart"><i class="fa fa-times"></i></button>
      </div>

      <div class="cart-body" id="cart-body">
        <!-- line items will be injected here by JS -->
        <ul id="cart-items" class="cart-items" aria-live="polite"></ul>

        <!-- promo helper / discount line -->
        <div id="cart-promo" class="cart-promo hidden" aria-live="polite">
          <div class="promo-applied">
            <span class="promo-label">Promo discount</span>
            <span class="promo-value" id="promo-discount">-GHC 0</span>
          </div>
          <div class="promo-cta">
            <small id="promo-help-text">Add 1 more Shawarma to get one free.</small>
            <button class="btn tiny" id="add-missing">Add missing items</button>
          </div>
        </div>

        <div class="cart-summary">
          <div class="summary-row">
            <span>Subtotal</span>
            <strong id="cart-subtotal">GHC 0</strong>
          </div>
          <div class="summary-row">
            <span>Delivery</span>
            <strong id="cart-delivery">GHC 0</strong>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <strong id="cart-total">GHC 0</strong>
          </div>
        </div>
      </div>

      <div class="cart-footer">
  <div class="footer-summary" style="display: none">
    <div>
      <div class="small">Subtotal</div>
      <div class="total-label">Total</div>
    </div>
    <div style="margin-left:auto; text-align:right;">
      <div id="footer-subtotal" class="small">GHC 0</div>
      <div id="footer-total" class="total-value">GHC 0</div>
    </div>
  </div>

  <div class="footer-actions" style="margin-left:12px;">
    <button id="checkout-btn" class="btn primary" data-action="checkout" style="min-width:120px;">
      <i class="fa fa-credit-card"></i> Pay
    </button>
    <button id="clear-cart" class="btn ghost" data-action="clear" style="min-width:80px;">
      <i class="fa fa-trash"></i>
    </button>
  </div>
</div>
    </aside>

    <!-- ENTRY PROMO MODAL / SLIDE-IN for new visitors -->
    <div id="entry-promo" class="entry-promo modal hidden" role="dialog" aria-modal="true" aria-label="Tuesday Promo">
      <div class="modal-inner">
        <button id="entry-close" class="icon-btn modal-close" aria-label="Close promo"><i class="fa fa-times"></i></button>
        <div class="modal-body">
          <h3><i class="fa fa-gift"></i> Tuesday Promo</h3>
          <p class="lead">Buy 2 Shawarmas, get one free. Valid Tuesdays. Tap to claim now.</p>
          <div class="modal-actions">
            <button class="btn primary" id="claim-promo-entry" data-promo="TUES-B2G1"><i class="fa fa-tag"></i> Claim Promo</button>
            <label class="dont-show">
              <input type="checkbox" id="dont-show-again" />
              Don't show again
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- CONTACT / FOOTER -->
<footer id="contact" class="site-footer" role="contentinfo" aria-label="Contact and footer">
  <div class="footer-top">
    <div class="footer-brand" aria-hidden="false">
      <span class="logo-mark">WRAP</span>
      <div style="display:flex;flex-direction:column;">
        <span class="logo-name" style="font-weight:900; color:var(--accent-2)">District</span>
        <small class="tagline">Fresh. Hot. Fast — Delivered to Tema</small>
      </div>
    </div>

    <div class="footer-ctas" role="group" aria-label="Footer actions">
      <!-- Order: scrolls to menu / opens cart -->
      <button id="footer-order" class="btn-footer btn-order" aria-label="Order now">
        <i class="fa fa-utensils" aria-hidden="true"></i> Order
      </button>

      <!-- WhatsApp quick contact -->
      <a id="footer-wa" class="btn-footer btn-wa" href="https://wa.me/233552509241" target="_blank" rel="noopener noreferrer" aria-label="Chat on WhatsApp">
        <i class="fa fa-whatsapp" aria-hidden="true"></i> WhatsApp
      </a>
    </div>
  </div>

  <div class="footer-grid">
    <div class="footer-left">
      <div class="contact-list">
        <div class="contact-row"><i class="fa fa-phone"></i><a href="tel:0552509241">0552509241</a></div>
        <div class="contact-row"><i class="fa fa-map-marker"></i><span>Tema Community 25, Devtraco</span></div>
        <div class="contact-row"><i class="fa fa-snapchat-ghost"></i><span>@kenneth_idk</span></div>
      </div>

      <div class="pickup" aria-hidden="false">
        <i class="fa fa-store"></i>
        <div style="flex:1;">
          <div style="font-weight:900">Pickup available</div>
          <small style="color:rgba(255,255,255,0.78)">Devtraco — Tap Order to choose Pickup or Delivery</small>
        </div>
      </div>
    </div>

    <div class="footer-right">
      <div class="meta-block">
        <div class="hours"><i class="fa fa-clock"></i>&nbsp; Hours</div>
        <div style="text-align:right">
          <div style="font-weight:900">Mon–Fri: 5pm • Sat–Sun: 9am</div>
          <div class="delivery" style="margin-top:4px">Delivery: Available — fees at checkout</div>
        </div>
      </div>

      <div style="margin-top:10px">
        <button id="footer-locate" class="btn-footer btn-wa" aria-label="Show pickup location">
          <i class="fa fa-map"></i> Our location
        </button>
      </div>
    </div>
  </div>

  <div class="footer-bottom">
    <small>© Wrap District — Built for mobile • Images and prices subject to change</small>
  </div>
</footer>
    <!-- PREORDER MODAL -->
<div id="preorder-modal" class="modal" role="dialog" style ="display: none" aria-modal="true" aria-hidden="true">
  <div class="modal-inner">
    <button class="icon-btn modal-close" id="preorder-close" aria-label="Close"><i class="fa fa-times"></i></button>
    <div class="modal-body">
      <h3><i class="fa fa-calendar-plus"></i> Preorder for next Promo</h3>
      <p class="lead">We will reserve your current cart items for the next Tuesday promo window.</p>

      <form id="preorder-form">
        <label class="label">Name</label>
        <input id="preorder-name" class="input" type="text" placeholder="Your name" required>

        <label class="label">Phone</label>
        <input id="preorder-phone" class="input" type="tel" placeholder="0550xxxxxx" required>

        <label class="label">Note (optional)</label>
        <input id="preorder-note" class="input" type="text" placeholder="Delivery/pickup notes">

        <div style="display:flex; gap:8px; margin-top:10px;">
          <button type="submit" class="btn primary" id="preorder-confirm"><i class="fa fa-check"></i> Confirm Preorder</button>
          <button type="button" class="btn ghost" id="preorder-cancel">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
  </main>
  <!-- ===== Menu tabs + Cart header checkout enhancements ===== -->

  <style>
/* Checkout page (in-file, not a modal) — REPLACED: ensures it sits below the header and is scrollable on mobile */
#checkout-page {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 3200;
  background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6));
  /* place checkout below the fixed header so it doesn't get overlapped by browser UI */
  align-items: flex-start;
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
  /* allow the page container itself to scroll if content taller than viewport */
  overflow: auto;
}
#checkout-page[aria-hidden="false"] { display: flex; }

/* keep the inner dialog visually below the header and inside safe area */
#checkout-inner {
  width: 100%;
  max-width: 920px;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  background: linear-gradient(180deg,#080808,#050505);
  color: #fff;
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 0;
  /* push the dialog down so it appears like a page below your header + safe-area */
  margin-top: calc(56px + var(--safe-top, 12px) + 12px);
  /* keep the dialog height bounded so inner columns can scroll independently */
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 48px));
}
@media (max-width: 900px) { #checkout-inner { grid-template-columns: 1fr; } }

/* left and right columns should scroll individually */
.checkout-left {
  padding: 16px 18px;
  max-height: 100%;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}
.checkout-right {
  padding: 16px 18px;
  border-left: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  overflow: auto;
  max-height: 100%;
  -webkit-overflow-scrolling: touch;
}

/* small banner to highlight delivery-not-included message (style used by script) */
#checkout-delivery-note {
  display: block;
  margin-top: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  background: linear-gradient(90deg, rgba(255,160,80,0.06), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,160,80,0.08);
  color: rgba(255,255,255,0.9);
  font-weight:800;
  font-size:13px;
}

/* small responsive tweaks */
@media (max-width:600px){
  .checkout-right { padding-top:6px; }
  .order-line img { width:56px; height:44px; }
  .checkout-title { font-size:16px; }
}
</style>
  <style>
/* header right area inside cart header */
.cart-header .cart-header-right {
  display:flex;
  align-items:center;
  gap:10px;
  margin-left:auto;
}
.cart-header .cart-header-total {
  font-weight:900;
  color: var(--accent-2);
  font-size:14px;
  text-align:right;
  min-width:80px;
}
.cart-header .cart-header-checkout {
  border:0;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  padding:8px 10px;
  border-radius:10px;
  display:inline-flex;
  gap:8px;
  align-items:center;
  cursor:pointer;
  box-shadow: 0 8px 26px rgba(255,106,0,0.10);
}
.cart-header .cart-header-checkout:active { transform: translateY(1px) scale(.995); }
.tab-btn[role="tab"] { cursor:pointer; }
</style>


<!-- Product detail modal (Task 2) -->
<style>
/* Basic modal sizing tweaks (uses existing .modal/.modal-inner from your CSS) */
#product-modal .modal-inner { max-width:520px; width:100%; padding:0; border-radius:14px; overflow:hidden; }
#product-modal .pm-header{ display:flex; gap:12px; padding:12px; align-items:center; background:linear-gradient(180deg, rgba(10,10,10,0.98), rgba(6,6,6,0.98)); border-bottom:1px solid rgba(255,255,255,0.03);}
#product-modal .pm-thumb{ width:110px; height:86px; object-fit:cover; border-radius:10px; flex: 0 0 110px; border:1px solid rgba(255,255,255,0.04); }
#product-modal .pm-title{ font-weight:900; color:#fff; font-size:16px; margin:0; }
#product-modal .pm-body{ padding:12px; max-height:60vh; overflow:auto; background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(8,8,8,0.98)); }
#product-modal .pm-footer{ display:flex; gap:8px; align-items:center; justify-content:space-between; padding:12px; border-top:1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(8,8,8,0.98), rgba(6,6,6,0.98)); }
#product-modal .pm-price{ font-weight:900; color:var(--accent-2); font-size:18px; }
#product-modal .pm-actions .btn{ min-width:120px; }
</style>

<!-- modal skeleton -->
<div id="product-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;">
  <div class="modal-inner">
    <button class="icon-btn modal-close" id="pm-close" aria-label="Close"><i class="fa fa-times"></i></button>
    <div class="pm-header">
      <img src="" alt="" class="pm-thumb" id="pm-thumb">
      <div style="flex:1; min-width:0">
        <h3 class="pm-title" id="pm-title"></h3>
        <div class="small muted" id="pm-desc"></div>
      </div>
    </div>
    <div class="pm-body" id="pm-body">
      <!-- cloned .item-config will be inserted here -->
    </div>
    <div class="pm-footer">
      <div class="pm-price" id="pm-price">GHC 0</div>
      <div class="pm-actions">
        <button id="pm-add" class="btn primary"><i class="fa fa-plus-circle"></i> Add to cart</button>
        <button id="pm-cancel" class="btn ghost">Cancel</button>
      </div>
    </div>
  </div>
</div>
<!-- ========== PAYSTACK FRONTEND: Checkout modal, handlers, InlineJS ========== -->
<!-- InlineJS CDN (Popup V2) - required for resumeTransaction() -->
<script src="https://js.paystack.co/v2/inline.js"></script>


<!-- Leaflet (Map) CSS & JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* Checkout modal (full form) */
#checkout-full-modal { display:none; position:fixed; inset:0; z-index:3000; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; padding:12px; }
#checkout-full-modal[aria-hidden="false"] { display:flex; }
.checkout-full-inner { width:100%; max-width:720px; border-radius:12px; background:linear-gradient(180deg,#0b0b0b,#070707); border:1px solid rgba(255,255,255,0.04); box-shadow:0 40px 120px rgba(0,0,0,0.7); color:#fff; padding:0; overflow:hidden; display:grid; grid-template-columns: 1fr 360px; gap:0; }
@media (max-width:900px) { .checkout-full-inner { grid-template-columns: 1fr; } }

.checkout-left { padding:16px 18px; }
.checkout-right { padding:16px 18px; border-left:1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); overflow:auto; max-height: 82vh; }

.checkout-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
.checkout-title { color:var(--accent-2); font-weight:900; font-size:18px; margin:0; }

.form-row { display:flex; gap:8px; margin-bottom:10px; }
.form-col { flex:1; display:flex; flex-direction:column; gap:6px; }
.input, select, textarea { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#fff; font-weight:800; box-sizing:border-box; }
.input[readonly] { cursor:pointer; background: rgba(255,255,255,0.01); }
.small-muted { color: rgba(255,255,255,0.72); font-size:13px; }

.order-line { display:flex; gap:8px; align-items:center; margin-bottom:10px; }
.order-line img { width:64px; height:48px; object-fit:cover; border-radius:8px; border:1px solid rgba(255,255,255,0.04); }
.order-line .ol-meta { flex:1; min-width:0; }
.order-line .ol-meta strong { display:block; font-weight:900; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.order-line .ol-meta small { color: rgba(255,255,255,0.75); }
.order-line .ol-price { font-weight:900; color:var(--accent-2); min-width:70px; text-align:right; }

.checkout-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
.btn.full { padding:12px 16px; border-radius:12px; font-weight:900; min-width:140px; }
.btn.primary.full { background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); color:#111; border:0; box-shadow: 0 12px 36px rgba(255,106,0,0.12); }

/* Map modal */
#map-modal { display:none; position:fixed; inset:0; z-index:3600; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; padding:8px; }
#map-modal[aria-hidden="false"] { display:flex; }
.map-inner { width:100%; max-width:920px; height:78vh; border-radius:12px; overflow:hidden; background:#fff; display:flex; flex-direction:column; }
.map-top { display:flex; gap:8px; padding:8px; align-items:center; background:#fff; border-bottom:1px solid #eee; }
.map-search { flex:1; padding:8px 12px; border-radius:8px; border:1px solid #ddd; }
#map { flex:1; }
.map-results { max-height:160px; overflow:auto; background:#fff; border-top:1px solid #eee; }
.map-result { padding:8px 10px; border-bottom:1px solid #f1f1f1; cursor:pointer; }
.map-result:hover { background:#f7f7f7; }

.map-actions { display:flex; gap:10px; padding:8px; justify-content:flex-end; background:#fff; border-top:1px solid #eee; }

.toast.wrap-toast { position:fixed; left:50%; transform:translateX(-50%); bottom:18px; z-index:4000; background:rgba(0,0,0,0.85); color:#fff; padding:10px 14px; border-radius:999px; font-weight:800; display:none; }
.toast.wrap-toast.show { display:block; animation: toast-in 320ms cubic-bezier(.2,.9,.3,1); }

</style>




<!-- ===== In-page Checkout Section (Task 3) ===== -->
<style>
/* Checkout page (in-file, not a modal) */
#checkout-page { display: none; position: fixed; inset: 0; z-index: 3200; background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6)); align-items: center; justify-content: center; padding: 12px; box-sizing: border-box; }
#checkout-page[aria-hidden="false"] { display: flex; }
#checkout-inner { width: 100%; max-width: 920px; border-radius: 12px; overflow: hidden; box-shadow: 0 40px 120px rgba(0,0,0,0.7); background: linear-gradient(180deg,#080808,#050505); color: #fff; display: grid; grid-template-columns: 1fr 360px; gap:0; }
@media (max-width: 900px) { #checkout-inner { grid-template-columns: 1fr; } }

.checkout-left { padding: 16px 18px; max-height: 90vh; overflow:auto; }
.checkout-right { padding: 16px 18px; border-left: 1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); overflow:auto; max-height: 90vh; }

.checkout-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
.checkout-title { color: var(--accent-2); font-weight:900; font-size:18px; margin:0; }

.form-row { display:flex; gap:8px; margin-bottom:10px; }
.form-col { flex:1; display:flex; flex-direction:column; gap:6px; }
.input, select, textarea { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#fff; font-weight:800; box-sizing:border-box; }
.input[readonly] { cursor:pointer; background: rgba(255,255,255,0.01); }

.order-line { display:flex; gap:8px; align-items:center; margin-bottom:10px; }
.order-line img { width:64px; height:48px; object-fit:cover; border-radius:8px; border:1px solid rgba(255,255,255,0.04); }
.order-line .ol-meta { flex:1; min-width:0; }
.order-line .ol-meta strong { display:block; font-weight:900; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.order-line .ol-meta small { color: rgba(255,255,255,0.75); }
.order-line .ol-price { font-weight:900; color:var(--accent-2); min-width:70px; text-align:right; }

.checkout-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
.btn.full { padding:12px 16px; border-radius:12px; font-weight:900; min-width:140px; }
.btn.primary.full { background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); color:#111; border:0; box-shadow: 0 12px 36px rgba(255,106,0,0.12); }

/* small helper area */
.checkout-note { color: rgba(255,255,255,0.78); font-size:13px; margin-top:12px; }

/* header close button */
#checkout-close { background:transparent; border:0; color: var(--muted); font-size:18px; padding:8px; }

/* subtle responsive */
@media (max-width:600px){
  .checkout-right { padding-top:6px; }
  .order-line img { width:56px; height:44px; }
  .checkout-title { font-size:16px; }
}
</style>

<section id="checkout-page" aria-hidden="true" role="dialog" aria-label="Checkout page">
  <div id="checkout-inner" role="document">
    <div class="checkout-left">
      <div class="checkout-header">
        <h3 class="checkout-title"><i class="fa fa-shopping-basket"></i> Complete Order</h3>
        <div>
          <button id="checkout-close" class="icon-btn" aria-label="Close checkout"><i class="fa fa-times"></i></button>
        </div>
      </div>

      <div>
        <div class="form-row">
          <div class="form-col">
            <label class="small-muted">Full name *</label>
            <input id="cf-name" class="input" type="text" placeholder="Jane Doe" required />
          </div>
          <div class="form-col">
            <label class="small-muted">Phone *</label>
            <input id="cf-phone" class="input" type="tel" placeholder="0550xxxxxx" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-col">
            <label class="small-muted">Email *</label>
            <input id="cf-email" class="input" type="email" placeholder="you@example.com" required />
          </div>
          <div class="form-col">
            <label class="small-muted">Order type *</label>
            <select id="cf-type" class="input">
              <option value="delivery">Delivery</option>
              <option value="pickup">Pickup</option>
            </select>
          </div>
        </div>

        <div style="margin-top:6px;">
          <label class="small-muted">Your Address*</label>
        <input id="cf-address" class="input" type="text" placeholder="Enter delivery address (only when Delivery selected)" readonly />
          <input type="hidden" id="cf-lat" />
          <input type="hidden" id="cf-lon" />
        </div>

        <div class="form-row" style="margin-top:10px;">
          <div class="form-col">
            <label class="small-muted">Preferred date</label>
            <input id="cf-date" class="input" type="date" />
          </div>
          <div class="form-col">
            <label class="small-muted">Preferred time</label>
            <input id="cf-time" class="input" type="time" />
          </div>
        </div>

        <div style="margin-top:10px;">
          <label class="small-muted">Notes (delivery/pickup instructions)</label>
          <textarea id="cf-note" class="input" rows="3" placeholder="e.g., knock twice, leave at gate"></textarea>
        </div>

        <div style="margin-top:12px;">
          <label class="small-muted">Payment method</label>
          <select id="cf-paymethod" class="input">
            <option value="paystack">Pay with Card / Mobile Money (Paystack)</option>
            <option value="cash">Cash on Delivery</option>
          </select>
        </div>

        <div class="checkout-actions">
          <button id="cf-submit" class="btn primary full">Confirm & Pay</button>
          <button id="cf-cancel" class="btn ghost full">Cancel</button>
        </div>

      <div id="cart-delivery-note" class="small-muted" style="margin-top:8px; padding:10px; border-radius:10px; background: linear-gradient(90deg, rgba(255,160,80,0.04), rgba(255,255,255,0.01)); border:1px solid rgba(255,160,80,0.06);">
         <strong>Important:</strong> The checkout price shown <em>does NOT</em> include delivery fees. Delivery fee will be estimated after checkout based on your address and communicated to you.
       </div>
 
      </div>
    </div>

    <aside class="checkout-right" aria-label="Order summary">
      <h4 style="margin:0 0 10px 0; color:var(--accent-2); font-weight:900;">Your order</h4>
      <div id="cf-order-lines" style="margin-bottom:6px;">
        <!-- order lines injected here -->
      </div>

      <div style="border-top:1px dashed rgba(255,255,255,0.04); padding-top:10px; margin-top:12px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div class="small-muted">Subtotal</div>
          <div id="cf-subtotal" class="small-muted">GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
          <div class="small-muted">Delivery</div>
          <div id="cf-delivery" class="small-muted">GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
          <div class="small-muted">Promo</div>
          <div id="cf-promo" class="small-muted">-GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px; font-weight:900; color:#fff;">
          <div>Total</div>
          <div id="cf-total" style="color:var(--accent-2)">GHC 0</div>
        </div>
      </div>

      <div style="margin-top:12px;" class="small-muted">
        Please confirm your details before proceeding. You will receive an email & SMS after payment.
      </div>
    </aside>
  </div>
</section>
  <!-- ========== ORDER CONFIRMATION MODAL (shows after successful payment + reload) ========= -->
<style>
/* Confirmation modal styles */
#order-confirmation-modal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 8000;
  background: rgba(0,0,0,0.6);
  align-items: center;
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
}
#order-confirmation-modal[aria-hidden="false"] { display:flex; }

.oc-inner {
  width: 100%;
  max-width: 720px;
  border-radius: 12px;
  background: linear-gradient(180deg,#0b0b0b,#060606);
  color: #fff;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
}
.oc-header { display:flex; gap:12px; align-items:center; justify-content:space-between; }
.oc-title { font-size:18px; font-weight:900; color: var(--accent-2, #FFD166); margin:0; }
.oc-body { display:flex; gap:12px; flex-direction:column; max-height: 60vh; overflow:auto; padding:6px 0; }
.oc-grid { display:grid; grid-template-columns: 1fr 160px; gap:12px; align-items:start; }
.oc-lines { border-top:1px dashed rgba(255,255,255,0.04); padding-top:8px; }
.oc-line { display:flex; justify-content:space-between; gap:8px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,0.02); }
.oc-total { font-weight:900; color: var(--accent-2, #FFD166); font-size:18px; }
.oc-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }
.btn.print { padding:10px 12px; border-radius:10px; font-weight:900; background: linear-gradient(90deg, var(--accent-1, #FF6A00), var(--accent-2, #FFD166)); color:#111; border:0; }
.btn.ok { padding:10px 12px; border-radius:10px; font-weight:900; background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.06); }

/* print-only styles: print only modal content */
@media print {
  body * { visibility: hidden; }
  #order-confirmation-modal, #order-confirmation-modal * { visibility: visible; }
  #order-confirmation-modal { position: static; background: #fff; }
  .oc-inner { box-shadow: none; background: #fff; color: #000; }
}
</style>

<div id="order-confirmation-modal" role="dialog" aria-hidden="true" aria-label="Order confirmation">
  <div class="oc-inner" role="document">
    <div class="oc-header">
      <h3 class="oc-title"><i class="fa fa-check-circle"></i> Order Confirmed</h3>
      <button id="oc-close" class="icon-btn" aria-label="Close confirmation"><i class="fa fa-times"></i></button>
    </div>

    <div class="oc-body">
      <div id="oc-summary" class="oc-grid">
        <div>
          <div><strong>Reference:</strong> <span id="oc-ref">—</span></div>
          <div><strong>Name:</strong> <span id="oc-name">—</span></div>
          <div><strong>Phone:</strong> <span id="oc-phone">—</span></div>
          <div><strong>Email:</strong> <span id="oc-email">—</span></div>
          <div><strong>Order type:</strong> <span id="oc-type">—</span></div>
          <div><strong>Address:</strong> <span id="oc-address">—</span></div>
          <div><strong>Notes:</strong> <span id="oc-note">—</span></div>
        </div>
        <div style="text-align:right;">
          <div class="small-muted">Placed at</div>
          <div id="oc-ts" style="font-weight:800;margin-bottom:10px">—</div>
          <div class="oc-total" id="oc-total">GHC 0</div>
        </div>
      </div>

      <div class="oc-lines" id="oc-lines">
        <!-- order lines inserted here -->
      </div>

      <div style="margin-top:8px" class="small-muted">
        <p><strong>Important:</strong> Delivery fee is calculated separately and will be communicated after we confirm your exact location. The total shown at checkout did <em>not</em> include delivery unless explicitly shown as added.</p>
        <p>Please keep this reference for inquiries. We will contact you (phone/SMS/WhatsApp) with an estimated delivery fee and ETA.</p>
      </div>
    </div>

    <div class="oc-actions">
      <button id="oc-print" class="btn print"><i class="fa fa-file-pdf"></i> Save as PDF</button>
      <button id="oc-ok" class="btn ok">Okay</button>
    </div>
  </div>
</div>


  <!-- === REPLACE your existing checkout CSS with this block === -->
<style>
/* CHECKOUT PAGE — unified, mobile-friendly, scrollable under fixed header */
#checkout-page {
  display: none;
  position: fixed;
  inset: 0;                 /* fill viewport */
  z-index: 3200;
  background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6));
  /* place checkout below header and allow page-level scroll if content taller than viewport */
  align-items: flex-start;                  /* ensures top-aligned so margin-top works predictably */
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
  overflow: auto;                           /* page can scroll if inner is taller than viewport */
  -webkit-overflow-scrolling: touch;
}

/* show when opened */
#checkout-page[aria-hidden="false"] { display: flex; }

/* Inner dialog
   - Use margin-top to sit under the sticky header safely
   - Use max-height so inner columns can scroll independently
*/
#checkout-inner {
  width: 100%;
  max-width: 920px;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  background: linear-gradient(180deg,#080808,#050505);
  color: #fff;
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 0;
  margin: calc(56px + var(--safe-top,12px) + 12px) auto 24px; /* pushes it below fixed header */
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 48px)); /* keeps dialog within viewport */
  box-sizing: border-box;
}

/* On narrow screens stack into single column */
@media (max-width: 900px) {
  #checkout-inner { grid-template-columns: 1fr; max-width: 680px; }
}

/* Left & right columns scroll independently */
.checkout-left,
.checkout-right {
  padding: 16px 18px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  max-height: calc(100%); /* ensures columns don't overflow the dialog */
  box-sizing: border-box;
}

/* Right column: give it a visual top so "Your order" stays visible while lines scroll */
.checkout-right {
  border-left: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  position: relative;
}

/* Make the "Your order" heading sticky within the right column so the user always sees the header.
   The order lines themselves scroll under it. This prevents the feeling that the section is "stuck". */
.checkout-right > h4 {
  position: sticky;
  top: 0;
  z-index: 5;
  margin: 0 0 10px 0;
  padding-top: 6px;
  background: transparent; /* inherits dialog BG */
  color: var(--accent-2);
  font-weight: 900;
}

/* constrain the order lines area so it scrolls nicely */
#cf-order-lines {
  overflow: auto;
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 240px)); /* adapt so lines area remains scrollable */
  -webkit-overflow-scrolling: touch;
}

/* Make the checkout close button comfortable to tap */
#checkout-close { background: transparent; border: 0; color: var(--muted); font-size: 18px; padding: 8px; cursor: pointer; }

/* small responsive tweaks */
@media (max-width: 600px) {
  #checkout-inner { margin-top: calc(56px + var(--safe-top, 12px) + 6px); padding-bottom: 8px; }
  .checkout-right { border-left: none; border-top: 1px solid rgba(255,255,255,0.03); }
  .checkout-right > h4 { top: 0; }
  #cf-order-lines { max-height: calc(60vh); }
}
</style>


  <!-- Task 3: Promo slideshow (paste after your scripts, before </body>) -->
<style>
/* Promo slideshow styles — mobile-first, uses your accent variables */
.promo-carousel {
  width:100%;
  max-width: var(--max-width,420px);
  margin: 8px auto 18px;
  position: relative;
  box-sizing: border-box;
  overflow: visible;
}
.promo-carousel .pc-slides { position: relative; width:100%; height: 42vh; min-height:220px; border-radius:14px; overflow: clip; box-shadow: var(--card-shadow); }
.promo-carousel .pc-slide {
  position: absolute; inset:0;
  display: none;
  will-change: transform, opacity;
  transition: opacity 520ms cubic-bezier(.2,.9,.3,1), transform 520ms cubic-bezier(.2,.9,.3,1);
  background-size: cover;
  background-position: center;
}
.promo-carousel .pc-slide.is-active { display:block; opacity:1; transform: none; }
.promo-carousel .pc-slide .overlay {
  position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(0,0,0,0.18) 0%, rgba(0,0,0,0.55) 70%);
  display:flex; align-items:flex-end; padding:14px; box-sizing:border-box;
}
.promo-card {
  width:100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: 12px;
  padding: 12px;
  box-sizing:border-box;
  backdrop-filter: blur(6px) saturate(120%);
  display:flex; gap:10px; align-items:center;
}
.promo-left { flex:0 0 72px; display:flex; align-items:center; justify-content:center; }
.promo-left .pc-ico { font-size:34px; color: #fff; opacity:0.98; text-shadow: 0 6px 20px rgba(0,0,0,0.6); }
.promo-right { flex:1 1 auto; min-width:0; display:flex; flex-direction:column; gap:6px; }
.promo-eyebrow { font-size:12px; color:var(--accent-2); font-weight:900; text-transform:uppercase; letter-spacing:0.8px; }
.promo-title { font-size:16px; font-weight:900; color:#fff; margin:0; line-height:1.05; }
.promo-desc { font-size:13px; color: rgba(255,255,255,0.9); }
.promo-cta-row { display:flex; gap:8px; margin-top:8px; align-items:center; }
.promo-cta-row .btn { min-height:40px; padding:8px 12px; font-weight:900; border-radius:10px; }

.promo-controls { position:absolute; left:12px; right:12px; bottom:12px; display:flex; align-items:center; justify-content:space-between; gap:8px; pointer-events:none; }
.pc-dots { display:flex; gap:8px; align-items:center; pointer-events:auto; }
.pc-dot { width:8px; height:8px; border-radius:999px; background: rgba(255,255,255,0.18); border:1px solid rgba(255,255,255,0.04); padding:0; }
.pc-dot.is-active { width:34px; background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); box-shadow: 0 8px 20px rgba(255,106,0,0.14); border-radius:999px; }

.pc-nav { display:flex; gap:8px; pointer-events:auto; }
.pc-nav .icon-btn { background: rgba(0,0,0,0.45); color:#fff; border-radius:10px; padding:8px; }

@media (max-width:360px){
  .promo-left { flex:0 0 56px; }
  .promo-left .pc-ico { font-size:28px; }
  .promo-title { font-size:15px; }
  .promo-card { padding:10px; border-radius:10px; }
}
</style>



  <!-- Cart footer enhancement: paste after your main script and before </body> -->
<style>
/* Override / enhancement for cart drawer footer behavior */
.cart-drawer {
  /* make the drawer a column flex container so footer stays pinned */
  display: flex !important;
  flex-direction: column;
  justify-content: space-between;
  height: 100vh;          /* fill viewport so footer anchors to bottom */
  overflow: hidden;       /* inner scrolling happens in .cart-body */
}

/* .cart-body becomes the scrollable area */
.cart-body {
  flex: 1 1 auto;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  /* ensure content never gets hidden under footer */
  padding-bottom: calc(var(--cart-footer-h, 96px) + 18px);
}

/* footer pinned inside flex layout */
.cart-footer {
  position: relative;     /* keep it in flow but pinned to bottom via flex */
  z-index: 60;
  flex: 0 0 var(--cart-footer-h, 96px);
  height: var(--cart-footer-h, 96px);
  box-shadow: 0 -10px 36px rgba(0,0,0,0.55);
  border-top: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(6,6,6,0.98), rgba(8,8,8,0.98));
  box-sizing: border-box;
}

/* compact the footer on very small screens to avoid being too tall */
@media (max-width: 380px) {
  :root { --cart-footer-h: 84px; }
  .cart-footer { height: var(--cart-footer-h); }
  .footer-summary .total-label { font-size: 12px; }
  .footer-summary .total-value { font-size: 14px; }
}

/* ensure checkout button remains visible & tappable */
.cart-footer .footer-actions { align-items: center; gap: 8px; }
.cart-footer .btn.primary { min-width: 120px; }

/* small improvement: when drawer is open, slightly dim body (applies when JS adds class) */
body.cart-open::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.28);
  z-index: 1350; /* behind the drawer (drawer 1400) */
  pointer-events: none;
}
</style>

<script>
/*
  Unified page script for Wrap District — copy-paste this single block into your page
  Replaces previous multiple scripts. Handles:
   - Mobile nav open/close
   - Slideshow (controls + dots + autoplay)
   - Menu tabs filtering
   - Product modal (clone config + add to cart)
   - Cart (add/remove/increase/decrease, localStorage persistence)
   - Promo rules: Buy 2 Get 1 (shawarma), Free Coke for Loaded Fries
   - Cart drawer open/close + header totals sync
   - Checkout page open, totals calculation, Paystack inline or simulated payment
   - Preorder modal + form save
   - Entry promo modal behavior + "don't show again"
   - Promo countdown timer (counts to next Tuesday 23:59:59)
   - Order confirmation modal read/write from localStorage
*/

(function(){
  'use strict';

  // ---------- Utilities ----------
  const $ = (sel, root=document) => root.querySelector(sel);
  const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
  const elText = (el) => el ? (el.innerText || el.textContent || '') : '';
  const toNum = (v, d=0) => {
    const n = Number(String(v||'').replace(/[^\d.-]/g,'')); return isNaN(n) ? d : n;
  };
  const fmtGhc = (n) => `GHC ${Math.round(Number(n||0))}`;
  const nowIso = () => new Date().toISOString();

  // Cart storage key
  const CART_KEY = 'wrap_cart_v2';
  const LAST_ORDER_KEY = 'wrap_last_order';
  const SHOW_CONFIRM_KEY = 'wrap_show_confirmation';
  const ENTRY_PROMO_KEY = 'wrap_entry_promo_dontshow';

  // Minimal local cart structure: { itemId: { id, title, unitPrice, qty, meta, imageSrc } }
  let cart = loadCart();

  // ---------- Persistence ----------
  function saveCart() {
    try { localStorage.setItem(CART_KEY, JSON.stringify(cart)); } catch(e){ console.warn('saveCart failed', e); }
    renderCart();
  }
  function loadCart() {
    try {
      const raw = localStorage.getItem(CART_KEY);
      if (!raw) return {};
      return JSON.parse(raw) || {};
    } catch(e) { console.warn('loadCart parse failed', e); return {}; }
  }
  function clearCart() {
    cart = {};
    try { localStorage.removeItem(CART_KEY); } catch(e){}
    renderCart();
  }

  // ---------- DOM references ----------
  const mobileNav = $('#mobile-nav');
  const hamburger = $('#hamburger');
  const navCloseBtn = $('#nav-close');

  const cartToggle = $('#cart-toggle');
  const cartDrawer = $('#cart-drawer');
  const cartClose = $('#cart-close');
  const cartCountEls = [$('#cart-count'), $('#cart-mini-count')].filter(Boolean);
  const cartItemsWrap = $('#cart-items');
  const cartSubtotalEl = $('#cart-subtotal');
  const cartTotalEl = $('#cart-total');
  const cartDeliveryEl = $('#cart-delivery');
  const cartMiniCount = $('#cart-mini-count');
  const cartPromoBlock = $('#cart-promo');
  const promoDiscountEl = $('#promo-discount');
  const promoHelpText = $('#promo-help-text');
  const addMissingBtn = $('#add-missing');

  const checkoutBtn = $('#checkout-btn');
  const headerCheckoutBtn = $('#cart-header-checkout'); // may be created by CSS script elsewhere
  const checkoutPage = $('#checkout-page');
  const checkoutInner = $('#checkout-inner');

  const preorderModal = $('#preorder-modal');
  const preorderBtnSelectors = ['#promo-preorder-btn', '[data-action="preorder-promo"]'];

  const productModal = $('#product-modal');
  const pmThumb = $('#pm-thumb');
  const pmTitle = $('#pm-title');
  const pmDesc = $('#pm-desc');
  const pmBody = $('#pm-body');
  const pmPrice = $('#pm-price');
  const pmAdd = $('#pm-add');
  const pmCancel = $('#pm-cancel');
  const pmClose = $('#pm-close');

  const entryPromo = $('#entry-promo');
  const entryClose = $('#entry-close');
  const claimPromoEntryBtn = $('#claim-promo-entry');
  const dontShowAgainCheckbox = $('#dont-show-again');

  const promoCountdownEl = $('#promo-timer');
  const promoApplyButtons = Array.from(document.querySelectorAll('[data-action="apply-promo"]'));

  const productSlides = $$('.slide');
  const slideDotsWrap = $('#slide-dots');
  const slidePrev = $('.slide-prev');
  const slideNext = $('.slide-next');

  const menuTabs = $$('.menu-tabs .tab-btn');

  const orderConfirmationModal = $('#order-confirmation-modal');
  const ocClose = $('#oc-close');
  const ocOk = $('#oc-ok');
  const ocPrint = $('#oc-print');

  // Defensive gets
  function el(id) { return document.getElementById(id); }

  // ---------- Slideshow ----------
  (function setupSlideshow(){
    const slides = productSlides.length ? productSlides : $$('.pc-slide');
    if (!slides.length) return;

    let active = slides.findIndex(s => s.getAttribute('aria-hidden') === 'false');
    if (active < 0) active = 0;
    const dots = slideDotsWrap ? Array.from(slideDotsWrap.querySelectorAll('.dot')) : [];

    function showSlide(i) {
      i = (i + slides.length) % slides.length;
      slides.forEach((s, idx) => {
        const is = idx === i;
        s.style.display = is ? '' : 'none';
        s.setAttribute('aria-hidden', is ? 'false' : 'true');
      });
      // update dots
      if (dots.length) dots.forEach((d, idx) => d.classList.toggle('is-active', idx===i));
      active = i;
    }

    // Bind prev/next/dots
    slidePrev && slidePrev.addEventListener('click', ()=> showSlide(active-1));
    slideNext && slideNext.addEventListener('click', ()=> showSlide(active+1));
    if (dots.length) dots.forEach((d, idx) => d.addEventListener('click', ()=> showSlide(idx)));

    // Auto-advance
    let auto = setInterval(()=> showSlide(active+1), 5000);
    // Pause when user interacts
    [slidePrev, slideNext, ...dots].filter(Boolean).forEach(node => {
      node.addEventListener('mouseenter', ()=> clearInterval(auto));
      node.addEventListener('focus', ()=> clearInterval(auto));
      node.addEventListener('mouseleave', ()=> { auto = setInterval(()=> showSlide(active+1), 5000); });
      node.addEventListener('blur', ()=> { auto = setInterval(()=> showSlide(active+1), 5000); });
    });

    // initialize
    showSlide(active);
  })();

  // ---------- Mobile nav ----------
  (function setupMobileNav(){
    if (!mobileNav) return;
    function openNav(){
      mobileNav.style.display = 'block';
      mobileNav.setAttribute('aria-hidden','false');
      hamburger && hamburger.setAttribute('aria-expanded', 'true');
      try { mobileNav.focus(); } catch(e){}
      document.body.style.overflow = 'hidden';
    }
    function closeNav(){
      mobileNav.style.display = 'none';
      mobileNav.setAttribute('aria-hidden','true');
      hamburger && hamburger.setAttribute('aria-expanded', 'false');
      try { hamburger && hamburger.focus(); } catch(e){}
      document.body.style.overflow = '';
    }
    hamburger && hamburger.addEventListener('click', () => {
      const expanded = hamburger.getAttribute('aria-expanded') === 'true';
      if (expanded) {
        closeNav();
      } else {
        // open
        mobileNav.style.display = 'block';
        mobileNav.setAttribute('aria-hidden','false');
        hamburger.setAttribute('aria-expanded','true');
        try { mobileNav.focus(); } catch(e){}
        document.body.style.overflow = 'hidden';
      }
    });
    navCloseBtn && navCloseBtn.addEventListener('click', closeNav);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && mobileNav.getAttribute('aria-hidden') === 'false') closeNav(); });
    // close when nav links clicked (smooth scroll)
    const navLinks = mobileNav ? mobileNav.querySelectorAll('a.nav-link') : [];
    navLinks && Array.from(navLinks).forEach(link => {
      link.addEventListener('click', (ev) => {
        const href = (link.getAttribute('href') || '').trim();
        if (href && href.startsWith('#')) {
          ev.preventDefault();
          const target = document.querySelector(href);
          closeNav();
          setTimeout(()=> { target && target.scrollIntoView({behavior:'smooth', block:'start'}); }, 120);
        } else {
          closeNav();
        }
      }, { passive: true });
    });
  })();

  // ---------- Menu tabs filtering ----------
  (function setupTabs(){
    if (!menuTabs.length) return;
    const items = $$('.menu-item');
    function apply(cat) {
      items.forEach(it => {
        const itemCat = (it.dataset.category || '').toLowerCase();
        const show = !cat || cat === 'all' || itemCat.split(' ').some(c => c === cat);
        it.style.display = show ? '' : 'none';
        it.setAttribute('aria-hidden', show ? 'false' : 'true');
      });
    }
    function setActive(btn) {
      menuTabs.forEach(b => { b.classList.toggle('is-active', b === btn); b.setAttribute('aria-selected', String(b===btn)); });
      try { btn.focus(); } catch(e){}
    }
    menuTabs.forEach(btn => {
      btn.setAttribute('role','tab');
      btn.tabIndex = 0;
      btn.addEventListener('click', () => { setActive(btn); apply((btn.dataset.cat||'all').toLowerCase()); });
      btn.addEventListener('keydown', (e)=> { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); }});
    });
    // init
    const initial = menuTabs.find(b=>b.classList.contains('is-active')) || menuTabs[0];
    if (initial) { setActive(initial); apply((initial.dataset.cat||'all').toLowerCase()); }
  })();

  // ---------- Helper: read item price from a menu-item node ----------
  function readItemPriceFromNode(menuItem) {
    // Strategy:
    // 1) Sum numeric values of selects inside .item-config (option value is price)
    // 2) Sum checked addon checkbox values
    // 3) If none found, try .price-value text
    // 4) Fallback to dataset price or 0
    try {
      let total = 0;
      const config = menuItem.querySelector('.item-config');
      if (config) {
        // selects
        config.querySelectorAll('select').forEach(s => total += toNum(s.value, 0));
        // checkboxes (addon-checkbox)
        config.querySelectorAll('input[type="checkbox"]').forEach(cb => { if (cb.checked) total += toNum(cb.value, 0); });
      }
      if (total > 0) return Math.round(total);
      const pv = menuItem.querySelector('.price-value');
      if (pv) {
        const n = toNum(elText(pv));
        if (n) return Math.round(n);
      }
      // dataset data-price?
      const dsPrice = toNum(menuItem.dataset.price, 0);
      if (dsPrice) return Math.round(dsPrice);
      // fallback: try first select option selected numeric
      const anySelect = menuItem.querySelector('select');
      if (anySelect) return toNum(anySelect.value, 0);
    } catch(e) {
      console.warn('readItemPriceFromNode error', e);
    }
    return 0;
  }

  // ---------- Add item to cart (from a menu-item) ----------
  function addItemFromMenu(menuItem, qty=1) {
    try {
      const itemId = menuItem.dataset.itemId || menuItem.id || ('item-'+Math.floor(Math.random()*99999));
      const title = (menuItem.querySelector('.item-title')?.innerText || menuItem.dataset.name || itemId).trim();
      const img = menuItem.querySelector('.item-thumb')?.src || '';
      // Build meta from selects and addons (to show in confirmation/print)
      const meta = {};
      const selects = menuItem.querySelectorAll('select');
      selects.forEach(s => { if (s.name) meta[s.name] = { label: s.options[s.selectedIndex]?.text || '', value: s.value }; });
      const addons = [];
      menuItem.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        if (cb.classList.contains('addon-checkbox') && cb.checked) {
          addons.push({ key: cb.dataset.addonKey || cb.value, label: cb.closest('.addon')?.querySelector('span')?.innerText || cb.value, value: cb.value });
        }
      });
      if (addons.length) meta.addons = addons;
      const unitPrice = readItemPriceFromNode(menuItem) || toNum(menuItem.dataset.price, 0);

      // Insert or update
      if (!cart[itemId]) {
        cart[itemId] = { id: itemId, title, unitPrice: Math.round(unitPrice), qty: 0, meta, imageSrc: img };
      }
      cart[itemId].qty = (cart[itemId].qty || 0) + qty;
      // Merge meta (simple replacement)
      cart[itemId].meta = meta;
      saveCart();
      showToast(`${title} added to cart`);
    } catch(e) { console.error('addItemFromMenu error', e); }
  }

  // ---------- Remove/decrease item ----------
  function decreaseItem(itemId, decreaseBy=1) {
    if (!cart[itemId]) return;
    cart[itemId].qty = (cart[itemId].qty || 0) - decreaseBy;
    if (cart[itemId].qty <= 0) delete cart[itemId];
    saveCart();
  }
  function increaseItem(itemId, inc=1) {
    if (!cart[itemId]) return;
    cart[itemId].qty = (cart[itemId].qty || 0) + inc;
    saveCart();
  }
  function removeItem(itemId) {
    if (!cart[itemId]) return;
    delete cart[itemId];
    saveCart();
  }

  // ---------- Promo rules ----------
  function computePromoDiscount(cartObj) {
    // returns { promoDiscount: number, promoLines: array of added free items to be added to cart for display }
    let discount = 0;
    const freeLines = []; // e.g., { id, title, unitPrice:0, qty, meta }
    try {
      // Buy-2-get-1 for shawarma (data-item-id="shawarma" or id contains 'shawarma' or dataset promo)
      const shawarmaEntryKey = Object.keys(cartObj).find(k => (k.toLowerCase().includes('shawarma') || (cartObj[k].meta && cartObj[k].meta.promo==='buy2get1') || (cartObj[k].promo === 'buy2get1') ));
      if (shawarmaEntryKey) {
        const shaw = cartObj[shawarmaEntryKey];
        const triples = Math.floor((shaw.qty || 0) / 3);
        if (triples > 0) {
          // discount = triples * unitPrice (assuming identical price per shawarma)
          discount += triples * (shaw.unitPrice || 0);
        }
      }
      // Loaded Fries free Coke: if loaded-fries exists and has a promo -> add free coke line
      const friesKey = Object.keys(cartObj).find(k => k.includes('fries') || (cartObj[k].meta && cartObj[k].meta.promo === 'freecoke') || (cartObj[k].promo === 'freecoke'));
      if (friesKey) {
        const fries = cartObj[friesKey];
        // For every fries qty, we add a free coke line (qty = fries.qty), but keep price 0
        if (fries.qty > 0) {
          // create synthetic free item with id 'free-coke'
          freeLines.push({ id: 'free-coke', title: 'Free Coke (promo)', unitPrice: 0, qty: fries.qty, meta: { promoFrom: friesKey } });
        }
      }
    } catch(e) { console.warn('computePromoDiscount error', e); }
    return { promoDiscount: Math.round(discount), promoLines: freeLines };
  }

  // ---------- Totals & rendering ----------
  function computeTotals() {
    const items = Object.values(cart || {});
    let subtotal = 0;
    let itemCount = 0;
    items.forEach(it => {
      subtotal += (Number(it.unitPrice) || 0) * (Number(it.qty) || 0);
      itemCount += (Number(it.qty) || 0);
    });
    const promoResult = computePromoDiscount(cart);
    const promoDiscount = promoResult.promoDiscount || 0;
    const promoLines = promoResult.promoLines || [];
    // Delivery default 0 (calculated in checkout specifically)
    const total = Math.max(0, subtotal - promoDiscount);
    return { subtotal, promoDiscount, promoLines, total, itemCount };
  }

  function renderCart() {
    // Renders cart drawer DOM (#cart-items), updates counts and totals
    try {
      // Clear cart-items
      if (!cartItemsWrap) {
        // update counts only
        updateCartUI();
        return;
      }
      cartItemsWrap.innerHTML = '';
      const keys = Object.keys(cart);
      if (!keys.length) {
        cartItemsWrap.innerHTML = '<li class="empty">Your cart is empty.</li>';
      } else {
        keys.forEach(k => {
          const it = cart[k];
          const li = document.createElement('li');
          li.className = 'cart-line';
          li.dataset.itemId = it.id;
          li.innerHTML = `
            <div class="line-left">
              <img class="cart-thumb" src="${escapeHtml(it.imageSrc || '')}" alt="${escapeHtml(it.title)}">
              <div style="min-width:0">
                <div class="line-title">${escapeHtml(it.title)}</div>
                <div class="line-meta small-muted">GHC ${Math.round(it.unitPrice || 0)} &nbsp; <span class="line-qty">× ${it.qty}</span></div>
              </div>
            </div>
            <div class="line-controls">
              <button class="icon-btn cart-decrease" title="Decrease"><i class="fa fa-minus"></i></button>
              <div style="width:36px; text-align:center; font-weight:900; color: var(--accent-2)">${it.qty}</div>
              <button class="icon-btn cart-increase" title="Increase"><i class="fa fa-plus"></i></button>
              <button class="icon-btn cart-remove" title="Remove"><i class="fa fa-trash"></i></button>
            </div>
          `;
          // attach handlers
          li.querySelector('.cart-increase').addEventListener('click', ()=> { increaseItem(it.id, 1); });
          li.querySelector('.cart-decrease').addEventListener('click', ()=> { decreaseItem(it.id, 1); });
          li.querySelector('.cart-remove').addEventListener('click', ()=> { removeItem(it.id); });
          cartItemsWrap.appendChild(li);
        });
      }

      // Apply promo free-lines into DOM (display only)
      const totals = computeTotals();
      if (totals.promoLines && totals.promoLines.length) {
        totals.promoLines.forEach(fl => {
          // ensure we don't duplicate free-coke line if it's already in cart display
          if (!cartItemsWrap.querySelector(`li[data-item-id="${escapeSelector(fl.id)}"]`)) {
            const li = document.createElement('li');
            li.className = 'cart-line cart-free';
            li.dataset.itemId = fl.id;
            li.innerHTML = `
              <div class="line-left">
                <img class="cart-thumb" src="" alt="${escapeHtml(fl.title)}">
                <div style="min-width:0">
                  <div class="line-title">${escapeHtml(fl.title)}</div>
                  <div class="line-meta small-muted">FREE (promo)</div>
                </div>
              </div>
              <div class="line-controls">
                <div style="width:36px; text-align:center; font-weight:900; color: var(--accent-2)">${fl.qty}</div>
              </div>
            `;
            cartItemsWrap.appendChild(li);
          }
        });
      }

      updateCartUI();
    } catch(e){ console.error('renderCart error', e); }
  }

  function updateCartUI() {
    const totals = computeTotals();
    // update counts
    cartCountEls.forEach(el => { if (el) el.innerText = totals.itemCount || 0; });
    if (cartMiniCount) cartMiniCount.innerText = totals.itemCount || 0;
    // update totals display
    cartSubtotalEl && (cartSubtotalEl.innerText = fmtGhc(totals.subtotal || 0));
    promoDiscountEl && (promoDiscountEl.innerText = `-GHC ${Math.round(totals.promoDiscount || 0)}`);
    cartTotalEl && (cartTotalEl.innerText = fmtGhc((totals.subtotal || 0) - (totals.promoDiscount || 0)));
    // show/hide promo block
    if (cartPromoBlock) {
      if (totals.promoDiscount > 0 || (totals.promoLines && totals.promoLines.length)) {
        cartPromoBlock.classList.remove('hidden');
        cartPromoBlock.removeAttribute('aria-hidden');
        // update helper text
        if (promoHelpText) {
          // For shawarma promo - indicate how many more needed
          const shawKey = Object.keys(cart).find(k => k.includes('shawarma'));
          if (shawKey) {
            const need = 3 - ((cart[shawKey].qty || 0) % 3);
            if (need > 0 && need < 3) promoHelpText.innerText = `Add ${need} more Shawarma(s) to get one free.`;
            else promoHelpText.innerText = 'Promo applied.';
          } else {
            promoHelpText.innerText = 'Promo applied.';
          }
        }
      } else {
        cartPromoBlock.classList.add('hidden');
        cartPromoBlock.setAttribute('aria-hidden','true');
      }
    }
  }

  // Escape helper for building HTML
  function escapeHtml(s) { return String(s||'').replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
  function escapeSelector(s) { return String(s||'').replace(/([ #;?%&,.+*~\':"!^$[\]()=>|\/@])/g,'\\$1'); }

  // ---------- Attach add/remove handlers for menu items ----------
  (function wireMenuAdders(){
    // handle Add / Remove buttons inside menu items
    const onAddClick = (ev) => {
      const btn = ev.currentTarget;
      const iid = btn.dataset.itemId;
      const menuItem = document.querySelector(`.menu-item[data-item-id="${escapeSelector(iid)}"], #${escapeSelector(iid)}`);
      if (!menuItem) {
        // maybe the button is inside the menu item already
        const mi = btn.closest('.menu-item');
        if (mi) addItemFromMenu(mi, 1);
      } else addItemFromMenu(menuItem, 1);
    };
    const onRemoveClick = (ev) => {
      const btn = ev.currentTarget;
      const iid = btn.dataset.itemId;
      if (!iid) return;
      decreaseItem(iid, 1);
    };
    // initial attach
    $$('.add-btn').forEach(b => b.addEventListener('click', onAddClick));
    $$('.remove-btn').forEach(b => b.addEventListener('click', onRemoveClick));
    // if menu items are added later, attach via MutationObserver
    const menuGrid = $('#menu-grid');
    if (menuGrid) {
      const mo = new MutationObserver(muts => {
        muts.forEach(m => {
          m.addedNodes && m.addedNodes.forEach(n => {
            if (!(n instanceof Element)) return;
            $$('.add-btn', n).forEach(b => b.addEventListener('click', onAddClick));
            $$('.remove-btn', n).forEach(b => b.addEventListener('click', onRemoveClick));
          });
        });
      });
      mo.observe(menuGrid, { childList: true, subtree: true });
    }
  })();

  // ---------- Cart drawer open/close ----------
  (function setupCartDrawer(){
    function openCart() {
      if (!cartDrawer) return;
      cartDrawer.style.display = 'block';
      cartDrawer.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      renderCart();
    }
    function closeCart() {
      if (!cartDrawer) return;
      cartDrawer.style.display = 'none';
      cartDrawer.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }
    cartToggle && cartToggle.addEventListener('click', (e) => {
      if (cartDrawer && cartDrawer.getAttribute('aria-hidden') === 'false') closeCart();
      else openCart();
    });
    cartClose && cartClose.addEventListener('click', closeCart);
    // clicking outside drawer closes
    cartDrawer && cartDrawer.addEventListener('click', (e) => { if (e.target === cartDrawer) closeCart(); });
  })();

  // ---------- "Add missing items" button (to reach promo) ----------
  if (addMissingBtn) {
    addMissingBtn.addEventListener('click', () => {
      // if shawarma present, add necessary items to reach next multiple of 3
      const shawKey = Object.keys(cart).find(k => k.includes('shawarma'));
      if (shawKey) {
        const need = 3 - ((cart[shawKey].qty || 0) % 3);
        if (need > 0 && need < 3) {
          cart[shawKey].qty += need;
          saveCart();
          showToast(`Added ${need} Shawarma(s) to qualify for promo`);
          return;
        }
      }
      // else try add a shawarma fresh if none exists
      const menuShaw = document.querySelector('.menu-item[data-item-id="shawarma"]') || document.getElementById('item-shawarma');
      if (menuShaw) {
        addItemFromMenu(menuShaw, 2); // add 2 to attempt to trigger promo
        showToast('Added items to help you reach the promo');
        return;
      }
      showToast('Could not automatically add missing items.');
    });
  }

  // ---------- Toast ----------
  function showToast(msg, ms=1800) {
    try {
      let t = document.querySelector('.toast.wrap-toast');
      if (!t) {
        t = document.createElement('div');
        t.className = 'toast wrap-toast';
        document.body.appendChild(t);
      }
      t.innerText = msg;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), ms);
    } catch(e){}
  }

  // ---------- Product modal (clone item-config) ----------
  (function setupProductModal(){
    if (!productModal) return;
    let activeMenuItem = null;
    let clonedConfig = null;

    function openFor(menuItem) {
      activeMenuItem = menuItem;
      const thumb = menuItem.querySelector('.item-thumb')?.src || '';
      const title = elText(menuItem.querySelector('.item-title')) || menuItem.dataset.name || 'Item';
      const desc = elText(menuItem.querySelector('.item-desc')) || '';
      pmThumb.src = thumb;
      pmThumb.alt = title;
      pmTitle.innerText = title;
      pmDesc.innerText = desc;

      // clone .item-config
      const config = menuItem.querySelector('.item-config');
      pmBody.innerHTML = '';
      if (config) {
        clonedConfig = config.cloneNode(true);
        // strip ids to avoid duplicates
        clonedConfig.querySelectorAll('[id]').forEach(n => n.removeAttribute('id'));
        pmBody.appendChild(clonedConfig);
        // live update price on change
        clonedConfig.querySelectorAll('select, input[type="checkbox"]').forEach(inp => {
          inp.addEventListener('change', updateModalPrice);
        });
      } else {
        pmBody.innerHTML = '<div class="small-muted">No extra options.</div>';
      }
      updateModalPrice();
      productModal.style.display = 'flex';
      productModal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      setTimeout(()=> pmClose && pmClose.focus(), 80);
    }

    function closeModal() {
      pmBody.innerHTML = '';
      clonedConfig = null;
      activeMenuItem = null;
      productModal.style.display = 'none';
      productModal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }

    function updateModalPrice() {
      if (!clonedConfig) return;
      // compute price same as readItemPriceFromNode (but on clonedConfig)
      let total = 0;
      clonedConfig.querySelectorAll('select').forEach(s => total += toNum(s.value, 0));
      clonedConfig.querySelectorAll('input[type="checkbox"]').forEach(cb => { if (cb.checked) total += toNum(cb.value,0); });
      pmPrice.innerText = fmtGhc(total);
    }

    // wire openers: clicking item-thumb or item-title
    function attachOpeners() {
      $$('.menu-item').forEach(mi => {
        const thumb = mi.querySelector('.item-thumb');
        const title = mi.querySelector('.item-title');
        [thumb, title].filter(Boolean).forEach(n => {
          n.style.cursor = 'pointer';
          n.addEventListener('click', (e) => {
            e.stopPropagation();
            openFor(mi);
          });
        });
      });
    }
    attachOpeners();
    const menuGrid = $('#menu-grid');
    if (menuGrid) {
      const mo = new MutationObserver(()=> attachOpeners());
      mo.observe(menuGrid, { childList:true, subtree:true });
    }

    // On Add inside modal: copy selections back to original menu item, then call add
    pmAdd && pmAdd.addEventListener('click', () => {
      if (!activeMenuItem || !clonedConfig) { closeModal(); return; }
      try {
        // copy selects by name
        clonedConfig.querySelectorAll('select').forEach(cs => {
          if (!cs.name) return;
          const orig = activeMenuItem.querySelector(`select[name="${cs.name}"]`);
          if (orig) { orig.value = cs.value; orig.dispatchEvent(new Event('change', { bubbles:true })); }
        });
        // copy checkboxes by data-addon-key or label matching
        clonedConfig.querySelectorAll('input[type="checkbox"]').forEach(cb => {
          const key = cb.dataset.addonKey;
          let orig = key ? activeMenuItem.querySelector(`input.addon-checkbox[data-addon-key="${key}"]`) : null;
          if (!orig) {
            // fallback by label text
            const labelText = cb.closest('.addon')?.querySelector('span')?.innerText?.trim();
            if (labelText) {
              orig = Array.from(activeMenuItem.querySelectorAll('.addon')).map(a=>({el:a, text:a.querySelector('span')?.innerText?.trim()})).find(x=>x.text===labelText)?.el?.querySelector('input[type="checkbox"]') || null;
            }
          }
          if (orig) { orig.checked = !!cb.checked; orig.dispatchEvent(new Event('change', { bubbles:true })); }
        });
        // trigger add
        const origAdd = activeMenuItem.querySelector('.add-btn');
        if (origAdd) origAdd.click();
      } catch(e) { console.warn('pmAdd copy failed', e); }
      setTimeout(()=> closeModal(), 220);
    });

    pmCancel && pmCancel.addEventListener('click', () => closeModal());
    pmClose && pmClose.addEventListener('click', () => closeModal());
    productModal && productModal.addEventListener('click', (e) => { if (e.target === productModal) closeModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && productModal.style.display === 'flex') closeModal(); });
  })();

  // ---------- Promo countdown to next Tuesday 23:59:59 ----------
  (function setupPromoCountdown(){
    if (!promoCountdownEl) return;
    function nextTuesdayEnd() {
      const now = new Date();
      // Find next Tuesday (weekday 2 if Sunday=0)
      const day = now.getDay();
      const daysUntilTue = (2 - day + 7) % 7 || 7; // always next Tue (not today unless today is Tue and time passed)
      const candidate = new Date(now.getFullYear(), now.getMonth(), now.getDate() + daysUntilTue, 23, 59, 59, 0);
      // if today is Tuesday and time earlier, return this Tuesday's end
      if (day === 2) {
        // if now before 23:59:59 return today's end
        const todayEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23,59,59,0);
        if (now < todayEnd) return todayEnd;
        // else already passed, go to next Tue
        return new Date(now.getFullYear(), now.getMonth(), now.getDate() + 7, 23,59,59,0);
      }
      return candidate;
    }
    function tick(){
      const end = nextTuesdayEnd();
      const diff = Math.max(0, end - Date.now());
      const s = Math.floor(diff/1000)%60;
      const m = Math.floor(diff/60000)%60;
      const h = Math.floor(diff/3600000)%24;
      const d = Math.floor(diff/86400000);
      promoCountdownEl.innerText = `${d}d ${h}h ${m}m ${s}s`;
      if (diff <= 0) { clearInterval(interval); promoCountdownEl.innerText = 'Promo period'; }
    }
    tick();
    const interval = setInterval(tick, 1000);
  })();

  // ---------- Entry promo modal ----------
  (function setupEntryPromo(){
    if (!entryPromo) return;
    // Show only if not disabled in localStorage
    try {
      const dont = localStorage.getItem(ENTRY_PROMO_KEY);
      if (!dont) {
        // show after small delay
        setTimeout(()=> {
          entryPromo.style.display = 'flex';
          entryPromo.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';
        }, 900);
      }
    } catch(e){}

    entryClose && entryClose.addEventListener('click', ()=> { entryPromo.style.display='none'; entryPromo.setAttribute('aria-hidden','true'); document.body.style.overflow=''; });
    claimPromoEntryBtn && claimPromoEntryBtn.addEventListener('click', () => {
      // mark promo claimed in localStorage
      try { localStorage.setItem('wrap_claimed_promo', 'TUES-B2G1'); } catch(e){}
      entryPromo.style.display='none';
      entryPromo.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
      showToast('Promo claimed — it will apply at checkout.');
    });
    dontShowAgainCheckbox && dontShowAgainCheckbox.addEventListener('change', (e) => {
      try {
        if (dontShowAgainCheckbox.checked) localStorage.setItem(ENTRY_PROMO_KEY, '1');
        else localStorage.removeItem(ENTRY_PROMO_KEY);
      } catch(e){}
    });
  })();

  // ---------- Preorder modal ----------
  (function setupPreorder(){
    const openBtns = preorderBtnSelectors.map(s => document.querySelector(s)).filter(Boolean);
    const preorderForm = $('#preorder-form');
    const preorderClose = $('#preorder-close');
    if (!preorderModal) return;
    function openPreorder() {
      preorderModal.style.display = 'flex';
      preorderModal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      setTimeout(()=> $('#preorder-name')?.focus(), 80);
    }
    function closePreorder() {
      preorderModal.style.display = 'none';
      preorderModal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }
    openBtns.forEach(b => b.addEventListener('click', openPreorder));
    preorderClose && preorderClose.addEventListener('click', closePreorder);
    preorderModal && preorderModal.addEventListener('click', (e)=> { if (e.target === preorderModal) closePreorder(); });
    if (preorderForm) {
      preorderForm.addEventListener('submit', (ev) => {
        ev.preventDefault();
        const name = $('#preorder-name')?.value || '';
        const phone = $('#preorder-phone')?.value || '';
        const note = $('#preorder-note')?.value || '';
        if (!name || !phone) { alert('Please provide name and phone'); return; }
        const preordersRaw = localStorage.getItem('wrap_preorders');
        const arr = preordersRaw ? JSON.parse(preordersRaw) : [];
        arr.push({ id: 'pre-'+Date.now(), name, phone, note, cart: cart, ts: nowIso() });
        try { localStorage.setItem('wrap_preorders', JSON.stringify(arr)); } catch(e){}
        closePreorder();
        showToast('Preorder saved. We will reserve your items for next promo.');
      });
    }
    const cancelBtn = $('#preorder-cancel');
    cancelBtn && cancelBtn.addEventListener('click', ()=> { preorderModal.style.display='none'; preorderModal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; });
  })();

  // ---------- Checkout page open/populate/submit ----------
  (function setupCheckout(){
    const page = $('#checkout-page');
    const inner = $('#checkout-inner');
    const closeBtn = $('#checkout-close');
    const cancelBtn = $('#cf-cancel');
    const submitBtn = $('#cf-submit');
    const nameIn = $('#cf-name');
    const phoneIn = $('#cf-phone');
    const emailIn = $('#cf-email');
    const typeIn = $('#cf-type');
    const addrIn = $('#cf-address');
    const latIn = $('#cf-lat');
    const lonIn = $('#cf-lon');
    const dateIn = $('#cf-date');
    const timeIn = $('#cf-time');
    const noteIn = $('#cf-note');
    const payMethod = $('#cf-paymethod');

    const orderLinesWrap = $('#cf-order-lines');
    const cfSubtotal = $('#cf-subtotal');
    const cfDelivery = $('#cf-delivery');
    const cfPromo = $('#cf-promo');
    const cfTotal = $('#cf-total');

    // Compute delivery fee helper: basic Haversine from store coords
    const STORE_COORDS = { lat: 5.6600, lon: 0.0190 }; // change if needed
    const DELIVERY_CONFIG = { baseFee: 6, perKm: 2.5, minFee: 4, maxFee: 60, freeWithinKm: 0.8 };

    function toRad(v){ return v * Math.PI / 180; }
    function haversineKm(lat1,lon1,lat2,lon2){
      const R=6371;
      const dLat = toRad(lat2-lat1);
      const dLon = toRad(lon2-lon1);
      const a = Math.sin(dLat/2)*Math.sin(dLat/2) + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R*c;
    }
    function computeDeliveryFee(lat, lon) {
      if (!lat || !lon) return DELIVERY_CONFIG.baseFee;
      const dist = haversineKm(STORE_COORDS.lat, STORE_COORDS.lon, Number(lat), Number(lon));
      if (dist <= DELIVERY_CONFIG.freeWithinKm) return 0;
      let fee = DELIVERY_CONFIG.baseFee + (dist * DELIVERY_CONFIG.perKm);
      fee = Math.max(fee, DELIVERY_CONFIG.minFee);
      fee = Math.min(fee, DELIVERY_CONFIG.maxFee);
      return Math.round(fee);
    }

    function populateOrderLines() {
      if (!orderLinesWrap) return;
      orderLinesWrap.innerHTML = '';
      const lines = Object.values(cart || {});
      if (!lines.length) {
        orderLinesWrap.innerHTML = '<div class="small-muted">Your cart is empty.</div>';
        return;
      }
      lines.forEach(l => {
        const div = document.createElement('div');
        div.className = 'order-line';
        div.innerHTML = `
          <img src="${escapeHtml(l.imageSrc||'')}" alt="${escapeHtml(l.title||'Item')}" />
          <div class="ol-meta">
            <strong>${escapeHtml(l.title||'Item')}</strong>
            <small>${escapeHtml((l.meta && l.meta.addons) ? l.meta.addons.map(a=>a.label).join(', ') : '')}</small>
          </div>
          <div class="ol-price">${fmtGhc((Number(l.unitPrice)||0) * (Number(l.qty)||1))}</div>
        `;
        orderLinesWrap.appendChild(div);
      });
    }

    function refreshTotals() {
      const t = computeTotals();
      cfSubtotal && (cfSubtotal.innerText = fmtGhc(t.subtotal || 0));
      // delivery only if delivery selected:
      const type = typeIn?.value || 'delivery';
      let delivery = 0;
      if (type === 'delivery') {
        const lat = latIn?.value || '';
        const lon = lonIn?.value || '';
        delivery = computeDeliveryFee(lat || STORE_COORDS.lat, lon || STORE_COORDS.lon);
      }
      cfDelivery && (cfDelivery.innerText = fmtGhc(delivery || 0));
      cfPromo && (cfPromo.innerText = `-GHC ${Math.round(t.promoDiscount || 0)}`);
      const total = Math.max(0, (t.subtotal || 0) - (t.promoDiscount || 0) + (delivery||0));
      cfTotal && (cfTotal.innerText = fmtGhc(total));
    }

    function openCheckoutPage() {
      if (!page) return;
      // hide other modals
      Array.from(document.querySelectorAll('.modal, .entry-promo')).forEach(m => { try { m.style.display='none'; m.setAttribute('aria-hidden','true'); } catch(e){} });
      populateOrderLines();
      refreshTotals();
      // prefill from localStorage
      nameIn && (nameIn.value = localStorage.getItem('wrap_user_name') || '');
      phoneIn && (phoneIn.value = localStorage.getItem('wrap_user_phone') || '');
      emailIn && (emailIn.value = localStorage.getItem('wrap_checkout_email') || '');
      page.style.display = 'flex';
      page.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      setTimeout(()=> nameIn && nameIn.focus(), 120);
    }

    function closeCheckoutPage() {
      if (!page) return;
      page.style.display = 'none';
      page.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }

    // wire openers
    checkoutBtn && checkoutBtn.addEventListener('click', (e) => { e.preventDefault(); openCheckoutPage(); });
    // headerCheckoutBtn may be injected earlier — attach if exists
    headerCheckoutBtn && headerCheckoutBtn.addEventListener('click', (e) => { e.preventDefault(); openCheckoutPage(); });

    // close/cancel
    closeBtn && closeBtn.addEventListener('click', closeCheckoutPage);
    cancelBtn && cancelBtn.addEventListener('click', closeCheckoutPage);
    page && page.addEventListener('click', (e) => { if (e.target === page) closeCheckoutPage(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && page.getAttribute('aria-hidden') === 'false') closeCheckoutPage(); });

    // input watchers
    typeIn && typeIn.addEventListener('change', refreshTotals);
    latIn && latIn.addEventListener('input', refreshTotals);
    lonIn && lonIn.addEventListener('input', refreshTotals);

    // submit handler — basic Paystack inline integration or simulation
    submitBtn && submitBtn.addEventListener('click', (e) => {
      e.preventDefault();
      submitBtn.disabled = true;
      const name = nameIn?.value?.trim() || '';
      const phone = phoneIn?.value?.trim() || '';
      const email = emailIn?.value?.trim() || '';
      const type = typeIn?.value || 'delivery';
      const address = addrIn?.value || '';
      if (!name || !phone || !email) { alert('Please enter name, phone and email.'); submitBtn.disabled=false; return; }
      if (type === 'delivery' && !address) { alert('Please provide your delivery address.'); submitBtn.disabled=false; return; }

      const t = computeTotals();
      const lat = latIn?.value || '';
      const lon = lonIn?.value || '';
      const deliveryFee = (type === 'delivery') ? computeDeliveryFee(lat || STORE_COORDS.lat, lon || STORE_COORDS.lon) : 0;
      const totalAmount = Math.round((t.subtotal || 0) - (t.promoDiscount || 0) + (deliveryFee||0));
      // Save contact convenience
      try { localStorage.setItem('wrap_user_name', name); localStorage.setItem('wrap_user_phone', phone); localStorage.setItem('wrap_checkout_email', email); } catch(e){}

      // If pay with cash => simulate local order
      const pm = payMethod?.value || 'paystack';
      if (pm === 'cash') {
        const order = {
          id: 'CASH-' + Date.now(),
          reference: 'CASH-' + Date.now(),
          name, phone, email, type, address, lat, lon, note: noteIn?.value||'',
          cart: Object.values(cart),
          totals: { subtotal: t.subtotal, promo: t.promoDiscount, delivery: deliveryFee, total: totalAmount },
          ts: nowIso()
        };
        try { localStorage.setItem(LAST_ORDER_KEY, JSON.stringify(order)); localStorage.setItem(SHOW_CONFIRM_KEY, '1'); } catch(e){}
        // clear cart and reload so confirmation modal shows
        clearCart();
        closeCheckoutPage();
        window.location.reload();
        return;
      }

      // paystack inline if available (global PaystackPop)
      const PAYSTACK_PUBLIC_KEY = window.PAYSTACK_PUBLIC_KEY || 'pk_test_297586e51710e83d3c159bfe71ff45c7e23411fa'; // default set earlier in page
      if (pm === 'paystack' && window.PaystackPop && PAYSTACK_PUBLIC_KEY) {
        const ref = 'PSK-' + Date.now() + '-' + Math.floor(Math.random()*9999);
        const handler = window.PaystackPop.setup({
          key: PAYSTACK_PUBLIC_KEY,
          email,
          amount: totalAmount * 100,
          currency: 'GHS',
          ref,
          onClose: function() {
            alert('Payment cancelled');
            submitBtn.disabled = false;
          },
          callback: function(response) {
            // success
            const order = {
              id: response.reference || ref,
              reference: response.reference || ref,
              name, phone, email, type, address, lat, lon, note: noteIn?.value||'',
              cart: Object.values(cart),
              totals: { subtotal: t.subtotal, promo: t.promoDiscount, delivery: deliveryFee, total: totalAmount },
              ts: nowIso()
            };
            try { localStorage.setItem(LAST_ORDER_KEY, JSON.stringify(order)); localStorage.setItem(SHOW_CONFIRM_KEY, '1'); } catch(e){}
            clearCart();
            closeCheckoutPage();
            window.location.reload();
          }
        });
        handler.openIframe();
        return;
      }

      // fallback: ask to simulate payment
      const simulate = confirm('Paystack not available. Simulate successful payment for testing? (No real charge)');
      if (!simulate) { submitBtn.disabled=false; return; }
      const order = {
        id: 'SIM-' + Date.now(),
        reference: 'SIM-' + Date.now(),
        name, phone, email, type, address, lat, lon, note: noteIn?.value||'',
        cart: Object.values(cart),
        totals: { subtotal: t.subtotal, promo: t.promoDiscount, delivery: deliveryFee, total: totalAmount },
        ts: nowIso()
      };
      try { localStorage.setItem(LAST_ORDER_KEY, JSON.stringify(order)); localStorage.setItem(SHOW_CONFIRM_KEY, '1'); } catch(e){}
      clearCart();
      closeCheckoutPage();
      window.location.reload();
    });
  })();

  // ---------- Order confirmation modal behavior ----------
  (function setupOrderConfirmation(){
    if (!orderConfirmationModal) return;
    const ocRef = $('#oc-ref');
    const ocName = $('#oc-name');
    const ocPhone = $('#oc-phone');
    const ocEmail = $('#oc-email');
    const ocType = $('#oc-type');
    const ocAddress = $('#oc-address');
    const ocNote = $('#oc-note');
    const ocTs = $('#oc-ts');
    const ocLines = $('#oc-lines');
    const ocTotal = $('#oc-total');

    function fillAndShow(order) {
      if (!order) return;
      ocRef && (ocRef.innerText = order.reference || ('ref-'+Math.floor(Math.random()*1000000)));
      ocName && (ocName.innerText = order.name || '-');
      ocPhone && (ocPhone.innerText = order.phone || '-');
      ocEmail && (ocEmail.innerText = order.email || '-');
      ocType && (ocType.innerText = order.type || '-');
      ocAddress && (ocAddress.innerText = order.address || '-');
      ocNote && (ocNote.innerText = order.note || '-');
      ocTs && (ocTs.innerText = new Date(order.ts || Date.now()).toLocaleString());
      ocTotal && (ocTotal.innerText = `GHC ${Number(order.totals?.total || 0).toFixed(0)}`);

      // lines
      ocLines && (ocLines.innerHTML = '');
      const lines = Array.isArray(order.cart) ? order.cart : [];
      if (!lines.length) {
        ocLines && (ocLines.innerHTML = '<div class="small-muted">No lines recorded.</div>');
      } else {
        lines.forEach(l => {
          const div = document.createElement('div');
          div.className = 'oc-line';
          const title = `<strong>${escapeHtml(l.title||'Item')}</strong>`;
          const extras = (l.meta && l.meta.addons) ? ('<div class="small-muted">' + escapeHtml(l.meta.addons.map(a=>a.label||a.key).join(', ')) + '</div>') : '';
          const right = `<div style="text-align:right">${Number(l.qty||1)} × GHC ${Number(l.unitPrice||0).toFixed(0)}<div style="font-weight:900;margin-top:4px">GHC ${ (Number(l.qty||1)*Number(l.unitPrice||0)).toFixed(0) }</div></div>`;
          div.innerHTML = `<div style="flex:1">${title}${extras}</div><div style="min-width:150px">${right}</div>`;
          ocLines.appendChild(div);
        });
      }
      orderConfirmationModal.style.display = 'flex';
      orderConfirmationModal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
    }
    function hide() {
      orderConfirmationModal.style.display = 'none';
      orderConfirmationModal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
    }

    ocOk && ocOk.addEventListener('click', () => {
      try {
        localStorage.removeItem(SHOW_CONFIRM_KEY);
        localStorage.removeItem(LAST_ORDER_KEY);
        localStorage.removeItem(CART_KEY);
        cart = {};
        renderCart();
      } catch(e){}
      hide();
      window.location.href = window.location.pathname;
    });
    ocClose && ocClose.addEventListener('click', () => { hide(); });

    ocPrint && ocPrint.addEventListener('click', () => {
      // Use the localStorage-last order to print (page-level printer)
      try {
        const raw = localStorage.getItem(LAST_ORDER_KEY);
        const order = raw ? JSON.parse(raw) : null;
        if (!order) { alert('No order to print'); return; }
        // open a printable window built in earlier code (simple)
        const w = window.open('', '_blank', 'width=900,height=1100');
        if (!w) { alert('Popup blocked. Allow popups to print.'); return; }
        w.document.write(`<html><head><title>Invoice ${order.reference||''}</title></head><body><pre>${escapeHtml(JSON.stringify(order, null, 2))}</pre></body></html>`);
        w.document.close();
        w.focus();
        setTimeout(()=> { try { w.print(); w.close(); } catch(e){} }, 350);
      } catch(e) { console.warn(e); alert('Could not print.'); }
    });

    // On load, if flag set -> show
    try {
      const flag = localStorage.getItem(SHOW_CONFIRM_KEY);
      if (flag === '1') {
        const raw = localStorage.getItem(LAST_ORDER_KEY);
        const order = raw ? JSON.parse(raw) : null;
        setTimeout(()=> fillAndShow(order), 200);
      }
    } catch(e) { console.warn('order confirm load error', e); }
  })();

  // ---------- Suppress legacy blocking alerts on checkout triggers ----------
  (function suppressLegacyAlerts(){
    try {
      const _alert = window.alert;
      const _confirm = window.confirm;
      window.alert = function(msg){
        try { if (typeof msg === 'string' && msg.includes('ORDER SUMMARY')) { console.info('Suppressed alert'); return; } } catch(e){}
        return _alert.apply(this, arguments);
      };
      window.confirm = function(msg){
        try { if (typeof msg === 'string' && msg.includes('ORDER SUMMARY')) { console.info('Suppressed confirm'); return true; } } catch(e){}
        return _confirm.apply(this, arguments);
      };
    } catch(e){}
  })();

  // ---------- Attach interceptors to checkout triggers (robust) ----------
  (function attachCheckoutInterceptors(){
    const selectors = [
      '#checkout-btn',
      '#cart-header-checkout',
      '.cart-header .cart-header-checkout',
      '[data-action="checkout"]',
      '[data-action="pay"]',
      '.cart-footer .btn.primary',
      '#cart-toggle'
    ];
    function safeOpenCheckout() {
      if (typeof openCheckoutPage === 'function') { try { openCheckoutPage(); return; } catch(e){} }
      const footer = document.getElementById('checkout-btn');
      if (footer) { footer.click(); return; }
      const cart = document.getElementById('cart-drawer');
      if (cart) { cart.style.display='block'; cart.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
    }
    function attachInterceptor(el){
      if (!el) return;
      try { if (el.getAttribute && el.getAttribute('onclick')) el.removeAttribute('onclick'); } catch(e){}
      el.addEventListener('click', function(ev){
        ev.preventDefault();
        ev.stopImmediatePropagation();
        const oldAlert = window.alert, oldConfirm = window.confirm;
        try {
          window.alert = function(){};
          window.confirm = function(){ return true; };
          safeOpenCheckout();
        } catch(e) { console.error(e); }
        finally { try { window.alert = oldAlert; window.confirm = oldConfirm; } catch(e){} }
      }, true);
    }
    function attachAll() {
      selectors.forEach(sel => Array.from(document.querySelectorAll(sel)).forEach(el => attachInterceptor(el)));
    }
    attachAll();
    const mo = new MutationObserver(() => attachAll());
    mo.observe(document.body, { childList: true, subtree: true });
  })();

  // ---------- Menu item modal + "details" buttons already wired above; Promo apply buttons ----------
  (function promoApplyWiring(){
    promoApplyButtons.forEach(b => {
      b.addEventListener('click', (e) => {
        const code = b.dataset.promoCode || b.getAttribute('data-promo-code') || 'PROMO';
        try { localStorage.setItem('wrap_applied_promo', code); } catch(e){}
        showToast('Promo applied — it will be reflected at checkout');
        // update UI if necessary
        renderCart();
      });
    });
  })();

  // ---------- Small helper: initialize rendering and UI on load ----------
  document.addEventListener('DOMContentLoaded', function(){
    // initial render
    renderCart();

    // wire product modal openers and adders were attached earlier, ensure any add buttons in menu run addItemFromMenu if not intercepted
    // some add buttons might be simple forms — we already attached `.add-btn` clicks earlier

    // wire promo pre-order buttons (in promo details)
    $$('.promo-cta-row .btn, button[data-action="preorder-promo"]').forEach(b => {
      b.addEventListener('click', (e) => {
        const target = document.querySelector('#preorder-modal');
        if (target) {
          target.style.display = 'flex';
          target.setAttribute('aria-hidden','false');
          document.body.style.overflow = 'hidden';
        }
      });
    });

    // wire footer order: scroll to menu or open cart
    const footerOrder = $('#footer-order');
    const menuAnchor = $('#menu');
    footerOrder && footerOrder.addEventListener('click', (e) => {
      const ccount = Number($('#cart-count')?.innerText || '0');
      if (ccount > 0 && cartToggle) cartToggle.click();
      else if (menuAnchor) menuAnchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    // wire footer-locate to scroll to contact
    const footerLocate = $('#footer-locate');
    const contact = $('#contact');
    footerLocate && footerLocate.addEventListener('click', ()=> { if (contact) contact.scrollIntoView({ behavior:'smooth', block:'start' }); });

    // wire footer Whatsapp rel (defensive)
    const wa = $('#footer-wa');
    if (wa) wa.setAttribute('rel','noopener noreferrer');

    // ensure renderCart runs on start
    renderCart();
  });

  // ---------- Utilities that might be referenced globally ----------
  window.renderCart = renderCart;
  window.computeCartTotals = computeTotals;
  window.openCheckoutPage = function(){ const el = document.getElementById('checkout-btn'); if (el) el.click(); else { try { const fn = document.querySelector('#checkout-btn'); } catch(e){} } };
  window.resetCheckoutScroll = function(){ try { const p = document.getElementById('checkout-page'); if (p) p.scrollTop = 0; const inner = document.getElementById('checkout-inner'); if (inner) inner.scrollTop = 0; } catch(e){} };

  // ---------- small helper for escapeHtml in closures ----------
  function escapeHtmlLocal(s){ return escapeHtml(s); }

})(); // end unified IIFE
</script>

</html>
  
