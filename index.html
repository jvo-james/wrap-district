<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Wrap District — Hero</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
<!-- ----- ESSENTIAL META (keep if not already present) ----- -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- ----- ICONS (Font Awesome free CDN) ----- -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />


<!-- ----- YOUR MAIN STYLESHEET (place after fonts & icons) ----- -->
<link rel="stylesheet" href="/path/to/wrap-district-styles.css" />

<!-- ----- OPTIONAL: Paystack inline script (include if you'll use inline checkout) ----- -->
<script src="https://js.paystack.co/v1/inline.js" defer></script>

<!-- ----- OPTIONAL: Favicons (replace with your files) ----- -->
<link rel="icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<!-- SAFETY: stop invisible overlays blocking clicks -->
<style>
/* 1) Ensure overlays that are not intentionally active do not intercept pointer events */
.overlay-dim, .modal[hidden], .drawer[hidden], .chat-panel[hidden] {
  pointer-events: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  display: none !important;
}

/* 2) Keep intended active overlay behavior (when JS adds .active or removes hidden) */
.overlay-dim.active { pointer-events: auto !important; visibility: visible !important; display: block !important; opacity: 1 !important; }

/* 3) Safety-net for any element that may cover viewport but should be invisible */
*[data-blocker-temp] { pointer-events: none !important; }

/* 4) Ensure core interactive regions are above accidental blockers */
.site-header, main, .container, .menu-section, .hero-section {
  position: relative;
  z-index: 2000 !important;
}
</style>

<style>
/* =========================
Wrap District — Header & Hero styles
Mobile-first, responsive, animated, accessible
========================= */

/* --- design tokens --- */
:root{
--bg:#0b0b0b;
--card:#ffffff;
--muted:#9aa0a6;
--accent:#ff6b3d; /* warm CTA */
--accent-2:#ffc857; /* secondary warm */
--accent-3:#ff3d6e; /* pink highlight */
--glass: rgba(255,255,255,0.06);
--glass-strong: rgba(0,0,0,0.46);
--overlay: rgba(0,0,0,0.32);
--max-width:1200px;
--radius:14px;
--header-h:64px; /* updated by media queries for large screens */
--text-hero: 'Playfair Display', serif;
--text-ui: 'Montserrat', sans-serif;
}

/* reset-ish for the region we style */
.header-inner, .hero-viewport-inner, .container { box-sizing: border-box; }

/* --- container --- */
.container{
width:100%;
max-width:var(--max-width);
margin:0 auto;
padding:0 18px;
}

/* --- base typography --- */
body {
font-family: var(--text-ui);
color: #111;
background: #fff;
-webkit-font-smoothing:antialiased;
-moz-osx-font-smoothing:grayscale;
}

/* --- header (fixed/sticky) --- */
.site-header{
position:fixed;
top:0;
left:0;
right:0;
height:var(--header-h);
display:flex;
align-items:center;
justify-content:center;
z-index:1200;
backdrop-filter: blur(8px) saturate(120%);
-webkit-backdrop-filter: blur(8px) saturate(120%);
background: linear-gradient(180deg, rgba(255,255,255,0.88), rgba(255,255,255,0.76));
border-bottom: 1px solid rgba(16,16,16,0.04);
box-shadow: 0 6px 18px rgba(15,15,15,0.06);
}

/* header inner layout */
.header-inner{
display:flex;
align-items:center;
gap:14px;
width:100%;
padding:8px 0;
}

/* brand */
.brand{
display:flex;
gap:12px;
align-items:center;
text-decoration:none;
color: inherit;
}
.logo{
display:flex;
align-items:center;
justify-content:center;
width:44px; height:44px;
border-radius:10px;
background: linear-gradient(135deg,var(--accent),var(--accent-2));
color:white;
box-shadow: 0 8px 20px rgba(255,107,61,0.18);
font-size:18px;
}
.brand-text { line-height:1; display:none; } /* hidden on small by default */
.brand-title{ font-family: var(--text-hero); letter-spacing:0.06em; font-size:0.95rem; display:block; color:#111; }
.brand-tag{ display:block; font-size:0.67rem; color:var(--muted); margin-top:2px; }

/* main nav (desktop) */
.main-nav{
margin-left:16px;
flex:1;
}
.nav-list{
list-style:none;
display:flex;
gap:14px;
align-items:center;
margin:0;
padding:0;
}
.nav-link{
display:inline-flex;
gap:8px;
align-items:center;
text-decoration:none;
color:#222;
padding:8px 12px;
border-radius:12px;
font-weight:600;
font-size:0.92rem;
transition: all .22s ease;
}
.nav-link i { opacity:0.85; }
.nav-link:hover, .nav-link:focus{
transform: translateY(-3px);
box-shadow: 0 8px 20px rgba(16,16,16,0.06);
background: linear-gradient(180deg, rgba(255,255,255,0.8), rgba(255,255,255,0.6));
}

/* header actions */
.header-actions{
display:flex;
align-items:center;
gap:8px;
}
.icon-btn{
display:inline-grid;
place-items:center;
width:44px;height:44px;border-radius:10px;
background:transparent;border:0;
font-size:1.02rem;
}
.icon-btn:focus{ outline:3px solid rgba(255,107,61,0.16); outline-offset:3px; border-radius:10px; }

/* cart badge */
.cart-badge{
display:inline-block;
min-width:20px;height:20px;
padding:0 6px;
border-radius:999px;
font-size:0.7rem;font-weight:700;
background:var(--accent-3); color:white;
margin-left: -12px;
transform-origin:center;
}
.cart-badge.pulse{ animation: cartPulse .72s ease; }
@keyframes cartPulse{ 0%{ transform:scale(.9) }50%{ transform:scale(1.15) }100%{ transform:scale(1)} }

/* CTA button style */
.btn{
font-family: var(--text-ui);
border-radius:12px;
padding:10px 14px;
font-weight:700;
border:0;
cursor:pointer;
display:inline-flex;
gap:8px;
align-items:center;
}
.btn-cta{
background: linear-gradient(90deg,var(--accent),var(--accent-2));
color:#111;
box-shadow: 0 12px 30px rgba(255,107,61,0.13);
transform: translateZ(0);
}
.btn-outline{
border:1px solid rgba(16,16,16,0.06);
background:transparent;
color:#222;
}
.btn-pay{
background: linear-gradient(90deg,#3b82f6,#06b6d4);
color:white;
}

/* hamburger (mobile visible) */
.hamburger{ display:inline-grid; }

/* --- HERO --- */
/* hero takes full viewport minus header */
.hero-section.hero-viewport{
position:relative;
margin-top:var(--header-h); /* ensures hero starts below header */
min-height: calc(100vh - var(--header-h));
overflow:hidden;
background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
display:block;
-webkit-font-smoothing:antialiased;
}

/* inner content sizing */
.hero-viewport-inner{
display:flex;
gap:22px;
align-items:stretch;
padding:28px 0;
position:relative;
}

/* carousel area */
.hero-carousel-wrap{
position:relative;
flex:1 1 720px;
min-height: calc(100vh - var(--header-h) - 56px);
border-radius:20px;
overflow:hidden;
box-shadow: 0 24px 70px rgba(15,15,15,0.08);
background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
}

/* stage that holds slides - keep relative */
.carousel-stage{
position:relative;
width:100%;
height:100%;
}

/* slide - absolute overlay stack */
.hero-slide{
position:absolute;
inset:0;
display:flex;
align-items:center;
justify-content:flex-start;
gap:28px;
padding:36px;
box-sizing:border-box;
transition: opacity .55s cubic-bezier(.2,.9,.2,1), transform .6s cubic-bezier(.2,.9,.2,1);
opacity:0;
pointer-events:none;
}
.hero-slide.active{ opacity:1; pointer-events:auto; transform:translateZ(0); }

/* slide artwork */
.slide-artwork{
position:relative;
width:60%;
height:100%;
margin:0;
display:block;
border-radius:18px;
overflow:hidden;
flex-shrink:0;
background: linear-gradient(160deg, rgba(0,0,0,0.18), rgba(0,0,0,0.06));
}
.slide-artwork img.slide-image{
display:block;
width:100%;
height:100%;
object-fit:cover;
transition: transform .9s cubic-bezier(.22,.9,.18,1), filter .6s ease;
will-change:transform;
transform-origin:center;
filter: saturate(1.05) contrast(1.02);
}

/* decorative badges inside image */
.slide-badges{
position:absolute;
left:16px; top:16px;
display:flex;
gap:8px;
flex-wrap:wrap;
}
.badge{
display:inline-flex;
gap:8px;
align-items:center;
padding:8px 10px;
border-radius:999px;
background: rgba(0,0,0,0.45);
color:white;
font-weight:700;
font-size:0.8rem;
box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}
.badge .fa{ opacity:0.9; font-size:0.85rem; }

/* slide panel (text) */
.slide-panel{
width:40%;
min-width:260px;
display:flex;
flex-direction:column;
gap:14px;
padding:28px;
background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02));
border-radius:14px;
backdrop-filter: blur(6px);
box-shadow: 0 12px 30px rgba(12,12,12,0.06);
transform: translateY(8px);
transition: transform .6s cubic-bezier(.2,.9,.2,1), opacity .6s;
color: #111;
}
.hero-slide:not(.active) .slide-panel{ transform: translateY(18px); opacity:0; }

/* Eyebrow & title */
.eyebrow{ color: var(--muted); font-weight:700; font-size:0.85rem; display:flex; gap:8px; align-items:center; }
.hero-title{
margin:0;
font-family: var(--text-hero);
font-size: clamp(1.4rem, 3.8vw, 2.6rem);
letter-spacing: -0.02em;
line-height:1.02;
display:flex;
gap:10px;
align-items:center;
}
.hero-title i{ color: var(--accent); font-size:1.05rem; }

/* sub / description */
.hero-sub{ color: #333; font-size:1rem; margin:0; }

/* CTA row */
.hero-ctas{ display:flex; gap:10px; flex-wrap:wrap; margin-top:6px; }
.btn-cta{ padding:12px 16px; font-size:0.95rem; border-radius:12px; }
.btn-outline{ padding:10px 14px; }

/* features chips */
.hero-features{ list-style:none; display:flex; gap:10px; padding:0; margin:0; margin-top:8px; flex-wrap:wrap; }
.hero-features li{
display:inline-flex; gap:8px; align-items:center;
background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
padding:8px 10px;border-radius:999px;font-weight:700;color:var(--muted);
font-size:0.9rem;
box-shadow: 0 6px 18px rgba(16,16,16,0.03);
}

/* carousel controls (prev/next/dots) */
.carousel-controls{
position:absolute;
bottom:18px;
left:18px;
display:flex;
align-items:center;
gap:10px;
z-index:40;
}
.carousel-prev, .carousel-next{
width:44px;height:44px;border-radius:10px;border:0; display:inline-grid; place-items:center;
background: rgba(255,255,255,0.9); box-shadow: 0 10px 26px rgba(16,16,16,0.08);
}
.carousel-dots{ display:flex; gap:8px; align-items:center; padding:4px; background: rgba(255,255,255,0.72); border-radius:999px; box-shadow: 0 8px 20px rgba(16,16,16,0.06); }
.dot{ width:10px;height:10px; border-radius:999px; display:inline-grid; place-items:center; border:0; background: rgba(0,0,0,0.12); padding:6px; }
.dot.active{ background: var(--accent); transform:scale(1.18); box-shadow: 0 6px 18px rgba(255,107,61,0.12); }

/* decorative floating stickers */
.hero-stickers{
position:absolute;
right:18px; top:18px;
display:flex; flex-direction:column; gap:12px; z-index:30; pointer-events:none;
}
.sticker{
width:52px;height:52px;border-radius:12px; display:grid; place-items:center; background:linear-gradient(135deg,var(--accent-2),var(--accent)); color:white;
box-shadow: 0 12px 30px rgba(255,107,61,0.12); opacity:0.95; transform: translateZ(0);
}

/* right quick-picks aside */
.hero-right.quick-picks-section{
width:320px;
position:relative;
display:none; /* hidden by default on small screens */
}
.featured-card{
position:sticky; top:calc(var(--header-h) + 24px);
background: #fff;
border-radius:18px;
padding:16px;
box-shadow: 0 20px 50px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.04);
}
.featured-head .featured-title{ font-size:1.06rem; margin:0; }
.quick-picks{ list-style:none; padding:8px 0; margin:12px 0 0 0; display:flex; flex-direction:column; gap:10px; }
.pick{ display:flex; gap:10px; align-items:center; border-radius:12px; padding:8px; background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent); }
.pick-media img{ width:60px;height:60px; border-radius:10px; object-fit:cover; }

/* mini cart in right */
.mini-cart{ margin-top:12px; padding-top:8px; border-top:1px dashed rgba(16,16,16,0.04); }

/* hero slide subtle text reveal animation */
@keyframes textRiseFade {
0% { transform: translateY(10px); opacity: 0; filter: blur(4px); }
100% { transform: translateY(0); opacity: 1; filter: blur(0); }
}
.hero-slide.active .slide-panel { animation: textRiseFade .55s cubic-bezier(.2,.9,.2,1) both; }

/* slight shimmer on hero title */
.hero-title::after{
content:'';
display:block;
width:0;
height:4px;
border-radius:10px;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.24), transparent);
margin-top:8px;
transition: width .55s ease;
}
.hero-slide.active .hero-title::after{ width:46%; }

/* hover micro interaction on artwork and badges */
.hero-carousel-wrap:hover .slide-artwork img{ transform: scale(1.03) translateZ(0); filter: saturate(1.08) contrast(1.03); }

/* subtle entrance for entire carousel on load */
.hero-carousel-wrap{ transform: translateY(4px); transition: transform .8s cubic-bezier(.2,.9,.2,1), box-shadow .4s; }
.hero-carousel-wrap:has(.hero-slide.active){ transform: none; }

/* --- responsive breakpoints --- */
/* show brand text at medium break */
@media (min-width:720px){
.brand-text{ display:block; }
:root{ --header-h:72px; }
}

/* larger screens: show nav and quick-picks */
@media (min-width:980px){
.hamburger{ display:none; } /* hide hamburger on large */
.main-nav{ display:block; }
.header-actions .location-btn, .header-actions .search-btn { display:inline-flex; }
.header-actions .btn-cta { display:inline-flex; }
.brand-title{ font-size:1rem; }
:root{ --header-h:82px; }
.hero-viewport-inner{ gap:28px; }
.hero-right.quick-picks-section { display:block; }
.hero-carousel-wrap{ flex-basis: 68%; }
.slide-artwork{ width:62%; }
.slide-panel{ width:36%; }
}

/* small screens: compact header */
@media (max-width:979px){
/* hide nav and many header icons to keep header minimal */
.main-nav{ display:none; }
.header-actions .search-btn, .header-actions .location-btn, .header-actions .order-cta { display:none; }
.brand-text{ display:none; } /* only show logo on small */
.hero-viewport-inner{ padding:18px 0; }
.hero-carousel-wrap{ border-radius:14px; min-height: calc(100vh - var(--header-h) - 36px); }
.slide-artwork{ display:block; width:100%; height:62vh; border-radius:14px; }
.slide-panel{ position:absolute; left:14px; right:14px; bottom:18px; width:auto; backdrop-filter: blur(8px) saturate(120%); background: linear-gradient(180deg, rgba(0,0,0,0.28), rgba(0,0,0,0.16)); color:white; }
.slide-panel .eyebrow, .slide-panel .hero-features, .hero-sub{ color: rgba(255,255,255,0.9); }
.hero-title{ color:white; font-size: clamp(1.4rem, 6.5vw, 2.2rem); }
.carousel-controls{ left:12px; bottom:12px; }
.hero-stickers{ right:12px; top:calc(var(--header-h) + 12px); }
.hero-right.quick-picks-section{ display:none; } /* hide right picks on small */
}

/* very large screens: more spacing */
@media (min-width:1400px){
.hero-carousel-wrap{ min-height: calc(100vh - var(--header-h) - 40px); }
.slide-artwork img{ transform-origin: center left; }
}

/* --- mobile nav open overlay (controlled by JS toggling documentElement.classList) --- */
html.mobile-nav-open .main-nav{
display:block;
position: fixed;
left:0; right:0; top:var(--header-h); height: calc(100vh - var(--header-h));
background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.98));
padding: 22px;
box-shadow: 0 40px 80px rgba(16,16,16,0.12);
z-index:1100;
}
html.mobile-nav-open .nav-list{ flex-direction:column; gap:16px; }
html.mobile-nav-open .nav-link{ padding:12px 16px; }

/* accessibility: focus visible */
a:focus, button:focus { outline: 3px solid rgba(99,102,241,0.12); outline-offset:3px; }

/* reduced motion */
@media (prefers-reduced-motion: reduce){
.hero-slide, .slide-artwork img, .badge, .sticker, .dot, .btn-cta { transition: none !important; animation: none !important; }
}

/* small utilities */
.muted{ color:var(--muted); font-size:0.9rem; }
.small{ font-size:0.82rem; }
.tiny{ font-size:0.72rem; color:var(--muted); }

/* make sure header spacing doesn't cover the anchor targets when linking to sections */
:target::before{
content: "";
display:block;
height: calc(var(--header-h) + 12px);
margin-top: calc(-1 * (var(--header-h) + 12px));
}

/* end of header & hero styling */
</style>


<style>
/* ================================
Wrap District — Cart, Modals & Chat
Beautiful, accessible, responsive, animated
================================ */

/* ---------------------
Shared modal/drawer tokens
--------------------- */
:root{
--modal-bg: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
--modal-glass: rgba(255,255,255,0.6);
--modal-radius:18px;
--drawer-width:420px;
--chat-width:340px;
--chat-expanded-width:360px;
}

/* ============================
OVERLAY (dim layer) - used by modals/drawers
============================ */
.overlay-dim{
position:fixed;
inset:0;
background: linear-gradient(180deg, rgba(2,6,23,0.48), rgba(2,6,23,0.36));
z-index:1100;
opacity:0;
pointer-events:none;
transition: opacity .28s ease;
backdrop-filter: blur(6px) saturate(110%);
}
.overlay-dim.active{
opacity:1;
pointer-events:auto;
}

/* ============================
CART DRAWER (desktop & mobile)
============================ */
.drawer{
position:fixed;
z-index:1150;
right:0;
top:0;
height:100vh;
display:flex;
flex-direction:column;
background: transparent;
pointer-events:none; /* wrapper - inner shell will receive pointer events */
transition: transform .36s cubic-bezier(.22,.9,.18,1), opacity .26s;
opacity:0;
}
.drawer[hidden]{ transform: translateX(8px); opacity:0; pointer-events:none; }
.drawer:not([hidden]){ transform: translateX(0); opacity:1; pointer-events:auto; }

/* inner shell */
.drawer-shell{
width: min(var(--drawer-width), 94vw);
max-width: var(--drawer-width);
height:100%;
background: var(--modal-bg);
border-radius: 18px 0 0 18px;
box-shadow: 0 40px 120px rgba(8,8,8,0.2);
padding:18px;
box-sizing:border-box;
margin-left: auto;
overflow-y:auto;
pointer-events:auto;
border-left: 1px solid rgba(16,16,16,0.04);
}

/* drawer header */
.drawer-head{
display:flex;
align-items:center;
gap:12px;
justify-content:space-between;
padding-bottom:6px;
border-bottom: 1px dashed rgba(16,16,16,0.04);
}
.drawer-head h3{ margin:0; font-size:1.06rem; display:flex; gap:10px; align-items:center; }
.drawer-close{ background:transparent; border:0; font-size:1.05rem; width:44px; height:44px; border-radius:10px; }

/* cart items list */
.cart-items{ list-style:none; margin:12px 0 8px 0; padding:0; display:flex; flex-direction:column; gap:12px; }
.cart-item{
display:flex; gap:10px; align-items:center;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
border-radius:12px; padding:12px;
box-shadow: 0 10px 30px rgba(12,12,12,0.05);
border: 1px solid rgba(16,16,16,0.03);
}
.cart-item img{ width:72px; height:72px; border-radius:12px; object-fit:cover; flex-shrink:0; }
.cart-item strong{ display:block; font-size:0.98rem; }
.cart-item .muted.small{ color:var(--muted); font-size:0.82rem; margin-top:6px; }

/* qty & price pane */
.cart-item .qty-box{
margin-left:auto; text-align:right; display:flex; flex-direction:column; gap:8px; align-items:flex-end;
}
.qty-controls{ display:inline-flex; gap:6px; align-items:center; }
.qty-controls .icon-btn{ width:36px; height:36px; border-radius:9px; background:transparent; border:1px solid rgba(16,16,16,0.04); }
.cart-item .price{ font-weight:800; font-size:1rem; }

/* remove button */
.cart-item .remove-item{ background: linear-gradient(90deg, rgba(255,107,61,0.06), rgba(255,61,110,0.03)); border-radius:10px; padding:8px 10px; font-weight:700; }

/* cart summary */
.cart-summary{
margin-top:12px;
padding-top:12px; border-top:1px dashed rgba(16,16,16,0.04);
display:flex; flex-direction:column; gap:12px;
}
.cart-row{ display:flex; justify-content:space-between; align-items:center; gap:8px; font-weight:600; }
.cart-row.total{ font-size:1.1rem; font-weight:900; }

/* cart actions */
.cart-actions{ display:flex; gap:10px; align-items:center; margin-top:6px; }
.cart-actions .checkout{ flex:1; padding:12px 14px; border-radius:12px; font-weight:900; }
.cart-actions .clear-cart{ padding:10px 12px; border-radius:10px; }

/* empty-cart state */
.drawer .empty-state{
display:flex; flex-direction:column; gap:10px; align-items:center; justify-content:center; padding:36px 6px; text-align:center;
color:var(--muted);
}

/* responsive: mobile drawer slides from bottom and becomes full-screen panel */
@media (max-width:720px){
.drawer{ left:0; right:0; top:auto; bottom:0; height:auto; transform: translateY(18px); }
.drawer-shell{ width:100%; max-width:100%; height: min(70vh, 86vh); border-radius:12px 12px 0 0; margin:0 auto; padding:14px; }
}

/* ============================
GENERIC MODAL (builder-modal and other modals)
============================ */
.modal{
position:fixed;
inset:0;
z-index:1200;
display:flex;
align-items:center;
justify-content:center;
pointer-events:none;
opacity:0;
transition: opacity .26s ease;
}
.modal[hidden]{ opacity:0; pointer-events:none; transform: scale(.998); }
.modal:not([hidden]){ opacity:1; pointer-events:auto; }

/* modal shell (centered card) */
.modal-shell{
width: min(1100px, calc(100vw - 36px));
max-height: calc(100vh - 110px);
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
border-radius: var(--modal-radius);
box-shadow: 0 40px 140px rgba(8,8,8,0.22);
padding:18px;
display:grid;
grid-template-columns: 1fr 380px;
gap:18px;
overflow:hidden;
pointer-events:auto;
border:1px solid rgba(16,16,16,0.04);
}

/* modal header */
.modal-header{
display:flex; justify-content:space-between; align-items:center; gap:12px;
padding-bottom:6px; border-bottom:1px dashed rgba(16,16,16,0.04);
}
.modal-header h3{ margin:0; font-size:1.12rem; }

/* left column of builder : content */
.modal-left{
overflow:auto;
padding-right:6px;
}

/* right column : preview */
.modal-right{
background: linear-gradient(180deg, rgba(250,250,250,0.96), rgba(245,245,245,0.96));
border-radius: 14px;
padding:14px;
box-shadow: inset 0 2px 6px rgba(255,255,255,0.85), 0 12px 40px rgba(12,12,12,0.06);
display:flex;
flex-direction:column;
gap:12px;
min-width:260px;
max-height: calc(100vh - 180px);
overflow:auto;
}

/* live preview image */
.preview-image img{ width:100%; height:220px; object-fit:cover; border-radius:12px; }

/* builder stepper and options */
.builder-stepper{ display:flex; gap:8px; flex-wrap:wrap; margin:12px 0; }
.builder-stepper .step{
background: rgba(16,16,16,0.02); border-radius:12px; padding:8px 12px; border:1px solid rgba(16,16,16,0.03);
cursor:pointer; font-weight:800; display:inline-flex; gap:8px; align-items:center;
}
.builder-stepper .step.active{ background: linear-gradient(90deg, var(--accent), var(--accent-2)); color:#111; box-shadow: 0 12px 30px rgba(255,107,61,0.08); }

/* options grid */
.options-grid{ display:grid; grid-template-columns: repeat(2,1fr); gap:10px; }
.option{
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
border-radius:12px;
padding:10px;
text-align:left;
border:1px solid rgba(16,16,16,0.03);
cursor:pointer;
box-shadow: 0 10px 26px rgba(12,12,12,0.04);
display:flex; flex-direction:column; gap:8px;
}
.option.selected{ border: 2px solid rgba(255,107,61,0.16); box-shadow: 0 12px 36px rgba(255,107,61,0.06); transform: translateY(-4px); }
.option strong{ font-weight:900; }

/* step panel layout */
.builder-step-panel{ padding:8px 0; }
.builder-steps{ min-height:220px; }

/* modal footer actions inside preview */
.preview-actions .btn{ width:100%; }

/* modal responsiveness */
@media (max-width:980px){
.modal-shell{ grid-template-columns: 1fr; padding:12px; width: calc(100vw - 20px); max-height: calc(100vh - 40px); border-radius:12px; }
.modal-right{ order:2; }
.modal-left{ order:1; }
.preview-image img{ height:180px; }
}

/* keyboard focus visual for modal elements */
.modal-shell :focus{ outline:3px solid rgba(99,102,241,0.12); outline-offset:4px; border-radius:10px; }

/* subtle entrance animation */
.modal:not([hidden]) .modal-shell{ transform: translateY(6px); transition: transform .36s cubic-bezier(.2,.9,.2,1); }

/* ============================
GENERIC SMALL MODAL (confirmation/toasts)
============================ */
.small-modal{
width:fit-content;
max-width:92vw;
padding:12px 16px;
border-radius:12px;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
box-shadow: 0 20px 60px rgba(8,8,8,0.14);
}

/* ============================
TOASTER (already used by JS) — polished
============================ */
.wrap-toaster{
position: fixed;
right: 18px;
bottom: 18px;
background: linear-gradient(90deg, rgba(16,16,16,0.9), rgba(36,36,36,0.95));
color: #fff;
padding: 12px 16px;
border-radius: 12px;
font-weight:800;
z-index:1300;
transform-origin: bottom right;
opacity:0;
transition: opacity .22s ease, transform .24s cubic-bezier(.2,.9,.2,1);
pointer-events:none;
}
.wrap-toaster.visible{ opacity:1; pointer-events:auto; transform: translateY(-6px); }

/* ============================
MANEF CHATBOT — floating assistant
============================ */
#manef-chat{
position:fixed;
right:18px;
bottom:18px;
z-index:1250;
display:flex;
flex-direction:column;
gap:8px;
align-items:flex-end;
}

/* chat toggle bubble */
.chat-toggle{
width:62px; height:62px; border-radius:999px; display:inline-grid; place-items:center;
background: linear-gradient(135deg, var(--accent-2), var(--accent));
color:white; box-shadow: 0 18px 48px rgba(255,107,61,0.12);
border:0;
cursor:pointer;
transition: transform .22s ease, box-shadow .22s;
}
.chat-toggle:active{ transform: scale(.96); }

/* chat panel (hidden by default) */
.chat-panel{
width: var(--chat-width);
max-width: calc(100vw - 36px);
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
border-radius: 14px;
box-shadow: 0 40px 120px rgba(8,8,8,0.18);
overflow:hidden;
display:flex;
flex-direction:column;
pointer-events:auto;
transform-origin: bottom right;
transition: transform .28s cubic-bezier(.22,.9,.18,1), opacity .22s;
opacity:0;
transform: translateY(6px) scale(.98);
border:1px solid rgba(16,16,16,0.04);
}

/* when visible — JS toggles hidden attribute, but we style both states generically */
.chat-panel[hidden]{ opacity:0; transform: translateY(6px) scale(.98); pointer-events:none; }
.chat-panel:not([hidden]){ opacity:1; transform: translateY(0) scale(1); pointer-events:auto; }

/* chat header */
.chat-head{
display:flex; gap:12px; align-items:center; padding:12px 12px; border-bottom:1px dashed rgba(16,16,16,0.04);
background: linear-gradient(90deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
}
.chat-avatar{ width:42px; height:42px; border-radius:10px; display:grid; place-items:center; background: linear-gradient(135deg,#ffd8a8,#ff6b3d); color:#111; font-weight:900; }
.chat-head strong{ font-size:1rem; }
.chat-head .muted.tiny{ font-size:0.78rem; color:var(--muted); }

/* chat body messages area */
.chat-body{ padding:12px; display:flex; flex-direction:column; gap:8px; max-height:360px; overflow:auto; background: linear-gradient(180deg, rgba(250,250,250,0.98), rgba(245,245,245,0.98)); }
.chat-body .bot-message, .chat-body .chat-msg.bot{ align-self:flex-start; background: linear-gradient(90deg, rgba(240,240,245,0.98), rgba(245,245,250,0.98)); color:#111; padding:10px 12px; border-radius:12px; box-shadow: 0 8px 20px rgba(12,12,12,0.04); max-width:86%; }
.chat-body .chat-msg.user{ align-self:flex-end; background: linear-gradient(90deg, rgba(255,107,61,0.98), rgba(255,61,110,0.98)); color:white; padding:10px 12px; border-radius:12px; max-width:86%; box-shadow: 0 12px 30px rgba(255,107,61,0.08); }

/* chat footer */
.chat-foot{ display:flex; gap:8px; padding:10px; border-top:1px dashed rgba(16,16,16,0.04); background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98)); }
.chat-input{ flex:1; padding:10px 12px; border-radius:10px; border:1px solid rgba(16,16,16,0.04); font-size:0.95rem; }
.send-chat{ width:44px; height:44px; border-radius:10px; background: linear-gradient(90deg,#3b82f6,#06b6d4); color:white; border:0; }

/* compact mobile chat: remove large shadows and make full-width panel */
@media (max-width:520px){
#manef-chat{ right:12px; bottom:12px; left:12px; align-items:center; }
.chat-panel{ width: 100%; border-radius:12px; max-height: 78vh; }
.chat-body{ max-height: 52vh; }
.chat-toggle{ width:56px; height:56px; }
}

/* accessibility: prefer-reduced-motion for chat animations */
@media (prefers-reduced-motion: reduce){
.modal-shell, .drawer-shell, .chat-panel, .hero-slide { transition: none !important; animation: none !important; }
}

/* small niceties: focus and hover states for buttons in cart/modal/chat */
.btn:focus, .icon-btn:focus { box-shadow: 0 10px 26px rgba(99,102,241,0.08); transform: translateY(-1px); }
.button-glow{ box-shadow: 0 16px 48px rgba(255,107,61,0.12); transform: translateZ(0); }

/* ============================
END styling for cart, modals & chat
============================ */
</style>
<style>
/* ============================
Fast Picks & Promo — Stunning Styles
Paste after your existing styles (uses --accent, --accent-2, --glass tokens)
============================ */

/* ---------- FAST PICKS (aside #fast-picks / .quick-picks-section) ---------- */

/* Base container */
#fast-picks.quick-picks-section {
width: 100%;
margin: 18px auto;
box-sizing: border-box;
transition: transform .36s cubic-bezier(.2,.9,.2,1), opacity .3s;
will-change: transform, opacity;
}

/* Featured-card becomes the big visual element */
#fast-picks .featured-card {
display: grid;
grid-template-columns: 1fr;
gap: 12px;
align-items:stretch;
padding: 18px;
border-radius: 18px;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(248,248,249,0.96));
box-shadow: 0 30px 90px rgba(12,12,12,0.08);
border: 1px solid rgba(16,16,16,0.04);
transform: translateY(0);
}

/* Make Fast Picks visually dominant on small screens:
- large carousel-like cards
- take much vertical space so users see it before menu
*/
@media (max-width:979px) {
#fast-picks { order: -1; margin-top: 14px; padding: 6px; }
#fast-picks .featured-card { padding: 16px; border-radius: 14px; }

/* Expand picks into a horizontal swipeable row style */
.quick-picks {
display:flex;
gap:12px;
overflow-x:auto;
padding-bottom:6px;
-webkit-overflow-scrolling: touch;
scroll-snap-type: x mandatory;
}
.quick-picks .pick {
min-width: 78%;
scroll-snap-align: center;
flex: 0 0 auto;
padding: 12px;
border-radius: 14px;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
box-shadow: 0 22px 60px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.04);
transform-origin:center;
transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s;
}
.quick-picks .pick:active, .quick-picks .pick:focus-within { transform: translateY(-6px); box-shadow: 0 30px 90px rgba(12,12,12,0.09); }
.pick-media img { width:84px;height:84px;border-radius:12px; }
.pick-info strong{ font-size:1.06rem; display:block; margin-bottom:6px; }
.pick-actions { display:flex; gap:8px; margin-top:10px; }
.pick .pick-icons { margin-top:6px; color:var(--muted); }
/* larger mini-cart */
.mini-cart { margin-top:12px; background: linear-gradient(90deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98)); padding:12px; border-radius:12px; }
}

/* Desktop: make Fast Picks prominent but side-oriented */
@media (min-width:980px) {
#fast-picks {
width: 400px;
position:relative;
}
#fast-picks .featured-card {
position: sticky;
top: calc(var(--header-h) + 28px);
padding: 20px;
gap: 16px;
}
.quick-picks {
display:flex;
flex-direction:column;
gap:12px;
max-height: calc(100vh - var(--header-h) - 160px);
overflow:auto;
padding-right:6px;
}
.quick-picks .pick {
display:flex; align-items:center; gap:12px; padding:12px;
transition: transform .28s ease, box-shadow .28s ease;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(252,252,253,0.96));
}
.quick-picks .pick:hover { transform: translateY(-6px); box-shadow: 0 26px 74px rgba(12,12,12,0.06); }
.pick-media img { width:72px;height:72px;border-radius:12px; }
.pick-info strong{ font-size:1.02rem; }
.pick-actions { display:flex; gap:8px; margin-left:auto; }
}

/* CTA highlight area inside Featured Card */
.featured-head{ display:flex; flex-direction:column; gap:8px; }
.featured-title{ font-family: var(--text-hero); font-size:1.12rem; letter-spacing: -0.02em; color:#111; }
.featured-sub{ color:var(--muted); font-size:0.93rem; margin:0; }

/* shimmering CTA band */
.featured-card::after{
content:'';
position:absolute;
inset:auto 14px 14px 14px;
height:6px;
border-radius:8px;
background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
pointer-events:none;
}

/* small 'fast pick' badge */
.featured-title i{ color: var(--accent); margin-right:6px; }

/* ---------- PROMO — BUY 2 SHAWARMAS GET 1 FREE (section #promo.promo-radiant) ---------- */

#promo.promo-radiant{
margin: 28px auto;
padding: 26px;
border-radius: 22px;
overflow: visible;
position: relative;
background: linear-gradient(135deg, rgba(255,240,230,0.98), rgba(255,250,242,0.96));
box-shadow: 0 40px 140px rgba(255,133,88,0.06), inset 0 1px 0 rgba(255,255,255,0.6);
border: 1px solid rgba(255,120,66,0.06);
max-width: var(--max-width);
}

/* glowing decorative ring behind promo */
#promo.promo-radiant::before{
content:'';
position:absolute;
right: -6%;
top: -18%;
width:520px;
height:520px;
border-radius:50%;
background: radial-gradient(circle at 30% 30%, rgba(255,203,164,0.35), transparent 30%), radial-gradient(circle at 70% 70%, rgba(255,107,61,0.06), transparent 40%);
filter: blur(28px);
z-index:0;
pointer-events:none;
}

/* layout: left content and right collage */
.promo-inner{
position:relative;
display:grid;
grid-template-columns: 1fr 420px;
gap:22px;
align-items:center;
z-index:2;
}
.promo-left{ padding:6px 6px 6px 12px; }
.promo-right{ display:flex; align-items:center; justify-content:center; position:relative; }

/* promo badge and header */
.promo-badge{
display:inline-flex; gap:10px; align-items:center;
padding:8px 12px; border-radius:999px; background: linear-gradient(90deg,var(--accent-2),var(--accent));
color: #111; font-weight:900; font-size:0.92rem;
box-shadow: 0 14px 50px rgba(255,107,61,0.08);
}
.promo-title{
font-family: var(--text-hero);
font-size: clamp(1.6rem, 3.8vw, 2.4rem);
margin:12px 0 8px 0;
letter-spacing: -0.02em;
color: #111;
line-height:1.02;
}
.promo-desc{ color:#333; font-size:1rem; margin:0 0 14px 0; max-width:66ch; }

/* big CTA cluster with countdown pill */
.promo-actions{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
.promo-actions .btn-cta{
padding:14px 18px; font-size:1.02rem; border-radius:12px; box-shadow: 0 16px 46px rgba(255,107,61,0.08);
}
.promo-actions .btn-outline{ padding:12px 14px; border-radius:12px; }

/* Countdown pill */
.promo-countdown{
display:inline-flex; gap:12px; align-items:center; padding:10px 12px; border-radius:12px;
background: linear-gradient(90deg, rgba(255,255,255,0.96), rgba(255,255,255,0.92));
border: 1px solid rgba(16,16,16,0.04);
box-shadow: 0 12px 32px rgba(12,12,12,0.04);
font-weight:800;
}

/* right collage (overlapping images) */
.promo-collage{ position:relative; width:100%; height:280px; display:grid; place-items:center; }
.promo-collage .collage-item{
position:absolute; background-size:cover; background-position:center; border-radius:16px; box-shadow: 0 20px 60px rgba(12,12,12,0.08);
transition: transform .6s cubic-bezier(.2,.9,.2,1), box-shadow .36s;
outline: 4px solid rgba(255,255,255,0.12);
}
.promo-collage .collage-item.big{ width: 260px; height: 260px; left: 40px; top: 10px; transform: rotate(-6deg); }
.promo-collage .collage-item.medium{ width: 160px; height: 160px; right: 18px; top: 40px; transform: rotate(4deg); }
.promo-collage .collage-item.small{ width: 120px; height: 120px; right: -8px; bottom: -6px; transform: rotate(-4deg); }

/* animated pulse / hover to attract attention */
#promo.promo-radiant:hover .collage-item{ transform: scale(1.02) rotate(0deg); box-shadow: 0 36px 100px rgba(12,12,12,0.14); }

/* celebration ribbon — Buy 2 Get 1 */
.promo-ribbon{
position:absolute;
left:16px;
top:-12px;
display:inline-flex; align-items:center; gap:10px;
padding:10px 14px; border-radius:999px;
background: linear-gradient(90deg, #ffd6b3, #ffb58a);
color:#111; font-weight:900; box-shadow: 0 12px 40px rgba(255,107,61,0.06);
transform: rotate(-4deg);
z-index:3;
border: 1px solid rgba(255,120,66,0.06);
}

/* floating food sparkles near ribbon */
.promo-ribbon::after{
content:'';
display:block;
width:12px; height:12px; border-radius:4px;
background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0.5));
margin-left:8px;
box-shadow: 0 8px 26px rgba(255,107,61,0.08);
animation: sparkle 1.8s infinite ease-in-out;
}
@keyframes sparkle {
0%{ transform: translateY(0) scale(0.9); opacity:0.85 }
50%{ transform: translateY(-6px) scale(1.12); opacity:1 }
100%{ transform: translateY(0) scale(0.9); opacity:0.85 }
}

/* persuasive microcopy under title */
.promo-subtle{
color:var(--muted);
font-weight:700;
display:block;
margin-top:6px;
}

/* FOOTER note for promo (small print) */
.promo-desc.small{ font-size:0.86rem; color:var(--muted); margin-top:6px; }

/* accessibility: reduce motion */
@media (prefers-reduced-motion: reduce){
.collage-item, .promo-ribbon::after, .quick-picks .pick { animation: none !important; transition: none !important; transform: none !important; }
}

/* responsive adjustments */
@media (max-width:980px){
.promo-inner{ grid-template-columns: 1fr; gap:12px; }
.promo-right{ order:2; display:flex; justify-content:center; }
.promo-left{ order:1; padding:0; }
.promo-collage{ height:220px; }
.promo-collage .collage-item.big{ width: 220px; height:220px; left: 12px; top: 6px; }
.promo-collage .collage-item.medium{ width: 140px; height:140px; right: 22px; top: 36px; }
.promo-collage .collage-item.small{ width: 100px; height:100px; right: -4px; bottom: -6px; }
#promo.promo-radiant{ padding:16px; border-radius:12px; margin:16px 8px; }
}

/* extra CTA glow on hover for persuasion */
#promo .btn-cta:hover{ transform: translateY(-4px); box-shadow: 0 28px 90px rgba(255,107,61,0.12); }

/* utility: ensure promo images set by your applyAllArtwork script will cover nicely */
.promo-collage .collage-item[style]{
background-repeat:no-repeat;
background-size:cover;
background-position:center;
}

/* end of fast picks & promo styles */
</style>
<script>
(function(){
  // Run after page scripts initialize
  function enhanceCart() {
    const drawer = document.querySelector('#cart-drawer');
    const shell = drawer?.querySelector('.drawer-shell');
    const items = drawer?.querySelector('.cart-items');
    const summary = drawer?.querySelector('.cart-summary');
    const checkout = drawer?.querySelector('.checkout');

    if (!drawer || !shell || !items || !summary) return;

    // Ensure shell uses full-safe viewport height on mobile
    function setShellMaxHeight(){
      // 100dvh support for modern browsers; fallback to window.innerHeight
      const vh = Math.min(window.innerHeight, document.documentElement.clientHeight || Infinity);
      shell.style.maxHeight = (vh) + 'px';
    }
    setShellMaxHeight();
    window.addEventListener('resize', setShellMaxHeight);

    // When cart opens, make items scroll to top and focus checkout
    const openButtons = document.querySelectorAll('[data-action="open-cart"], .cart-btn, .mini-cart .btn[data-action="view-cart"]');
    openButtons.forEach(b => b.addEventListener('click', () => {
      setTimeout(()=> {
        // small reveal animation
        shell.animate([{ transform: 'translateY(6px)', opacity: 0 }, { transform: 'translateY(0)', opacity: 1 }], { duration: 420, easing: 'cubic-bezier(.2,.9,.2,1)' });

        // scroll items to top gracefully
        items && items.scrollTo({ top: 0, behavior: 'smooth' });

        // focus checkout for keyboard users
        if (checkout) checkout.focus();
      }, 120);
    }));

    // If cart drawer is closed via Escape or close button, return focus to cart button
    const closeButtons = drawer.querySelectorAll('.drawer-close, [data-action="close-cart"]');
    closeButtons.forEach(b => b.addEventListener('click', ()=>{
      const cartBtn = document.querySelector('.cart-btn');
      setTimeout(()=> cartBtn && cartBtn.focus(), 80);
    }));

    // Make sure remove buttons in items (dynamic) keep behavior and do not cause layout jumps
    items.addEventListener('click', (e) => {
      const rm = e.target.closest('.remove-item');
      if (!rm) return;
      // after removing, keep summary visible (no jump)
      setTimeout(()=> {
        items.style.scrollBehavior = 'auto';
        items.scrollTop = Math.max(0, rm.closest('.cart-item') ? rm.closest('.cart-item').offsetTop - 8 : 0);
        setTimeout(()=> items.style.scrollBehavior = '', 50);
      }, 10);
    });

    // optional: touch-friendly overscroll bounce prevention on iOS
    items.addEventListener('touchstart', () => {}, { passive: true });
  }

  // Run on load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', enhanceCart);
  } else enhanceCart();
})();
</script>

<style>
/* =========================
MENU SECTION — Beautiful, responsive, & conversion-focused
- Mobile-first: 2 columns
- Desktop >=980px: 3 columns
- Prominent CTA buttons and visual price badges
========================= */

/* Grid container */
.menu-section { padding: 28px 0; }
.menu-section .section-head { margin-bottom: 12px; }
.menu-grid {
display: grid;
grid-template-columns: repeat(2, 1fr); /* mobile-first: 2cols (2x2 when 4 items visible) */
gap: 16px;
align-items: start;
margin-top: 8px;
transition: all .32s ease;
}

/* Menu item card */
.menu-item{
background: linear-gradient(180deg, rgba(255,255,255,0.99), rgba(250,250,250,0.98));
border-radius: 14px;
overflow: hidden;
display:flex;
flex-direction:column;
gap:10px;
box-shadow: 0 18px 56px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.04);
transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s, border-color .28s;
will-change: transform;
}

/* hover / focus lift */
.menu-item:hover, .menu-item:focus-within{ transform: translateY(-8px); box-shadow: 0 36px 120px rgba(12,12,12,0.10); border-color: rgba(255,107,61,0.06); }

/* Thumbnail area */
.menu-item .thumb{
width:100%;
aspect-ratio: 16 / 11; /* nice food ratio */
background: #f6f6f6;
position:relative;
overflow:hidden;
display:block;
}
.menu-item .thumb img{
width:100%;
height:100%;
object-fit:cover;
display:block;
transition: transform 8s ease; /* slow ken-burns */
transform-origin:center center;
}

/* subtle zoom on hover for sensory effect */
.menu-item:hover .thumb img{ transform: scale(1.06); }

/* Price badge overlay on image */
.menu-item .thumb::after{
content: attr(data-price) "";
position:absolute;
right:10px;
top:10px;
padding:8px 12px;
border-radius:999px;
font-weight:900;
font-size:0.95rem;
background: linear-gradient(90deg,var(--accent-2),var(--accent));
color:#111;
box-shadow: 0 10px 30px rgba(255,107,61,0.10);
display:inline-block;
}

/* Name + meta */
.menu-item .meta{
padding:12px 14px 10px;
display:flex;
flex-direction:column;
gap:8px;
}
.menu-item .meta .name{
font-family: var(--text-hero);
font-size:1.02rem;
margin:0;
display:flex;
gap:8px;
align-items:center;
}
.menu-item .meta .desc{
margin:0;
color:var(--muted);
font-size:0.92rem;
}

/* row for actions */
.menu-item .meta-line{
display:flex;
align-items:center;
gap: 8px;
margin-top:6px;
}

/* price and action area */
.menu-item .price{
font-weight:900;
font-size:1rem;
color:#111;
display:inline-flex;
gap:8px;
align-items:center;
}

/* meta actions (fav, customize, add) */
.menu-item .meta-actions{
margin-left:auto;
display:flex;
align-items:center;
gap:8px;
}

/* Favorite icon button */
.menu-item .icon-btn{
width:40px; height:40px; border-radius:10px;
display:inline-grid; place-items:center;
background: rgba(16,16,16,0.02);
transition: background .18s, transform .18s;
}
.menu-item .icon-btn.favored{ background: linear-gradient(90deg, #ffd6b3, #ffc28a); box-shadow: 0 10px 30px rgba(255,170,110,0.08); transform: translateY(-2px); }
.menu-item .icon-btn:active{ transform: scale(.96); }

/* Buttons inside each card — visible & finger-friendly */
.menu-item .btn.small, .menu-item .btn.btn-pay.small{
padding:8px 12px; border-radius:10px; font-weight:800; font-size:0.92rem;
}
.menu-item .btn.small{ background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96)); border:1px solid rgba(16,16,16,0.04); }
.menu-item .btn.btn-pay.small { background: linear-gradient(90deg,#3b82f6,#06b6d4); color:white; }

/* make sure the actions are fully visible even on small screens */
.menu-item .pick-actions, .menu-item .meta-actions{ display:flex; gap:8px; align-items:center; }

/* price scale on larger screens */
@media (min-width:720px){
.menu-item .thumb{ aspect-ratio: 16/10; }
.menu-item .meta{ padding:14px; }
}

/* Desktop grid: 3 columns for a denser layout */
@media (min-width:980px){
.menu-grid{
grid-template-columns: repeat(3, 1fr);
gap:20px;
}
.menu-item .thumb{ aspect-ratio: 16/9; }
.menu-item{ border-radius:16px; }
.menu-item .name{ font-size:1.06rem; }
.menu-item .price{ font-size:1.06rem; }
}

/* Make CTA cluster sticky at bottom of each card on larger screens */
@media (min-width:980px){
.menu-item{ display:flex; flex-direction:column; }
.meta{ flex:1 1 auto; }
.meta-line{ margin-top:auto; align-items:center; }
}

/* accessibility: focus-visible */
.menu-item a:focus, .menu-item button:focus, .menu-item .icon-btn:focus { outline: 3px solid rgba(99,102,241,0.12); outline-offset:4px; border-radius:10px; }

/* placeholder / low-image state */
.menu-item.placeholder .thumb{ background: linear-gradient(90deg,#f2f2f4,#fafafa); display:grid; place-items:center; color:var(--muted); font-weight:800; }

/* quick decorative badges inside meta (e.g. spicy, veg) */
.menu-item .meta .badge{
display:inline-flex; gap:8px; align-items:center;
padding:6px 8px; border-radius:999px; font-weight:800; font-size:0.82rem;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
border: 1px solid rgba(16,16,16,0.03);
}

/* Make buttons more prominent on hover so they catch attention */
.menu-item:hover .btn.small{ transform: translateY(-2px); box-shadow: 0 12px 32px rgba(12,12,12,0.06); }

/* small-screen tweaks for touch targets */
@media (max-width:520px){
.menu-grid { gap:12px; }
.menu-item .meta { padding:10px; }
.menu-item .btn.small{ padding:10px 12px; font-size:0.96rem; }
.menu-item .thumb::after{ font-size:0.92rem; padding:7px 10px; }
}

/* ensure menu filters row remains visible and sticky on scroll on desktop */
.menu-filters{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:10px; }
@media (min-width:980px){
.menu-filters{ position: sticky; top: calc(var(--header-h) + 10px); z-index: 900; background: transparent; padding:6px 0; }
}

/* reduced motion */
@media (prefers-reduced-motion: reduce){
.menu-item, .menu-item .thumb img { transition: none !important; animation: none !important; transform: none !important; }
}

/* final polish: ensure menu action icons are visible */
.meta-actions .fa, .pick-icons .fa{ color: rgba(0,0,0,0.64); font-size:0.98rem; }

/* End of menu styling */
</style>

<style>
/* ===============================
About / Testimonials / Contact / Footer
— Wrap District: polished, responsive, conversion-focused
Mobile-first, accessible, uses existing design tokens
=============================== */

/* -------------------------
ABOUT / WHY WRAP DISTRICT
------------------------- */
.about-section{
padding: 28px 0;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(249,249,250,0.99));
}
.about-grid{
display:grid;
grid-template-columns: 1fr;
gap:18px;
align-items:center;
max-width: var(--max-width);
margin:0 auto;
padding:8px 18px;
}

/* media area */
.about-media{
width:100%;
height: 240px;
border-radius:14px;
overflow:hidden;
box-shadow: 0 22px 60px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.04);
display:grid;
place-items:center;
background: linear-gradient(180deg,#fff,#fff);
}
.about-media img{ width:100%; height:100%; object-fit:cover; display:block; transition: transform 9s ease; }
.about-media:hover img{ transform: scale(1.04); }

/* content */
.about-content{
display:flex;
flex-direction:column;
gap:12px;
padding:12px 4px;
}
.about-content h2{ font-family: var(--text-hero); font-size:1.28rem; margin:0; color:#111; }
.about-content p{ color: #333; line-height:1.48; margin:0; max-width:68ch; }

/* features list */
.features-list{
display:flex;
gap:12px;
flex-direction:column;
margin-top:8px;
padding:0;
list-style:none;
}
.features-list li{
display:flex; gap:12px; align-items:center;
padding:10px;
border-radius:12px;
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
border:1px solid rgba(16,16,16,0.03);
box-shadow: 0 10px 30px rgba(12,12,12,0.04);
}
.features-list li i{ background: linear-gradient(135deg,var(--accent-2),var(--accent)); color:#111; width:44px;height:44px; display:grid; place-items:center; border-radius:10px; font-size:1.08rem; box-shadow: 0 10px 28px rgba(255,107,61,0.06); }
.features-list li div strong{ display:block; font-weight:900; }
.features-list li div .muted.small{ color:var(--muted); }

/* desktop: two-column layout with image left, content right */
@media (min-width:980px){
.about-grid{ grid-template-columns: 48% 52%; gap:28px; padding:12px 18px; align-items:center; }
.about-media{ height:360px; border-radius:18px; }
.about-content h2{ font-size:1.6rem; }
.features-list{ flex-direction:column; }
}

/* -------------------------
TESTIMONIALS / WHAT CUSTOMERS SAY
------------------------- */
.testimonials-section{ padding: 26px 0; background: linear-gradient(180deg, rgba(255,250,248,0.98), rgba(255,255,255,0.98)); }
.testimonials-section .container{ max-width: var(--max-width); padding:8px 18px; margin:0 auto; }
.testimonials-grid{ display:grid; grid-template-columns: 1fr; gap:14px; margin-top:12px; }

/* testimonial card */
.testimonial{
background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
padding:16px;
border-radius:14px;
box-shadow: 0 18px 60px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.03);
display:flex;
gap:12px;
align-items:flex-start;
transition: transform .26s cubic-bezier(.2,.9,.2,1), box-shadow .26s;
}
.testimonial:hover{ transform: translateY(-6px); box-shadow: 0 30px 100px rgba(12,12,12,0.08); }

/* quote icon and stars */
.testimonial .fa-quote-left{ color: var(--accent); font-size:1.6rem; margin-right:6px; opacity:0.95; }
.testimonial p{ margin:0; color:#222; line-height:1.46; font-size:0.98rem; }
.testimonial footer.muted{ margin-top:10px; color:var(--muted); display:flex; gap:8px; align-items:center; font-weight:800; }

/* grid on larger screens */
@media (min-width:720px){
.testimonials-grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (min-width:1200px){
.testimonials-grid{ grid-template-columns: repeat(3, 1fr); gap:20px; }
}

/* small decorative star accent */
.testimonial::before{
content: '';
width:44px;height:44px;border-radius:10px;
background: linear-gradient(135deg,var(--accent),var(--accent-2));
position:absolute;
transform: translateY(-8px);
opacity:0;
}

/* -------------------------
CONTACT / VISIT & ORDER
------------------------- */
.contact-section{ padding: 28px 0; background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(248,248,249,0.98)); }
.contact-inner{ max-width:var(--max-width); margin:0 auto; padding:8px 18px; display:grid; grid-template-columns: 1fr; gap:18px; align-items:start; }

/* contact card */
.contact-card{
background: linear-gradient(180deg, rgba(255,255,255,0.99), rgba(250,250,250,0.98));
border-radius:16px;
padding:18px;
box-shadow: 0 22px 80px rgba(12,12,12,0.06);
border: 1px solid rgba(16,16,16,0.03);
}
.contact-card h3{ margin:0 0 8px; font-size:1.06rem; font-family: var(--text-hero); }
.contact-card p{ margin:6px 0; color:#333; }
.contact-cta{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; align-items:center; }
.contact-cta .btn-pay{ padding:12px 16px; font-weight:900; box-shadow: 0 14px 46px rgba(59,130,246,0.08); }
.contact-cta a.btn{ border:1px solid rgba(16,16,16,0.04); padding:10px 14px; }

/* map card (visual) */
.map-card{ min-height:220px; border-radius:16px; overflow:hidden; position:relative; box-shadow: 0 22px 80px rgba(12,12,12,0.06); }
.map-placeholder{ width:100%; height:100%; min-height:220px; background: linear-gradient(180deg,#eee,#f8f8f8); display:grid; place-items:center; color:var(--muted); font-weight:900; }

/* desktop layout: card + map side-by-side */
@media (min-width:980px){
.contact-inner{ grid-template-columns: 1fr 420px; gap:22px; align-items:start; }
.contact-card{ padding:20px; position:sticky; top: calc(var(--header-h) + 22px); }
.map-card{ min-height:380px; border-radius:18px; }
}

/* -------------------------
FOOTER — polished
------------------------- */
.site-footer{
padding: 24px 0 36px;
background: linear-gradient(180deg, rgba(7,7,7,0.96), rgba(12,12,12,0.98));
color: #f2f3f5;
border-top: 1px solid rgba(255,255,255,0.02);
}
.footer-inner{
max-width:var(--max-width);
margin:0 auto;
padding:8px 18px;
display:grid;
grid-template-columns: 1fr;
gap:18px;
align-items:start;
}

/* footer columns */
.footer-col{ padding:12px; }
.footer-col h4{ color:#fff; margin:0 0 10px 0; font-size:1rem; display:flex; gap:8px; align-items:center; }
.footer-col .muted.small{ color: rgba(255,255,255,0.65); }

/* brand in footer */
.site-footer .brand{ color:#fff; display:flex; gap:12px; align-items:center; text-decoration:none; }
.site-footer .brand i{ font-size:20px; color: var(--accent-2); background: linear-gradient(135deg,#fff,#fff); padding:6px; border-radius:8px; }

/* quick links & socials */
.footer-links{ list-style:none; padding:0; margin:8px 0 0; display:flex; flex-direction:column; gap:8px; }
.footer-links a{ color: rgba(255,255,255,0.9); text-decoration:none; font-weight:700; }
.socials{ display:flex; gap:10px; margin-top:8px; }
.socials .icon-btn{ background: rgba(255,255,255,0.04); color:#fff; width:44px;height:44px;border-radius:10px; display:grid; place-items:center; }

/* newsletter */
.newsletter{ margin-top:10px; display:flex; gap:8px; flex-direction:column; }
.newsletter-form{ display:flex; gap:8px; align-items:center; }
.newsletter input{ padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.06); background: rgba(255,255,255,0.02); color:#fff; flex:1; }
.newsletter .btn.small{ background: linear-gradient(90deg,var(--accent-2),var(--accent)); color:#111; font-weight:900; }

/* copyright row */
.copyright{ margin-top:12px; color: rgba(255,255,255,0.6); font-size:0.88rem; padding-top:12px; border-top:1px solid rgba(255,255,255,0.02); }

/* Desktop footer: three columns */
@media (min-width:980px){
.footer-inner{ grid-template-columns: 1fr 1fr 320px; gap:22px; }
.footer-col{ padding:14px; }
.newsletter-form{ max-width:360px; }
}

/* small screens: stack, lighten shadows */
@media (max-width:520px){
.about-media{ height:200px; }
.map-placeholder{ min-height:160px; }
.footer-inner{ padding:12px 12px; }
.newsletter-form{ flex-direction:column; gap:8px; }
}

/* reduced motion */
@media (prefers-reduced-motion: reduce){
.about-media img, .testimonial, .menu-item { transition: none !important; transform: none !important; animation: none !important; }
}

/* accessible focus */
a:focus, button:focus, input:focus { outline: 3px solid rgba(255,183,130,0.12); outline-offset:4px; border-radius:8px; }

/* Final polish: ensure color contrast of key CTAs */
.btn-cta, .btn-pay { font-weight:900; }

/* ===============================
End: About / Testimonials / Contact / Footer
=============================== */
</style>
  <style>
/* =============================
  Layering & interaction safety for overlays, modals, drawer, header & chat
  Paste AFTER your main styles so it overrides accidental earlier rules.
  ============================= */

/* --- z-index scale (higher = on top) --- */
/* Base content (menu, hero, cards) should remain low */
main, .container, section, .menu-section, .hero-section { z-index: 0 !important; position: relative; }

/* Header should always be above page content (sticky/fixed) */
.site-header {
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  z-index: 3000 !important;
  pointer-events: auto !important;
}

/* Overlay (dimmer) sits above content but below modal/drawer shells */
.overlay-dim {
  position: fixed !important;
  inset: 0 !important;
  z-index: 4000 !important;
  pointer-events: none !important;   /* default: don't intercept clicks when inactive */
  display: none !important;
  opacity: 0 !important;
}
.overlay-dim.active {
  display: block !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

/* Drawer (cart) — above overlay but below modal by default */
.drawer, .cart-drawer {
  position: fixed !important;
  z-index: 4500 !important;
  pointer-events: auto !important;
  will-change: transform, opacity;
}

/* Generic modal shells should appear above everything else */
.modal, .modal-shell, .modal-builder {
  position: fixed !important;
  inset: 0 !important;           /* center/fill area */
  z-index: 5000 !important;
  pointer-events: auto !important;
}

/* Chat widget should float above modals/drawers (if you want it always on top) */
#manef-chat, .chat-widget, .chat-panel {
  position: fixed !important;
  z-index: 6000 !important;
  pointer-events: auto !important;
}

/* Toaster / notifications above everything else */
.wrap-toaster {
  z-index: 7000 !important;
  position: fixed !important;
  pointer-events: auto !important;
}

/* Accessibility / safety: hide hidden overlays from pointer events */
[hidden] { pointer-events: none !important; visibility: hidden !important; display: none !important; }

/* If any ancestor has transform or filter (creates stacking context), ensure these elements are direct-body children (see JS). */
/* Keep this as last-resort override for specific accidental blockers */
html.mobile-nav-open .overlay-dim { z-index: 4200 !important; }

/* small nicety: ensure interactive elements in header are above header background */
.site-header * { position: relative; z-index: 3100 !important; }

/* End layering rules */
</style>
<style>
/* === Chat: force bottom-right / panel above everything === */
#manef-chat {
  position: fixed !important;
  right: 18px !important;
  bottom: 18px !important;
  z-index: 6000 !important;        /* ensure it's above most UI */
  display: flex !important;
  flex-direction: column;
  gap: 8px;
  align-items: flex-end;
  pointer-events: auto !important;
}

/* bubble */
#manef-chat .chat-toggle {
  position: relative;
  width: 62px;
  height: 62px;
  border-radius: 999px;
  display: inline-grid;
  place-items: center;
  cursor: pointer;
  z-index: 1;
}

/* panel anchored to bubble (appears above the bubble) */
#manef-chat .chat-panel {
  position: absolute !important;
  right: 0 !important;
  bottom: calc(100% + 12px) !important; /* sits above bubble */
  transform-origin: bottom right;
  width: var(--chat-width, 340px);
  max-width: calc(100vw - 32px);
  z-index: 6100 !important; /* slightly above the bubble */
  pointer-events: auto !important;
}

/* when hidden, keep it non-interactive */
#manef-chat .chat-panel[hidden] { pointer-events: none !important; visibility: hidden !important; opacity: 0 !important; }

/* mobile tweak: keep chat bubble visible and panel full-width above bubble */
@media (max-width:520px){
  #manef-chat { right: 12px !important; bottom: 12px !important; left: auto !important; align-items: center; }
  #manef-chat .chat-panel {
    position: fixed !important;
    right: 12px !important;
    bottom: calc(100% + 8px) !important;
    width: min(96vw, 420px);
    max-height: 78vh;
  }
}
</style>

  <!-- Header layout: logo left, cart + hamburger right on small screens -->
<style>
/* target your site's small-screen breakpoint (matches existing CSS) */
@media (max-width: 979px) {

  /* make header inner use full width and space items */
  .site-header { /* keep existing fixed styling but ensure no centering issues */
    display: block; /* ensure header uses flow, container handles centering */
    background-clip: padding-box;
  }

  .header-inner{
    display:flex !important;
    align-items:center;
    justify-content: space-between !important; /* push logo left, actions right */
    gap:12px;
    width:100%;
    padding: 8px 14px; /* small padding */
    box-sizing: border-box;
  }

  /* brand/logo on the left */
  .brand{
    order: 0;
    display:flex;
    align-items:center;
    gap:12px;
    text-decoration:none;
  }
  .brand-text{ display:none !important; } /* keep compact on small */

  /* hide the main navigation on small screens (keep for accessibility) */
  .main-nav{ display:none !important; order: 1; }

  /* header-actions (group at right) */
  .header-actions{
    order: 2;
    margin-left: auto;      /* ensure it's pushed to the far right */
    display:flex;
    gap:8px;
    align-items:center;
    justify-content:flex-end;
  }

  /* show only cart + hamburger; hide other action icons on small */
  .header-actions .search-btn,
  .header-actions .location-btn,
  .header-actions .order-cta,
  .header-actions a[role="link"]{ display:none !important; }

  /* ensure cart button and hamburger remain visible and touch-friendly */
  .header-actions .cart-btn,
  .header-actions .hamburger{
    display:inline-grid !important;
    width:44px;
    height:44px;
    padding:0;
    border-radius:10px;
  }

  /* ensure cart badge is visible and doesn't overflow */
  .cart-badge{ margin-left:-8px; transform: none; }

  /* small adjustment so header doesn't cover content anchors */
  :root{ --header-h:72px; } /* stays consistent with your other rules */
}

/* Extra safety: if header-inner ever gets centered by other rules, force spacing */
@media (max-width: 520px){
  .header-inner{ padding:8px 10px; }
  .brand .logo{ width:40px; height:40px; }
  .header-actions .cart-btn, .header-actions .hamburger{ width:50px; height:50px; }
}
</style>
<!-- HERO: make hero half-height on small screens -->
<style>
/* Target small screens (matches your existing breakpoint) */
@media (max-width: 979px) {

  /* Make the whole hero section occupy half the viewport */
  .hero-section.hero-viewport {
    min-height: 50vh !important;
    max-height: 50vh !important;
    overflow: hidden !important; /* keep layout tidy */
    margin-top: var(--header-h); /* keep header offset */
  }

  /* Ensure the inner container fills the reduced hero height */
  .hero-viewport-inner {
    height: 100% !important;
    align-items: stretch !important;
    padding: 8px 0 !important;
    display: flex !important;
    gap: 12px !important;
  }

  /* Carousel area should stretch to the hero height */
  .hero-carousel-wrap {
    min-height: 100% !important;
    height: 100% !important;
    border-radius: 12px !important;
    overflow: hidden !important;
  }

  /* Make slides and stage respect the reduced height */
  .carousel-stage, .hero-slide {
    height: 100% !important;
    position: relative !important;
  }

  /* Artwork should fill the left/top half and scale correctly */
  .slide-artwork {
    width: 100% !important;
    height: 100% !important; /* override earlier 62vh */
    border-radius: 12px !important;
    overflow: hidden !important;
    flex: none !important;
  }
  .slide-artwork img.slide-image {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    transform: none !important;
  }

  /* Slide panel (text overlay) sits comfortably inside the hero,
     and is limited in height so it won't overflow the half-hero */
  .slide-panel {
    position: absolute !important;
    left: 12px !important;
    right: 12px !important;
    bottom: 12px !important;
    width: auto !important;
    max-height: 44% !important; /* give enough space for title + CTAs */
    overflow-y: auto !important;
    padding: 12px !important;
    border-radius: 12px !important;
    box-sizing: border-box !important;
  }

  /* Keep carousel controls compact and visible inside half-hero */
  .carousel-controls {
    left: 12px !important;
    bottom: 10px !important;
    gap: 8px !important;
  }

  /* Stickers should not push layout: tuck them inside hero safely */
  .hero-stickers { top: calc(var(--header-h) + 8px) !important; right: 12px !important; }

  /* Hide right quick-picks on small screens (keeps hero tidy) */
  .hero-right.quick-picks-section { display: none !important; }

  /* Ensure no other rule forces hero to full-screen */
  .hero-section[ data-fullscreen="true" ] { height: auto !important; min-height: 50vh !important; max-height: 50vh !important; }

  
}
</style>

  <style>
/* Stylish menu filter pills + animated indicator */
.menu-filters{
  position: relative;
  display:flex;
  gap:10px;
  align-items:center;
  padding:8px;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  scrollbar-width: none;
}
.menu-filters::-webkit-scrollbar{ display:none; }

/* Pill buttons */
.menu-filters .filter{
  appearance: none;
  border: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
  color: #222;
  font-weight: 800;
  border-radius: 999px;
  padding: 8px 14px;
  display:inline-flex;
  gap:8px;
  align-items:center;
  cursor: pointer;
  transition: transform .18s cubic-bezier(.2,.9,.2,1), box-shadow .18s, color .18s, background .18s;
  box-shadow: 0 8px 20px rgba(12,12,12,0.04);
}

/* icon spacing */
.menu-filters .filter i{ opacity:0.96; font-size:0.95rem; }

/* hover / active micro-interactions */
.menu-filters .filter:hover{ transform: translateY(-3px); box-shadow: 0 18px 48px rgba(12,12,12,0.07); }
.menu-filters .filter:active{ transform: translateY(-1px) scale(.995); }

/* Selected state (uses your --accent tokens) */
.menu-filters .filter.active{
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  color: #111;
  box-shadow: 0 22px 70px rgba(255,107,61,0.10);
  transform: translateY(-4px);
}

/* Focus ring for keyboard users */
.menu-filters .filter:focus{
  outline: 3px solid rgba(99,102,241,0.12);
  outline-offset: 6px;
  border-radius: 999px;
}

/* Sliding indicator (underline that moves to active filter) */
.menu-filters .filter-indicator{
  position: absolute;
  height: 6px;
  border-radius:6px;
  bottom: 2px;
  left: 0;
  width: 0;
  background: linear-gradient(90deg, var(--accent-2), var(--accent-3));
  box-shadow: 0 10px 30px rgba(255,107,61,0.10);
  transition: left .28s cubic-bezier(.2,.9,.2,1), width .28s cubic-bezier(.2,.9,.2,1), opacity .18s;
  pointer-events: none;
  opacity: 0.98;
  will-change: left, width;
}

/* Responsive: let filters wrap on larger small screens */
@media (min-width:720px){
  .menu-filters{ gap:12px; padding:6px 0; }
}

/* When indicator isn't ready */
.menu-filters .filter-indicator.hidden{ opacity: 0; transform: translateY(4px); }

/* compact pills for very small view */
@media (max-width:420px){
  .menu-filters .filter{ padding:8px 10px; font-size:0.95rem; }
  .menu-filters .filter-indicator{ height:4px; bottom:1px; }
}
</style>
<style>
/* ===========================
Hero readability & slideshow polish (overrides)
Paste AFTER existing hero styles
=========================== */

/* 1) Add a consistent dark overlay on slide artwork for readable text */
.slide-artwork {
  position: relative !important;
  overflow: hidden !important;
}

/* overlay layer (keeps image visible but darkens for contrast) */
.slide-artwork::after{
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: linear-gradient(180deg, rgba(0,0,0,0.44) 0%, rgba(0,0,0,0.48) 40%, rgba(0,0,0,0.56) 100%);
  mix-blend-mode: normal;
  z-index: 8;
  transition: background .36s ease;
}

/* On large screens, a lighter overlay so artwork still reads as image */
@media (min-width:980px){
  .slide-artwork::after{
    background: linear-gradient(180deg, rgba(0,0,0,0.32), rgba(0,0,0,0.42));
  }
}

/* 2) Make slide text panel clearly elevated and readable */
.slide-panel {
  z-index: 20 !important;
  color: #fff !important; /* always white text on top of overlay */
  background: linear-gradient(180deg, rgba(0,0,0,0.44), rgba(0,0,0,0.22)) !important;
  border-radius: 12px !important;
  box-shadow: 0 18px 50px rgba(0,0,0,0.45) !important;
  backdrop-filter: blur(6px) saturate(120%) !important;
  -webkit-backdrop-filter: blur(6px) saturate(120%) !important;
  border: 1px solid rgba(255,255,255,0.04) !important;
}

/* ensure inner text uses high contrast colors */
.slide-panel .eyebrow, .slide-panel .hero-features li { color: rgba(255,255,255,0.92) !important; }
.slide-panel .hero-sub { color: rgba(255,255,255,0.92) !important; }

/* 3) stronger title styling for legibility (with subtle shadow) */
.hero-title {
  color: #fff !important;
  text-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 1px 0 rgba(0,0,0,0.25) !important;
  z-index: 22 !important;
}

/* 4) CTA buttons contrast on top of overlay */
.hero-ctas .btn {
  box-shadow: 0 12px 36px rgba(0,0,0,0.45) !important;
}
.btn-cta { color: #111 !important; } /* already bright background */
.btn-outline { background: rgba(255,255,255,0.06) !important; color: #fff !important; border-color: rgba(255,255,255,0.12) !important; }

/* 5) badges — ensure readable pill backgrounds & size */
.badge {
  background: linear-gradient(90deg, rgba(0,0,0,0.56), rgba(0,0,0,0.42)) !important;
  color: #fff !important;
  font-size: 0.82rem !important;
  z-index: 30 !important;
  border: 1px solid rgba(255,255,255,0.06) !important;
}

/* 6) ensure dots/controls are visible above overlay */
.carousel-controls, .carousel-controls * { z-index: 60 !important; position: relative !important; }

/* 7) fix potential pointer-events blocking on slides (allow buttons inside slide-panel) */
.hero-slide { pointer-events: none; } /* non-active slides ignore pointer events */
.hero-slide.active { pointer-events: auto; } /* active slide allows interactions */

/* ensure slide-panel and its buttons are always interactive */
.slide-panel, .slide-panel button, .slide-panel a { pointer-events: auto !important; }

/* 8) small visual for when text would still be low-contrast: add subtle inner-glow */
.slide-panel .hero-title::after{
  content: "";
  display:block;
  width: 100%;
  height: 8px;
  margin-top: 6px;
  background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border-radius: 6px;
}

/* 9) responsive: make slide-panel use lighter overlay on very small screens for legibility */
@media (max-width:520px){
  .slide-panel{ background: linear-gradient(180deg, rgba(0,0,0,0.62), rgba(0,0,0,0.42)) !important; max-height: 48% !important; }
  .hero-title{ font-size: clamp(1.25rem, 5.8vw, 1.9rem) !important; }
}

/* End hero readability overrides */
</style>
<style>
.hero-slide { transition: opacity .5s ease, transform .6s cubic-bezier(.2,.9,.2,1); transform-origin: center; }
.hero-slide.active { transform: translateZ(0) scale(1); opacity: 1; }
.hero-slide:not(.active) { opacity: 0; transform: scale(.995); pointer-events: none; }
</style>
<style>
  /* === Premium cart: sticky header + scrollable items === */
.drawer-shell {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 0;
  overflow: hidden; /* important: only the cart-body scrolls */
  background: var(--modal-bg);
  border-radius: 18px 0 0 18px;
}

/* Sticky header inside drawer */
.drawer-head {
  flex: 0 0 auto;
  padding: 18px;
  position: sticky;
  top: 0;
  z-index: 12;
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
  border-radius: 18px 0 0 0;
  border-bottom: 1px solid rgba(16,16,16,0.04);
}

/* Scrollable area that holds items ONLY */
.cart-body {
  flex: 1 1 auto;
  overflow-y: auto;
  padding: 18px;
  -webkit-overflow-scrolling: touch;
}

/* Items list spacing */
.cart-items {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-bottom: 8px; /* breathing room above sticky footer */
}

/* Premium item card */
.cart-item {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 12px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.99), rgba(250,250,250,0.98));
  box-shadow: 0 12px 36px rgba(12,12,12,0.06);
  border: 1px solid rgba(16,16,16,0.04);
  min-height: 84px;
}

/* thumbnail */
.cart-item img {
  width: 76px;
  height: 76px;
  border-radius: 10px;
  object-fit: cover;
  flex-shrink: 0;
  box-shadow: 0 8px 26px rgba(12,12,12,0.06);
}

/* left meta area */
.cart-item .meta {
  flex: 1 1 auto;
  min-width: 0; /* allow text truncation */
}
.cart-item .meta strong {
  display:block;
  font-weight:900;
  font-size:1rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.cart-item .meta .muted.small {
  margin-top:6px;
  color:var(--muted);
  font-size:0.9rem;
}

/* right pane: qty + price */
.cart-item .qty-box {
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:8px;
  min-width: 110px;
}

/* qty controls */
.qty-controls { display:inline-flex; align-items:center; gap:8px; }
.qty-controls .icon-btn {
  width:36px; height:36px; border-radius:9px;
  border:1px solid rgba(16,16,16,0.04); background:transparent;
  display:inline-grid; place-items:center;
  font-weight:800;
}
.qty-value { font-weight:900; font-size:1rem; min-width:28px; text-align:center; }

/* price badge */
.cart-item .price {
  font-weight:900;
  font-size:0.98rem;
  padding:6px 10px;
  border-radius:10px;
  background: linear-gradient(90deg, var(--accent-2), var(--accent));
  color:#111;
  box-shadow: 0 10px 30px rgba(255,107,61,0.08);
}

/* remove (small link/button) */
.cart-item .remove-item {
  margin-top:6px;
  border-radius:9px;
  padding:6px 8px;
  font-weight:800;
  background: transparent;
  border:1px solid rgba(16,16,16,0.03);
}

/* Sticky footer / summary */
.cart-summary {
  flex: 0 0 auto;
  position: sticky;
  bottom: 0;
  z-index: 12;
  padding: 14px;
  border-top: 1px solid rgba(16,16,16,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
  box-shadow: 0 -10px 30px rgba(12,12,12,0.04);
  border-radius: 0 0 18px 18px;
}

/* Make checkout a prominent full-width CTA */
.cart-actions .checkout {
  width: 100%;
  padding: 12px 14px;
  font-size: 1rem;
  border-radius: 12px;
  font-weight: 900;
}

/* Mobile tweaks */
@media (max-width:720px) {
  .drawer-shell { max-height: 86vh; border-radius: 12px 12px 0 0; }
  .cart-item img { width:64px; height:64px; }
  .cart-item { min-height: 72px; padding:10px; }
  .cart-item .qty-box { min-width: 90px; }
}
/* ===== Builder modal — premium upgrade ===== */

/* stepper visuals */
.builder-stepper {
  display:flex;
  gap:10px;
  align-items:center;
  padding:12px;
  overflow-x:auto;
  -webkit-overflow-scrolling: touch;
}
.builder-stepper .step {
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:8px 12px;
  border-radius:999px;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
  border: 1px solid rgba(16,16,16,0.03);
  cursor:pointer;
  font-weight:800;
}
.builder-stepper .step .num {
  width:28px;height:28px;border-radius:8px;display:inline-grid;place-items:center;
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  color:#111;font-weight:900;
  box-shadow: 0 8px 30px rgba(255,107,61,0.08);
}
.builder-stepper .step.active { transform: translateY(-4px); box-shadow: 0 20px 60px rgba(12,12,12,0.07); color:#111; }

/* progress bar under stepper */
.builder-progress {
  height:6px;
  background: rgba(16,16,16,0.04);
  border-radius: 6px;
  margin-top:10px;
  overflow:hidden;
}
.builder-progress > i {
  display:block;
  height:100%;
  width:0%;
  background: linear-gradient(90deg, var(--accent-2), var(--accent));
  border-radius:6px;
  transition: width .32s cubic-bezier(.2,.9,.2,1);
}

/* left column content: nicer option cards */
.options-grid { gap: 12px; grid-template-columns: repeat(2,1fr); }
.option {
  padding:12px;
  border-radius:12px;
  transition: transform .22s, box-shadow .22s, border-color .22s;
}
.option:hover { transform: translateY(-4px); box-shadow: 0 18px 60px rgba(12,12,12,0.06); }
.option.selected { border: 2px solid rgba(255,107,61,0.16); transform: translateY(-6px); }

/* price breakdown block inside preview (right side) */
.preview-price-breakdown {
  margin-top:8px;
  padding:10px;
  border-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(248,248,249,0.98));
  border:1px solid rgba(16,16,16,0.04);
  box-shadow: inset 0 2px 8px rgba(255,255,255,0.6);
  font-weight:700;
}
.preview-price-breakdown .line { display:flex; justify-content:space-between; gap:8px; font-weight:700; }
.preview-price-breakdown .muted { font-weight:600; color:var(--muted); font-size:0.95rem; }

/* sticky preview on wide screens */
.modal-right {
  position: sticky;
  top: calc(var(--header-h) + 24px);
  align-self: flex-start;
}

/* sticky action bar (Back / Next / Add) at modal bottom on small screens */
.builder-actionbar {
  display:flex;
  gap:10px;
  padding:12px;
  border-top:1px dashed rgba(16,16,16,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
  position: sticky;
  bottom: 0;
  z-index: 20;
  justify-content: flex-end;
}

/* disabled look */
.btn[disabled], .btn.disabled {
  opacity:0.48; cursor:not-allowed; transform:none; box-shadow:none;
}

/* mobile behavior: preview moves below content, actionbar sticks */
@media (max-width:980px) {
  .modal-shell { grid-template-columns: 1fr; padding:12px; }
  .modal-right { order: 2; position: relative; top: auto; }
  .builder-actionbar { position: sticky; bottom: 0; left: 0; right: 0; }
  .options-grid { grid-template-columns: 1fr; }
}

/* small micro-interaction focus ring */
.modal-shell .option:focus { outline: 3px solid rgba(99,102,241,0.12); outline-offset:4px; border-radius:10px; }

/* subtle animation for preview price update */
.preview-price { transition: transform .18s ease, color .18s; }
.preview-price.pulse { transform: translateY(-3px); }

</style>
<style>
  /* =========================
Mobile-first overrides (phones)
Drop this AFTER your main CSS to strongly override desktop rules
Breakpoint: <= 720px (phones) and finer at 420px
========================= */

/* global mobile-friendly tokens */
:root {
  --mobile-gap: 12px;
  --mobile-pad: 14px;
  --mobile-radius: 12px;
  --mobile-cta-h: 54px;
  --safe-bottom: env(safe-area-inset-bottom, 12px);
}

/* Target phones */
@media (max-width: 720px) {

  /* make sure site header is compact and actions grouped right */
  .site-header {
    height: 64px !important;
    padding: 6px 12px !important;
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96)) !important;
    box-shadow: 0 8px 28px rgba(12,12,12,0.06) !important;
  }
  .header-inner {
    gap: 8px !important;
    padding: 8px 12px !important;
    justify-content: space-between !important;
  }
  .brand-text { display:none !important; }
  .icon-btn, .cart-btn { width:48px; height:48px; border-radius:10px; }

  /* cart badge readable on small screens */
  .cart-badge {
    min-width:20px; height:20px; font-size:0.75rem; padding:0 6px; margin-left:-8px;
  }

  /* HERO — compact, readable, interactive */
  .hero-section.hero-viewport { min-height: 48vh !important; max-height: 56vh !important; margin-top: var(--header-h); }
  .hero-carousel-wrap { border-radius: 12px !important; min-height: 100% !important; height: 100% !important; }
  .slide-artwork { height: 100% !important; width: 100% !important; border-radius: 12px !important; }
  .slide-artwork::after { background: linear-gradient(180deg, rgba(0,0,0,0.64), rgba(0,0,0,0.44)) !important; }
  .slide-panel {
    position: absolute !important;
    left: 12px !important;
    right: 12px !important;
    bottom: 12px !important;
    max-height: 46% !important;
    padding: 12px !important;
    border-radius: 12px !important;
    background: linear-gradient(180deg, rgba(0,0,0,0.64), rgba(0,0,0,0.44)) !important;
    color: #fff !important;
  }
  .hero-title { font-size: clamp(1.2rem, 6.4vw, 1.8rem) !important; line-height:1.04; }
  .hero-ctas { gap:8px; }
  .btn-cta, .btn-pay { padding: 12px 14px; font-size: 0.97rem; border-radius: 12px; }

  /* carousel controls small & tucked */
  .carousel-controls { left: 10px !important; bottom: 8px !important; gap:8px; }
  .carousel-prev, .carousel-next { width:40px; height:40px; border-radius:10px; font-size:0.95rem; }

  /* hide large right picks on phones */
  .hero-right.quick-picks-section { display:none !important; }

  /* MENU: one item per row */
  .menu-grid { grid-template-columns: 1fr !important; gap: 12px !important; padding: 6px 0 !important; }
  .menu-item { border-radius: 12px; padding: 10px; display:flex; gap:10px; align-items:flex-start; }
  .menu-item .thumb { width: 96px; height: 84px; aspect-ratio: auto; border-radius:10px; flex-shrink:0; }
  .menu-item .meta { padding: 4px 6px; }
  .menu-item .meta-line { flex-wrap:wrap; gap:8px; align-items:center; }
  .menu-item .meta-actions { margin-left: 0; display:flex; gap:8px; width:100%; justify-content:flex-end; }
  .menu-item .btn.btn-pay.small { min-width: 110px; padding:10px 12px; }

  /* make add buttons full width inside cards for finger targets (stacked) */
  .menu-item .meta-actions .btn {
    padding:10px 12px; border-radius:10px;
  }

  /* Filters: horizontally scrollable pills */
  .menu-filters { padding: 8px 6px; gap:8px; }
  .menu-filters .filter { padding:8px 12px; white-space:nowrap; }

  /* FAST PICKS: horizontal swipe */
  #fast-picks .quick-picks { gap:12px; padding-left:6px; padding-right:6px; overflow-x:auto; -webkit-overflow-scrolling:touch; }
  .quick-picks .pick { min-width: 75%; flex:0 0 auto; border-radius:12px; }

  /* CART: bottom sheet full-width, sticky header & footer, big CTA */
  .drawer {
    left: 0 !important;
    right: 0 !important;
    top: auto !important;
    bottom: 0 !important;
    transform: translateY(0) !important;
    height: auto !important;
  }
  .drawer-shell {
    width: 100% !important;
    max-width: 100% !important;
    height: min(86vh, 96vh) !important;
    border-radius: 12px 12px 0 0 !important;
    padding: 0 !important;
    display:flex !important;
    flex-direction: column;
    overflow: hidden;
  }
  .drawer-head { padding: 14px !important; border-radius: 12px 12px 0 0 !important; }
  .cart-body { padding: 12px !important; overflow-y:auto; -webkit-overflow-scrolling:touch; }
  .cart-items { gap: 12px; }
  .cart-summary {
    padding: 14px !important;
    border-radius: 0 0 12px 12px !important;
    position: sticky; bottom: 0; z-index:30;
    box-shadow: 0 -8px 28px rgba(12,12,12,0.06);
    padding-bottom: calc(var(--safe-bottom) + 12px);
  }
  .cart-actions .checkout { height: var(--mobile-cta-h); font-size:1.02rem; padding: 12px; border-radius:10px; }
  .cart-item { padding: 10px; gap:10px; }
  .cart-item img { width: 68px; height:68px; border-radius:10px; }

  /* Make remove small and unobtrusive */
  .cart-item .remove-item { padding:6px 8px; font-size:0.86rem; }

  /* BUILDER: full-screen, preview collapsible */
  .modal-shell { width: 100% !important; height: 100% !important; max-height: 100% !important; grid-template-columns: 1fr !important; border-radius: 12px !important; padding: 0 !important; display:flex; flex-direction:column; }
  #builder-modal .modal-left { overflow:auto; padding: 12px !important; max-height: calc(100vh - 160px); }
  #builder-modal .modal-right { order: 2; position: relative; width: 100% !important; max-height: 240px; overflow:auto; padding: 12px; border-top:1px dashed rgba(16,16,16,0.04); background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96)); }
  .builder-actionbar { position: sticky; bottom: 0; left: 0; right: 0; padding: 12px; display:flex; gap:8px; background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98)); border-top:1px solid rgba(16,16,16,0.04); z-index:50; padding-bottom: calc(var(--safe-bottom) + 10px); }
  .builder-actionbar .btn { flex:1; height:48px; border-radius:10px; }

  /* CHAT: make the panel full width on phones and higher */
  #manef-chat { left: 12px; right: 12px; bottom: 12px; align-items:center; }
  #manef-chat .chat-panel {
    position: fixed !important;
    right: 12px !important;
    left: 12px !important;
    bottom: calc(var(--mobile-cta-h) + 24px) !important;
    width: auto !important;
    max-height: 74vh !important;
    border-radius: 12px !important;
  }
  .chat-body { max-height: 48vh !important; overflow:auto; -webkit-overflow-scrolling:touch; }
  .chat-foot { padding: 10px !important; gap: 8px; }
  .chat-input { font-size: 1rem; padding: 12px; border-radius: 10px; }

  /* touch targets bigger & consistent */
  .icon-btn { min-width:44px; min-height:44px; }
  .btn { min-height:44px; border-radius:10px; }

  /* footer safe area */
  .site-footer { padding-bottom: calc(24px + var(--safe-bottom)); }
}

/* super small phones: tighten things */
@media (max-width:420px) {
  .hero-title { font-size: clamp(1.05rem, 5.8vw, 1.6rem) !important; }
  .menu-item .thumb { width:80px; height:72px; }
  .cart-item img { width: 60px; height:60px; }
  .builder-actionbar .btn { font-size: 0.95rem; }
}

</style>
  <style>
    /* Chat small polish: typing indicator & chips */
.chat-typing {
  display:flex; gap:6px; align-items:center; padding:8px 10px;
}
.chat-typing .dot {
  width:8px; height:8px; border-radius:50%; background:rgba(0,0,0,0.12);
  animation: dotPulse 1s infinite ease-in-out;
}
.chat-typing .dot:nth-child(2){ animation-delay: .12s }
.chat-typing .dot:nth-child(3){ animation-delay: .24s }
@keyframes dotPulse {
  0%{ transform: translateY(0); opacity:.45 }
  50%{ transform: translateY(-5px); opacity:1 }
  100%{ transform: translateY(0); opacity:.45 }
}
.chat-suggestions { display:flex; gap:8px; flex-wrap:wrap; padding:8px; }
.chat-suggestions .chip {
  background: linear-gradient(180deg, #fff,#fafafa);
  border:1px solid rgba(16,16,16,0.04);
  padding:8px 12px; border-radius:999px; font-weight:800; cursor:pointer;
  box-shadow: 0 10px 30px rgba(12,12,12,0.04);
}

    /* ===== VD HERO — Card on orange, overlapping circles, stacked headline ===== */
:root{
  --vd-orange: #ff8a1a;
  --vd-card-bg: #fffefb;
  --vd-accent: #ff7f1a;
  --vd-muted: #6b6b6b;
  --vd-radius: 12px;
  --vd-card-max: 1120px;
}

/* outer hero area */
#hero.vd-hero { background: linear-gradient(180deg, var(--vd-orange), #ff7a00); padding:48px 0; position: relative; overflow: visible; }
.vd-hero-wrap{ display:flex; justify-content:center; align-items:center; padding: 8px 18px; }

/* white card */
.vd-card{
  width:100%;
  max-width: var(--vd-card-max);
  background: var(--vd-card-bg);
  border-radius: 10px;
  padding: 18px;
  box-shadow: 0 28px 80px rgba(12,12,12,0.12);
  border: 1px solid rgba(16,16,16,0.04);
  position: relative;
  box-sizing: border-box;
}

/* top row inside the card */
.vd-card-top{ display:flex; align-items:center; gap:12px; border-bottom:1px solid rgba(16,16,16,0.03); padding-bottom:12px; margin-bottom:14px; }
.vd-brand{ display:flex; flex-direction:column; gap:2px; }
.vd-brand-title{ font-family: 'Playfair Display', serif; letter-spacing:0.06em; font-size:1rem; color:#d35400; }
.vd-brand-tag{ font-size:0.78rem; color:var(--vd-muted); font-weight:700; }

/* small top nav */
.vd-top-nav{ display:flex; gap:14px; margin-left:18px; flex:1; align-items:center; }
.vd-top-nav a{ text-decoration:none; color:#888; font-weight:700; font-size:0.92rem; padding:6px 6px; }
.vd-top-nav a:hover{ color:#111; transform: translateY(-2px); }

/* socials */
.vd-socials a{ margin-left:8px; color:#d35400; text-decoration:none; }

/* main body: left circle, center text, right circle */
.vd-hero-body{ display:flex; align-items:center; gap:22px; padding: 22px 6px 12px; position:relative; min-height: 320px; }

/* circular images */
.vd-circle{ width: 260px; height:260px; border-radius:999px; overflow:hidden; flex-shrink:0; position:relative; display:grid; place-items:center; background:#f6f2ee; box-shadow: 0 20px 60px rgba(12,12,12,0.06); border:8px solid rgba(255,255,255,0.88); }
.vd-circle img{ width:100%; height:100%; object-fit:cover; display:block; }

/* placement tweaks */
.vd-circle-left{ transform: translateX(-18px) translateY(6px); }
.vd-circle-right{ transform: translateX(18px) translateY(-6px); }

/* 50% off badge */
.vd-off-badge{ position:absolute; right: -18px; top: -22px; background: var(--vd-accent); color:#fff; width:96px; height:96px; border-radius:999px; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow: 0 18px 48px rgba(0,0,0,0.12); font-weight:900; }
.vd-off-badge small{ font-size:0.6rem; display:block; margin-top:2px; font-weight:800; }

/* center text */
.vd-center{ flex:1; text-align:left; padding: 6px 12px; min-width: 320px; max-width: 640px; }

/* eyebrow */
.vd-eyebrow{ font-weight:800; color:var(--vd-muted); font-size:0.86rem; letter-spacing:0.04em; margin-bottom:6px; }

/* stacked title */
.vd-title{ margin:0; font-family: 'Playfair Display', serif; line-height:0.95; color:#cf5b0f; font-weight:900; }
.vd-title .vd-line{ display:block; font-size: clamp(2rem, 5.4vw, 3.4rem); letter-spacing: -0.02em; }
.vd-title .vd-line-top{ color:#d95b0b; }
.vd-title .vd-line-bottom{ color:#ff8a1a; }

/* description and CTAs */
.vd-desc{ margin:12px 0 16px; color:#333; max-width:56ch; font-size:1rem; }
.vd-ctas{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
.vd-btn-primary{ background: linear-gradient(90deg,#ff8a1a,#ffc857); border:0; padding:12px 18px; border-radius:10px; font-weight:900; color:#111; box-shadow: 0 14px 40px rgba(255,107,61,0.1); cursor:pointer; }
.vd-btn-ghost{ background:transparent; border:1px solid rgba(16,16,16,0.06); padding:10px 14px; border-radius:10px; font-weight:800; color:#444; cursor:pointer; }

/* dots */
.vd-dots{ margin-top:14px; display:flex; gap:8px; align-items:center; justify-content:flex-start; }
.vd-dot{ width:12px; height:12px; border-radius:999px; background: rgba(0,0,0,0.14); border:0; cursor:pointer; transition: transform .22s ease, background .22s; }
.vd-dot[aria-selected="true"], .vd-dot.active{ background: #ff8a1a; transform:scale(1.18); box-shadow: 0 8px 30px rgba(255,107,61,0.12); }

/* responsive */
@media (max-width: 940px){
  #hero.vd-hero { padding: 26px 0; }
  .vd-hero-body{ flex-direction:column; gap:12px; align-items:center; min-height: auto; padding: 18px; }
  .vd-center{ text-align:center; max-width: 640px; }
  .vd-circle{ width: 180px; height:180px; border-width:6px; }
  .vd-off-badge{ right: -10px; top: -14px; width:64px; height:64px; }
  .vd-title .vd-line{ font-size: clamp(1.5rem, 7vw, 2.2rem); }
}

/* minor polished touches */
.vd-card, .vd-btn-primary, .vd-btn-ghost { -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

/* make sure hero dots are centered on very small screens */
@media (max-width:520px){
  .vd-dots{ justify-content:center; }
}
/* ---------- Premium Cart Drawer — Add after your existing cart styles ---------- */

/* Make the drawer inner behave like a column so header stays visible and items can scroll */
.drawer-shell {
  display: flex;
  flex-direction: column;
  padding: 12px 16px;
  gap: 12px;
  height: 100%;
  box-sizing: border-box;
}

/* Keep header visible (already outside cart-body in your markup) */
.drawer-head {
  position: relative; /* keep in flow but above items */
  z-index: 12;
  background: transparent;
  padding: 10px 6px;
}

/* cart-body becomes the flexible pane with scrollable items */
.cart-body {
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1 1 auto;          /* grows to fill available vertical space */
  min-height: 0;           /* important for children overflow to work */
  overflow: hidden;
  padding-right: 6px;
}

/* Only the items list scrolls (header & summary stay visible) */
.cart-items {
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  gap: 14px;
  padding: 12px 6px;
}

/* Style for each cart item to match the image */
.cart-item {
  display: flex;
  align-items: center;
  gap: 18px;
  background: #fff;
  border-radius: 14px;
  padding: 14px 16px;
  box-shadow: 0 18px 40px rgba(12,12,12,0.06);
  border: 1px solid rgba(16,16,16,0.03);
  min-height: 96px;
  align-items: center;
}

/* left circular thumbnail */
.cart-item img {
  width: 96px;
  height: 96px;
  border-radius: 999px;
  object-fit: cover;
  box-shadow: 0 12px 34px rgba(12,12,12,0.06);
  flex-shrink: 0;
}

/* optional radio indicator on very left (like the mock) */
.cart-item::before {
  content: '';
  width: 18px;
  height: 18px;
  border-radius: 50%;
  border: 3px solid rgba(255,100,140,0.12); /* unselected */
  margin-right: 8px;
  flex-shrink: 0;
}
.cart-item.selected::before {
  background: #ff6b8a;
  border-color: #ff6b8a;
  box-shadow: 0 8px 26px rgba(255,107,140,0.12);
}

/* details block */
.cart-item .details {
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 0;
}
.cart-item .details .name {
  font-weight: 800;
  font-size: 1rem;
  color: #111;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.cart-item .details .desc {
  font-size: 0.88rem;
  color: var(--muted, #9aa0a6);
}

/* price & controls pane (right side of item) */
.cart-item .meta {
  margin-left: auto;
  display:flex;
  align-items:center;
  gap: 18px;
  min-width: 160px;
}

/* price style */
.cart-item .price {
  font-weight:900;
  font-size:1.02rem;
  color: #111;
  margin-right: 6px;
}

/* quantity pill (pink rounded) */
.qty-controls {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  background: linear-gradient(90deg,#ff9aa8,#ff6b8a);
  padding: 8px 12px;
  border-radius: 999px;
  box-shadow: 0 18px 50px rgba(255,107,140,0.12);
  color: white;
  font-weight: 800;
}
.qty-controls button {
  width: 30px; height: 30px; border-radius: 8px; border: 0; background: transparent; color: #fff; font-weight: 900;
  cursor: pointer;
}
.qty-controls .qty-value { min-width: 18px; text-align:center; display:inline-block; }

/* remove button on very right (icon inside small white card) */
.cart-item .remove-item {
  background: #fff;
  border-radius: 10px;
  border: 1px solid rgba(16,16,16,0.04);
  width:46px; height:46px;
  display:grid; place-items:center;
  color: #ff6b8a;
  box-shadow: 0 12px 36px rgba(255,107,140,0.06);
  cursor:pointer;
}

/* cart summary (stays at bottom of the drawer) */
.cart-summary {
  flex: 0 0 auto;
  padding: 14px;
  background: linear-gradient(180deg,#fff,#fcfcfc);
  border-radius: 14px;
  box-shadow: 0 24px 70px rgba(12,12,12,0.06);
  border: 1px solid rgba(16,16,16,0.04);
}

/* summary rows + CTA */
.cart-summary .cart-row { display:flex; justify-content:space-between; align-items:center; padding:6px 0; font-weight:700; color:#222; }
.cart-summary .cart-row.total { font-size:1.06rem; font-weight:900; margin-top:6px; }

/* big pink checkout */
.cart-summary .checkout {
  width:100%;
  margin-top:12px;
  padding:12px 14px;
  border-radius:12px;
  background: linear-gradient(90deg,#ff9aa8,#ff6b8a);
  color:#fff;
  font-weight:900;
  border:none;
  box-shadow: 0 26px 80px rgba(255,107,140,0.12);
}

/* coupon row style (if you show coupon fields) */
.cart-footer-row {
  display:flex;
  gap:12px;
  align-items:center;
  margin-top:12px;
}
.cart-footer-row input[type="text"] {
  flex:1;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(16,16,16,0.04);
}

/* mobile: full-width panel, summary sticky overlay at bottom */
@media (max-width:720px) {
  .drawer-shell { padding:12px; }
  .drawer-shell { border-radius: 12px 12px 0 0; }
  .cart-summary {
    position: sticky;
    bottom: 12px;
    margin-bottom: 6px;
  }
  .cart-item img { width:78px; height:78px; }
  .qty-controls { padding:6px 10px; }
}

  </style>
  <style>
    /* ---- Premium vd-hero enhancements (paste after existing hero rules) ---- */

/* Animated gradient background for card */
.vd-card {
  position: relative;
  overflow: visible;
  transition: transform .6s cubic-bezier(.2,.9,.2,1), box-shadow .45s;
}
/* float & subtle scale on hover */
.vd-card:hover { transform: translateY(-6px) scale(1.007); box-shadow: 0 40px 120px rgba(15,15,15,0.12); }

/* SVG blob container (appended by JS) */
.vd-art-blob{
  position: absolute;
  pointer-events: none;
  z-index: 2;
  filter: blur(18px) saturate(1.05);
  mix-blend-mode: multiply;
  opacity: .85;
  transition: transform .6s ease, opacity .6s;
}

/* different layout "modes" for variety */
.vd-layout-left .vd-circle-left { transform: translateX(-8px) translateY(6px) scale(1.06); }
.vd-layout-right .vd-circle-right { transform: translateX(8px) translateY(-6px) scale(1.06); }
.vd-layout-center .vd-circle-left,
.vd-layout-center .vd-circle-right { transform: scale(.94) translateY(4px); opacity: .9; }
.vd-layout-collage .vd-circle-left { transform: translateX(-28px) rotate(-6deg) scale(1.08); }
.vd-layout-collage .vd-circle-right { transform: translateX(28px) rotate(6deg) scale(.9); }

/* "Are you Starving?" hero punch */
.vd-starving {
  font-family: var(--text-hero);
  letter-spacing: -0.02em;
  display:inline-block;
  background: linear-gradient(90deg, rgba(255,235,190,0.12), rgba(255,205,120,0.06));
  padding: 8px 12px;
  border-radius: 12px;
  box-shadow: 0 14px 44px rgba(255,120,36,0.06);
  transform-origin: left center;
  animation: starving-pop 1.1s ease both;
}
@keyframes starving-pop {
  0% { transform: scale(.86) translateY(6px); opacity:0; }
  60% { transform: scale(1.03) translateY(-4px); opacity:1; }
  100% { transform: scale(1) translateY(0); opacity:1; }
}

/* Ken-Burns for circular images */
.vd-circle img { transition: transform 14s ease; transform-origin: center; will-change: transform; }
.vd-card.playing .vd-circle-left img { transform: scale(1.08) translateX(-3%); }
.vd-card.playing .vd-circle-right img { transform: scale(1.06) translateX(3%); }

/* headline reveal (small stagger) */
.vd-title .vd-line { display:block; transform: translateY(12px); opacity:0; transition: transform .48s cubic-bezier(.2,.9,.2,1), opacity .48s; }
.vd-card.show-lines .vd-title .vd-line { transform: translateY(0); opacity:1; }

/* cta pulse on active slide */
.vd-card.active-cta .vd-btn-primary { box-shadow: 0 20px 60px rgba(255,140,40,0.12); transform: translateY(-2px); animation: cta-breathe 3s infinite; }
@keyframes cta-breathe { 0%{ transform: translateY(-2px) scale(1)} 50%{ transform: translateY(-6px) scale(1.01)} 100%{ transform: translateY(-2px) scale(1)} }

/* dots (stronger focus & keyboard visibility) */
.vd-dot { border: 0; background: rgba(0,0,0,0.12); width:12px; height:12px; border-radius:999px; transition: transform .18s, background .18s; }
.vd-dot[aria-selected="true"] { background: linear-gradient(90deg,var(--accent),var(--accent-2)); transform: scale(1.22); box-shadow: 0 10px 30px rgba(255,107,61,0.08); outline: none; }

/* subtle color grading filter on images to keep hero premium */
.vd-circle img { filter: contrast(1.03) saturate(1.06) brightness(0.98); }

/* responsive tweak: collapse circles on small to single centered image */
@media (max-width:940px) {
  .vd-circle-left, .vd-circle-right { width: 180px; height:180px; border-width:6px; }
  .vd-layout-collage .vd-circle-right { display:none; } /* show only one image in collage on small */
}
/* ===== Cart polish (paste after existing cart styles) ===== */

/* make drawer a little wider on desktop — change as you like */
:root { --drawer-width: 520px; } /* override previous token if needed */
.drawer-shell { max-width: var(--drawer-width); width: min(var(--drawer-width), 94vw); }

/* brighter glass + subtle border to feel premium */
.drawer-shell {
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
  border-left: 1px solid rgba(16,16,16,0.05);
}

/* bigger circular thumbnails for clarity */
.cart-item img {
  width: 88px;
  height: 88px;
  border-radius: 12px;
  object-fit: cover;
  box-shadow: 0 12px 40px rgba(12,12,12,0.06);
}

/* make item cards slightly taller and more airy */
.cart-item { min-height: 96px; padding: 14px 16px; gap: 18px; }

/* ellipsis for long titles & options */
.cart-item .name { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* qty controls: button sizes & pill look */
.qty-controls {
  display:inline-flex;
  gap:8px;
  align-items:center;
  border-radius: 999px;
  padding: 6px;
  background: rgba(0,0,0,0.04);
}
.qty-controls button {
  width:36px; height:36px; border-radius:9px;
  background: transparent; border: 1px solid rgba(16,16,16,0.04);
  display:inline-grid; place-items:center; cursor:pointer; font-weight:900;
}
.qty-controls .qty-value { min-width: 34px; text-align:center; font-weight:900; }

/* subtle pulse when qty changes */
@keyframes qtyPulse { 0%{ transform: scale(.98); } 50%{ transform: scale(1.03);} 100%{ transform: scale(1);} }
.cart-item.qty-pulse { animation: qtyPulse .28s ease; }

/* add animation for item removal */
.cart-item { transition: opacity .28s ease, transform .28s ease, height .32s ease, margin .28s ease, padding .28s ease; overflow: hidden; }
.cart-item.removing { opacity: 0; transform: translateX(8px) scale(.995); height: 0 !important; margin: 0 !important; padding: 0 !important; }

/* slight entrance animation when item added */
@keyframes itemAdd {
  from { transform: translateY(8px) scale(.995); opacity:0; }
  to { transform:none; opacity:1; }
}
.cart-item.just-added { animation: itemAdd .38s cubic-bezier(.2,.9,.2,1); }

/* sticky header & summary feel (keeps checkout always visible) */
.drawer-head{ position: sticky; top: 0; z-index: 20; background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96)); padding: 18px; }
.cart-summary{ position: sticky; bottom: 0; z-index: 20; background: linear-gradient(180deg,#fff,#fcfcfc); padding: 14px; }

/* make checkout CTA even more prominent */
.cart-summary .checkout {
  background: linear-gradient(90deg,#ff8a1a,#ff6b8a);
  color: #fff; font-weight:900; padding: 14px; border-radius:12px;
  box-shadow: 0 24px 80px rgba(255,107,120,0.10);
}

/* empty state with comfy spacing */
.drawer .empty-state{ padding: 48px 18px; font-weight:800; color:var(--muted); }

/* accessible focus ring refinements */
.cart-item button:focus, .cart-item a:focus { outline: 3px solid rgba(99,102,241,0.12); outline-offset:4px; border-radius:8px; }

/* small-screen adaptations (keeps cart bottom-sheet roomy) */
@media (max-width:720px){
  :root{ --drawer-width: 100vw; }
  .drawer-shell{ max-width: 100vw; border-radius: 12px 12px 0 0; padding: 8px; }
  .cart-item img { width: 76px; height: 76px; }
  .cart-summary .checkout { padding: 12px; font-size: 1rem; }
}
/* Build modal styles - paste after cart CSS */
.modal[aria-hidden="true"]{ display:none; }
.modal{ position:fixed; inset:0; z-index:2000; display:flex; align-items:center; justify-content:center; }
.modal-backdrop{ position:absolute; inset:0; background:rgba(12,12,12,0.48); backdrop-filter: blur(6px); }
.modal-shell{ position:relative; width:min(920px,96vw); max-height:88vh; overflow:auto; background:#fff; border-radius:12px; box-shadow:0 30px 120px rgba(8,8,8,0.36); padding:18px; display:flex; flex-direction:column; }
.modal-head{ display:flex; justify-content:space-between; align-items:center; gap:12px; padding-bottom:6px; border-bottom:1px solid rgba(16,16,16,0.04); }
.modal-body{ padding: 14px 0; flex:1; }
.product-row{ display:grid; grid-template-columns: 300px 1fr; gap:18px; align-items:start; }
.product-media img{ width:100%; height:220px; object-fit:cover; border-radius:12px; box-shadow:0 12px 40px rgba(12,12,12,0.06); }
#build-image-input{ margin-top:8px; font-size:0.95rem; }
.options{ margin-top:8px; display:flex; flex-direction:column; gap:8px; }
.option{ display:flex; gap:8px; align-items:center; }
.option .opt-title{ font-weight:700; margin-right:auto; }
.qty-row{ margin-top:12px; display:flex; justify-content:space-between; align-items:center; gap:12px; }
.price-row{ margin-top:14px; display:flex; justify-content:space-between; align-items:center; padding-top:6px; border-top:1px dashed rgba(0,0,0,0.04); font-size:1.05rem; }
.modal-foot{ display:flex; gap:12px; justify-content:flex-end; padding-top:12px; border-top:1px solid rgba(16,16,16,0.04); }
.hidden{ display:none; }

/* small screens */
@media (max-width:720px){
  .product-row{ grid-template-columns: 1fr; }
  .modal-shell{ width:100vw; height:100vh; border-radius:0; max-height:100vh; padding:12px; }
}

    /* Cart Drawer */
.cart-drawer{ position:fixed; inset:0; z-index:2200; display:none; }
.cart-drawer[aria-hidden="false"]{ display:block; }
.cart-backdrop{ position:absolute; inset:0; background:rgba(10,10,10,0.5); backdrop-filter: blur(4px); }
.cart-panel{ position:fixed; right:0; top:0; height:100vh; width:min(460px,96vw); background:#fff; box-shadow: -20px 0 60px rgba(8,8,8,0.3); display:flex; flex-direction:column; border-left:1px solid rgba(0,0,0,0.04); }
.cart-head{ display:flex; justify-content:space-between; align-items:center; padding:16px; border-bottom:1px solid rgba(0,0,0,0.04); }
.cart-body{ padding:12px; overflow:auto; flex:1; }
.cart-empty{ text-align:center; padding:36px 12px; color:#666; }
.cart-items{ list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:12px; }
.cart-item{ display:grid; grid-template-columns:72px 1fr auto; gap:12px; align-items:center; padding:8px; border-radius:8px; }
.cart-item img{ width:72px; height:72px; object-fit:cover; border-radius:8px; }
.item-meta{ display:flex; flex-direction:column; gap:6px; min-width:0; }
.item-title{ font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.item-variant{ font-size:0.9rem; color:#666; }
.item-qty{ display:flex; gap:6px; align-items:center; }
.item-qty button{ padding:6px 8px; border-radius:6px; border:1px solid rgba(0,0,0,0.06); background:transparent; }
.item-price{ min-width:90px; text-align:right; font-weight:600; }

.cart-foot{ padding:14px; border-top:1px solid rgba(0,0,0,0.04); }
.cart-summary{ display:flex; flex-direction:column; gap:8px; }
.summary-row{ display:flex; justify-content:space-between; align-items:center; font-size:0.98rem; }
.summary-row.total{ font-size:1.05rem; font-weight:700; border-top:1px dashed rgba(0,0,0,0.04); padding-top:8px; margin-top:8px; }
.promo-row{ display:flex; gap:8px; margin-top:6px; }
.promo-row input{ flex:1; padding:8px; border-radius:8px; border:1px solid rgba(0,0,0,0.06); }
.checkout-row{ margin-top:10px; }
.cart-close{ font-size:22px; background:transparent; border:0; cursor:pointer; }

.cart-toggle{ position:relative; }
.cart-badge{ background:#D9302A; color:#fff; border-radius:999px; padding:2px 8px; margin-left:8px; font-weight:700; font-size:0.85rem; }

    /* ===========================
   Responsive helpers & defaults
   Paste this AFTER your main styles
   =========================== */

:root{
  /* tweak these to change scale on all breakpoints quickly */
  --hero-item-size: 220px;   /* desktop baseline */
  --hero-gap: 24px;
  --hero-font-scale: 1;      /* multiply base font sizes in items */
  --panel-radius: 12px;
  --cart-sheet-height: 82vh;
}

/* Safety: prevent unexpected overflow globally */
*,
*::before,
*::after { box-sizing: border-box; max-width: 100%; }

/* Ensure images never overflow card containers */
img, picture, video { max-width: 100%; height: auto; display: block; object-fit: cover; }

/* Hero defaults used by the site’s hero */
.hero {
  /* keep same layout as desktop, but allow reductions via variable */
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--hero-gap);
  align-items: start;
  overflow: visible;
  padding: 48px clamp(16px, 4vw, 48px);
}

/* The items container inside hero — adapt to your markup (.hero-items / .items) */
.hero .items,
.hero-items,
.items {
  display: grid;
  gap: clamp(10px, 1.6vw, var(--hero-gap));
  grid-template-columns: repeat(auto-fit, minmax(var(--hero-item-size), 1fr));
  align-items: start;
  justify-items: stretch;
}

/* Individual product / item cards inside the hero */
.hero .item,
.hero-item,
.product-card {
  width: 100%;
  max-width: none;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 12px;
  border-radius: 12px;
  overflow: hidden;
  min-height: 1px;
  /* scale text relative to variable to make everything fit */
  font-size: calc(1rem * var(--hero-font-scale));
}

/* Truncate long titles so they won't push layouts */
.hero .item .title,
.product-card .title { 
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Make image container fixed-ish so card heights remain consistent */
.hero .item .thumb,
.product-card .thumb {
  width: 100%;
  height: calc(var(--hero-item-size) * 0.56); /* 16:9-ish on desktop */
  min-height: 60px;
  border-radius: 8px;
  overflow: hidden;
}

/* ===========================
   Cart drawer -> responsive behaviour
   (desktop: keeps as side drawer, mobile: becomes bottom sheet)
   =========================== */

/* keep default desktop behaviour (if your existing styles already use right:0) */
/* Mobile / small tablet overrides below */
@media (max-width: 1024px) {
  /* reduce hero item size a bit for large tablets */
  :root { --hero-item-size: 180px; --hero-gap: 18px; --hero-font-scale: 0.95; }
}

/* Small tablets / landscape phones */
@media (max-width: 768px) {
  :root { --hero-item-size: 150px; --hero-gap: 14px; --hero-font-scale: 0.92; }

  /* Hero: make item images smaller and allow single column where necessary */
  .hero {
    padding: 32px 16px;
  }
  .hero .items,
  .hero-items,
  .items {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
  }
  .hero .item .thumb,
  .product-card .thumb {
    height: calc(var(--hero-item-size) * 0.55);
  }

  /* Cart drawer becomes bottom sheet: full width and anchored to bottom */
  #cart-drawer .cart-panel,
  .cart-drawer .cart-panel {
    left: 0 !important;
    right: 0 !important;
    top: auto !important;
    bottom: 0 !important;
    width: 100% !important;
    height: var(--cart-sheet-height) !important;
    max-height: 92vh;
    border-radius: var(--panel-radius) var(--panel-radius) 0 0;
    box-shadow: 0 -12px 40px rgba(2,6,23,0.45);
    transform: translateY(0);
    display: flex;
    flex-direction: column;
  }

  .cart-drawer .cart-backdrop { background: rgba(0,0,0,0.45); }

  /* cart header / body adjustments */
  .cart-head { padding: 12px 16px; }
  .cart-body { padding: 10px 12px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
  .cart-item { grid-template-columns: 56px 1fr auto; gap:10px; padding: 8px; }
  .cart-item img { width:56px; height:56px; border-radius:8px; }

  .cart-foot { padding: 12px 14px; }

  /* make checkout easily tappable */
  .checkout-row .btn { width: 100%; padding: 12px 14px; font-size: 1rem; border-radius: 10px; }

  /* smaller badge and spacing */
  .cart-toggle { padding: 8px 10px; }
  .cart-badge { padding: 4px 8px; font-size: 0.78rem; }

  /* Modal adjustments: make product modal full-screen-ish with safe area for mobile */
  .modal,
  .product-modal,
  .dialog {
    padding: 12px;
  }
  .modal .modal-panel,
  .product-modal .modal-panel,
  .dialog .modal-panel {
    width: calc(100% - 28px);
    max-width: none;
    max-height: 86vh;
    margin: 0 auto;
    border-radius: 12px;
    overflow: hidden;
  }
  .modal .modal-body { max-height: calc(86vh - 120px); overflow-y: auto; -webkit-overflow-scrolling: touch; }

  /* Compact action rows */
  .modal .modal-actions,
  .product-modal .modal-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
}

/* Phones: tighten up even more */
@media (max-width: 480px) {
  :root { --hero-item-size: 120px; --hero-gap: 10px; --hero-font-scale: 0.88; --cart-sheet-height: 88vh; }

  .hero { padding: 20px 12px; }
  .hero .items,
  .hero-items,
  .items { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; }
  .hero .item .thumb,
  .product-card .thumb { height: calc(var(--hero-item-size) * 0.6); }

  .btn-add.added { background: #fff1ef; color: #b71c1c; border: 1px solid rgba(183,28,28,0.08); box-shadow:none; }
.btn-add.added i { margin-right:6px; }

  /* ====== Mobile nav responsive styling ====== */
@media (max-width: 920px) {
  /* hide desktop nav list and brand text to save space */
  .brand-text { display: none !important; }
  .main-nav { display: none !important; } /* hide original nav on small screens */
  .hamburger { display: inline-grid; }     /* ensure hamburger is visible */

  /* Mobile overlay */
  .mobile-overlay {
    position: fixed; inset: 0; z-index: 1400;
    background: rgba(10,10,10,0.48);
    backdrop-filter: blur(6px);
    transition: opacity .28s ease;
    opacity: 0;
    pointer-events: none;
  }
  .mobile-overlay[aria-hidden="false"], .mobile-overlay.show { opacity: 1; pointer-events: auto; }

  /* Panel */
  .mobile-panel {
    position: fixed;
    top: 0; right: 0;
    height: 100vh;
    width: 88%;
    max-width: 420px;
    z-index: 1500;
    transform: translateX(110%);
    transition: transform .36s cubic-bezier(.22,.95,.32,1);
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
    box-shadow: -24px 40px 80px rgba(12,12,12,0.16);
    display: flex;
    flex-direction: column;
    border-left: 1px solid rgba(16,16,16,0.04);
    padding: 12px;
    overflow-y: auto;
  }
  .mobile-panel[aria-hidden="false"] { transform: translateX(0); }

  .mobile-panel-inner { display:flex; flex-direction:column; min-height:100%; }

  .mobile-panel-head { display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px 6px; }
  .mobile-brand { display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit; }
  .mobile-brand .logo { width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2)); color:white; display:flex; align-items:center; justify-content:center; }
  .mobile-brand .brand-text { display:block; font-size:0.9rem; line-height:1; }
  .mobile-close { width:44px;height:44px; }

  .mobile-panel-body { padding: 6px; display:flex; flex-direction:column; gap:12px; }

  .mobile-nav-container .nav-list {
    display:flex; flex-direction:column; gap:6px; padding:6px 4px; margin:0;
  }
  .mobile-nav-container .nav-list .nav-link {
    display:flex; align-items:center; gap:12px;
    padding:14px 12px; border-radius:12px;
    font-size:1.05rem; font-weight:700;
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
    border: 1px solid rgba(16,16,16,0.04);
    box-shadow: 0 8px 26px rgba(16,16,16,0.04);
    color:#111;
  }

  .mobile-cta { display:flex; gap:10px; flex-direction:column; padding:8px 4px; margin-top:6px; }
  .mobile-cta .btn { width:100%; padding:14px; font-size:1rem; border-radius:12px; }

  .mobile-panel-foot { margin-top:auto; padding: 12px 6px; text-align:center; color:var(--muted); }

  /* subtle states */
  .mobile-panel .nav-link:active, .mobile-panel .nav-link:focus { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(16,16,16,0.06); }

  /* hamburger -> X transform (we swap icons via JS but keep some visual feedback) */
  .hamburger.open { background: linear-gradient(90deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02)); transform: rotate(0.001deg); }

  /* make sure header is above overlay stacking contexts */
  .site-header { z-index: 1600; }
}
  /* ===== Builder option tiles (premium) ===== */
.options-grid.option-tiles-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  align-items: start;
  padding: 6px;
}

/* option card */
.option-card {
  display: block;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
  border-radius: 12px;
  border: 1px solid rgba(16,16,16,0.04);
  box-shadow: 0 10px 30px rgba(14,14,14,0.06);
  overflow: hidden;
  text-align: left;
  cursor: pointer;
  padding: 0;
  transition: transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .22s ease;
  min-height: 160px;
  display: flex;
  flex-direction: column;
}

/* image area keeps aspect ratio and is cover */
.option-card .option-media {
  flex: 0 0 110px;
  min-height: 110px;
  background-size: cover;
  background-position: center;
  display:block;
}

/* meta area */
.option-card .option-meta {
  padding: 10px 12px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.option-card .option-title { font-weight:700; font-size:0.96rem; color:#111; }
.option-card .option-sub { font-size:0.85rem; color:var(--muted); }

/* hover */
.option-card:hover { transform: translateY(-6px); box-shadow: 0 20px 40px rgba(12,12,12,0.08); }

/* selected state */
.option-card.selected {
  outline: 3px solid rgba(255,107,61,0.12);
  border-color: rgba(255,107,61,0.12);
  box-shadow: 0 24px 60px rgba(255,107,61,0.06);
  transform: translateY(-4px);
}
.option-card[aria-pressed="true"] { box-shadow: 0 22px 50px rgba(0,0,0,0.08); }

/* multi-select visual (checkbox-like chip) */
.option-card.selected::after {
  content: "\f00c"; /* FontAwesome check mark */
  font-family: "Font Awesome 6 Free";
  font-weight: 900;
  position: absolute;
  right: 10px; top: 10px;
  background: rgba(0,0,0,0.6); color: #fff;
  width: 34px; height: 34px; border-radius: 10px;
  display:flex; align-items:center; justify-content:center;
}

/* make small screens horizontally scrollable for quick selection */
@media (max-width: 720px) {
  .options-grid.option-tiles-grid {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 8px;
    -webkit-overflow-scrolling: touch;
  }
  .option-card { min-width: 220px; flex: 0 0 auto; }
  .modal-right { order: 2; } /* keep preview below on small screens */
}

/* preview gallery styling (right column) */
.preview-gallery {
  display: flex; gap:8px; margin-top:8px; flex-wrap:wrap;
}
.preview-thumb { width:54px; height:54px; padding:0; border-radius:8px; overflow:hidden; border:1px solid rgba(16,16,16,0.04); background:#fff; }
.preview-thumb .thumb-img { width:100%; height:100%; background-size:cover; background-position:center; }
  /* ===== micro pop animation + price badge ===== */

/* pop animation uses transform + scale + subtle bounce */
@keyframes tilePop {
  0%   { transform: scale(1); }
  40%  { transform: scale(1.06); }
  70%  { transform: scale(0.995); }
  100% { transform: scale(1); }
}

/* apply small pop when .pop added */
.option-card.pop {
  animation: tilePop 320ms cubic-bezier(.2,.85,.2,1);
}

/* subtle pulse shadow on select */
.option-card.selected {
  box-shadow: 0 26px 68px rgba(255,107,61,0.10);
  transform: translateY(-4px);
}

/* price-badge: small rounded pill over image */
.price-badge {
  position: absolute;
  right: 10px;
  top: 10px;
  background: linear-gradient(90deg,#ff6b3d,#ffc857);
  color: white;
  font-weight: 800;
  font-size: 0.8rem;
  padding: 6px 8px;
  border-radius: 999px;
  box-shadow: 0 8px 20px rgba(16,16,16,0.12);
  z-index: 4;
  pointer-events: none;
}

/* darken the price-badge slightly for better contrast on very bright images */
.option-card .option-media::after {
  content: "";
  position: absolute; inset: 0;
  mix-blend-mode: multiply;
  opacity: 0.02;
  pointer-events: none;
}

/* smaller badge on narrow widths */
@media (max-width: 520px) {
  .price-badge { font-size: 0.76rem; padding: 5px 7px; right:8px; top:8px; }
}
  /* ===== Builder Summary — premium styling ===== */
.order-summary {
  display: flex;
  flex-direction: column;
  gap: 14px;
  padding: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
  border-radius: 12px;
  border: 1px solid rgba(16,16,16,0.04);
  box-shadow: 0 12px 36px rgba(16,16,16,0.06);
}

/* selected chips */
.selected-chips {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  padding:4px 0;
}
.summary-title { margin:0 0 6px 0; font-weight:800; color:#111; }

/* chip */
.chip {
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 10px;
  border-radius:999px;
  background:linear-gradient(180deg,rgba(255,255,255,0.94),rgba(250,250,250,0.94));
  border:1px solid rgba(16,16,16,0.04);
  box-shadow:0 6px 18px rgba(16,16,16,0.04);
  cursor:pointer;
  font-weight:700;
}
.chip .remove { opacity:0.9; color:#b71c1c; background:transparent; border:0; font-size:0.92rem; }

/* price lines */
.summary-breakdown .line { display:flex; align-items:center; justify-content:space-between; padding:8px 4px; border-radius:8px; }
.summary-breakdown .line:not(.total-line):hover { background: rgba(0,0,0,0.02); }
.summary-breakdown .label { color:var(--muted); font-weight:700; font-size:0.95rem; }
.summary-breakdown .value { font-weight:800; color:#111; }

/* qty controls */
.qty-controls { display:inline-flex; align-items:center; gap:8px; }
.qty-controls .icon-btn { width:36px; height:36px; font-size:1rem; border-radius:8px; }

/* total line standout */
.total-line { background: linear-gradient(90deg, rgba(255,107,61,0.06), rgba(255,200,120,0.03)); padding:12px; border-radius:12px; }
.total-val { font-size:1.12rem; color:#111; }

/* promo */
.summary-promo { display:flex; gap:8px; align-items:center; }
.summary-promo input { flex:1; padding:10px 12px; border-radius:10px; border:1px solid rgba(16,16,16,0.06); }

/* actions */
.summary-actions { display:flex; gap:10px; align-items:center; }
#summary-add { flex:1; }
#summary-close { flex:0 0 auto; }

/* small screens: stack nicely */
@media (max-width:720px) {
  .order-summary { padding:10px; }
  .chip { padding:8px 10px; font-size:0.95rem; }
  .summary-breakdown .label { font-size:0.9rem; }
  .summary-breakdown .value { font-size:0.95rem; }
}
  /* summary add pulse */
#summary-add.added { transform: scale(0.98); box-shadow: 0 10px 30px rgba(16,16,16,0.06); transition: all 160ms ease; }
  /* ===== Premium Build Modal — Visual & Responsive Enhancements ===== */

/* container adjustments */
.modal.modal-builder,
#build-modal,
#builder-modal {
  --modal-radius: 18px;
  --modal-gap: 20px;
  --modal-bg: linear-gradient(180deg,#fff,#fbfbfb);
  --muted-2: rgba(16,16,16,0.36);
}

/* shell layout (desktop) */
.modal-shell.container,
#builder-modal .modal-shell.container {
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: var(--modal-gap);
  align-items: start;
  padding: 22px;
  background: transparent;
}

/* left column (options) */
.modal-left {
  background: var(--modal-bg);
  border-radius: var(--modal-radius);
  padding: 18px;
  box-shadow: 0 20px 50px rgba(9, 10, 10, 0.06);
  border: 1px solid rgba(16,16,16,0.04);
  min-height: 320px;
  overflow: visible;
}

/* builder header */
.modal-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:12px;
}
.modal-header h3 { margin:0; font-size:1.05rem; letter-spacing:0.02em; }

/* stepper (pill style) */
.builder-stepper {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-bottom:12px;
}
.builder-stepper .step {
  background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.92));
  border:1px solid rgba(16,16,16,0.04);
  padding:8px 12px;
  border-radius:999px;
  font-weight:700;
  cursor:pointer;
  transition: all .22s cubic-bezier(.2,.9,.2,1);
  box-shadow: 0 6px 18px rgba(16,16,16,0.03);
}
.builder-stepper .step.active {
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  color: #111;
  transform: translateY(-4px) scale(1.01);
  box-shadow: 0 22px 50px rgba(255,107,61,0.12);
}

/* options grid */
.options-grid {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(120px,1fr));
  gap:12px;
  align-items:start;
  margin-top:8px;
}

/* option-card (polished) */
.option-card {
  display:flex;
  flex-direction:column;
  gap:10px;
  border-radius:12px;
  overflow:hidden;
  background: linear-gradient(180deg, #fff, #fff);
  border:1px solid rgba(16,16,16,0.04);
  padding:10px;
  min-height:128px;
  cursor:pointer;
  transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s ease, border-color .2s;
  will-change: transform;
}

/* media area */
.option-card .option-media {
  width:100%;
  height:86px;
  border-radius:10px;
  background-size:cover;
  background-position:center;
  box-shadow: inset 0 -12px 40px rgba(0,0,0,0.06);
  overflow:hidden;
}

/* content area (title/price) */
.option-card .option-meta { display:flex; align-items:center; justify-content:space-between; gap:8px; }
.option-card .option-title { font-weight:800; font-size:0.95rem; color:#111; }
.option-card .option-sub { font-size:0.82rem; color:var(--muted); font-weight:700; }

/* selected state */
.option-card.selected {
  transform: translateY(-8px);
  box-shadow: 0 28px 70px rgba(16,16,16,0.08);
  border-color: rgba(255,107,61,0.12);
  outline: none;
}

/* pop animation (short) */
@keyframes tileMicroPop { 0%{ transform: scale(1) } 45%{ transform: scale(1.06) } 80%{ transform: scale(.995) } 100%{ transform: scale(1) } }
.option-card.pop { animation: tileMicroPop .36s cubic-bezier(.2,.9,.2,1); }

/* price badge (if present) — refined look */
.option-card .price-badge {
  right: 10px;
  top: 8px;
  padding:6px 8px;
  font-weight:900;
  font-size:0.78rem;
  border-radius:999px;
  box-shadow: 0 10px 30px rgba(16,16,16,0.08);
  display:inline-flex;
  gap:6px;
  align-items:center;
}

/* ------ right preview column (sticky on desktop) ------ */
.modal-right {
  position:relative;
}
.modal-right[hidden] { display:none; }

/* glossy preview card */
.live-preview {
  position:sticky;
  top: 84px;
  background: linear-gradient(180deg,#ffffff, #fffdfb);
  border-radius: 16px;
  padding: 16px;
  border:1px solid rgba(16,16,16,0.04);
  box-shadow: 0 28px 80px rgba(16,16,16,0.08);
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* preview image */
.preview-image {
  width:100%;
  height:200px;
  border-radius:12px;
  overflow:hidden;
  background-size:cover;
  background-position:center;
  display:flex;
  align-items:flex-end;
  justify-content:flex-start;
}
.preview-image img { width:100%; height:100%; object-fit:cover; display:block; }

/* preview meta */
.preview-info { display:flex; flex-direction:column; gap:10px; }
.preview-title { margin:0; font-weight:900; font-size:1.05rem; }
.preview-price { font-weight:900; font-size:1.08rem; }

/* qty controls in preview */
.preview-qty .icon-btn { width:40px; height:40px; border-radius:10px; }

/* preview actions */
.preview-actions { display:flex; gap:8px; }
.preview-actions .btn { flex:1; padding:12px 14px; border-radius:12px; font-weight:800; }

/* delivery toggle compact */
.delivery-toggle label { display:inline-flex; gap:8px; align-items:center; padding:8px 10px; border-radius:10px; background: rgba(0,0,0,0.02); cursor:pointer; }
.delivery-address { margin-top:8px; }

/* tiny micro animations for preview price */
.preview-price.pulse { animation: tileMicroPop .36s cubic-bezier(.2,.9,.2,1); }

/* ===== Mobile / narrow (sheet-style) ===== */
@media (max-width: 880px) {
  .modal-shell.container { grid-template-columns: 1fr; padding:14px; gap:12px; }
  .modal-right { order:-1; } /* show preview first */
  .modal-right .live-preview { position: relative; top: 0; box-shadow: 0 12px 36px rgba(16,16,16,0.06); }
  .modal-left { padding:14px; border-radius: 14px; }
  .options-grid { grid-template-columns: repeat(auto-fit, minmax(140px,1fr)); gap:10px; }

  /* fullscreen modal look (bottom-sheet) */
  #builder-modal[aria-hidden="false"], .modal.modal-builder[aria-hidden="false"] {
    position:fixed; left:0; right:0; top:8vh; bottom:0; z-index: 1400;
    padding:8px 12px; border-radius: 18px 18px 0 0;
    background: linear-gradient(180deg,#fff,#fffbf8); overflow:auto;
  }

  /* make action buttons larger for touch */
  .preview-actions .btn { padding:14px 16px; font-size:1rem; border-radius:12px; }
  .option-card { min-height:140px; padding:12px; }
  .option-card .option-media { height:110px; }
}

/* tiny polish: transition on modal show */
.modal.modal-builder, #builder-modal { transition: transform .28s cubic-bezier(.2,.9,.2,1), opacity .28s ease; transform-origin:center; }

/* ensure focus visible */
.option-card:focus, .option-card:active { outline: 3px solid rgba(255,107,61,0.12); outline-offset:3px; }

/* accessibility: high contrast fallback */
@media (prefers-contrast: more) {
  .option-card { border:1px solid rgba(0,0,0,0.12); }
}
  /* =========================
Hero — Mobile-first polish & fixes
========================= */

/* Make hero less tall on small screens and keep layout compact */
.vd-hero-wrap.container { padding: 18px; }
.vd-card { border-radius: 18px; overflow: visible; }

/* mobile baseline: compact font sizes and stacking */
#hero.vd-hero .vd-hero-body { display:flex; flex-direction:column; align-items:center; gap:14px; padding:18px 12px; }
.vd-hero .vd-circle { display:block; width:120px; height:120px; border-radius:999px; overflow:hidden; flex:0 0 auto; }
.vd-left-img, .vd-right-img { width:100%; height:100%; object-fit:cover; display:block; }

/* headline & description sizing */
.vd-title .vd-line { display:block; line-height:1; font-weight:800; font-size:1.6rem; letter-spacing:0.02em; }
#vd-desc { font-size:0.92rem; color:var(--muted); max-width:520px; text-align:center; margin:6px auto 0; }

/* CTAs — mobile friendly full width */
.vd-ctas { display:flex; gap:10px; width:100%; justify-content:center; margin-top:8px; }
.vd-ctas .btn { flex:1 1 auto; min-height:44px; font-size:1rem; border-radius:12px; }
.vd-ctas .vd-btn-primary { padding:12px 14px; }
.vd-ctas .vd-btn-ghost { padding:12px 14px; background:transparent; border:1px solid rgba(16,16,16,0.06); }

/* dots/tap targets */
.vd-dots { display:flex; gap:8px; margin-top:8px; }
.vd-dot { width:12px; height:12px; border-radius:999px; background:rgba(0,0,0,0.12); border:0; padding:0; }
.vd-dot.active, .vd-dot[aria-selected="true"] { background: linear-gradient(90deg,var(--accent),var(--accent-2)); transform: scale(1.12); }

/* subtle micro-anim for CTA */
.vd-btn-primary:active, .vd-btn-primary.pressed { transform: translateY(2px) scale(.996); transition: transform .12s; }

/* hero min height — keep it compact on phones */
#hero.vd-hero { min-height: calc(60vh - var(--header-h)); display:block; }

/* hide large decorative blobs to reduce clutter on small screens */
.vd-art-blob, .vd-blob-a, .vd-blob-b, .vd-blob-c { display:none !important; }

/* ensure hero images don't overflow and keep z-index above overlays */
.vd-card, .vd-hero-wrap { position:relative; z-index:1200; }

/* responsive: tablets & up */
@media (min-width: 720px) {
  /* two-column layout restored on bigger screens */
  #hero.vd-hero .vd-hero-body { flex-direction:row; align-items:center; justify-content:space-between; gap:24px; padding:28px; }
  .vd-left-img, .vd-right-img { width:160px; height:160px; border-radius:50%; }
  .vd-title .vd-line { font-size:2.2rem; }
  #hero.vd-hero { min-height: calc(80vh - var(--header-h)); }
}

/* desktop: keep original large feel but ensure content isn't cut off */
@media (min-width: 1100px) {
  .vd-title .vd-line { font-size:2.8rem; }
  .vd-left-img, .vd-right-img { width:220px; height:220px; }
}

/* accessibility: focus outlines */
.vd-ctas .btn:focus { outline:3px solid rgba(255,107,61,0.12); outline-offset:4px; }

/* small helper to ensure hero doesn't overflow on very tiny screens */
@media (max-height:520px) {
  #hero.vd-hero { min-height: calc(48vh - var(--header-h)); }
}
  /* Manef chat — minimal positioning & safe stacking */
#manef-chat { position: fixed; right: 18px; bottom: 18px; z-index: 14000; font-family: var(--text-ui, Arial, sans-serif); }
#manef-chat .chat-toggle { width:56px;height:56px;border-radius:999px; display:inline-grid; place-items:center; box-shadow:0 10px 34px rgba(2,6,23,0.18); background:linear-gradient(180deg,#fff,#fff); border:0; cursor:pointer; }
#manef-chat .chat-panel { width: 340px; max-width: 92vw; border-radius:14px; overflow:hidden; box-shadow:0 28px 80px rgba(2,6,23,0.14); background:#fff; display:flex; flex-direction:column; }
#manef-chat .chat-head { display:flex; align-items:center; gap:10px; padding:12px 12px; border-bottom:1px solid rgba(0,0,0,0.06); }
#manef-chat .chat-body { padding:12px; max-height: 44vh; overflow:auto; background: linear-gradient(180deg,#fff,#f9f9fb); }
#manef-chat .chat-foot { display:flex; gap:8px; padding:10px; border-top:1px solid rgba(0,0,0,0.04); }
#manef-chat .chat-input { flex:1; padding:10px; border-radius:10px; border:1px solid rgba(0,0,0,0.06); }
#manef-chat .chat-messages .chat-msg { margin-bottom:10px; }
#manef-chat .chat-msg.bot .chat-bubble { background:#fff; border:1px solid rgba(0,0,0,0.04); padding:10px; border-radius:10px; }
#manef-chat .chat-msg.user { text-align:right; }
#manef-chat .chat-msg.user .chat-bubble { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color:#111; padding:10px; border-radius:10px; display:inline-block; }
#manef-chat .chat-typing .dot { display:inline-block; width:6px;height:6px;border-radius:50%;background:#ccc;margin:0 3px; animation:manef-dot .9s infinite; }
@keyframes manef-dot { 0%{ transform:translateY(0) } 50%{ transform:translateY(-4px) } 100%{ transform:translateY(0) } }
#manef-chat .chat-panel[hidden] { display:none !important; }
  </style>
</head>
<body>

<!-- ==============================
SITE HEADER (icons everywhere)
============================== -->

<header class="site-header" role="banner" aria-label="Wrap District header">
<div class="container header-inner">
<!-- BRAND / LOGO -->
<a class="brand" href="/" aria-label="Wrap District home">
<div class="logo" aria-hidden="true" title="Wrap District">
<!-- FontAwesome icon (replace with real font include in <head>) -->
<i class="fa fa-utensils" aria-hidden="true" style="font-size:28px"></i>
</div>


<div class="brand-text" aria-hidden="true">
<strong class="brand-title">WRAP DISTRICT</strong>
<span class="brand-tag">Fresh • Loaded • Fast</span>
</div>
</a>

<!-- NAVIGATION (icons in menu items too) -->
<nav class="main-nav" role="navigation" aria-label="Main menu">
<ul class="nav-list" role="menubar" aria-hidden="false">
<li role="none"><a role="menuitem" href="#hero" class="nav-link"><i class="fa fa-home" aria-hidden="true"></i> Home</a></li>
<li role="none"><a role="menuitem" href="#menu" class="nav-link"><i class="fa fa-list"></i> Menu</a></li>
<li role="none"><a role="menuitem" href="#build" class="nav-link"><i class="fa fa-tools"></i> Build</a></li>
<li role="none"><a role="menuitem" href="#promo" class="nav-link"><i class="fa fa-bolt"></i> Promos</a></li>
<li role="none"><a role="menuitem" href="#about" class="nav-link"><i class="fa fa-info-circle"></i> About</a></li>
</ul>
</nav>

<!-- ACTIONS: SEARCH, LOCATION, CART, ORDER (icons everywhere) -->
<div class="header-actions" role="group" aria-label="Header actions">
<!-- Search -->
<button class="icon-btn search-btn" aria-label="Search menu" type="button" data-action="open-search">
<i class="fa fa-search" aria-hidden="true"></i>
</button>

<!-- Location -->
<a class="icon-btn location-btn" href="#contact" aria-label="Location & hours">
<i class="fa fa-map-marker" aria-hidden="true"></i>
</a>

<!-- Cart -->
<button class="icon-btn cart-btn" aria-label="Open cart" type="button" data-action="open-cart" aria-haspopup="dialog" aria-expanded="false">
<i class="fa fa-shopping-cart" aria-hidden="true"></i>
<span class="cart-badge" id="cart-count" data-count="0" aria-live="polite" aria-atomic="true">0</span>
</button>

<!-- Order CTA — now points to Paystack (data attribute used for integration) -->
<button class="btn btn-cta order-cta" type="button" data-action="open-paystack" aria-label="Order now — Paystack">
<i class="fa fa-bolt" aria-hidden="true"></i>
Order Now
</button>

<!-- Mobile hamburger (icon) -->
<button class="hamburger icon-btn" aria-label="Open menu" aria-expanded="false" type="button">
<i class="fa fa-bars" aria-hidden="true"></i>
</button>
</div>
</div>


</header>



<main id="main" role="main">
<!-- HERO: REPLACE existing <section id="hero"> with this block -->
<section id="hero" class="vd-hero" aria-label="Featured">
  <div class="vd-hero-wrap container">

    <div class="vd-card" role="region" aria-label="Featured card">
      <!-- top row inside the card -->
      <div class="vd-card-top">
        <div class="vd-brand" aria-hidden="true">
          <strong class="vd-brand-title">WRAP DISTRICT</strong>
          <span class="vd-brand-tag">Fresh • Loaded • Fast</span>
        </div>

        <nav class="vd-top-nav" aria-label="Hero quick links" style="display: none">
          <a href="#hero">HOME</a>
          <a href="#menu">MENU</a>
          <a href="#promo">PROMOS</a>
          <a href="#about">ABOUT</a>
        </nav>

        <div class="vd-socials" aria-hidden="true" style="display: none">
          <a href="#" aria-label="facebook"><i class="fa fa-facebook-f"></i></a>
          <a href="#" aria-label="twitter"><i class="fa fa-twitter"></i></a>
          <a href="#" aria-label="instagram"><i class="fa fa-instagram"></i></a>
        </div>
      </div>

      <!-- body: left circle, center text, right circle -->
      <div class="vd-hero-body" role="region" aria-label="Hero carousel">

        <!-- left circular image -->
        <figure class="vd-circle vd-circle-left" aria-hidden="true">
          <img src="" alt="" loading="lazy" class="vd-left-img" />
        </figure>

        <!-- center text -->
        <div class="vd-center">
          <div class="vd-eyebrow" id="vd-eyebrow">100% FRESH & MADE DAILY</div>

          <h1 class="vd-title" id="vd-title" aria-live="polite" aria-atomic="true">
            <span class="vd-line vd-line-top">TASTE</span>
            <span class="vd-line vd-line-bottom">ORGANIC</span>
          </h1>

          <p class="vd-desc" id="vd-desc">We blend local flavours with fast, modern service — freshly made daily in Tema Community 25.</p>

          <div class="vd-ctas">
            <button class="btn vd-btn-primary" id="vd-order" aria-label="Order now">ORDER NOW</button>
            <button class="btn vd-btn-ghost" id="vd-see-menu" aria-label="See menu">SEE MENU</button>
          </div>

          <div class="vd-dots" role="tablist" aria-label="Slide indicators" id="vd-dots">
            <!-- dots inserted by JS or statically present (JS will sync aria-selected) -->
            <button class="vd-dot" role="tab" aria-selected="true" data-index="0" aria-label="Slide 1"></button>
            <button class="vd-dot" role="tab" aria-selected="false" data-index="1" aria-label="Slide 2"></button>
            <button class="vd-dot" role="tab" aria-selected="false" data-index="2" aria-label="Slide 3"></button>
            <button class="vd-dot" role="tab" aria-selected="false" data-index="3" aria-label="Slide 4"></button>
            <button class="vd-dot" role="tab" aria-selected="false" data-index="4" aria-label="Slide 5"></button>
            <button class="vd-dot" role="tab" aria-selected="false" data-index="5" aria-label="Slide 6"></button>
          </div>
        </div>

        <!-- right circular image + off badge -->
        <figure class="vd-circle vd-circle-right" aria-hidden="true">
          <img src="" alt="" loading="lazy" class="vd-right-img" />
          <div class="vd-off-badge" aria-hidden="true"><strong>50%</strong><small>OFF</small></div>
        </figure>

      </div>
    </div>
  </div>
</section>


<section id="menu" class="menu-section" aria-label="Full menu">
<div class="container">
<header class="section-head">
<h2 class="section-title"><i class="fa fa-concierge-bell"></i> Full Menu</h2>
<p class="section-sub">Choose, customize and order. Everything is priced transparently.</p>
</header>

<!-- Filters -->
<div class="menu-filters" role="tablist" aria-label="Filter menu">
<button class="filter active" data-filter="all" role="tab" aria-selected="true"><i class="fa fa-th"></i> All</button>
<button class="filter" data-filter="shawarma" role="tab"><i class="fa fa-bread-slice"></i> Shawarma</button>
<button class="filter" data-filter="fries" role="tab"><i class="fa fa-box"></i> Loaded Fries</button>
<button class="filter" data-filter="angwamo" role="tab"><i class="fa fa-drumstick-bite"></i> Angwamo</button>
<button class="filter" data-filter="rice" role="tab"><i class="fa fa-rice"></i> Fried Rice</button>
</div>

<!-- Grid: note data-grid attribute — CSS will make this 3x3 on large viewports -->
<div class="menu-grid" role="list" aria-live="polite" aria-atomic="false" data-grid="3x3">

<!-- Menu item card (repeatable) -->
<article class="menu-item" data-id="shawarma-regular" data-category="shawarma" data-price="45" role="listitem" aria-label="Shawarma Regular">
<div class="thumb" data-thumb="thumb-shawarma" role="presentation">
<img src="" alt="Shawarma — Regular" data-artwork="thumb-shawarma" loading="lazy" />
</div>

<div class="meta">
<h3 class="name"><i class="fa fa-bread-slice"></i> Shawarma — Regular</h3>
<p class="desc">Classic size with your choice of protein and fillings.</p>

<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 45</span>

<div class="meta-actions">
<button class="icon-btn" data-action="fav" aria-label="Add shawarma to favourites" title="Add to favourites">
<i class="fa fa-heart"></i>
</button>

<button class="btn small" data-action="open-builder" data-item="shawarma"><i class="fa fa-wrench"></i> Customize</button>

<button class="btn btn-pay small" data-action="add-to-cart" data-item="shawarma" aria-label="Add shawarma to cart">
<i class="fa fa-plus-circle"></i> Add
</button>
</div>
</div>
</div>
</article>

<!-- Loaded Fries -->
<article class="menu-item" data-id="fries-single" data-category="fries" data-price="55" role="listitem" aria-label="Loaded Fries Single">
<div class="thumb" data-thumb="thumb-fries" role="presentation">
<img src="" alt="Loaded Fries — Single" data-artwork="thumb-fries" loading="lazy" />
</div>

<div class="meta">
<h3 class="name"><i class="fa fa-box-open"></i> Loaded Fries — Single</h3>
<p class="desc">Cheese, sauce, choice of protein — add bacon or chicken.</p>

<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 55</span>

<div class="meta-actions">
<button class="icon-btn" data-action="fav" aria-label="Add fries to favourites"><i class="fa fa-heart"></i></button>
<button class="btn small" data-action="open-builder" data-item="fries"><i class="fa fa-wrench"></i> Customize</button>
<button class="btn btn-pay small" data-action="add-to-cart" data-item="fries"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

<!-- Angwamo -->
<article class="menu-item" data-id="angwamo-plate" data-category="angwamo" data-price="55" role="listitem" aria-label="Loaded Angwamo Plate">
<div class="thumb" data-thumb="thumb-angwamo" role="presentation">
<img src="" alt="Loaded Angwamo — Plate" data-artwork="thumb-angwamo" loading="lazy" />
</div>

<div class="meta">
<h3 class="name"><i class="fa fa-drumstick-bite"></i> Loaded Angwamo — Plate</h3>
<p class="desc">A hearty plate with eggs, sides & toppings — choose a combo for more.</p>

<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 55</span>
<div class="meta-actions">
<button class="icon-btn" data-action="fav" aria-label="Add angwamo to favourites"><i class="fa fa-heart"></i></button>
<button class="btn small" data-action="open-builder" data-item="angwamo"><i class="fa fa-wrench"></i> Customize</button>
<button class="btn btn-pay small" data-action="add-to-cart" data-item="angwamo"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

<!-- Fried Rice -->
<article class="menu-item" data-id="fried-rice" data-category="rice" data-price="60" role="listitem" aria-label="Fried Rice">
<div class="thumb" data-thumb="thumb-rice" role="presentation">
<img src="" alt="Fried Rice" data-artwork="thumb-rice" loading="lazy" />
</div>

<div class="meta">
<h3 class="name"><i class="fa fa-rice"></i> Fried Rice</h3>
<p class="desc">Served with your choice of protein — great as a plate or combo.</p>

<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 60</span>
<div class="meta-actions">
<button class="icon-btn" data-action="fav" aria-label="Add fried rice to favourites"><i class="fa fa-heart"></i></button>
<button class="btn small" data-action="open-builder" data-item="rice"><i class="fa fa-wrench"></i> Customize</button>
<button class="btn btn-pay small" data-action="add-to-cart" data-item="rice"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

<!-- Add placeholder items to fill a 3x3 grid on large viewports (designer will style) -->
<article class="menu-item placeholder" data-id="dessert-1" data-category="dessert" role="listitem" aria-label="Dessert">
<div class="thumb" role="presentation"><img src="" alt="Dessert thumbnail" data-artwork="thumb-dessert" loading="lazy" /></div>
<div class="meta">
<h3 class="name"><i class="fa fa-ice-cream"></i> Dessert</h3>
<p class="desc">Sweet treats to finish your meal.</p>
<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 25</span>
<div class="meta-actions">
<button class="btn small" data-action="open-builder" data-item="dessert"><i class="fa fa-wrench"></i> Customize</button>
<button class="btn btn-pay small" data-action="add-to-cart" data-item="dessert"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

<article class="menu-item placeholder" data-id="drink-1" data-category="drinks" role="listitem" aria-label="Drink">
<div class="thumb" role="presentation"><img src="" alt="Drink thumbnail" data-artwork="thumb-drink" loading="lazy" /></div>
<div class="meta">
<h3 class="name"><i class="fa fa-glass-martini-alt"></i> Drink</h3>
<p class="desc">Soft drinks & bottled water.</p>
<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 10</span>
<div class="meta-actions">
<button class="btn small" data-action="add-to-cart" data-item="drink"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

<article class="menu-item placeholder" data-id="side-1" data-category="sides" role="listitem" aria-label="Side">
<div class="thumb" role="presentation"><img src="" alt="Side thumbnail" data-artwork="thumb-side" loading="lazy" /></div>
<div class="meta">
<h3 class="name"><i class="fa fa-carrot"></i> Side</h3>
<p class="desc">Fries, coleslaw, extra toppings.</p>
<div class="meta-line">
<span class="price"><i class="fa fa-money-bill-wave"></i> GHC 8</span>
<div class="meta-actions">
<button class="btn small" data-action="add-to-cart" data-item="side"><i class="fa fa-plus-circle"></i> Add</button>
</div>
</div>
</div>
</article>

</div>
</div>
</section>


<div id="builder-modal" class="modal modal-builder" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="builder-title" hidden>
<div class="modal-shell container" role="document">
<div class="modal-left">
<header class="modal-header">
<h3 id="builder-title"><i class="fa fa-tools"></i> Build Your Meal</h3>
<button class="icon-btn" data-action="close-builder" aria-label="Close builder" type="button">
<i class="fa fa-times" aria-hidden="true"></i>
</button>
</header>

<!-- stepper nav -->
<nav class="builder-stepper" aria-label="Builder steps">
<button class="step active" data-step="size" type="button">1. <i class="fa fa-arrows-alt-v"></i> Size</button>
<button class="step" data-step="protein" type="button">2. <i class="fa fa-drumstick-bite"></i> Protein</button>
<button class="step" data-step="fillings" type="button">3. <i class="fa fa-leaf"></i> Fillings</button>
<button class="step" data-step="sauces" type="button">4. <i class="fa fa-tint"></i> Sauces</button>
<button class="step" data-step="summary" type="button">5. <i class="fa fa-receipt"></i> Summary</button>
</nav>

<!-- step panels (populated by JS) -->
<div class="builder-steps">
<section class="builder-step-panel" data-step-panel="size" hidden>
<div class="options-grid" role="list" aria-label="Size options"></div>
</section>

<section class="builder-step-panel" data-step-panel="protein" hidden>
<div class="options-grid" role="list" aria-label="Protein options"></div>
</section>

<section class="builder-step-panel" data-step-panel="fillings" hidden>
<div class="options-grid" role="list" aria-label="Fillings options"></div>
</section>

<section class="builder-step-panel" data-step-panel="sauces" hidden>
<div class="options-grid" role="list" aria-label="Sauce options"></div>
</section>

<section class="builder-step-panel" data-step-panel="summary" hidden>
  <div class="order-summary" aria-live="polite" aria-atomic="true">

    <!-- top: selected options chips -->
    <div class="summary-selected">
      <h4 class="summary-title">Your choices</h4>
      <div class="selected-chips" role="list" aria-label="Selected options">
        <!-- chips appended by JS -->
      </div>
    </div>

    <!-- mid: price breakdown -->
    <div class="summary-breakdown" aria-label="Price breakdown">
      <div class="line">
        <div class="label">Base price</div>
        <div class="value" id="summary-base">GHC 0</div>
      </div>
      <div class="line">
        <div class="label">Extras</div>
        <div class="value" id="summary-extras">GHC 0</div>
      </div>
      <div class="line">
        <div class="label">Delivery</div>
        <div class="value" id="summary-delivery">GHC 0</div>
      </div>
      <div class="line qty-line">
        <div class="label">Quantity</div>
        <div class="value qty-controls">
          <button class="icon-btn summary-dec" aria-label="Decrease quantity" type="button">−</button>
          <span id="summary-qty" aria-live="polite" aria-atomic="true">1</span>
          <button class="icon-btn summary-inc" aria-label="Increase quantity" type="button">+</button>
        </div>
      </div>
      <div class="line total-line">
        <div class="label">Total</div>
        <div class="value total-val" id="summary-total">GHC 0</div>
      </div>
    </div>

    <!-- promo + validation (optional) -->
    <div class="summary-promo">
      <input id="summary-promo" type="text" placeholder="Promo code (optional)" aria-label="Promo code" />
      <button id="summary-apply-promo" class="btn ghost" type="button">Apply</button>
      <div id="summary-promo-msg" class="muted tiny" role="status" aria-live="polite"></div>
    </div>

    <!-- footer: Add to cart / Cancel -->
    <div class="summary-actions">
      <button id="summary-add" class="btn btn-cta summary-add" type="button" aria-label="Add built item to cart"><i class="fa fa-shopping-cart"></i> Add to Cart</button>
      <button id="summary-close" class="btn btn-outline" type="button" data-action="close-builder">Cancel</button>
    </div>

  </div>
</section>
</div>
</div>

<aside class="modal-right" hidden>
<div class="live-preview">
<div class="preview-image" data-preview-image="placeholder" role="img" aria-label="Preview image">
<img src="" alt="Preview" data-artwork="preview" loading="lazy" />
</div>

<div class="preview-info">
<h4 class="preview-title"><i class="fa fa-hamburger"></i> Your Meal</h4>
<!-- Preview gallery (insert inside modal-right .preview-info) -->
<div class="preview-main">
  <div class="preview-image" data-preview-image="placeholder" role="img" aria-label="Preview image">
    <img src="" alt="Preview" data-artwork="preview" loading="lazy" />
  </div>
  <div class="preview-gallery" aria-label="Selected option images"></div>
</div>
<div class="preview-meta">
<div>
<div class="preview-price" aria-live="polite"><i class="fa fa-money-bill-wave"></i> GHC 0</div>
<div class="muted tiny preview-sub">Estimated price</div>
</div>

<div class="preview-qty">
<button class="icon-btn qty-dec" data-action="qty-dec" aria-label="Decrease quantity" type="button"><i class="fa fa-minus"></i></button>
<span class="qty-value">1</span>
<button class="icon-btn qty-inc" data-action="qty-inc" aria-label="Increase quantity" type="button"><i class="fa fa-plus"></i></button>
</div>
</div>

<div class="preview-actions">
<button class="btn btn-cta" data-action="add-to-cart"><i class="fa fa-shopping-cart"></i> Add to Cart</button>
<button class="btn btn-pay" data-action="buy-now" data-paystack="true"><i class="fa fa-credit-card"></i> Checkout — Paystack</button>
</div>

<div class="delivery-toggle">
<label><input type="radio" name="delivery" value="pickup" checked> <i class="fa fa-store"></i> Pickup</label>
<label><input type="radio" name="delivery" value="delivery"> <i class="fa fa-truck"></i> Delivery (+GHC 10)</label>
<div class="delivery-address" hidden>
<input type="text" name="address" placeholder="Delivery address" aria-label="Delivery address" />
</div>
</div>

<div class="nutrition-note muted"><i class="fa fa-info-circle"></i> Made fresh — photos are illustrative.</div>
</div>
</div>
</aside>
</div>
</div>


<aside id="cart-drawer" class="drawer cart-drawer" role="dialog" aria-modal="true" aria-labelledby="cart-title" hidden>
<div class="drawer-shell container">
<header class="drawer-head">
<h3 id="cart-title"><i class="fa fa-shopping-cart"></i> Your Cart</h3>
<button class="icon-btn drawer-close" data-action="close-cart" aria-label="Close cart" type="button">
<i class="fa fa-times"></i>
</button>
</header>

<div class="cart-body" aria-live="polite">
<ul class="cart-items" role="list" aria-label="Cart items">
<!-- JS will append <li class="cart-item"> elements here -->
</ul>

<div class="cart-summary">
<div class="cart-row">
<span><i class="fa fa-calculator"></i> Subtotal</span><strong id="cart-subtotal">GHC 0</strong>
</div>
<div class="cart-row">
<span><i class="fa fa-truck"></i> Delivery</span><strong id="cart-delivery">GHC 0</strong>
</div>
<div class="cart-row total">
<span><i class="fa fa-dollar-sign"></i> Total</span><strong id="cart-total">GHC 0</strong>
</div>

<div class="cart-actions">
<!-- Paystack checkout button (data attributes for later JS integration) -->
<button class="btn btn-cta checkout" id="checkout-paystack" data-action="checkout-paystack" data-paystack="true" aria-label="Checkout with Paystack">
<i class="fa fa-wallet"></i> Checkout — Pay with Paystack
</button>

<button class="btn btn-outline clear-cart" data-action="clear-cart"><i class="fa fa-trash"></i> Clear Cart</button>
</div>
</div>
</div>
</div>
</aside>


<div id="manef-chat" class="chat-widget" aria-hidden="false">
<button class="chat-toggle" data-action="toggle-chat" aria-expanded="false" aria-controls="chat-panel" aria-label="Open chat with Manef">
<i class="fa fa-robot" aria-hidden="true"></i>
</button>

<div id="chat-panel" class="chat-panel" hidden role="dialog" aria-label="Manef chat assistant">
<header class="chat-head">
<div class="chat-avatar" aria-hidden="true"><i class="fa fa-user-chef" aria-hidden="true"></i></div>
<div>
<strong>Manef — Virtual Chef</strong>
<div class="muted tiny">Ask about menu, promos, or type "build shawarma"</div>
</div>
<button class="icon-btn" data-action="close-chat" aria-label="Close chat" type="button"><i class="fa fa-times"></i></button>
</header>

<div class="chat-body" aria-live="polite">
<div class="bot-message"><i class="fa fa-robot"></i> Hi! I'm <strong>Manef</strong> — I can help you build your meal.</div>
<div class="chat-messages" role="log"></div>
</div>

<footer class="chat-foot">
<input class="chat-input" type="text" aria-label="Message Manef" placeholder="How can I help? e.g. 'How much is shawarma?'" />
<button class="icon-btn send-chat" data-action="send-chat" aria-label="Send message" type="button"><i class="fa fa-paper-plane"></i></button>
</footer>
</div>
</div>


<section id="testimonials" class="testimonials-section" aria-label="Customer testimonials">
<div class="container">
<h2 class="section-title"><i class="fa fa-comments"></i> What Customers Say</h2>

<div class="testimonials-grid" role="list">
<blockquote class="testimonial" role="listitem">
<p><i class="fa fa-quote-left"></i> “Best shawarma in Tema — fresh and juicy. Delivery was so fast!”</p>
<footer class="muted">— Nana A. <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i></footer>
</blockquote>

<blockquote class="testimonial" role="listitem">
<p><i class="fa fa-quote-left"></i> “Love the build-your-own feature. I always add extra cheese.”</p>
<footer class="muted">— Kofi D. <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i></footer>
</blockquote>

<blockquote class="testimonial" role="listitem">
<p><i class="fa fa-quote-left"></i> “Promos are great. Free Coke with my fries was a win.”</p>
<footer class="muted">— Ama S. <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i></footer>
</blockquote>
</div>
</div>
</section>

<!-- ==============================
ABOUT / WHY US
============================== -->
<section id="about" class="about-section" aria-label="About Wrap District">
<div class="container about-grid">
<div class="about-media" data-img="about-kitchen" role="img" aria-label="Wrap District kitchen photo">
<img src="" alt="Wrap District kitchen" data-artwork="about-kitchen" loading="lazy" />
</div>

<div class="about-content">
<h2><i class="fa fa-seedling"></i> Why Wrap District?</h2>
<p>We blend local flavours with fast, modern service. From freshly sliced meat to house-made sauces, every meal is prepared to delight. Based in Tema Community 25 — serving the neighborhood with pride.</p>

<ul class="features-list" role="list">
<li role="listitem"><i class="fa fa-leaf"></i>
<div><strong>Fresh Ingredients</strong><div class="muted small">Sourced daily</div></div>
</li>

<li role="listitem"><i class="fa fa-tools"></i>
<div><strong>Build Your Meal</strong><div class="muted small">Full customization</div></div>
</li>

<li role="listitem"><i class="fa fa-truck"></i>
<div><strong>Fast Delivery</strong><div class="muted small">Local coverage</div></div>
</li>
</ul>
</div>
</div>
</section>

<!-- ==============================
CONTACT & LOCATION (Paystack references & call)
============================== -->
<section id="contact" class="contact-section" aria-label="Contact and location">
<div class="container contact-inner">
<div class="contact-card">
<h3><i class="fa fa-map-marker-alt"></i> Visit or Order</h3>
<p><strong>Address:</strong> Tema Community 25, Devtraco</p>
<p><strong>Hours:</strong> Mon–Fri: 5pm • Sat–Sun: 9am</p>

<div class="contact-cta">
<!-- Paystack CTA (opens paystack checkout when JS integrated) -->
<button class="btn btn-pay" data-action="open-paystack" aria-label="Order with Paystack"><i class="fa fa-wallet"></i> Order & Pay</button>
<a class="btn btn-outline" href="tel:+233552509241"><i class="fa fa-phone"></i> Call</a>
</div>
</div>

<div class="map-card" aria-hidden="true">
<div class="map-placeholder" data-map="embed" role="img" aria-label="Map placeholder"></div>
</div>
</div>
</section>

<!-- ==============================
FOOTER — icons & paystack note
============================== -->
<footer class="site-footer" role="contentinfo" aria-label="Footer">
<div class="container footer-inner">
<div class="footer-col">
<a class="brand" href="/" aria-label="Wrap District home">
<i class="fa fa-utensils" aria-hidden="true" style="font-size:20px"></i>
<div>
<strong>WRAP DISTRICT</strong>
<div class="muted small">Tema Community 25, Devtraco</div>
</div>
</a>

<div class="contact-lines">
<div class="contact-line"><i class="fa fa-phone"></i> <a href="tel:+233552509241">+233 55 250 9241</a></div>
<div class="contact-line"><i class="fa fa-map-marker"></i> Tema Community 25, Devtraco</div>
</div>
</div>

<div class="footer-col">
<h4><i class="fa fa-link"></i> Quick Links</h4>
<ul class="footer-links" role="list">
<li><a href="#menu"><i class="fa fa-list"></i> Menu</a></li>
<li><a href="#build"><i class="fa fa-tools"></i> Build</a></li>
<li><a href="#promo"><i class="fa fa-gift"></i> Promos</a></li>
<li><a href="#contact"><i class="fa fa-map"></i> Contact</a></li>
</ul>
</div>

<div class="footer-col">
<h4><i class="fa fa-hashtag"></i> Follow</h4>
<div class="socials">
<a class="icon-btn" href="https://instagram.com" aria-label="Instagram"><i class="fa fa-instagram"></i></a>
<a class="icon-btn" href="https://wa.me/233552509241" aria-label="WhatsApp"><i class="fa fa-whatsapp"></i></a>
<a class="icon-btn" href="https://snapchat.com" aria-label="Snapchat"><i class="fa fa-snapchat"></i></a>
</div>

<div class="newsletter">
<label for="newsletter" class="muted"><i class="fa fa-envelope"></i> Get promos & deals</label>
<div class="newsletter-form">
<input id="newsletter" type="email" placeholder="Email address" aria-label="Email address" />
<button class="btn small" type="button"><i class="fa fa-paper-plane"></i> Subscribe</button>
</div>
</div>
</div>
</div>

<div class="container copyright">
<small class="muted">© <span id="year">2025</span> Wrap District. All rights reserved. • Payments via <i class="fa fa-credit-card"></i> Paystack</small>
</div>
</footer>
```

</main>

<!-- ==============================
OVERLAY (used by modal/drawer JS)
============================== -->

<div class="overlay-dim" aria-hidden="true"></div>

  <!-- Build Modal (paste near end of <body>) -->
<div id="build-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="build-title">
  <div class="modal-backdrop" data-action="close"></div>
  <div class="modal-shell" role="document" aria-describedby="build-desc">
    <header class="modal-head">
      <h2 id="build-title">Customize & Build</h2>
      <button class="modal-close" aria-label="Close build modal" data-action="close">&times;</button>
    </header>

    <main class="modal-body">
      <section class="product-row">
        <div class="product-media">
          <img id="build-image" src="" alt="" />
          <input id="build-image-input" type="file" accept="image/*" aria-label="Upload image" />
        </div>

        <div class="product-meta">
          <p id="build-desc" class="muted">Choose options and customize your item.</p>

          <!-- dynamic options area -->
          <div id="build-options" class="options"></div>

          <!-- extras / toggles -->
          <div class="extras">
            <label><input type="checkbox" id="extra-giftwrap" /> Gift wrap (+GHC 5)</label>
          </div>

          <!-- quantity -->
          <div class="qty-row">
            <label for="build-qty">Quantity</label>
            <div class="qty-controls" role="group" aria-label="Quantity">
              <button data-action="qty-dec" aria-label="Decrease quantity">−</button>
              <span id="build-qty" class="qty-value" role="status" aria-live="polite">1</span>
              <button data-action="qty-inc" aria-label="Increase quantity">+</button>
            </div>
          </div>

          <!-- live price -->
          <div class="price-row">
            <div>Price</div>
            <strong id="build-price" aria-live="polite">GHC 0</strong>
          </div>

          <!-- validation / error -->
          <div id="build-error" role="alert" aria-live="assertive" class="hidden"></div>
        </div>
      </section>
    </main>

    <footer class="modal-foot">
      <button class="btn ghost" data-action="close">Cancel</button>
      <button id="build-add" class="btn primary" data-action="add">Add to Cart</button>
    </footer>
  </div>
</div>
<!-- Cart Drawer (paste near end of <body>) -->
<div id="cart-drawer" class="cart-drawer" aria-hidden="true" aria-labelledby="cart-title" role="dialog">
  <div class="cart-backdrop" data-action="close-drawer"></div>
  <aside class="cart-panel" role="document">
    <header class="cart-head">
      <h2 id="cart-title">Your Cart</h2>
      <button class="cart-close" aria-label="Close cart" data-action="close-drawer">&times;</button>
    </header>

    <main class="cart-body" id="cart-body">
      <div id="cart-empty" class="cart-empty">
        <p>Your cart is empty.</p>
        <button class="btn" id="shop-btn">Keep shopping</button>
      </div>

      <ul id="cart-items" class="cart-items" aria-live="polite"></ul>
    </main>

    <footer class="cart-foot">
      <div class="cart-summary">
        <div class="summary-row">
          <span>Subtotal</span>
          <span id="cart-subtotal">GHC 0.00</span>
        </div>
        <div class="summary-row">
          <span>Discount</span>
          <span id="cart-discount">GHC 0.00</span>
        </div>
        <div class="summary-row total">
          <strong>Total</strong>
          <strong id="cart-total">GHC 0.00</strong>
        </div>

        <div class="promo-row">
          <input id="promo-code" type="text" placeholder="Promo code" aria-label="Promo code" />
          <button id="apply-promo" class="btn ghost">Apply</button>
          <div id="promo-msg" class="muted"></div>
        </div>

        <div class="checkout-row">
          <button id="checkout-btn" class="btn primary" disabled>Checkout</button>
        </div>
      </div>
    </footer>
  </aside>
</div>

<!-- Cart badge (example, place in header) -->
<button id="cart-toggle" class="cart-toggle" aria-haspopup="dialog" aria-controls="cart-drawer" aria-label="Open cart">
  Cart <span id="cart-badge" class="cart-badge" aria-live="polite">0</span>
</button>

<!-- Trigger example (put where product cards are) -->
<button class="open-build" data-product='{"id":"p1","name":"Fufu Maker","basePrice":45,"variants":[{"name":"Small","priceDelta":0},{"name":"Large","priceDelta":12}], "image":" /path/to/default.jpg"}'>
  Build
</button>
<!-- MOBILE NAV + OVERLAY (paste once near end of <body>) -->
<div id="mobile-overlay" class="mobile-overlay" hidden aria-hidden="true"></div>

<!-- Mobile nav panel (appended by JS if not present) -->
<nav id="mobile-panel" class="mobile-panel" role="dialog" aria-modal="true" aria-label="Mobile menu" hidden>
  <div class="mobile-panel-inner">
    <header class="mobile-panel-head">
      <a class="brand mobile-brand" href="/" aria-label="Home">
        <div class="logo" aria-hidden="true"><i class="fa fa-utensils"></i></div>
        <div class="brand-text"><strong>WRAP DISTRICT</strong><small>Fresh • Loaded • Fast</small></div>
      </a>
      <button class="icon-btn mobile-close" aria-label="Close menu" type="button"><i class="fa fa-times"></i></button>
    </header>

    <div class="mobile-panel-body">
      <!-- nav-list is cloned here by JS -->
      <div class="mobile-nav-container"></div>

      <div class="mobile-cta">
        <button class="btn btn-cta" data-action="open-cart"><i class="fa fa-shopping-cart"></i> View cart</button>
        <button class="btn btn-outline" data-action="open-paystack"><i class="fa fa-wallet"></i> Order & Pay</button>
      </div>

      <footer class="mobile-panel-foot">
        <small class="muted">© <span id="year-mobile">2025</span> Wrap District</small>
      </footer>
    </div>
  </div>
</nav>
</body>
  <script> 
  /* ===== Manef chat — robust single initializer ===== */
(function(){
  if (window._manef_chat_fixed) return;
  window._manef_chat_fixed = true;

  const LS_KEY = 'manef_chat_history_v2';
  const MAX_HISTORY = 40;

  // ensure widget exists (create if missing)
  let widget = document.getElementById('manef-chat');
  if (!widget) {
    widget = document.createElement('div');
    widget.id = 'manef-chat';
    widget.innerHTML = `
      <button class="chat-toggle" data-action="toggle-chat" aria-expanded="false" aria-label="Open chat">
        <i class="fa fa-robot" aria-hidden="true"></i>
      </button>
      <div id="chat-panel" class="chat-panel" role="dialog" aria-label="Manef chat assistant" hidden>
        <header class="chat-head">
          <div class="chat-avatar" aria-hidden="true"><i class="fa fa-user-chef"></i></div>
          <div style="flex:1">
            <strong>Manef — Virtual Chef</strong>
            <div class="muted tiny">Ask about menu, promos or type "build shawarma"</div>
          </div>
          <button class="icon-btn" data-action="close-chat" aria-label="Close chat"><i class="fa fa-times"></i></button>
        </header>
        <div class="chat-body">
          <div class="chat-messages" role="log" aria-live="polite"></div>
          <div class="chat-suggestions" aria-hidden="false" style="margin-top:6px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="chip btn small">Build Shawarma</button>
            <button class="chip btn small">Promos</button>
            <button class="chip btn small">Menu</button>
          </div>
        </div>
        <footer class="chat-foot">
          <input class="chat-input" type="text" aria-label="Message Manef" placeholder="How can I help? e.g. 'build shawarma'"/>
          <button class="icon-btn send-chat" data-action="send-chat" aria-label="Send"><i class="fa fa-paper-plane"></i></button>
        </footer>
      </div>
    `;
    document.body.appendChild(widget);
  } else {
    // make sure it's direct child of body (avoid stacking issues)
    if (widget.parentElement !== document.body) document.body.appendChild(widget);
  }

  // DOM refs
  const toggle = widget.querySelector('[data-action="toggle-chat"]');
  const panel = widget.querySelector('#chat-panel');
  const chatMessages = panel.querySelector('.chat-messages');
  const chatInput = panel.querySelector('.chat-input');
  const sendBtn = panel.querySelector('[data-action="send-chat"]');
  const closeBtn = panel.querySelector('[data-action="close-chat"]');
  const suggestions = panel.querySelector('.chat-suggestions');

  // remove old listeners safely by cloning elements that might have had handlers
  function replaceNode(el) { if (!el || !el.parentNode) return el; const clone = el.cloneNode(true); el.parentNode.replaceChild(clone, el); return clone; }
  if (toggle) toggle = replaceNode(toggle);
  if (closeBtn) closeBtn = replaceNode(closeBtn);
  if (sendBtn) sendBtn = replaceNode(sendBtn);

  // load history
  function loadHistory(){ try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch(e){ return []; } }
  function saveHistory(arr){ try { localStorage.setItem(LS_KEY, JSON.stringify((arr||[]).slice(-MAX_HISTORY))); } catch(e){} }

  // append message to DOM + persist
  function appendMessage(who, html) {
    if (!chatMessages) return;
    const node = document.createElement('div');
    node.className = `chat-msg ${who === 'user' ? 'user' : 'bot'}`;
    node.innerHTML = `<div class="chat-bubble">${html}</div><div class="chat-meta tiny muted" style="margin-top:6px;font-size:11px">${new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</div>`;
    chatMessages.appendChild(node);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    const h = loadHistory(); h.push({ who, text: html, t: Date.now() }); saveHistory(h);
  }

  function appendPlain(who, text) { appendMessage(who, escapeHtml(text)); }

  // typing indicator
  function showTyping(){ const el = document.createElement('div'); el.className = 'chat-typing bot'; el.innerHTML = `<div class="chat-bubble"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>`; chatMessages.appendChild(el); chatMessages.scrollTop = chatMessages.scrollHeight; return ()=> el.remove(); }

  // escape
  function escapeHtml(s){ if (!s) return ''; return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  // simple rule-based bot handler
  function handleBotQuery(raw) {
    const text = (raw||'').trim().toLowerCase();
    if (!text) return "Tell me what you'd like — e.g., 'build shawarma' or 'how much is fries?'.";
    if (text.includes('menu')) return 'We have Shawarma, Loaded Fries, Angwamo, Fried Rice, Sides & Drinks.';
    if (text.includes('prom')) return 'Promo: Buy 2 Shawarmas, get 1 free — Tuesdays.';
    if (text.includes('shawarma')) {
      if (text.startsWith('build') || text.includes('build')) return { action: 'openBuilder', item: 'shawarma', text: 'Opening builder for Shawarma...' };
      return 'Shawarma: GHC 45 (Regular). Type "build shawarma" to customize.';
    }
    if (text.includes('fries')) {
      if (text.includes('build')) return { action: 'openBuilder', item: 'fries', text: 'Opening builder for Loaded Fries...' };
      return 'Loaded Fries start from GHC 55.';
    }
    if (text.includes('angwamo') || text.includes('angwamo')) {
      if (text.includes('build')) return { action: 'openBuilder', item: 'angwamo', text: 'Opening builder for Angwamo...' };
      return 'Angwamo: Hearty plate — choose combo or plate.';
    }
    if (/how much|price|cost/.test(text)) {
      if (text.includes('shawarma')) return 'Shawarma: GHC 45 — GHC 65 depending on size.';
      if (text.includes('fries')) return 'Loaded Fries: GHC 55 (Single) — GHC 70 (Large).';
      return 'Prices range GHC 8 — GHC 80. Ask for a specific item.';
    }
    // fallback
    return "I can help with building meals, promos, or prices. Try: 'Build shawarma' or 'How much is fries?'.";
  }

  // send user message flow
  function sendUserMessage(txt) {
    if (!txt || !txt.trim()) return;
    const content = escapeHtml(txt);
    appendMessage('user', content);
    chatInput.value = '';
    const stopTyping = showTyping();
    setTimeout(()=> {
      try {
        const result = handleBotQuery(txt);
        stopTyping();
        if (!result) { appendPlain('bot', "Sorry — I didn't get that."); return; }
        if (typeof result === 'string') appendPlain('bot', result);
        else if (typeof result === 'object') {
          appendPlain('bot', result.text || 'Okay...');
          if (result.action === 'openBuilder' && result.item && typeof window.openBuilder === 'function') {
            setTimeout(()=> {
              try { window.openBuilder(result.item); } catch(e){ console.warn('openBuilder failed', e); }
            }, 300);
          }
        }
      } catch (err) {
        stopTyping();
        appendPlain('bot', 'Oops — something went wrong.');
        console.error(err);
      }
    }, 450 + Math.random()*450);
  }

  // restore history
  (function restore(){
    try {
      const h = loadHistory();
      if (!h || !h.length) { appendPlain('bot', "Hi — I'm Manef. Ask me about menu, promos, or type 'build shawarma'."); return; }
      h.forEach(m => {
        // show last 40
        appendMessage(m.who, escapeHtml(m.text));
      });
      // small re-greeting if last message older than 24h
      const last = h[h.length-1];
      if (last && (Date.now() - (last.t || 0) > 1000*60*60*24)) appendPlain('bot', "Welcome back! Ask about today's promos or 'build shawarma'.");
    } catch(e) { appendPlain('bot', "Hi — I'm Manef. Ask me about menu, promos, or type 'build shawarma'."); }
  })();

  // event wiring
  toggle.addEventListener('click', (ev) => {
    ev.preventDefault();
    const isOpen = !(panel.hidden || panel.getAttribute('hidden') === 'true' || panel.style.display === 'none');
    if (isOpen) {
      panel.hidden = true;
      toggle.setAttribute('aria-expanded','false');
    } else {
      panel.hidden = false;
      toggle.setAttribute('aria-expanded','true');
      setTimeout(()=> (chatInput && chatInput.focus()), 60);
    }
  });

  closeBtn && closeBtn.addEventListener('click', (ev) => {
    ev.preventDefault();
    panel.hidden = true;
    toggle.setAttribute('aria-expanded','false');
    toggle.focus();
  });

  // send button
  sendBtn && sendBtn.addEventListener('click', (ev) => {
    ev.preventDefault();
    const v = chatInput.value || '';
    if (!v.trim()) return;
    sendUserMessage(v);
  });

  // enter key on input (no shift)
  chatInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); const v = chatInput.value || ''; if (!v.trim()) return; sendUserMessage(v); }
    if (e.key === 'Escape') { panel.hidden = true; toggle.setAttribute('aria-expanded','false'); toggle.focus(); }
  });

  // chips / suggestions
  suggestions.addEventListener('click', (e) => {
    const chip = e.target.closest('.chip');
    if (!chip) return;
    const txt = chip.textContent.trim();
    if (/build shawarma/i.test(txt)) { appendMessage('user', 'Build shawarma'); if (typeof window.openBuilder === 'function') { appendPlain('bot','Opening builder for Shawarma...'); setTimeout(()=> window.openBuilder('shawarma'), 200); } return; }
    if (/promos/i.test(txt)) { appendMessage('user', 'Promos'); appendPlain('bot','Promo: Buy 2 Shawarmas get 1 free — Tuesdays.'); return; }
    if (/menu/i.test(txt)) { appendMessage('user','Menu'); appendPlain('bot','Menu: Shawarma, Loaded Fries, Angwamo, Fried Rice, Sides & Drinks.'); return; }
  });

  // expose helpers
  window.ManefChat = {
    sendUserMessage, appendMessage, open: ()=>{ panel.hidden = false; toggle.setAttribute('aria-expanded','true'); chatInput.focus(); }, close: ()=>{ panel.hidden = true; toggle.setAttribute('aria-expanded','false'); },
    clearHistory: ()=>{ saveHistory([]); chatMessages.innerHTML=''; appendPlain('bot', "Hi — I'm Manef. Ask me about menu, promos, or type 'build shawarma'."); }
  };

  console.info('Manef chat fixed & initialized.');
})();
  </script>
<script>
(function () {
'use strict';

/* =========================
LOCAL IMAGE MAP (update filenames here if different)
These point to files in the same folder as your HTML.
Use exact filenames (case-sensitive on many hosts).
========================= */
const IMAGES = {
// hero slides
'hero-shawarma-large': 'hero-shawarma-large.jpg',
'hero-fries-large' : 'hero-fries-large.jpg',
  'hero-angwamo-large' : 'hero-angwamo-large.jpg',

// promo collage
'promo-shawarma' : 'promo-shawarma.jpg',
'promo-fries' : 'promo-fries.jpg',
'promo-angwamo' : 'hero-shawarma-large.jpg',

// thumbnails used in picks / menu
'thumb-shawarma' : 'thumb-shawarma.jpg',
'thumb-fries' : 'thumb-fries.jpg',
'thumb-angwamo' : 'hero-angwamo-large.jpg',
'thumb-rice' : 'hero-friedrice-large.jpg',
'thumb-dessert'      : 'promo-shawarma.jpg',
'thumb-drink'        : 'promo-fries.jpg',

// other previews / about / avatar
'hero-friedrice-large': 'hero-friedrice-large.jpg',
'preview-shawarma' : 'hero-shawarma-large.jpg',
'about-kitchen' : 'thumb-shawarma.jpg',
'manef-avatar' : 'thumb-shawarma.jpg'
};

/* Fallback remote images (used only if local file fails to load) */
const FALLBACKS = {
'hero-shawarma-large': 'https://images.unsplash.com/photo-1604908554325-1ff3a7b1b0f8?q=80&w=1400&auto=format&fit=crop',
'hero-fries-large': 'https://images.unsplash.com/photo-1542444459-db0b8c7dfb3a?q=80&w=1400&auto=format&fit=crop',
'hero-angwamo-large': 'https://images.unsplash.com/photo-1627308595229-7830a5c91f9f?q=80&w=1400&auto=format&fit=crop',
'promo-shawarma': 'https://images.unsplash.com/photo-1604908554325-1ff3a7b1b0f8?q=80&w=1000&auto=format&fit=crop',
'promo-fries': 'https://images.unsplash.com/photo-1542444459-db0b8c7dfb3a?q=80&w=1000&auto=format&fit=crop',
'thumb-shawarma': 'https://images.unsplash.com/photo-1604908554325-1ff3a7b1b0f8?q=80&w=600&auto=format&fit=crop',
'thumb-fries': 'https://images.unsplash.com/photo-1542444459-db0b8c7dfb3a?q=80&w=600&auto=format&fit=crop',
'thumb-angwamo': 'https://images.unsplash.com/photo-1627308595229-7830a5c91f9f?q=80&w=600&auto=format&fit=crop',
'thumb-rice': 'https://images.unsplash.com/photo-1604754521116-9c6a1a2bde9a?q=80&w=600&auto=format&fit=crop',
'about-kitchen': 'https://images.unsplash.com/photo-1541542684-32e1077b2a3e?q=80&w=1200&auto=format&fit=crop',
'preview': 'https://images.unsplash.com/photo-1604908554325-1ff3a7b1b0f8?q=80&w=1200&auto=format&fit=crop',
'thumb-dessert': 'https://images.unsplash.com/photo-1505250469679-203ad9ced0cb?q=80&w=600&auto=format&fit=crop',
'thumb-drink': 'https://images.unsplash.com/photo-1505576391880-7a6b6d6a6f5d?q=80&w=600&auto=format&fit=crop',
'thumb-side': 'https://images.unsplash.com/photo-1498837167922-ddd27525d352?q=80&w=600&auto=format&fit=crop'
};

/* =========================
Small utilities
========================= */
const $ = (sel, ctx = document) => ctx.querySelector(sel);
const $$ = (sel, ctx = document) => Array.from((ctx || document).querySelectorAll(sel));
const on = (el, ev, fn, opts) => el && el.addEventListener(ev, fn, opts);
const esc = s => String(s || '').replace(/[&<>"']/g, c => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[c]));
const fmt = (n) => `GHC ${Number(n).toFixed(2)}`;
const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
const noop = () => {};
const now = () => Date.now();

/* =========================
Image loader:
- Try local file from IMAGES map first (path like './file.jpg')
- If load fails (404), fallback to remote FALLBACKS
- Works for <img> elements and elements that want background-image
- Uses onload/onerror to set final value
========================= */
function resolveLocalOrFallback(key) {
const local = IMAGES[key] || IMAGES[key.replace(/-large$|_large$/,'')] || null;
const fallback = FALLBACKS[key] || '';
return { local, fallback };
}

function applyImageToElement(el, key) {
if (!key || !el) return;
const { local, fallback } = resolveLocalOrFallback(key);

// prefer local; test by trying to load the local path
const tryLocal = (path) => {
if (!path) return Promise.reject('no-local');
return new Promise((resolve, reject) => {
const img = new Image();
img.onload = () => resolve(path);
img.onerror = () => reject('local-fail');
img.src = path;
});
};

// pick setter depending on element type
const setSrc = (url) => {
if (el.tagName && el.tagName.toLowerCase() === 'img') {
el.src = url;
} else {
// background image with subtle overlay for better contrast
const overlay = 'linear-gradient(120deg, rgba(0,0,0,0.12), rgba(0,0,0,0.04))';
el.style.backgroundImage = `${overlay}, url('${url}')`;
el.style.backgroundSize = el.style.backgroundSize || 'cover';
el.style.backgroundPosition = el.style.backgroundPosition || 'center';
}
};

// Try local then fallback
tryLocal(local || '').then(setSrc).catch(() => {
if (fallback) setSrc(fallback);
else if (local) setSrc(local); // as last resort try setting local directly (maybe server error not caught)
});
}

/* Walk document for data attributes and set images */
function applyAllArtwork() {
// data-img elements (used for background blocks)
$$('[data-img]').forEach(el => {
const key = el.dataset.img;
applyImageToElement(el, key);
if (!el.getAttribute('aria-label')) el.setAttribute('aria-label', (key || '').replace(/[-_]/g, ' '));
});

// images with data-artwork or data-thumb
$$('img[data-artwork], img[data-thumb]').forEach(img => {
const key = img.dataset.artwork || img.dataset.thumb;
applyImageToElement(img, key);
});

// non-img elements with data-artwork/data-thumb (background images)
$$('[data-artwork], [data-thumb]').filter(el => el.tagName.toLowerCase() !== 'img').forEach(el => {
const key = el.dataset.artwork || el.dataset.thumb;
applyImageToElement(el, key);
});
}

/* =========================
Simple localStorage helpers and app state
========================= */
const CART_KEY = 'wrapdistrict_cart_v3';
const FAV_KEY = 'wrapdistrict_favs_v1';

function load(key) {
try { const raw = localStorage.getItem(key); return raw ? JSON.parse(raw) : null; } catch (e) { return null; }
}
function save(key, val) {
try { localStorage.setItem(key, JSON.stringify(val)); } catch (e) { /* ignore */ }
}

let cart = load(CART_KEY) || [];
let favs = load(FAV_KEY) || {};

function cartCount() { return cart.reduce((s, it) => s + (it.qty || 0), 0); }
function cartSubtotal() { return cart.reduce((s, it) => s + (it.unitPrice * (it.qty || 1)), 0); }
function deliveryFee() { return cart.length ? 10 : 0; }
function cartTotal() { return cartSubtotal() + deliveryFee(); }

function persistCart() { save(CART_KEY, cart); updateCartBadge(); renderMiniCartTotal(); renderCartDrawer(); }

/* =========================
UI: toast
========================= */
let _toastTimer = null;
function toast(msg, ms = 2200) {
let el = document.querySelector('.wrap-toaster');
if (!el) {
el = document.createElement('div');
el.className = 'wrap-toaster';
Object.assign(el.style, {
position: 'fixed', right: '16px', bottom: '20px', zIndex: 9999, background: 'rgba(0,0,0,0.7)',
color: '#fff', padding: '10px 14px', borderRadius: '10px', fontWeight: 700, fontSize: '14px'
});
document.body.appendChild(el);
}
el.textContent = msg;
el.classList.add('visible');
if (_toastTimer) clearTimeout(_toastTimer);
_toastTimer = setTimeout(() => el.classList.remove('visible'), ms);
}

/* =========================
Cart rendering / mini-cart
========================= */
function updateCartBadge() {
const badge = $('#cart-count');
if (!badge) return;
badge.textContent = String(cartCount());
badge.setAttribute('data-count', String(cartCount()));
badge.classList.add('pulse');
setTimeout(() => badge.classList.remove('pulse'), 700);
}

function renderMiniCartTotal() {
const el = $('#mini-cart-total');
if (el) el.textContent = fmt(cartSubtotal());
}

function renderCartDrawer() {
const drawer = $('#cart-drawer');
if (!drawer) return;
const list = drawer.querySelector('.cart-items');
if (!list) return;
list.innerHTML = '';
cart.forEach((it, idx) => {
const li = document.createElement('li');
li.className = 'cart-item';
li.dataset.index = idx;
li.innerHTML = `
  <img src="${esc(it.image || '')}" alt="${esc(it.name)}" onerror="this.src='${IMAGES['thumb-shawarma'] || ''}'" />
  <div class="details">
    <strong class="name">${esc(it.name)}</strong>
    <div class="desc">${esc(it.optionsSummary || '')}</div>
  </div>
  <div class="meta">
    <div class="price">${fmt(it.unitPrice)}</div>
    <div class="qty-controls" role="group" aria-label="Quantity controls">
      <button type="button" data-action="qty-dec">−</button>
      <div class="qty-value">${it.qty}</div>
      <button type="button" data-action="qty-inc">+</button>
    </div>
    <button class="remove-item" data-index="${idx}" aria-label="Remove item"><i class="fa fa-trash"></i></button>
  </div>
`;

list.appendChild(li);
});

$('#cart-subtotal').textContent = fmt(cartSubtotal());
$('#cart-delivery').textContent = fmt(deliveryFee());
$('#cart-total').textContent = fmt(cartTotal());
}

function addToCartObj(item) {
const key = (item.id || '') + '|' + (item.optionsSummary || '');
const found = cart.find(c => ((c.id || '') + '|' + (c.optionsSummary || '')) === key);
if (found) found.qty = (found.qty || 0) + (item.qty || 1);
else cart.push(Object.assign({ qty: 1 }, item));
persistCart();
toast('Added to cart');
}

function removeCartIndex(idx) {
if (idx < 0 || idx >= cart.length) return;
cart.splice(idx, 1);
persistCart();
toast('Removed item');
}

function clearCart() {
cart = [];
persistCart();
toast('Cart cleared');
}

/* =========================
CATALOG (same as your original)
========================= */
const CATALOG = {
dessert: { id: 'dessert', name: 'Dessert', sizes: [{ id: 'std', label: 'Standard', price: 25 }], proteins: [], fillings: [], sauces: [] },
drink: { id: 'drink', name: 'Drink', sizes: [{ id: 'bottle', label: 'Bottle', price: 10 }], proteins: [], fillings: [], sauces: [] },
side: { id: 'side', name: 'Side', sizes: [{ id: 'single', label: 'Single', price: 8 }], proteins: [], fillings: [], sauces: [] }
};

  /* ===== Enhanced CATALOG entries (paste after your original CATALOG to override) ===== */

CATALOG.shawarma = {
  id: 'shawarma',
  name: 'Shawarma',
  previewImageKey: 'preview-shawarma',
  sizes: [
    { id: 'regular', label: 'Regular', price: 45, imageKey: 'thumb-shawarma' },
    { id: 'jumbo',   label: 'Jumbo',   price: 65, imageKey: 'hero-shawarma-large' }
  ],
  proteins: [
    { id: 'chicken', label: 'Chicken', price: 0,  imageKey: 'thumb-chicken' },
    { id: 'beef',    label: 'Beef',    price: 10, imageKey: 'thumb-beef' },
    { id: 'turkey',  label: 'Turkey',  price: 8,  imageKey: 'thumb-turkey' }
  ],
  fillings: [
    { id: 'lettuce',  label: 'Lettuce',     price: 0, imageKey: 'opt-lettuce' },
    { id: 'cheese',   label: 'Cheese',      price: 5, imageKey: 'opt-cheese' },
    { id: 'egg',      label: 'Egg',         price: 6, imageKey: 'opt-egg' },
    { id: 'baconbits',label: 'Bacon Bits',  price: 6, imageKey: 'opt-bacon-bits' },
    { id: 'extra-cheese', label: 'Extra Cheese', price: 5, imageKey: 'opt-extra-cheese' }
  ],
  sauces: [
    { id: 'garlic', label: 'Garlic Mayo', imageKey: 'opt-mayo' },
    { id: 'bbq',    label: 'BBQ Sauce',   imageKey: 'opt-bbq' },
    { id: 'peri',   label: 'Peri-Peri',   imageKey: 'opt-peri' }
  ]
};

CATALOG.fries = {
  id: 'fries',
  name: 'Loaded Fries',
  previewImageKey: 'promo-fries',
  sizes: [
    { id: 'single', label: 'Single', price: 55, imageKey: 'thumb-fries' },
    { id: 'large',  label: 'Large',  price: 70, imageKey: 'hero-fries-large' }
  ],
  proteins: [
    { id: 'none',    label: 'No protein', price: 0,  imageKey: 'thumb-fries' },
    { id: 'bacon',   label: 'Bacon',      price: 12, imageKey: 'thumb-bacon' },
    { id: 'chicken', label: 'Chicken',    price: 10, imageKey: 'thumb-chicken' }
  ],
  fillings: [
    { id: 'cheese',   label: 'Cheese',   price: 4, imageKey: 'opt-cheese' },
    { id: 'jalapeno', label: 'Jalapeño', price: 3, imageKey: 'opt-jalapeno' },
    { id: 'garlic',   label: 'Garlic Mayo', price: 0, imageKey: 'opt-mayo' },
    { id: 'baconbits',label: 'Bacon Bits', price: 6, imageKey: 'opt-bacon-bits' },
    { id: 'extra-cheese', label: 'Extra Cheese', price: 5, imageKey: 'opt-extra-cheese' }
  ],
  sauces: [
    { id: 'cheese-sauce', label: 'Cheese Sauce', imageKey: 'opt-cheese-sauce' },
    { id: 'garlic-mayo',  label: 'Garlic Mayo',  imageKey: 'opt-mayo' }
  ]
};

CATALOG.angwamo = {
  id: 'angwamo',
  name: 'Loaded Angwamo',
  previewImageKey: 'hero-angwamo-large',
  sizes: [
    { id: 'plate', label: 'Plate', price: 55, imageKey: 'thumb-angwamo' },
    { id: 'combo', label: 'Combo', price: 70, imageKey: 'hero-angwamo-large' }
  ],
  proteins: [
    { id: 'chicken', label: 'Chicken', price: 0,  imageKey: 'thumb-chicken' },
    { id: 'beef',    label: 'Beef',    price: 10, imageKey: 'thumb-beef' }
  ],
  fillings: [
    { id: 'egg',      label: 'Egg',     price: 0, imageKey: 'opt-egg' },
    { id: 'coleslaw', label: 'Coleslaw',price: 5, imageKey: 'opt-coleslaw' },
    { id: 'plantain', label: 'Plantain',price: 4, imageKey: 'opt-plantain' }
  ],
  sauces: [
    { id: 'spicy', label: 'Spicy', imageKey: 'opt-spicy' },
    { id: 'mild',  label: 'Mild',  imageKey: 'opt-mild' }
  ]
};

CATALOG.rice = {
  id: 'rice',
  name: 'Fried Rice',
  previewImageKey: 'hero-friedrice-large',
  sizes: [
    { id: 'regular', label: 'Regular', price: 60, imageKey: 'thumb-rice' },
    { id: 'extra',   label: 'Extra',   price: 80, imageKey: 'hero-friedrice-large' }
  ],
  proteins: [
    { id: 'chicken', label: 'Chicken', price: 0,  imageKey: 'thumb-chicken' },
    { id: 'beef',    label: 'Beef',    price: 12, imageKey: 'thumb-beef' }
  ],
  fillings: [
    { id: 'veg',   label: 'Veg',   price: 0, imageKey: 'opt-veg' },
    { id: 'peas',  label: 'Peas',  price: 0, imageKey: 'opt-peas' }
  ],
  sauces: [
    { id: 'soy',       label: 'Soya',       imageKey: 'opt-soy' },
    { id: 'sweet-chili', label: 'Sweet Chili', imageKey: 'opt-s-chili' }
  ]
};
/* =========================
Builder modal logic
========================= */
const builderModal = $('#builder-modal');
let builderState = null;

function openBuilder(itemKey) {
const cfg = CATALOG[itemKey];
if (!cfg) { toast('Item not available'); return; }
builderState = {
itemKey,
size: cfg.sizes[0].id,
protein: (cfg.proteins && cfg.proteins[0]) ? cfg.proteins[0].id : null,
fillings: new Set(),
sauces: new Set(),
qty: 1,
delivery: 'pickup'
};
/* ===== Enhanced option tiles (with price badge + pop animation) ===== */
function renderOptionTiles(panelName, optionsArray, singleSelect = true) {
  const grid = document.querySelector(`[data-step-panel="${panelName}"] .options-grid`);
  if (!grid) return;
  grid.innerHTML = '';
  grid.classList.add('option-tiles-grid');

  optionsArray.forEach(opt => {
    const card = document.createElement('button');
    card.type = 'button';
    card.className = 'option-card';
    card.dataset.optType = panelName;
    card.dataset.optId = opt.id;
    if (opt.price) card.dataset.optPrice = opt.price;
    if (opt.imageKey) card.dataset.imageKey = opt.imageKey;
    card.setAttribute('role', 'button');
    card.setAttribute('aria-pressed', 'false');

    // Build inner markup: media container + badge + meta
    card.innerHTML = `
      <div class="option-media-wrap" style="position:relative;">
        <div class="option-media" aria-hidden="true"></div>
      </div>
      <div class="option-meta">
        <div class="option-title">${esc(opt.label)}</div>
        <div class="option-sub">${opt.price ? '+ ' + fmt(opt.price) : (opt.price === 0 ? 'Included' : '')}</div>
      </div>
    `;

    // Price badge (absolute, over image) if price > 0
    if (opt.price && Number(opt.price) > 0) {
      const badge = document.createElement('div');
      badge.className = 'price-badge';
      badge.innerText = `+GHC ${Number(opt.price).toFixed(0)}`;
      card.querySelector('.option-media-wrap').appendChild(badge);
    }

    // image insertion (use your helper so fallback logic works)
    const mediaEl = card.querySelector('.option-media');
    applyImageToElement(mediaEl, opt.imageKey || '');

    /* Selection logic */
    card.addEventListener('click', (e) => {
      e.preventDefault();

      if (singleSelect) {
        // deselect siblings
        Array.from(grid.querySelectorAll('.option-card')).forEach(c => {
          c.classList.remove('selected', 'pop');
          c.setAttribute('aria-pressed', 'false');
        });
        // select this
        card.classList.add('selected', 'pop');
        card.setAttribute('aria-pressed', 'true');

        // update builder state
        if (panelName === 'size') builderState.size = opt.id;
        else if (panelName === 'protein') builderState.protein = opt.id;

      } else {
        // multi-select toggle
        const nowSel = card.classList.toggle('selected');
        // restart pop animation
        card.classList.remove('pop');
        void card.offsetWidth;
        card.classList.add('pop');
        card.setAttribute('aria-pressed', String(nowSel));

        if (!builderState[panelName]) builderState[panelName] = new Set();
        if (nowSel) builderState[panelName].add(opt.id);
        else builderState[panelName].delete(opt.id);
      }

      // update preview and gallery
      updateBuilderPreview();
      updatePreviewGallery(opt);
    });

    // keyboard activation
    card.addEventListener('keydown', (ev) => {
      if (ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); card.click(); }
    });

    grid.appendChild(card);
  });
}

function closeBuilder() {
if (!builderModal) return;
builderModal.hidden = true;
builderModal.setAttribute('aria-hidden', 'true');
document.documentElement.classList.remove('no-scroll');
releaseFocus(builderModal);
builderState = null;
}

function populateBuilder(cfg) {
const title = $('#builder-title');
if (title) title.innerHTML = `<i class="fa fa-tools"></i> Build: ${esc(cfg.name)}`;

// hide panels first
$$('[data-step-panel]').forEach(panel => panel.hidden = true);

// sizes
const sizeGrid = $('[data-step-panel="size"] .options-grid');
if (sizeGrid) {
sizeGrid.innerHTML = '';
(cfg.sizes || []).forEach(s => {
const btn = document.createElement('button');
btn.type = 'button';
btn.className = 'option';
btn.dataset.optType = 'size';
btn.dataset.optId = s.id;
btn.dataset.optPrice = s.price;
btn.innerHTML = `<strong>${esc(s.label)}</strong><div class="muted small">${fmt(s.price)}</div>`;
if (s.id === builderState.size) btn.classList.add('selected');
btn.addEventListener('click', () => {
builderState.size = s.id;
sizeGrid.querySelectorAll('.option').forEach(x => x.classList.remove('selected'));
btn.classList.add('selected');
updateBuilderPreview();
});
sizeGrid.appendChild(btn);
});
}

// proteins
const proteinGrid = $('[data-step-panel="protein"] .options-grid');
if (proteinGrid) {
proteinGrid.innerHTML = '';
(cfg.proteins || []).forEach(p => {
const btn = document.createElement('button');
btn.type = 'button';
btn.className = 'option';
btn.dataset.optType = 'protein';
btn.dataset.optId = p.id;
btn.dataset.optPrice = p.price || 0;
btn.innerHTML = `<strong>${esc(p.label)}</strong><div class="muted small">${p.price ? '+ ' + fmt(p.price) : 'Included'}</div>`;
if (p.id === builderState.protein) btn.classList.add('selected');
btn.addEventListener('click', () => {
builderState.protein = p.id;
proteinGrid.querySelectorAll('.option').forEach(x => x.classList.remove('selected'));
btn.classList.add('selected');
updateBuilderPreview();
});
proteinGrid.appendChild(btn);
});
}

// fillings (multi)
const fillingsGrid = $('[data-step-panel="fillings"] .options-grid');
if (fillingsGrid) {
fillingsGrid.innerHTML = '';
(cfg.fillings || []).forEach(f => {
const btn = document.createElement('button');
btn.type = 'button';
btn.className = 'option';
btn.dataset.optType = 'fillings';
btn.dataset.optId = f.id;
btn.dataset.optPrice = f.price || 0;
btn.innerHTML = `<span>${esc(f.label)}</span><div class="muted small">${f.price ? '+ ' + fmt(f.price) : ''}</div>`;
if (builderState.fillings.has(f.id)) btn.classList.add('selected');
btn.addEventListener('click', () => {
if (builderState.fillings.has(f.id)) { builderState.fillings.delete(f.id); btn.classList.remove('selected'); }
else { builderState.fillings.add(f.id); btn.classList.add('selected'); }
updateBuilderPreview();
});
fillingsGrid.appendChild(btn);
});
}

// sauces
const saucesGrid = $('[data-step-panel="sauces"] .options-grid');
if (saucesGrid) {
saucesGrid.innerHTML = '';
(cfg.sauces || []).forEach(s => {
const btn = document.createElement('button');
btn.type = 'button';
btn.className = 'option';
btn.dataset.optType = 'sauces';
btn.dataset.optId = s.id;
btn.innerHTML = `<span>${esc(s.label)}</span>`;
if (builderState.sauces.has(s.id)) btn.classList.add('selected');
btn.addEventListener('click', () => {
if (builderState.sauces.has(s.id)) { builderState.sauces.delete(s.id); btn.classList.remove('selected'); }
else { builderState.sauces.add(s.id); btn.classList.add('selected'); }
updateBuilderPreview();
});
saucesGrid.appendChild(btn);
});
}

// qty
const qtyDisplay = $('.qty-value');
if (qtyDisplay) qtyDisplay.textContent = String(builderState.qty);
on($('.qty-inc'), 'click', () => {
builderState.qty = clamp(builderState.qty + 1, 1, 99);
const d = $('.qty-value'); if (d) d.textContent = builderState.qty; updateBuilderPreview();
});
on($('.qty-dec'), 'click', () => {
builderState.qty = clamp(builderState.qty - 1, 1, 99);
const d = $('.qty-value'); if (d) d.textContent = builderState.qty; updateBuilderPreview();
});

// delivery radios
document.querySelectorAll('#builder-modal input[name="delivery"]').forEach(r => {
r.checked = r.value === 'pickup';
r.onchange = (ev) => {
builderState.delivery = ev.target.value;
const addr = $('.delivery-address');
if (addr) addr.hidden = (builderState.delivery !== 'delivery');
updateBuilderPreview();
};
});

// preview image
const previewImg = $('[data-preview-image] img');
if (previewImg) {
// use preview-shawarma if present, else lookup by name
const previewKey = 'preview-shawarma';
applyImageToElement(previewImg, previewKey);
}
}

function gotoBuilderStep(step) {
$$('.builder-stepper .step').forEach(s => s.classList.toggle('active', s.dataset.step === step));
$$('[data-step-panel]').forEach(p => p.hidden = (p.dataset.stepPanel !== step));
}
$$('.builder-stepper .step').forEach(s => on(s, 'click', () => gotoBuilderStep(s.dataset.step)));

function updateBuilderPreview() {
if (!builderState) return;
const cfg = CATALOG[builderState.itemKey];
if (!cfg) return;
const sizeObj = (cfg.sizes || []).find(s => s.id === builderState.size) || cfg.sizes[0];
const proteinObj = (cfg.proteins || []).find(p => p.id === builderState.protein) || { price: 0 };
let unit = (sizeObj ? sizeObj.price : 0) + (proteinObj ? (proteinObj.price || 0) : 0);
(cfg.fillings || []).forEach(f => { if (builderState.fillings.has(f.id)) unit += (f.price || 0); });
const total = (unit + (builderState.delivery === 'delivery' ? 10 : 0)) * builderState.qty;
const previewPriceEl = $('.preview-price');
if (previewPriceEl) previewPriceEl.textContent = fmt(total);
const qtyEl = $('.qty-value'); if (qtyEl) qtyEl.textContent = String(builderState.qty);
}

/* Add to cart (from builder or quick add) */
document.addEventListener('click', (e) => {
const btn = e.target.closest('[data-action="add-to-cart"], [data-action="add-to-cart"] *');
if (!btn) return;
// If builder open -> use builderState
if (builderState) {
const cfg = CATALOG[builderState.itemKey];
const sizeObj = (cfg.sizes || []).find(s => s.id === builderState.size) || cfg.sizes[0];
const proteinObj = (cfg.proteins || []).find(p => p.id === builderState.protein) || { label: '' };
let unit = (sizeObj ? sizeObj.price : 0) + (proteinObj ? (proteinObj.price || 0) : 0);
const fillingsArr = (cfg.fillings || []).filter(f => builderState.fillings.has(f.id)).map(f => f.label);
const saucesArr = (cfg.sauces || []).filter(s => builderState.sauces.has(s.id)).map(s => s.label);
(cfg.fillings || []).forEach(f => { if (builderState.fillings.has(f.id)) unit += (f.price || 0); });
const optionsSummary = [
`Size: ${sizeObj.label}`,
proteinObj.label ? `Protein: ${proteinObj.label}` : null,
fillingsArr.length ? `Fillings: ${fillingsArr.join(', ')}` : null,
saucesArr.length ? `Sauces: ${saucesArr.join(', ')}` : null,
builderState.delivery === 'delivery' ? 'Delivery' : 'Pickup'
].filter(Boolean).join(' • ');
addToCartObj({
id: `${builderState.itemKey}-${now()}`,
name: cfg.name,
qty: builderState.qty,
unitPrice: Number(unit.toFixed(2)),
optionsSummary,
meta: { size: sizeObj, protein: proteinObj, fillings: fillingsArr, sauces: saucesArr }
});
closeBuilder();
return;
}

// fallback: add by data-item or closest menu item
const element = e.target.closest('[data-action="add-to-cart"]');
const itemKey = element && (element.dataset.item || element.closest('.pick')?.dataset.id || element.closest('.menu-item')?.dataset.category || element.closest('.menu-item')?.dataset.id);
if (!itemKey) { toast('Cannot add item — no item specified.'); return; }
const cfg = CATALOG[itemKey];
if (!cfg) { addToCartObj({ id: `${itemKey}-${now()}`, name: itemKey, qty: 1, unitPrice: Number(element.dataset.price || 0), optionsSummary: 'Default' }); return; }
const defaultSize = cfg.sizes[0];
addToCartObj({ id: `${itemKey}-${now()}`, name: cfg.name, qty: 1, unitPrice: Number(defaultSize.price), optionsSummary: defaultSize.label });
});

/* =========================
Quick actions: quick-order, open-builder, view-cart, clear-cart
========================= */
document.addEventListener('click', (e) => {
const quick = e.target.closest('[data-action="quick-order"], [data-action="quick-order"] *');
if (quick) {
e.preventDefault();
const item = quick.dataset.item || quick.closest('.pick')?.dataset.id;
if (!item) { toast('No item selected'); return; }
const cfg = CATALOG[item];
if (!cfg) { toast('Item not available'); return; }
const size = cfg.sizes[0];
addToCartObj({ id: `${item}-${now()}`, name: cfg.name, qty: 1, unitPrice: size.price, optionsSummary: size.label });
openCartDrawer();
return;
}

const openBuilderBtn = e.target.closest('[data-action="open-builder"], [data-action="open-builder"] *');
if (openBuilderBtn) {
e.preventDefault();
const item = openBuilderBtn.dataset.item || openBuilderBtn.closest('.pick')?.dataset.id;
if (!item) { toast('No item to build'); return; }
openBuilder(item);
return;
}

const viewCart = e.target.closest('[data-action="view-cart"], [data-action="view-cart"] *');
if (viewCart) { e.preventDefault(); openCartDrawer(); return; }

const clear = e.target.closest('[data-action="clear-cart"], .clear-cart, [data-action="clear-cart"] *');
if (clear) { e.preventDefault(); if (confirm('Clear your cart?')) clearCart(); return; }
});

/* remove item from cart */
on(document, 'click', (e) => {
const rm = e.target.closest('.remove-item');
if (!rm) return;
const idx = Number(rm.dataset.index);
removeCartIndex(idx);
});

/* =========================
Cart drawer open / close helpers
========================= */
function openCartDrawer() {
const drawer = $('#cart-drawer');
if (!drawer) return;
drawer.hidden = false;
drawer.setAttribute('aria-hidden', 'false');
document.documentElement.classList.add('no-scroll');
renderCartDrawer();
const close = drawer.querySelector('.drawer-close'); if (close) close.focus();
}
function closeCartDrawer() {
const drawer = $('#cart-drawer');
if (!drawer) return;
drawer.hidden = true;
drawer.setAttribute('aria-hidden', 'true');
document.documentElement.classList.remove('no-scroll');
}
$$('.drawer-close, [data-action="close-cart"]').forEach(b => on(b, 'click', (ev) => { ev.preventDefault(); closeCartDrawer(); }));

/* =========================
Favorites
========================= */
document.addEventListener('click', (e) => {
const favBtn = e.target.closest('[data-action="fav"], [data-action="fav"] *');
if (!favBtn) return;
const button = favBtn.closest('[data-action="fav"]') || favBtn;
const article = button.closest('.menu-item, .pick');
const id = article && (article.dataset.id || article.dataset.id || article.dataset.id);
if (!id) { toast('Cannot favourite this item'); return; }
favs[id] = !favs[id];
save(FAV_KEY, favs);
button.classList.toggle('favored', !!favs[id]);
toast(favs[id] ? 'Added to favourites' : 'Removed from favourites');
});

// init fav buttons
$$('[data-action="fav"]').forEach(btn => {
const article = btn.closest('.menu-item, .pick');
const id = article && (article.dataset.id || article.dataset.id || article.dataset.id);
if (id && favs[id]) btn.classList.add('favored');
});

/* =========================
Filters (menu)
========================= */
$$('.filter').forEach(btn => on(btn, 'click', () => {
const key = btn.dataset.filter;
$$('.filter').forEach(x => x.classList.toggle('active', x === btn));
const items = $$('.menu-item');
items.forEach(it => {
const cat = it.dataset.category || 'all';
const show = key === 'all' ? true : (cat === key);
it.style.display = show ? '' : 'none';
});
}));

/* =========================
Search
========================= */
on($('.search-btn'), 'click', () => {
const q = prompt('Search menu — enter a word (e.g. shawarma):');
if (!q) return;
const txt = q.trim().toLowerCase();
if (!txt) return;
const candidates = $$('[data-id], .menu-item, .pick');
const found = candidates.find(c => (c.dataset.id || c.textContent || '').toLowerCase().includes(txt));
if (found) {
found.scrollIntoView({ behavior: 'smooth', block: 'center' });
found.classList.add('pulse-highlight');
setTimeout(() => found.classList.remove('pulse-highlight'), 1200);
toast('Found match');
} else {
toast('No match found');
}
});

/* =========================
Hero carousel
========================= */
function initCarousel() {
const carousel = document.querySelector('[data-carousel]');
if (!carousel) return;
const slides = Array.from(carousel.querySelectorAll('.hero-slide'));
const dots = Array.from(carousel.querySelectorAll('.carousel-dots .dot'));
const prev = carousel.querySelector('[data-carousel-prev]');
const next = carousel.querySelector('[data-carousel-next]');
let active = slides.findIndex(s => s.getAttribute('aria-hidden') === 'false' || s.classList.contains('active'));
if (active < 0) active = 0;
let timer = null;
const AUTO_MS = 4500;

function show(i) {
i = (i + slides.length) % slides.length;
slides.forEach((s, idx) => {
const hidden = idx !== i;
s.setAttribute('aria-hidden', hidden ? 'true' : 'false');
s.classList.toggle('active', !hidden);
});
dots.forEach((d, idx) => {
d.classList.toggle('active', idx === i);
d.setAttribute('aria-selected', idx === i ? 'true' : 'false');
});
active = i;
}

function prevSlide(e) { e && e.preventDefault(); show(active - 1); resetTimer(); }
function nextSlide(e) { e && e.preventDefault(); show(active + 1); resetTimer(); }

on(prev, 'click', prevSlide);
on(next, 'click', nextSlide);
dots.forEach((d, i) => on(d, 'click', (ev) => { ev.preventDefault(); show(i); resetTimer(); }));

carousel.addEventListener('mouseenter', () => { if (timer) clearInterval(timer); });
carousel.addEventListener('mouseleave', resetTimer);
carousel.addEventListener('touchstart', () => { if (timer) clearInterval(timer); }, { passive: true });
carousel.addEventListener('touchend', resetTimer);

slides.forEach(s => {
const media = s.querySelector('.slide-image') || s.querySelector('.slide-media');
if (!media) return;
let rect = null;
s.addEventListener('pointermove', ev => {
rect = s.getBoundingClientRect();
const px = ((ev.clientX - rect.left) / rect.width - 0.5) * 12;
const py = ((ev.clientY - rect.top) / rect.height - 0.5) * 10;
media.style.transform = `translate3d(${px}px, ${py}px, 0) scale(1.02)`;
});
s.addEventListener('pointerleave', () => { media.style.transform = ''; });
});

document.addEventListener('keydown', (e) => {
if (e.key === 'ArrowLeft') prevSlide();
else if (e.key === 'ArrowRight') nextSlide();
});

show(active);
resetTimer();

function resetTimer() {
if (timer) clearInterval(timer);
timer = setInterval(() => show(active + 1), AUTO_MS);
}
}

/* =========================
Parallax stickers
========================= */
function initParallaxStickers() {
const hero = $('#hero');
if (!hero) return;
const layers = Array.from(hero.querySelectorAll('.hero-bg-layer'));
function move() {
const top = hero.getBoundingClientRect().top;
layers.forEach((l, i) => {
const speed = (i + 1) * 0.03;
l.style.transform = `translateY(${Math.round(-top * speed)}px)`;
});
}
window.addEventListener('scroll', throttle(move, 16), { passive: true });
move();

$$('.hero-stickers .sticker').forEach((st, idx) => {
st.animate([
{ transform: 'translateY(0) rotate(0deg)' },
{ transform: 'translateY(-8px) rotate(4deg)' },
{ transform: 'translateY(0) rotate(0deg)' }
], { duration: 2600 + idx * 300, iterations: Infinity, easing: 'ease-in-out' });
});
}

function throttle(fn, t) {
let last = 0;
return function (...a) {
const nowTime = Date.now();
if (nowTime - last > t) { last = nowTime; fn.apply(this, a); }
};
}

/* =========================
Mobile hamburger nav
========================= */
(function initMobileNav() {
const burger = $('.hamburger');
if (!burger) return;
burger.addEventListener('click', () => {
const isOpen = document.documentElement.classList.toggle('mobile-nav-open');
burger.setAttribute('aria-expanded', String(isOpen));
if (isOpen) {
const first = $('.main-nav .nav-link');
first && first.focus();
}
});
})();

/* =========================
Chat (Manef) simple handler
========================= */
(function initChat() {
const toggle = document.querySelector('[data-action="toggle-chat"], .chat-toggle');
const panel = $('#chat-panel');
const chatMessages = panel?.querySelector('.chat-messages');
const chatInput = panel?.querySelector('.chat-input');
if (!toggle || !panel || !chatMessages || !chatInput) return;

toggle.addEventListener('click', () => {
const open = !panel.hidden;
panel.hidden = open;
toggle.setAttribute('aria-expanded', String(!open));
if (!open) setTimeout(() => chatInput.focus(), 50);
});

document.querySelectorAll('[data-action="close-chat"]').forEach(b => on(b, 'click', () => { panel.hidden = true; toggle.setAttribute('aria-expanded', 'false'); }));

function append(who, text) {
const node = document.createElement('div');
node.className = `chat-msg ${who === 'user' ? 'user' : 'bot'}`;
node.innerHTML = text;
chatMessages.appendChild(node);
chatMessages.scrollTop = chatMessages.scrollHeight;
}

append('bot', "Hello! I'm <strong>Manef</strong> — I can help with menu, promos, or 'build shawarma'.");

function handleBot(text) {
const t = (text || '').toLowerCase();
if (t.includes('shawarma')) { append('bot', 'Shawarma: GHC 45–80. Type \"build shawarma\" to customize.'); return; }
if (t.includes('fries')) { append('bot', 'Loaded Fries start at GHC 55. Type \"build fries\" to customize.'); return; }
if (t.includes('build') && t.includes('shawarma')) { append('bot', 'Opening builder for shawarma...'); openBuilder('shawarma'); return; }
if (t.includes('promo') || t.includes('free') || t.includes('tuesday')) { append('bot', 'Promo: Buy 2 Shawarmas, get 1 free — Tuesdays.'); return; }
append('bot', "I can help with menu, builders, promos or checkout. Try: 'Build shawarma'.");
}

chatInput.addEventListener('keydown', (e) => {
if (e.key === 'Enter') {
const txt = chatInput.value.trim();
if (!txt) return;
append('user', esc(txt));
chatInput.value = '';
setTimeout(() => handleBot(txt), 400 + Math.random() * 600);
}
});
$$('.send-chat').forEach(b => on(b, 'click', () => {
const txt = chatInput.value.trim();
if (!txt) return;
append('user', esc(txt));
chatInput.value = '';
setTimeout(() => handleBot(txt), 400 + Math.random() * 600);
}));
})();

/* =========================
PAYSTACK stub
========================= */
function buildOrderSummary() {
if (!cart.length) return 'Cart is empty';
const lines = cart.map(it => `${it.qty} x ${it.name} (${it.optionsSummary || 'Default'}) — ${fmt(it.unitPrice)}`);
const sub = fmt(cartSubtotal());
const del = fmt(deliveryFee());
const tot = fmt(cartTotal());
return `${lines.join('\n')}\n\nSubtotal: ${sub}\nDelivery: ${del}\nTotal: ${tot}`;
}

function openPaystackCheckout({ email = '', amountGhc = null, reference = null } = {}) {
const description = encodeURIComponent(buildOrderSummary());
const url = `https://paystack.com/pay/checkout-placeholder?amount=${amountGhc ? encodeURIComponent(amountGhc) : ''}&ref=${reference || ''}&desc=${description}&email=${encodeURIComponent(email)}`;
window.open(url, '_blank', 'noopener');
toast('Opening Paystack checkout...');
}

document.addEventListener('click', (e) => {
const payBtn = e.target.closest('[data-paystack], [data-action="checkout-paystack"], [data-action="open-paystack"], .btn-pay');
if (!payBtn) return;
e.preventDefault();

if (payBtn.dataset.action === 'buy-now' && builderState) {
const cfg = CATALOG[builderState.itemKey];
if (!cfg) { toast('Builder item not found'); return; }
const sizeObj = (cfg.sizes || []).find(s => s.id === builderState.size) || cfg.sizes[0];
const proteinObj = (cfg.proteins || []).find(p => p.id === builderState.protein) || { price: 0 };
let unit = (sizeObj ? sizeObj.price : 0) + (proteinObj ? (proteinObj.price || 0) : 0);
(cfg.fillings || []).forEach(f => { if (builderState.fillings.has(f.id)) unit += (f.price || 0); });
const total = (unit + (builderState.delivery === 'delivery' ? 10 : 0)) * builderState.qty;
openPaystackCheckout({ amountGhc: total, reference: `builder-${now()}` });
return;
}

if (payBtn.dataset.action === 'checkout-paystack' || payBtn.dataset.action === 'open-paystack' || payBtn.classList.contains('btn-pay')) {
if (!cart.length) { toast('Cart is empty'); return; }
openPaystackCheckout({ amountGhc: cartTotal(), reference: `cart-${now()}` });
return;
}

if (payBtn.dataset.paystack) {
openPaystackCheckout({ amountGhc: cartTotal(), reference: `pay-${now()}` });
}
});

/* =========================
Checkout click
========================= */
on(document, 'click', (e) => {
const checkout = e.target.closest('[data-action="checkout"], .checkout');
if (!checkout) return;
e.preventDefault();
if (!cart.length) { toast('Cart is empty'); return; }
openPaystackCheckout({ amountGhc: cartTotal(), reference: `cart-${now()}` });
});

/* =========================
Focus trap helpers
========================= */
function trapFocus(modal) {
if (!modal) return;
const focusables = modal.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');
const first = focusables[0];
const last = focusables[focusables.length - 1];
function keyHandler(e) {
if (e.key !== 'Tab') return;
if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
}
modal._trapHandler = keyHandler;
modal.addEventListener('keydown', keyHandler);
setTimeout(() => first && first.focus(), 10);
}
function releaseFocus(modal) {
if (!modal || !modal._trapHandler) return;
modal.removeEventListener('keydown', modal._trapHandler);
modal._trapHandler = null;
}

/* =========================
Misc helpers & keyboard handling
========================= */
document.addEventListener('keydown', (e) => {
if (e.key === 'Escape') {
if (builderModal && !builderModal.hidden) closeBuilder();
const drawer = $('#cart-drawer'); if (drawer && !drawer.hidden) closeCartDrawer();
const chat = $('#chat-panel'); if (chat && !chat.hidden) { chat.hidden = true; const tog = document.querySelector('.chat-toggle'); tog && tog.setAttribute('aria-expanded', 'false'); }
if (document.documentElement.classList.contains('mobile-nav-open')) {
document.documentElement.classList.remove('mobile-nav-open');
const burger = $('.hamburger'); burger && burger.setAttribute('aria-expanded', 'false');
}
}
});

$$('.modal [data-action="close-builder"], .icon-btn[data-action="close-builder"]').forEach(b => on(b, 'click', (ev) => { ev.preventDefault(); closeBuilder(); }));

$$('.cart-btn, [data-action="open-cart"]').forEach(b => on(b, 'click', (ev) => { ev.preventDefault(); openCartDrawer(); }));
$$('.mini-cart .btn[data-action="view-cart"]').forEach(b => on(b, 'click', (ev) => { ev.preventDefault(); openCartDrawer(); }));

/* set year in footer */
const yearEl = $('#year'); if (yearEl) yearEl.textContent = new Date().getFullYear();

/* =========================
Bootstrap initialization
========================= */
function bootstrap() {
updateCartBadge();
renderMiniCartTotal();
renderCartDrawer();
initCarousel();
initParallaxStickers();
// set images (local-first with fallback)
applyAllArtwork();

// ensure click targets show pointer on some elements if missing
$$('button, a').forEach(el => { if (!el.style.cursor) el.style.cursor = 'pointer'; });

// overlay click closes modal/drawer
const overlay = document.querySelector('.overlay-dim');
if (overlay) {
overlay.addEventListener('click', () => {
closeBuilder(); closeCartDrawer();
overlay.classList.remove('active');
});
}

// subtle reveal for slides
const slides = $$('[data-carousel] .hero-slide');
if (slides.length) {
slides.forEach((s, i) => {
const hidden = s.getAttribute('aria-hidden') !== 'false';
s.style.opacity = hidden ? '0' : '1';
s.style.transition = 'opacity 420ms ease, transform 420ms ease';
});
}
}

if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', bootstrap);
else bootstrap();

/* Expose some helpers in console for debugging */
window.WrapDistrict = {
cart, addToCartObj, removeCartIndex, clearCart, openCartDrawer, closeCartDrawer, openBuilder, closeBuilder, buildOrderSummary, openPaystackCheckout, IMAGES
};

console.info('Wrap District script loaded — images will use local files when present.');
})();
</script>
<script>
(function () {
  // elements we want to ensure are direct children of <body>
  const selectors = [
    '.overlay-dim',       // overlay
    '.drawer',            // cart drawer(s)
    '#cart-drawer',
    '.modal',             // builder modal(s)
    '#builder-modal',
    '#manef-chat',        // chat widget
    '.wrap-toaster'       // toaster if present
  ];

  function moveToBody(sel) {
    const el = document.querySelector(sel);
    if (!el) return;
    // only move when not already direct child of body
    if (el.parentElement && el.parentElement.tagName.toLowerCase() !== 'body') {
      try {
        // preserve next-sibling to maintain visual order if needed
        document.body.appendChild(el);
        el.style.willChange = el.style.willChange || 'transform, opacity';
        // ensure fixed positioning after move
        el.style.position = el.style.position || 'fixed';
      } catch (err) {
        // ignore; not critical
        console.warn('moveToBody failed for', sel, err);
      }
    }
  }

  // run after small delay to ensure DOM and other scripts finished their initial setup
  window.addEventListener('load', () => {
    selectors.forEach(s => moveToBody(s));
    // also run a micro-task to catch elements added later
    setTimeout(() => selectors.forEach(s => moveToBody(s)), 300);
  });
})();
</script>
<script>
(function(){
  // ensure chat element is a direct child of body (prevents stacking-context issues)
  const chat = document.querySelector('#manef-chat');
  if (chat && chat.parentElement !== document.body) {
    document.body.appendChild(chat);
  }

  // robust toggle behavior: open/close and focus input when opened
  const toggle = document.querySelector('#manef-chat .chat-toggle');
  const panel = document.querySelector('#chat-panel') || document.querySelector('#manef-chat .chat-panel');
  const input = panel?.querySelector('.chat-input');

  function openChat() {
    if (!panel) return;
    panel.hidden = false;
    panel.removeAttribute('hidden');
    toggle.setAttribute('aria-expanded', 'true');
    setTimeout(()=> input?.focus(), 80);
  }
  function closeChat() {
    if (!panel) return;
    panel.hidden = true;
    panel.setAttribute('hidden', 'true');
    toggle.setAttribute('aria-expanded', 'false');
  }

  if (toggle && panel) {
    toggle.addEventListener('click', () => {
      if (panel.hidden) openChat(); else closeChat();
    });
    // close buttons already exist; ensure they call closeChat
    document.querySelectorAll('[data-action="close-chat"], .icon-btn[data-action="close-chat"]').forEach(b => {
      b.addEventListener('click', closeChat);
    });
  }
})();
</script>
<script>
(function(){
  const container = document.querySelector('.menu-filters');
  if(!container) return;

  // Build button array
  const buttons = Array.from(container.querySelectorAll('.filter'));
  if(!buttons.length) return;

  // Ensure container role
  container.setAttribute('role','tablist');

  // Create & append indicator element
  let indicator = container.querySelector('.filter-indicator');
  if(!indicator){
    indicator = document.createElement('div');
    indicator.className = 'filter-indicator hidden';
    container.appendChild(indicator);
  }

  // Helper: activate a button visually + aria + performs filtering
  function activateButton(btn, focus=false, suppressFilterRun=false){
    buttons.forEach(b=>{
      const is = (b === btn);
      b.classList.toggle('active', is);
      b.setAttribute('aria-selected', is ? 'true' : 'false');
      b.setAttribute('tabindex', is ? '0' : '-1');
    });
    updateIndicator();

    // if we shouldn't run filter logic here (because original click will), return
    if(suppressFilterRun) return;

    // Run same filtering logic as original site for compatibility:
    const key = btn.dataset.filter;
    const items = Array.from(document.querySelectorAll('.menu-item'));
    items.forEach(it => {
      const cat = it.dataset.category || 'all';
      const show = (key === 'all') ? true : (cat === key);
      it.style.display = show ? '' : 'none';
    });

    if(focus) btn.focus();
  }

  // Position the indicator under active button
  function updateIndicator(){
    const active = container.querySelector('.filter.active') || buttons[0];
    if(!active) { indicator.classList.add('hidden'); return; }
    const rect = active.getBoundingClientRect();
    const parentRect = container.getBoundingClientRect();
    const left = rect.left - parentRect.left + container.scrollLeft;
    indicator.style.left = (left) + 'px';
    indicator.style.width = rect.width + 'px';
    indicator.classList.remove('hidden');
  }

  // Attach events
  buttons.forEach((btn, idx) => {
    // set roles and initial aria/tabindex
    btn.setAttribute('role','tab');
    const isActive = btn.classList.contains('active');
    btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
    btn.setAttribute('tabindex', isActive ? '0' : '-1');

    // click -> activate (suppress duplicate filter run if original click listener also runs)
    btn.addEventListener('click', (ev) => {
      // original page code may handle filtering on click; we still sync aria + indicator.
      activateButton(btn, false, true);
      // then trigger original handler by dispatching a click event that allows other listeners to run:
      // (but don't cause infinite loops — dispatch only if current event wasn't synthetic)
      // We'll call filter behavior directly to avoid double toggling
      const key = btn.dataset.filter;
      const items = Array.from(document.querySelectorAll('.menu-item'));
      items.forEach(it => {
        const cat = it.dataset.category || 'all';
        const show = (key === 'all') ? true : (cat === key);
        it.style.display = show ? '' : 'none';
      });
    });

    // keyboard accessibility: left/right move focus, Enter/Space activate
    btn.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight' || e.key === 'Right') {
        e.preventDefault();
        const next = buttons[(idx + 1) % buttons.length];
        next.focus();
      } else if (e.key === 'ArrowLeft' || e.key === 'Left') {
        e.preventDefault();
        const prev = buttons[(idx - 1 + buttons.length) % buttons.length];
        prev.focus();
      } else if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        btn.click();
      }
    });

    // keep indicator updated if user focuses with tab
    btn.addEventListener('focus', () => {
      updateIndicator();
    });
  });

  // reposition on resize or scroll (container might be scrollable)
  window.addEventListener('resize', () => requestAnimationFrame(updateIndicator));
  container.addEventListener('scroll', () => requestAnimationFrame(updateIndicator));

  // initial indicator placement
  setTimeout(updateIndicator, 80);
})();
</script>
<script>
  // Carousel sanity/restart helper
(function(){
  const stage = document.querySelector('[data-carousel]');
  if (!stage) { console.warn('No carousel stage found'); return; }

  const slides = Array.from(stage.querySelectorAll('.hero-slide'));
  console.log('Carousel found, slides count =', slides.length);

  // Make sure one slide is active and aria-hidden is set consistently
  let activeIndex = slides.findIndex(s => s.classList.contains('active') || s.getAttribute('aria-hidden') === 'false');
  if (activeIndex < 0) activeIndex = 0;

  slides.forEach((s, idx) => {
    const isActive = idx === activeIndex;
    s.classList.toggle('active', isActive);
    s.setAttribute('aria-hidden', isActive ? 'false' : 'true');
    s.style.opacity = isActive ? '1' : '0';
  });
  console.log('Set active slide to index', activeIndex);

  // Try to re-init carousel timer if needed (simple safe auto-advance)
  if (window._wrapdistrict_carousel_timer) {
    clearInterval(window._wrapdistrict_carousel_timer);
    window._wrapdistrict_carousel_timer = null;
  }
  const AUTO_MS = 4500;
  window._wrapdistrict_carousel_timer = setInterval(()=>{
    const current = slides.findIndex(s => s.classList.contains('active'));
    const next = (current + 1) % slides.length;
    slides.forEach((s, i) => {
      const show = (i === next);
      s.classList.toggle('active', show);
      s.setAttribute('aria-hidden', show ? 'false' : 'true');
      s.style.opacity = show ? '1' : '0';
    });
  }, AUTO_MS);
  console.log('Carousel auto-advance (safe) started with', AUTO_MS,'ms');
})();

  // check controls
(function(){
  const prev = document.querySelector('[data-carousel-prev]');
  const next = document.querySelector('[data-carousel-next]');
  const dots = Array.from(document.querySelectorAll('[data-carousel-dots] .dot'));
  console.log('prev exists?', !!prev, 'next exists?', !!next, 'dots count', dots.length);
  // simulate clicks safely (no-op if element not found)
  if(prev) { console.log('prev bounding rect:', prev.getBoundingClientRect()); }
  if(next) { console.log('next bounding rect:', next.getBoundingClientRect()); }
  dots.forEach((d,i)=> console.log('dot', i, 'rect', d.getBoundingClientRect(), 'aria-selected', d.getAttribute('aria-selected')));
})();
// ensure cart-body scroll + focus on open
(function(){
  const openBtns = document.querySelectorAll('[data-action="open-cart"], .cart-btn, .mini-cart .btn[data-action="view-cart"]');
  openBtns.forEach(b => b.addEventListener('click', () => {
    const shell = document.querySelector('#cart-drawer .drawer-shell');
    const body = document.querySelector('#cart-drawer .cart-body');
    // ensure safe max height (mobile)
    if (shell) shell.style.maxHeight = Math.min(window.innerHeight, document.documentElement.clientHeight) + 'px';
    setTimeout(() => {
      if (body) body.scrollTo({ top: 0, behavior: 'smooth' });
      const checkout = document.querySelector('#cart-drawer .checkout');
      if (checkout) checkout.focus({ preventScroll: true });
    }, 120);
  }));
})();

</script>
  <script>
    /* ===== Builder UI enhancers: progress, nav, live breakdown ===== */
(function(){
  // avoid running before builder elements exist
  function $qs(sel, ctx=document){ return ctx.querySelector(sel); }
  function $qa(sel, ctx=document){ return Array.from(ctx.querySelectorAll(sel)); }

  const modal = $qs('#builder-modal');
  if (!modal) return;

  // inject progress bar under stepper (idempotent)
  if (!$qs('.builder-progress', modal)) {
    const prog = document.createElement('div');
    prog.className = 'builder-progress';
    prog.innerHTML = '<i style="width:0%"></i>';
    const stepper = $qs('.builder-stepper', modal);
    if (stepper) stepper.after(prog);
  }

  // inject actionbar if missing
  if (!$qs('.builder-actionbar', modal)) {
    const action = document.createElement('div');
    action.className = 'builder-actionbar';
    action.innerHTML = `
      <button type="button" class="btn btn-outline back-step" aria-label="Previous step">Back</button>
      <button type="button" class="btn btn-outline save-fave" aria-label="Save preset">Save</button>
      <button type="button" class="btn btn-cta next-step" aria-label="Next step">Next</button>
      <button type="button" class="btn btn-pay confirm-add" aria-label="Add to cart">Add to Cart</button>
    `;
    // append to left column (end) so it sits inside modal-left; if not found append to modal-shell
    const leftCol = $qs('.modal-left', modal) || $qs('.modal-shell', modal);
    leftCol.appendChild(action);
  }

  const steps = $qa('.builder-stepper .step', modal);
  const panels = $qa('[data-step-panel]', modal);
  const progressBar = $qs('.builder-progress > i', modal);
  const actionBar = $qs('.builder-actionbar', modal);
  const backBtn = $qs('.back-step', modal);
  const nextBtn = $qs('.next-step', modal);
  const saveBtn = $qs('.save-fave', modal);
  const addBtn = $qs('.confirm-add', modal);
  const previewPriceEl = $qs('.preview-price', modal) || $qs('.preview-price', document);
  const previewBreakdownParent = document.createElement('div');
  previewBreakdownParent.className = 'preview-price-breakdown';
  previewBreakdownParent.innerHTML = '<div class="line"><span class="muted">Base</span><span class="base-val">GHC 0</span></div><div class="line"><span class="muted">Extras</span><span class="extras-val">GHC 0</span></div><div class="line"><span>Total</span><strong class="total-val">GHC 0</strong></div>';
  // append breakdown to modal-right preview-info area if exists
  const previewInfo = $qs('.modal-right .preview-info', modal) || $qs('.modal-right', modal);
  if (previewInfo && !previewInfo.querySelector('.preview-price-breakdown')) {
    previewInfo.appendChild(previewBreakdownParent);
  }

  // helper: set active step by index or name
  function setActiveStep(idOrIndex) {
    let idx = typeof idOrIndex === 'number' ? idOrIndex : steps.findIndex(s => s.dataset.step === idOrIndex);
    idx = Math.max(0, Math.min(steps.length - 1, idx));
    // mark step UI
    steps.forEach((s, i) => s.classList.toggle('active', i === idx));
    // show/hide panels
    panels.forEach(p => p.hidden = (p.dataset.stepPanel !== steps[idx].dataset.step));
    // update progress width
    const pct = Math.round(((idx) / (steps.length - 1)) * 100);
    if (progressBar) progressBar.style.width = pct + '%';
    // update action buttons state
    backBtn.disabled = (idx === 0);
    nextBtn.disabled = (idx === steps.length - 1);
    addBtn.style.display = (idx === steps.length - 1) ? '' : 'none';
    nextBtn.style.display = (idx === steps.length - 1) ? 'none' : '';
  }

  // when clicking stepper items
  steps.forEach((s, i) => {
    s.addEventListener('click', () => {
      setActiveStep(i);
      // move focus to first interactive in panel
      const panel = $qs(`[data-step-panel="${s.dataset.step}"]`, modal);
      const focusable = panel && panel.querySelector('button, [role="button"], input, select, textarea');
      if (focusable) focusable.focus();
    });
  });

  // Back / Next semantics with validation
  backBtn.addEventListener('click', () => {
    const cur = steps.findIndex(s => s.classList.contains('active'));
    setActiveStep(cur - 1);
  });

  nextBtn.addEventListener('click', () => {
    const cur = steps.findIndex(s => s.classList.contains('active'));
    // validate required selection on current panel (e.g., size required)
    const curStepName = steps[cur].dataset.step;
    const valid = validateStep(curStepName);
    if (!valid) {
      // flash a toast / highlight required options
      const panel = $qs(`[data-step-panel="${curStepName}"]`, modal);
      if (panel) {
        panel.animate([{ transform: 'translateX(-6px)' }, { transform: 'translateX(6px)' }, { transform: 'translateX(0)' }], { duration: 320 });
      }
      return;
    }
    setActiveStep(cur + 1);
  });

  // Add to cart: reuse existing UI action that your code expects (calls addToCartObj via data-action)
  addBtn.addEventListener('click', () => {
    const addTrigger = $qs('.preview-actions [data-action="add-to-cart"], .preview-actions .btn.btn-cta', modal) || $qs('[data-action="add-to-cart"]');
    if (addTrigger) addTrigger.click();
  });

  // Save favorite preset (stores in localStorage under builder_presets)
  saveBtn.addEventListener('click', () => {
    try {
      // derive a compact preset from builderState (global var from your code)
      const st = window.builderState || (window.WrapDistrict && window.WrapDistrict.builderState);
      if (!st) { toast('No builder state to save'); return; }
      const presets = JSON.parse(localStorage.getItem('builder_presets_v1') || '[]');
      presets.unshift({ id: 'p_' + Date.now(), name: `${st.itemKey} — ${st.size}`, state: st });
      localStorage.setItem('builder_presets_v1', JSON.stringify(presets.slice(0,6)));
      toast('Saved preset');
    } catch (err) { console.warn(err); toast('Cannot save preset'); }
  });

  // basic validation (ensure size chosen; you can extend with required protein rules)
  function validateStep(stepName) {
    if (!window.builderState) return true;
    if (stepName === 'size') {
      return !!builderState.size; // must choose size
    }
    // other rules could be added: require protein for certain items, etc.
    return true;
  }

  // Live price breakdown update: hook into your updateBuilderPreview by wrapping it
  const origUpdate = window.updateBuilderPreview;
  window.updateBuilderPreview = function wrappedUpdate() {
    try {
      if (typeof origUpdate === 'function') origUpdate();
    } catch (err) { console.warn('origUpdate error', err); }
    // compute breakdown from builderState & catalog (similar to your updateBuilderPreview logic)
    try {
      const st = window.builderState;
      if (!st) return;
      const cfg = window.CATALOG && window.CATALOG[st.itemKey];
      if (!cfg) return;
      const sizeObj = (cfg.sizes || []).find(s => s.id === st.size) || { price: 0 };
      const proteinObj = (cfg.proteins || []).find(p => p.id === st.protein) || { price: 0 };
      let base = Number((sizeObj.price || 0) + (proteinObj.price || 0));
      let extras = 0;
      (cfg.fillings || []).forEach(f => { if (st.fillings && st.fillings.has(f.id)) extras += (f.price || 0); });
      const delivery = (st.delivery === 'delivery' ? 10 : 0);
      const qty = st.qty || 1;
      const total = (base + extras + delivery) * qty;
      // update preview elements
      const breakdown = $qs('.preview-price-breakdown', modal);
      if (breakdown) {
        breakdown.querySelector('.base-val').textContent = fmt(base * qty);
        breakdown.querySelector('.extras-val').textContent = fmt(extras * qty + delivery * qty);
        breakdown.querySelector('.total-val').textContent = fmt(total);
      }
      // pulse animation for main preview price
      const pEl = previewPriceEl;
      if (pEl) {
        pEl.classList.add('pulse');
        setTimeout(()=> pEl.classList.remove('pulse'), 280);
      }
      // also update hidden preview values already used by checkout
      const previewPriceText = $qs('.preview-price', modal);
      if (previewPriceText) previewPriceText.textContent = fmt(total);
    } catch (err) { console.warn('breakdown update failed', err); }
  };

  // Initial set to step 0
  setActiveStep(0);

  // keyboard support: Enter triggers next if focus inside an option group
  modal.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      // if focus inside modal-left and not on input/button, forward to next
      const fk = document.activeElement;
      if (modal.contains(fk) && (!fk.matches || !fk.matches('button,input,textarea,select,a'))) {
        e.preventDefault(); nextBtn.click();
      }
    }
  });

  // expose a debug helper
  window._builder_ui = { setActiveStep };

})();

  </script>
  <script>
    /* ===== mobile helpers: add .is-mobile, adjust full-height for drawers ===== */
(function(){
  function applyMobileClass() {
    const m = window.matchMedia('(max-width:720px)').matches;
    document.documentElement.classList.toggle('is-mobile', m);
  }
  applyMobileClass();
  window.addEventListener('resize', function(){
    applyMobileClass();
    // adjust cart drawer max height if open
    const shell = document.querySelector('#cart-drawer .drawer-shell');
    if (shell && document.documentElement.classList.contains('is-mobile')) {
      // use innerHeight (mobile safe area)
      shell.style.height = Math.min(window.innerHeight, document.documentElement.clientHeight) + 'px';
    } else if (shell) {
      shell.style.height = ''; // reset for desktop
    }
  });

  // ensure mobile cart opens as bottom-sheet (some browsers need a transform reset)
  document.addEventListener('click', (e) => {
    const openCart = e.target.closest('[data-action="open-cart"], .cart-btn, [data-action="view-cart"]');
    if (!openCart) return;
    setTimeout(() => {
      const shell = document.querySelector('#cart-drawer .drawer-shell');
      if (!shell) return;
      if (document.documentElement.classList.contains('is-mobile')) {
        shell.style.maxHeight = Math.min(window.innerHeight, document.documentElement.clientHeight) + 'px';
        // ensure body isn't scrollable under the sheet
        document.documentElement.classList.add('no-scroll');
      } else {
        shell.style.maxHeight = '';
        document.documentElement.classList.remove('no-scroll');
      }
    }, 80);
  });

  // when user closes cart, restore scroll state
  document.querySelectorAll('[data-action="close-cart"], .drawer-close').forEach(b => b.addEventListener('click', ()=>{
    document.documentElement.classList.remove('no-scroll');
  }));
})();

  </script>
  <script>
/* ===== Manef Chat — robust replacement initializer ===== */
(function(){
  'use strict';

  // Avoid double-init
  if (window._manef_chat_initialized) return;
  window._manef_chat_initialized = true;

  // helpers
  const $ = (s, ctx=document) => ctx.querySelector(s);
  const $$ = (s, ctx=document) => Array.from((ctx||document).querySelectorAll(s));
  const now = () => new Date().toISOString();
  const fmt = (n) => (typeof n === 'number') ? `GHC ${n.toFixed(2)}` : n;

  // ensure widget exists
  let widget = document.getElementById('manef-chat');
  if (!widget) {
    console.warn('Manef chat widget not found — aborting enhanced chat init.');
    return;
  }

  // ensure widget is direct child of body to avoid stacking-context issues
  if (widget.parentElement !== document.body) document.body.appendChild(widget);

  // find or create panel and toggle
  let toggle = widget.querySelector('[data-action="toggle-chat"], .chat-toggle');
  let panel = document.getElementById('chat-panel') || widget.querySelector('.chat-panel');

  // If panel element not found, create a minimal one (fallback)
  if (!panel) {
    panel = document.createElement('div');
    panel.id = 'chat-panel';
    panel.className = 'chat-panel';
    panel.setAttribute('role','dialog');
    panel.setAttribute('aria-label','Manef chat assistant');
    panel.hidden = true;
    panel.innerHTML = `
      <header class="chat-head">
        <div class="chat-avatar"><i class="fa fa-user-chef"></i></div>
        <div><strong>Manef — Virtual Chef</strong><div class="muted tiny">Ask about menu, promos, or type "build shawarma"</div></div>
        <button class="icon-btn" data-action="close-chat" aria-label="Close chat"><i class="fa fa-times"></i></button>
      </header>
      <div class="chat-body"><div class="chat-messages" role="log" aria-live="polite"></div></div>
      <footer class="chat-foot">
        <input class="chat-input" type="text" aria-label="Message Manef" placeholder="How can I help? e.g. 'build shawarma'"/>
        <button class="icon-btn send-chat" data-action="send-chat" aria-label="Send"><i class="fa fa-paper-plane"></i></button>
      </footer>
    `;
    widget.appendChild(panel);
  }

  // If toggle missing, create one so users have a bubble
  if (!toggle) {
    toggle = document.createElement('button');
    toggle.className = 'chat-toggle';
    toggle.setAttribute('aria-label','Open chat with Manef');
    toggle.innerHTML = '<i class="fa fa-robot"></i>';
    widget.insertBefore(toggle, widget.firstChild);
  }

  // Remove previous listeners by cloning interactive nodes (safe teardown)
  function replaceNode(el) {
    try {
      const clone = el.cloneNode(true);
      el.parentNode.replaceChild(clone, el);
      return clone;
    } catch (e) { return el; }
  }
  toggle = replaceNode(toggle);
  const oldCloseButtons = $$('.chat-panel [data-action="close-chat"], #manef-chat [data-action="close-chat"]', document);
  oldCloseButtons.forEach(b => replaceNode(b));

  // query inner elements
  const chatMessages = panel.querySelector('.chat-messages') || (panel.querySelector('.chat-body') && panel.querySelector('.chat-body').appendChild(document.createElement('div')));
  const chatInput = panel.querySelector('.chat-input');
  const sendBtn = panel.querySelector('[data-action="send-chat"], .send-chat');
  const closeBtns = $$('.chat-panel [data-action="close-chat"], .icon-btn[data-action="close-chat"]', panel);

  // Store messages in localStorage (last 20)
  const LS_KEY = 'manef_chat_history_v1';
  function loadHistory(){ try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); } catch(e){ return []; } }
  function saveHistory(arr){ try { localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(-20))); } catch(e){} }

  // append message bubble
  function appendMessage(who, htmlText, opts={}) {
    if (!chatMessages) return;
    const node = document.createElement('div');
    node.className = `chat-msg ${who === 'user' ? 'user' : 'bot'}`;
    node.style.maxWidth = '86%';
    node.innerHTML = `<div class="chat-bubble">${htmlText}</div><div class="chat-meta tiny muted">${new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>`;
    chatMessages.appendChild(node);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    // persist
    const h = loadHistory();
    h.push({ who, text: htmlText, t: Date.now() });
    saveHistory(h);
  }

  // show typing indicator (returns a function to stop it)
  function showTyping() {
    if (!chatMessages) return ()=>{};
    const wrap = document.createElement('div');
    wrap.className = 'chat-typing bot';
    wrap.innerHTML = `<div class="chat-bubble"><div class="chat-typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div></div>`;
    chatMessages.appendChild(wrap);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    return function stopTyping() { wrap.remove(); };
  }

  // clear messages (for debug)
  function clearMessages() {
    if (!chatMessages) return;
    chatMessages.innerHTML = '';
    saveHistory([]);
  }

  // basic NLP-ish handler (local rules)
  function handleBotQuery(text) {
    const t = (text||'').toLowerCase().trim();
    // common quick replies
    if (!t) return "Tell me what you'd like — e.g., 'build shawarma' or 'how much is fries?'.";
    if (t.includes('menu') || t.includes('list')) {
      return 'We have Shawarma, Loaded Fries, Angwamo, Fried Rice, Sides & Drinks. Tap "Build Shawarma" to customize.';
    }
    if (t.includes('shawarma')) {
      if (t.includes('build') || t.startsWith('build')) {
        // signal to open builder
        return { action: 'openBuilder', item: 'shawarma', text: 'Opening builder for Shawarma...' };
      }
      return 'Shawarma starts at GHC 45 (Regular). Type "build shawarma" to customize.';
    }
    if (t.includes('fries')) {
      if (t.includes('build')) return { action:'openBuilder', item:'fries', text: 'Opening builder for Loaded Fries...' };
      return 'Loaded Fries start at GHC 55. Type "build fries" to customize.';
    }
    if (t.includes('promo') || t.includes('free') || t.includes('tuesday')) {
      return 'Promo: Buy 2 Shawarmas, get 1 free — Tuesdays. Add qualifying items to your cart to claim.';
    }
    if (t.match(/how much|price|cost/)) {
      // look for an item name
      if (t.includes('shawarma')) return 'Shawarma: GHC 45 (Regular) — GHC 65 (Jumbo).';
      if (t.includes('fries')) return 'Loaded Fries: GHC 55 (Single) — GHC 70 (Large).';
      if (t.includes('angwamo')) return 'Angwamo Plate: GHC 55 — Combo GHC 70.';
      return 'Most items range GHC 8 — GHC 80. Ask about a specific item like "price shawarma".';
    }
    // fallback
    return "I can help with building meals, promos, or prices. Try: 'Build shawarma', 'How much is fries?' or 'Promos'.";
  }

  // send message (user)
  function sendUserMessage(rawText) {
    if (!rawText || !rawText.trim()) return;
    const text = rawText.trim();
    appendMessage('user', escapeHtml(text));
    // bot "thinking"
    const stop = showTyping();
    // small simulated delay
    setTimeout(()=>{
      try {
        const botResult = handleBotQuery(text);
        stop();
        if (!botResult) {
          appendMessage('bot', 'Sorry — I could not understand. Try "menu" or "build shawarma".');
          return;
        }
        if (typeof botResult === 'string') {
          appendMessage('bot', escapeHtml(botResult));
        } else if (typeof botResult === 'object') {
          // object may indicate an action
          appendMessage('bot', escapeHtml(botResult.text || 'Okay...'));
          if (botResult.action === 'openBuilder' && botResult.item && typeof window.openBuilder === 'function') {
            // slightly delay so user sees the "Opening..." message
            setTimeout(()=> {
              try { window.openBuilder(botResult.item); } catch(e){ console.warn('openBuilder failed', e); }
            }, 400);
          }
        }
      } catch (err) {
        stop();
        appendMessage('bot', 'Oops — something went wrong. Please try again.');
        console.error(err);
      }
    }, 420 + Math.random()*420);
  }

  // escape function for HTML content in user messages
  function escapeHtml(s) {
    if (!s) return s;
    return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  // restore history into DOM
  (function restoreHistory(){
    try {
      const h = loadHistory();
      if (!h || !h.length) {
        // greeting
        appendMessage('bot', "Hello! I'm <strong>Manef</strong> — I can help with menu, builders, promos or checkout. Try: 'Build shawarma'.");
        return;
      }
      h.forEach(m => appendMessage(m.who, m.text));
      // small re-greeting if last bot message older than 24h
      const last = h[h.length-1];
      if (last && (Date.now() - (last.t || 0) > 1000*60*60*24)) {
        appendMessage('bot', "Welcome back! Ask me about today's promos, or type 'build shawarma'.");
      }
    } catch (e) { console.warn('restoreHistory failed', e); }
  })();

  // UI open/close helpers
  function openChat() {
    if (!panel) return;
    panel.hidden = false;
    panel.removeAttribute('hidden');
    toggle.setAttribute('aria-expanded','true');
    setTimeout(()=> { (panel.querySelector('.chat-input') || chatInput)?.focus(); }, 60);
    // ensure visible on mobile
    panel.scrollIntoView({behavior:'smooth', block:'end'});
  }
  function closeChat() {
    if (!panel) return;
    panel.hidden = true;
    panel.setAttribute('hidden','true');
    toggle.setAttribute('aria-expanded','false');
    toggle.focus();
  }

  // attach events
  toggle.addEventListener('click', (e) => { e.preventDefault(); if (panel.hidden) openChat(); else closeChat(); });

  closeBtns.forEach(b => b.addEventListener('click', (ev) => { ev.preventDefault(); closeChat(); }));

  // send button
  if (sendBtn) sendBtn.addEventListener('click', (ev) => {
    ev.preventDefault();
    const v = (chatInput && chatInput.value) || '';
    if (!v.trim()) return;
    chatInput.value = '';
    sendUserMessage(v);
  });

  // input enter
  if (chatInput) chatInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      const v = chatInput.value || '';
      if (!v.trim()) return;
      chatInput.value = '';
      sendUserMessage(v);
    } else if (e.key === 'Escape') {
      closeChat();
    }
  });

  // suggestion chips (create if not present)
  const suggestArea = panel.querySelector('.chat-suggestions') || (() => {
    const el = document.createElement('div');
    el.className = 'chat-suggestions';
    el.innerHTML = `<button class="chip">Build Shawarma</button><button class="chip">Promos</button><button class="chip">Menu</button>`;
    panel.querySelector('.chat-body').appendChild(el);
    return el;
  })();

  suggestArea.addEventListener('click', (ev) => {
    const chip = ev.target.closest('.chip');
    if (!chip) return;
    const txt = chip.textContent.trim();
    // map chips to actions
    if (/build shawarma/i.test(txt)) {
      // open builder directly
      appendMessage('user', 'Build shawarma');
      if (typeof window.openBuilder === 'function') {
        appendMessage('bot', 'Opening builder for Shawarma...');
        setTimeout(()=> window.openBuilder('shawarma'), 250);
      } else {
        appendMessage('bot', 'Builder not available right now.');
      }
      return;
    }
    if (/promos/i.test(txt)) {
      appendMessage('user', 'Promos');
      appendMessage('bot', 'Promo: Buy 2 Shawarmas get 1 free — Tuesdays.');
      return;
    }
    if (/menu/i.test(txt)) {
      appendMessage('user', 'Menu');
      appendMessage('bot', 'Menu: Shawarma, Loaded Fries, Angwamo, Fried Rice, Sides & Drinks.');
      return;
    }
  });

  // ensure scroll on new messages (mutation observer)
  try {
    const mo = new MutationObserver(()=> {
      if (chatMessages) chatMessages.scrollTop = chatMessages.scrollHeight;
    });
    mo.observe(chatMessages, { childList: true, subtree: false });
  } catch (e){ /* ignore */ }

  // expose for debugging
  window.ManefChat = {
    openChat, closeChat, appendMessage, clearMessages, sendUserMessage
  };

  // accessibility: focus trap when open (lightweight)
  panel.addEventListener('keydown', (e) => {
    if (e.key === 'Tab') {
      // simple trap: keep focus inside panel when open
      if (panel.hidden) return;
      const focusables = Array.from(panel.querySelectorAll('button, [href], input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(n=>!n.disabled && n.offsetParent !== null);
      if (!focusables.length) return;
      const first = focusables[0], last = focusables[focusables.length-1];
      if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
      else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
    }
  });

  // tiny helper toast if global toast exists
  if (typeof window.toast !== 'function') {
    window.toast = (m) => console.info('toast:', m);
  }

  console.info('Manef chat (enhanced) initialized.');
})();
</script>

  <script>
/* VD HERO — 6-slide slideshow integrated with your CATALOG/IMAGES */
(function(){
  'use strict';
  const hero = document.getElementById('hero');
  if (!hero) return;

  // Slide definitions (first slide matches the image visually but uses your business copy)
  // Keys: helpful if you want builder open for that item (use same keys as your CATALOG)
  const slidesData = [
    { key: 'business', titleTop: 'TASTE', titleBottom: 'ORGANIC', eyebrow: 'WRAP DISTRICT • FRESH DAILY', desc: 'We blend local flavours with fast, modern service. From freshly sliced meat to house-made sauces — every meal is prepared to delight.', leftImgKey: 'promo-shawarma', rightImgKey: 'promo-fries', badge: null },
    { key: 'shawarma', titleTop: 'BUILD', titleBottom: 'SHAWARMA', eyebrow: 'Best Seller', desc: 'Hand-cut meat, crisp veg, melty cheese & house sauces. Choose size, protein and toppings — made to order.', leftImgKey: 'hero-shawarma-large', rightImgKey: 'thumb-shawarma', badge: null },
    { key: 'fries', titleTop: 'LOADED', titleBottom: 'FRIES', eyebrow: 'Crunch & Cheese', desc: 'Cheese pulls, crispy bacon and saucy goodness. Customize toppings & spice level.', leftImgKey: 'hero-fries-large', rightImgKey: 'thumb-fries', badge: null },
    { key: 'angwamo', titleTop: 'LOADED', titleBottom: 'ANGWAMO', eyebrow: 'Hearty Plate', desc: 'Eggs, sides and savory toppings — perfect for a big appetite. Try combo options for value.', leftImgKey: 'hero-angwamo-large', rightImgKey: 'thumb-angwamo', badge: null },
    { key: 'friedrice', titleTop: 'FLAVOUR', titleBottom: 'FRIED RICE', eyebrow: 'Comfort Plate', desc: 'Served with your choice of protein — great as a plate or combo.', leftImgKey: 'hero-friedrice-large', rightImgKey: 'thumb-rice', badge: null },
    { key: 'promo', titleTop: 'BUY 2', titleBottom: 'GET 1 FREE', eyebrow: 'Limited Time', desc: 'Promo: Buy 2 Shawarmas — Get 1 Free on Tuesdays. Add two qualifying shawarmas to your cart and the third will be free.', leftImgKey: 'promo-shawarma', rightImgKey: 'promo-fries', badge: { main: '50%', sub: 'OFF' } }
  ];

 const IMAGES = {
  
  // hero slides 
  'promo-shawarma': 'promo-shawarma.jpg',
  'hero-shawarma-large': 'hero-shawarma-large.jpg',
  'hero-fries-large':  'hero-fries-large.jpg',
  'hero-angwamo-large': 'hero-angwamo-large.jpg',
  'hero-friedrice-large': 'hero-friedrice-large.jpg',

  // thumbnails used for right circle
  'thumb-shawarma': 'thumb-shawarma.jpg',
  'thumb-fries': 'thumb-fries.jpg',
  'thumb-angwamo': 'promo-anwamo.jpg',
  'thumb-rice': 'hero-friedrice-large.jpg'
};

  function resolveImage(key) {
    if (!key) return '';
    if (IMAGES[key]) return IMAGES[key];
    // if key looks like a URL (contains / or http), return as-is
    if (key.indexOf('/') >= 0 || key.indexOf('http') === 0) return key;
    // fallback generate likely filename
    return IMAGES[key] || key + '.jpg';
  }

  // DOM refs
  const leftImgEl = hero.querySelector('.vd-left-img');
  const rightImgEl = hero.querySelector('.vd-right-img');
  const eyebrowEl = hero.querySelector('#vd-eyebrow');
  const titleTopEl = hero.querySelector('.vd-line-top');
  const titleBottomEl = hero.querySelector('.vd-line-bottom');
  const descEl = hero.querySelector('#vd-desc');
  const orderBtn = hero.querySelector('#vd-order');
  const seeMenu = hero.querySelector('#vd-see-menu');
  const dots = Array.from(hero.querySelectorAll('.vd-dot'));
  const offBadgeEl = hero.querySelector('.vd-off-badge');

  // current index
  let cur = 0;
  let timer = null;
  const AUTO_MS = 4800;

  // render slide i
  function render(i, instant) {
    i = (i + slidesData.length) % slidesData.length;
    const s = slidesData[i];

    // images
    const leftSrc = resolveImage(s.leftImgKey);
    const rightSrc = resolveImage(s.rightImgKey);
    if (leftImgEl) leftImgEl.src = leftSrc || '';
    if (rightImgEl) rightImgEl.src = rightSrc || '';

    // eyebrow
    if (eyebrowEl) eyebrowEl.textContent = s.eyebrow || '';

    // title
    if (titleTopEl) titleTopEl.textContent = (s.titleTop || '').toUpperCase();
    if (titleBottomEl) titleBottomEl.textContent = (s.titleBottom || '').toUpperCase();

    // desc
    if (descEl) descEl.textContent = s.desc || '';

    // badge handling (if slide specifies a badge, show it with content; else hide)
    if (s.badge && offBadgeEl) {
      offBadgeEl.style.display = 'flex';
      offBadgeEl.querySelector('strong').textContent = s.badge.main || '';
      offBadgeEl.querySelector('small').textContent = s.badge.sub || '';
    } else if (offBadgeEl) {
      // only show the badge on the promo slide or keep it for visual parity as in the image
      // Slide 1 in the image shows a 50% off bubble — show when promo or when first slide uses badge
      if (i === 0) {
        // image looked like it had a round badge on right — we hide unless promo wants it
        offBadgeEl.style.display = 'none';
      } else {
        offBadgeEl.style.display = 'none';
      }
    }

    // update dots
    dots.forEach(d => {
      const idx = Number(d.dataset.index || d.getAttribute('data-index'));
      const sel = idx === i;
      d.setAttribute('aria-selected', sel ? 'true' : 'false');
      d.classList.toggle('active', sel);
    });

    // subtle transition
    if (!instant) {
      const card = hero.querySelector('.vd-card');
      if (card) card.animate([{ opacity: .96, transform: 'translateY(6px)' }, { opacity: 1, transform: 'translateY(0)' }], { duration: 420, easing: 'cubic-bezier(.2,.9,.2,1)' });
    }

    cur = i;
  }

  // dot click
  dots.forEach(d => {
    d.addEventListener('click', (e) => {
      const i = Number(d.dataset.index || d.getAttribute('data-index'));
      render(i);
      restartTimer();
    });
  });

  // order click — prefer openBuilder if slide key maps to an item in CATALOG
  orderBtn.addEventListener('click', (e) => {
    e.preventDefault();
    const s = slidesData[cur];
    if (!s) return;
    if (s.key && typeof window.CATALOG !== 'undefined' && window.CATALOG[s.key] && typeof window.openBuilder === 'function') {
      try { window.openBuilder(s.key); } catch (err) { console.warn(err); }
      return;
    }
    // fallback: add to cart with default size price if possible
    if (s.key && window.CATALOG && window.CATALOG[s.key] && typeof window.addToCartObj === 'function') {
      const cfg = window.CATALOG[s.key];
      const price = (cfg.sizes && cfg.sizes[0]) ? cfg.sizes[0].price : 0;
      window.addToCartObj({ id: `${s.key}-${Date.now()}`, name: cfg.name || s.titleTop + ' ' + s.titleBottom, qty: 1, unitPrice: Number(price || 0), optionsSummary: 'Default' });
      if (typeof window.openCartDrawer === 'function') window.openCartDrawer();
      return;
    }
    // ultimate fallback: open builder without item or show toast
    if (typeof window.toast === 'function') {
      window.toast('Select your item from the menu.');
    } else {
      alert(`Order: ${s.titleTop} ${s.titleBottom}`);
    }
  });

  // See menu scroll
  seeMenu.addEventListener('click', (e) => {
    e.preventDefault();
    const el = document.querySelector('#menu');
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
  });

  // keyboard nav
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') { prev(); restartTimer(); }
    if (e.key === 'ArrowRight') { next(); restartTimer(); }
  });

  // next / prev
  function next() { render(cur + 1); }
  function prev() { render(cur - 1); }

  // timer
  function startTimer() {
    stopTimer();
    timer = setInterval(() => render(cur + 1), AUTO_MS);
  }
  function stopTimer() { if (timer) { clearInterval(timer); timer = null; } }
  function restartTimer() { stopTimer(); startTimer(); }

  // pause on hover
  const cardWrap = hero.querySelector('.vd-card');
  if (cardWrap) {
    cardWrap.addEventListener('mouseenter', stopTimer);
    cardWrap.addEventListener('mouseleave', startTimer);
    cardWrap.addEventListener('touchstart', stopTimer, { passive: true });
    cardWrap.addEventListener('touchend', startTimer, { passive: true });
  }

  // initial render
  render(0, true);
  startTimer();

  // expose small API
  window.VD_HERO = { go: render, next, prev, current: () => cur, slides: slidesData };

})();
</script>
<script>
  // --- Cart scroll / sizing helpers (add near your existing enhanceCart/bootstrap) ---
(function cartLayoutHelpers(){
  const drawer = document.querySelector('#cart-drawer');
  if (!drawer) return;
  const shell = drawer.querySelector('.drawer-shell');
  const itemsList = drawer.querySelector('.cart-items');
  const summary = drawer.querySelector('.cart-summary');

  function setShellMaxHeight(){
    const vh = Math.min(window.innerHeight, document.documentElement.clientHeight || Infinity);
    shell.style.maxHeight = (vh) + 'px';
  }
  setShellMaxHeight();
  window.addEventListener('resize', setShellMaxHeight);

  // ensure items list is scrollable and summary always visible
  if (itemsList) {
    // when drawer opens, scroll to top and focus checkout for keyboard
    document.querySelectorAll('[data-action="open-cart"], .cart-btn, .mini-cart .btn[data-action="view-cart"]').forEach(b => {
      b.addEventListener('click', (e) => {
        setTimeout(()=> {
          itemsList.scrollTop = 0;
          const checkout = drawer.querySelector('.checkout');
          if (checkout) checkout.focus();
        }, 120);
      });
    });

    // delegate clicks for qty + / - buttons and remove
    itemsList.addEventListener('click', (e) => {
      const inc = e.target.closest('[data-action="qty-inc"]');
      const dec = e.target.closest('[data-action="qty-dec"]');
      const rem = e.target.closest('.remove-item');
      if (inc || dec) {
        const li = (inc || dec).closest('.cart-item');
        if (!li) return;
        const idx = Number(li.dataset.index);
        if (isNaN(idx)) return;
        // update model (your add/remove logic persists); adapt to your existing functions:
        if (inc) { cart[idx].qty = (cart[idx].qty || 1) + 1; }
        if (dec) { cart[idx].qty = Math.max(1, (cart[idx].qty || 1) - 1); }
        persistCart(); // your existing function updates visuals
      } else if (rem) {
        const idx = Number(rem.closest('.cart-item').dataset.index);
        if (!isNaN(idx)) { removeCartIndex(idx); }
      }
    });
  }
})();

</script>

  <script>
/* VD hero slides initializer — add after existing scripts */
(function(){
  const slides = [
    {
      id: 'shawarma',
      eyebrow: '100% FRESH & MADE DAILY',
      titleTop: 'Are you',
      titleBottom: 'Starving?',
      desc: 'Hot shawarma with house garlic — ready in 6 minutes.',
      leftImgKey: 'hero-shawarma-large',
      rightImgKey: 'promo-shawarma',
      layout: 'vd-layout-center', // center-focused (big headline)
      cta: 'Order now'
    },
    {
      id: 'fries',
      eyebrow: 'CRUNCHY & LOADED',
      titleTop: 'Loaded',
      titleBottom: 'Fries',
      desc: 'Topped with cheese, sauces & your favorite protein.',
      leftImgKey: 'hero-fries-large',
      rightImgKey: 'promo-fries',
      layout: 'vd-layout-right',
      cta: 'Get fries'
    },
    {
      id: 'angwamo',
      eyebrow: 'HEARTY PLATES',
      titleTop: 'Loaded',
      titleBottom: 'Angwamo',
      desc: 'Eggs, sides and local goodness. Try the combo.',
      leftImgKey: 'hero-angwamo-large',
      rightImgKey: 'promo-angwamo',
      layout: 'vd-layout-left',
      cta: 'Customize'
    },
    {
      id: 'duo',
      eyebrow: 'BEST OF BOTH',
      titleTop: 'Pick two',
      titleBottom: 'Mix & Match',
      desc: 'Collage-style layout that shows more than one item.',
      leftImgKey: 'thumb-shawarma',
      rightImgKey: 'thumb-fries',
      layout: 'vd-layout-collage',
      cta: 'Try combo'
    }
  ];

  // DOM refs
  const card = document.querySelector('.vd-card');
  const leftImgEl = document.querySelector('.vd-left-img');
  const rightImgEl = document.querySelector('.vd-right-img');
  const eyebrowEl = document.getElementById('vd-eyebrow');
  const titleElTop = document.querySelector('#vd-title .vd-line-top');
  const titleElBottom = document.querySelector('#vd-title .vd-line-bottom');
  const descEl = document.getElementById('vd-desc');
  const dots = Array.from(document.querySelectorAll('.vd-dot'));
  const primaryBtn = document.getElementById('vd-order');

  if(!card || !leftImgEl || !rightImgEl || !eyebrowEl || !titleElTop || !titleElBottom) return;

  let idx = 0;
  let timer = null;
  const AUTO_MS = 5200;

  // create subtle organic blobs (SVG) for depth
  function createBlob(color='#ffb57a', size=220, left=10, top=-40, id='blob1') {
    const div = document.createElement('div');
    div.className = 'vd-art-blob';
    div.id = id;
    div.style.width = size + 'px';
    div.style.height = size + 'px';
    div.style.left = left + 'px';
    div.style.top = top + 'px';
    div.innerHTML = `<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
      <defs><linearGradient id="g${id}" x1="0" x2="1"><stop offset="0" stop-color="${color}" stop-opacity="0.95"/><stop offset="1" stop-color="#ff6b3d" stop-opacity="0.7"/></linearGradient></defs>
      <path fill="url(#g${id})" d="M43.2,-64.7C56.7,-55.8,68.3,-45.2,74.6,-32.2C80.9,-19.2,81.9,-3.8,78.6,11.4C75.2,26.7,67.6,41.9,55.8,50.4C44,58.8,28,60.6,12.2,62.3C-3.6,64,-18.9,65.6,-33.8,61.2C-48.6,56.9,-63,46.4,-70.6,32.3C-78.2,18.1,-78.9,0.3,-73.1,-15.6C-67.2,-31.6,-54.7,-45.6,-39.6,-54.2C-24.4,-62.8,-12.2,-66.1,1.8,-68.1C15.8,-70,31.5,-70.8,43.2,-64.7Z" transform="translate(100 100) scale(0.9)"></path>
    </svg>`;
    return div;
  }

  // ensure blobs exist once
  if(!card.querySelector('#vd-blob-a')) {
    card.appendChild(createBlob('#ffd8a8', 300, -60, -80, 'vd-blob-a'));
    card.appendChild(createBlob('#ffb5a3', 220, 'auto', -40, 'vd-blob-b'));
    // right-side small blob
    const b = createBlob('#ffd1a3', 160, '', 12, 'vd-blob-c');
    b.style.right = '-36px';
    b.style.left = 'auto';
    card.appendChild(b);
  }

  function showSlide(i) {
    idx = (i + slides.length) % slides.length;
    const s = slides[idx];
    // layout classes
    card.classList.remove('vd-layout-left','vd-layout-right','vd-layout-center','vd-layout-collage');
    if(s.layout) card.classList.add(s.layout);
    // accessibility: announce eyebrow/title (aria-live)
    eyebrowEl.textContent = s.eyebrow || '';
    titleElTop.textContent = s.titleTop || '';
    titleElBottom.textContent = s.titleBottom || '';
    descEl.textContent = s.desc || '';
    primaryBtn.textContent = s.cta || 'Order now';

    // animate lines reveal
    card.classList.remove('show-lines');
    void card.offsetWidth;
    card.classList.add('show-lines');

    // set images using your applyImageToElement helper so fallback logic works
    if (s.leftImgKey) applyImageToElement(leftImgEl, s.leftImgKey);
    if (s.rightImgKey) applyImageToElement(rightImgEl, s.rightImgKey);

    // play ken-burns
    card.classList.add('playing');

    // mark active dot
    dots.forEach((d, j) => {
      d.setAttribute('aria-selected', j === idx ? 'true' : 'false');
      d.classList.toggle('active', j === idx);
    });

    // visual emphasis (cta)
    card.classList.toggle('active-cta', idx === 0); // example: highlight slide 0
  }

  // dot clicks
  dots.forEach(d => d.addEventListener('click', (ev) => {
    const i = Number(d.dataset.index || d.getAttribute('data-index') || dots.indexOf(d));
    if (!Number.isNaN(i)) {
      showSlide(i);
      resetTimer();
    }
  }));

  function prev() { showSlide(idx - 1); resetTimer(); }
  function next() { showSlide(idx + 1); resetTimer(); }

  function startTimer() {
    if (timer) clearInterval(timer);
    timer = setInterval(() => {
      showSlide(idx + 1);
    }, AUTO_MS);
  }
  function resetTimer(){ startTimer(); }

  // pointer parallax for images (subtle)
  (function pointerParallax(){
    const cardRect = () => card.getBoundingClientRect();
    card.addEventListener('pointermove', (ev) => {
      const r = cardRect();
      const dx = (ev.clientX - (r.left + r.width/2)) / (r.width/2); // -1..1
      const dy = (ev.clientY - (r.top + r.height/2)) / (r.height/2);
      leftImgEl.style.transform = `translate3d(${dx * 6}px, ${dy * 4}px, 0) scale(1.03)`;
      rightImgEl.style.transform = `translate3d(${dx * -6}px, ${dy * -3}px, 0) scale(1.02)`;
    }, { passive: true });
    card.addEventListener('pointerleave', () => {
      leftImgEl.style.transform = '';
      rightImgEl.style.transform = '';
    });
  })();

  // keyboard support for dots (left/right)
  document.addEventListener('keydown', (e)=>{
    if (e.key === 'ArrowLeft') prev();
    if (e.key === 'ArrowRight') next();
  });

  // expose controls
  window.VdHero = { showSlide, next, prev };

  // initial render
  showSlide(0);
  startTimer();

  // make dots indexed (in case markup didn't have data-index)
  dots.forEach((d,i)=> d.setAttribute('data-index', i));
})();
</script>
<script>
  /* ===== Cart interaction polish (paste after existing cart functions) ===== */

(function(){
  // debounce save to avoid spamming localStorage on fast clicks
  let _persistTimer = null;
  const PERSIST_DEBOUNCE = 80; // ms

  // replace existing persistCart with debounced version
  window.persistCart = function persistCartDebounced(){
    if (_persistTimer) clearTimeout(_persistTimer);
    _persistTimer = setTimeout(() => {
      try { localStorage.setItem(CART_KEY, JSON.stringify(cart)); } catch(e){ /* ignore */ }
      updateCartBadge(); renderMiniCartTotal(); renderCartDrawer();
    }, PERSIST_DEBOUNCE);
  };

  // helper - animate removal then actually remove from cart array
  function animateRemoval(idx, liEl){
    if (!liEl) {
      cart.splice(idx, 1);
      persistCart();
      return;
    }
    liEl.classList.add('removing');
    // CSS transitionend will fire when height/opacity finished — fallback timer
    const cleanup = () => {
      // Remove the item from cart by index (recalculate because indexes might shift)
      if (idx >= 0 && idx < cart.length) cart.splice(idx, 1);
      persistCart();
    };
    let called = false;
    function onEnd(ev){
      if (called) return;
      if (ev.propertyName && (ev.propertyName.indexOf('height')>=0 || ev.propertyName.indexOf('opacity')>=0 || ev.propertyName.indexOf('transform')>=0)) {
        called = true;
        liEl.removeEventListener('transitionend', onEnd);
        cleanup();
      }
    }
    liEl.addEventListener('transitionend', onEnd);
    // safety fallback
    setTimeout(()=>{ if (!called) { called = true; liEl.removeEventListener('transitionend', onEnd); cleanup(); } }, 520);
  }

  // consolidated event delegation for qty increment/decrement & remove
  const cartList = document.querySelector('#cart-drawer .cart-items');
  if (cartList) {
    cartList.addEventListener('click', (e) => {
      const dec = e.target.closest('[data-action="qty-dec"]');
      const inc = e.target.closest('[data-action="qty-inc"]');
      const rem = e.target.closest('.remove-item');
      // find parent list item
      const li = (dec || inc || rem) ? (dec || inc || rem).closest('.cart-item') : null;
      const idx = li ? Number(li.dataset.index) : NaN;

      if ((dec || inc) && !isNaN(idx)) {
        e.preventDefault();
        const currentQty = Number(cart[idx].qty || 1);
        if (dec) cart[idx].qty = Math.max(1, currentQty - 1);
        else cart[idx].qty = Math.min(99, currentQty + 1);
        // visual feedback
        li.classList.add('qty-pulse');
        setTimeout(()=> li.classList.remove('qty-pulse'), 300);
        persistCart();
        return;
      }

      if (rem && !isNaN(idx)) {
        e.preventDefault();
        // animate then remove
        animateRemoval(idx, rem.closest('.cart-item'));
        toast('Removing item…');
        return;
      }
    });

    // keyboard support for qty controls (Enter -> click)
    cartList.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const btn = e.target.closest('[data-action="qty-dec"], [data-action="qty-inc"], .remove-item');
        if (btn) btn.click();
      }
    });
  }

  // When adding programmatically (addToCartObj), ensure item animates in drawer
  const originalAddToCartObj = window.addToCartObj || null;
  window.addToCartObj = function wrappedAddToCart(item) {
    // call original to modify cart array
    if (originalAddToCartObj) originalAddToCartObj(item);
    // render and add a small 'just-added' class to newest li
    renderCartDrawer();
    const drawer = document.querySelector('#cart-drawer');
    const list = drawer && drawer.querySelector('.cart-items');
    if (!list) return;
    // newest item should be last — add class for animation
    const last = list.querySelector('.cart-item:last-child');
    if (last) {
      last.classList.add('just-added');
      setTimeout(()=> last.classList.remove('just-added'), 420);
    }
  };

  // ensure checkout button gets focus when cart opens (small nicety)
  const openBtns = document.querySelectorAll('[data-action="open-cart"], .cart-btn');
  openBtns.forEach(b => b.addEventListener('click', () => {
    setTimeout(()=> {
      const checkout = document.querySelector('#cart-drawer .checkout');
      if (checkout) checkout.focus({preventScroll: true});
    }, 120);
  }));

})();

</script>
  <script>
    /* Build modal logic (paste after your existing scripts) */
(function(){
  const modal = document.getElementById('build-modal');
  if (!modal) return;

  const imageEl = modal.querySelector('#build-image');
  const imageInput = modal.querySelector('#build-image-input');
  const optionsEl = modal.querySelector('#build-options');
  const qtyValue = modal.querySelector('#build-qty');
  const btnAdd = modal.querySelector('#build-add');
  const btnCloseNodes = modal.querySelectorAll('[data-action="close"]');
  const priceEl = modal.querySelector('#build-price');
  const errorEl = modal.querySelector('#build-error');

  // internal builder state
  let builder = {
    product: null,
    qty: 1,
    selections: {},
    extras: { giftwrap: false },
    customImageDataUrl: null
  };

  // utility: format price (expects fmt or fallback)
  function fmtPrice(n){
    if (typeof fmt === 'function') return fmt(n);
    return `GHC ${Number(n).toFixed(2)}`;
  }

  // focus management
  let lastTrigger = null;
  function openModal(triggerEl){
    lastTrigger = triggerEl;
    modal.setAttribute('aria-hidden','false');
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden'; // prevent background scroll
    trapFocus(modal);
    // set initial focus
    const closeBtn = modal.querySelector('.modal-close');
    if (closeBtn) closeBtn.focus();
  }
  function closeModal(){
    modal.setAttribute('aria-hidden','true');
    modal.style.display = 'none';
    document.body.style.overflow = '';
    releaseFocus();
    if (lastTrigger) lastTrigger.focus();
  }

  // load product into builder
  function populate(product){
    builder.product = product;
    builder.qty = 1;
    builder.selections = {};
    builder.extras = { giftwrap: false };
    builder.customImageDataUrl = null;
    errorEl.classList.add('hidden'); errorEl.textContent = '';

    // image
    imageEl.src = product.image || '';
    imageEl.alt = product.name || 'Product';

    // render options (variants / choices)
    optionsEl.innerHTML = '';
    if (Array.isArray(product.variants) && product.variants.length){
      const container = document.createElement('div');
      container.className = 'option';
      container.innerHTML = `<div class="opt-title">Variant</div>`;
      const select = document.createElement('select');
      select.setAttribute('aria-label','Select variant');
      product.variants.forEach((v, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `${v.name} ${v.priceDelta ? `(+${v.priceDelta})` : ''}`;
        select.appendChild(opt);
      });
      select.addEventListener('change', () => {
        builder.selections.variant = Number(select.value);
        renderPrice();
      });
      // default selection
      select.value = 0;
      builder.selections.variant = 0;
      container.appendChild(select);
      optionsEl.appendChild(container);
    }

    // extras (example: giftwrap toggle)
    const extraRow = document.createElement('div');
    extraRow.className = 'option';
    extraRow.innerHTML = `<label><input type="checkbox" id="giftwrap-checkbox" /> Gift wrap (+GHC 5)</label>`;
    optionsEl.appendChild(extraRow);
    const giftCheckbox = extraRow.querySelector('#giftwrap-checkbox');
    giftCheckbox.addEventListener('change', (e)=> { builder.extras.giftwrap = e.target.checked; renderPrice(); });

    // reset qty and UI
    qtyValue.textContent = String(builder.qty);
    renderPrice();
  }

  function computePrice(){
    const p = builder.product ? Number(builder.product.basePrice || 0) : 0;
    let totalUnit = p;
    const variantIdx = builder.selections.variant;
    if (typeof variantIdx === 'number' && builder.product.variants && builder.product.variants[variantIdx]) {
      const delta = Number(builder.product.variants[variantIdx].priceDelta || 0);
      totalUnit += delta;
    }
    if (builder.extras.giftwrap) totalUnit += 5;
    return { unit: totalUnit, total: totalUnit * builder.qty };
  }

  function renderPrice(){
    const { unit, total } = computePrice();
    priceEl.textContent = `${fmtPrice(unit)} • ${fmtPrice(total)}`;
  }

  // image preview from upload (FileReader)
  imageInput.addEventListener('change', (e) => {
    const f = e.target.files && e.target.files[0];
    if (!f) return;
    const reader = new FileReader();
    reader.onload = () => {
      builder.customImageDataUrl = reader.result;
      imageEl.src = builder.customImageDataUrl;
    };
    reader.readAsDataURL(f);
  });

  // qty handlers
  modal.addEventListener('click', (e) => {
    const dec = e.target.closest('[data-action="qty-dec"]');
    const inc = e.target.closest('[data-action="qty-inc"]');
    if (dec) { builder.qty = Math.max(1, builder.qty - 1); qtyValue.textContent = String(builder.qty); renderPrice(); }
    if (inc) { builder.qty = Math.min(99, builder.qty + 1); qtyValue.textContent = String(builder.qty); renderPrice(); }
  });

  // Add to cart: validate then call addToCartObj (your existing function)
  btnAdd.addEventListener('click', (e) => {
    if (!builder.product) return;
    // Example validation: check stock if provided
    const variant = builder.product.variants && builder.product.variants[builder.selections.variant];
    const available = variant && variant.stock ? variant.stock : Infinity;
    if (builder.qty > available) {
      errorEl.textContent = `Only ${available} left in stock for that variant.`;
      errorEl.classList.remove('hidden');
      return;
    }
    errorEl.classList.add('hidden'); errorEl.textContent = '';

    // build cart item object (shape expected by your cart)
    const item = {
      id: `${builder.product.id}-${Date.now()}`, // unique id
      productId: builder.product.id,
      name: builder.product.name,
      variant: variant ? variant.name : undefined,
      qty: builder.qty,
      unitPrice: computePrice().unit,
      image: builder.customImageDataUrl || builder.product.image || '',
      extras: Object.assign({}, builder.extras)
    };

    // call existing addToCartObj (if present) otherwise push to cart and persist
    if (typeof addToCartObj === 'function') {
      addToCartObj(item);
    } else {
      window.cart = window.cart || [];
      window.cart.push(item);
      persistCart();
      renderCartDrawer();
    }

    // small visual: flash toast and animate modal close -> cart
    if (typeof toast === 'function') toast('Added to cart');
    // animate: briefly badge pulse if you have updateCartBadge function
    if (typeof updateCartBadge === 'function') updateCartBadge();

    // close modal after a short delay so user sees feedback
    setTimeout(closeModal, 220);
  });

  // trigger wiring: delegate to document for dynamic triggers
  document.addEventListener('click', (e) => {
    const trigger = e.target.closest('.open-build');
    if (!trigger) return;
    // parse product JSON from data attribute (or implement your own loader)
    let productData = null;
    try { productData = JSON.parse(trigger.getAttribute('data-product')); } catch (err) { productData = null; }
    if (!productData) {
      // fallback: you might attach a product-id and fetch details server-side
      if (typeof toast === 'function') toast('Product info missing');
      return;
    }
    populate(productData);
    openModal(trigger);
  });

  // close handlers
  btnCloseNodes.forEach(n => n.addEventListener('click', closeModal));
  modal.querySelector('.modal-backdrop').addEventListener('click', closeModal);

  // global keyboard (ESC)
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeModal();
  });

  /* -------------------------
     Focus trap (simple) 
     ------------------------- */
  let focusable = [];
  let previouslyFocused = null;
  function trapFocus(root){
    previouslyFocused = document.activeElement;
    focusable = Array.from(root.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])'))
                     .filter(el => el.offsetParent !== null);
    if (focusable.length) focusable[0].focus();
    root.addEventListener('keydown', handleTrap);
  }
  function releaseFocus(){
    modal.removeEventListener('keydown', handleTrap);
    if (previouslyFocused) previouslyFocused = null;
  }
  function handleTrap(e){
    if (e.key !== 'Tab') return;
    const first = focusable[0], last = focusable[focusable.length - 1];
    if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
    else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
  }

})();

  </script>
<script>
  /* Cart Drawer & Cart logic */
(function(){
  const CART_KEY = 'CART_V1';
  const cartDrawer = document.getElementById('cart-drawer');
  const cartToggle = document.getElementById('cart-toggle');
  const cartBadge = document.getElementById('cart-badge');
  const cartItemsEl = document.getElementById('cart-items');
  const cartEmptyEl = document.getElementById('cart-empty');
  const cartSubtotalEl = document.getElementById('cart-subtotal');
  const cartDiscountEl = document.getElementById('cart-discount');
  const cartTotalEl = document.getElementById('cart-total');
  const checkoutBtn = document.getElementById('checkout-btn');
  const promoInput = document.getElementById('promo-code');
  const applyPromoBtn = document.getElementById('apply-promo');
  const promoMsg = document.getElementById('promo-msg');

  // In-memory cart object: array of items { id, productId, name, variant, qty, unitPrice, image, extras }
  let cart = loadCart();
  let activePromo = null; // { code, type, value } or null

  function round2(n){ return Math.round(n*100)/100; }
  function fmt(n){ return `GHC ${round2(Number(n || 0)).toFixed(2)}`; }

  /* ---------- Persistence ---------- */
  function loadCart(){
    try {
      const raw = localStorage.getItem(CART_KEY);
      if (!raw) return [];
      const parsed = JSON.parse(raw);
      if (!Array.isArray(parsed)) return [];
      return parsed;
    } catch (e) { return []; }
  }
  function persistCart(){
    try { localStorage.setItem(CART_KEY, JSON.stringify(cart)); } catch (e) { console.warn('Could not persist cart', e); }
  }

  /* ---------- Cart operations (public) ---------- */
  window.addToCartObj = function(item){
    // If item with same productId+variant+extras exists, increase qty instead of duplicate
    const matchIndex = cart.findIndex(ci => ci.productId === item.productId
                                         && ci.variant === item.variant
                                         && JSON.stringify(ci.extras || {}) === JSON.stringify(item.extras || {}));
    if (matchIndex > -1){
      cart[matchIndex].qty = Math.min(999, (cart[matchIndex].qty || 0) + (item.qty || 1));
    } else {
      cart.push(Object.assign({}, item));
    }
    persistCart();
    renderCartDrawer();
  };

  window.updateCartQty = function(itemId, qty){
    const i = cart.findIndex(x => x.id === itemId);
    if (i === -1) return;
    cart[i].qty = Math.max(1, Math.min(999, qty));
    persistCart();
    renderCartDrawer();
  };

  window.removeFromCart = function(itemId){
    cart = cart.filter(x => x.id !== itemId);
    persistCart();
    renderCartDrawer();
  };

  /* ---------- Totals & promo ---------- */
  function computeTotals(){
    let subtotal = 0;
    cart.forEach(it => { subtotal += Number(it.unitPrice || 0) * Number(it.qty || 1); });
    subtotal = round2(subtotal);
    let discount = 0;
    if (activePromo){
      if (activePromo.type === 'percentage'){
        discount = round2(subtotal * (activePromo.value / 100));
      } else if (activePromo.type === 'fixed'){
        discount = round2(activePromo.value);
      }
      if (discount > subtotal) discount = subtotal;
    }
    const total = round2(subtotal - discount);
    return { subtotal, discount, total };
  }

  /* ---------- Rendering ---------- */
  function renderCartDrawer(){
    // badge
    const totalCount = cart.reduce((s, it) => s + Number(it.qty || 0), 0);
    cartBadge.textContent = String(totalCount);
    // items
    cartItemsEl.innerHTML = '';
    if (cart.length === 0){
      cartEmptyEl.style.display = 'block';
      checkoutBtn.disabled = true;
    } else {
      cartEmptyEl.style.display = 'none';
      checkoutBtn.disabled = false;
      cart.forEach(item => {
        const li = document.createElement('li');
        li.className = 'cart-item';
        li.dataset.id = item.id;
        li.innerHTML = `
          <img src="${item.image || ''}" alt="${escapeHtml(item.name || '')}" />
          <div class="item-meta">
            <div class="item-title">${escapeHtml(item.name || '')}</div>
            <div class="item-variant">${escapeHtml(item.variant || '')}</div>
            <div class="item-qty" data-item-id="${item.id}">
              <button class="qty-dec" aria-label="Decrease quantity">−</button>
              <span class="qty-value" aria-live="polite">${item.qty}</span>
              <button class="qty-inc" aria-label="Increase quantity">+</button>
              <button class="remove-item" aria-label="Remove item" style="margin-left:8px; background:transparent; border:none; color:#B71C1C; cursor:pointer;">Remove</button>
            </div>
          </div>
          <div class="item-price">${fmt(Number(item.unitPrice) * Number(item.qty))}</div>
        `;
        cartItemsEl.appendChild(li);
      });
    }

    // totals
    const totals = computeTotals();
    cartSubtotalEl.textContent = fmt(totals.subtotal);
    cartDiscountEl.textContent = fmt(totals.discount);
    cartTotalEl.textContent = fmt(totals.total);

    persistCart();
  }

  /* ---------- Utilities ---------- */
  function escapeHtml(str){
    if (!str) return '';
    return String(str).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;');
  }

  /* ---------- Promo logic (example) ---------- */
  const PROMOS = {
    'SAVE10': { code:'SAVE10', type:'percentage', value:10, description:'10% off' },
    'GHC5': { code:'GHC5', type:'fixed', value:5, description:'GHC 5 off' }
  };

  function applyPromo(code){
    code = String(code || '').trim().toUpperCase();
    if (!code) { activePromo = null; promoMsg.textContent = ''; renderCartDrawer(); return; }
    const p = PROMOS[code];
    if (!p){
      promoMsg.textContent = 'Invalid code.';
      promoMsg.style.color = '#B71C1C';
      return false;
    }
    activePromo = p;
    promoMsg.textContent = `Applied: ${p.description}`;
    promoMsg.style.color = '';
    renderCartDrawer();
    return true;
  }

  /* ---------- Events (delegation) ---------- */
  // open/close drawer
  function openDrawer(){ cartDrawer.setAttribute('aria-hidden','false'); trapFocus(cartDrawer); }
  function closeDrawer(){ cartDrawer.setAttribute('aria-hidden','true'); releaseFocus(cartDrawer); }

  cartToggle.addEventListener('click', (e)=> {
    const hidden = cartDrawer.getAttribute('aria-hidden') === 'true';
    if (hidden) openDrawer(); else closeDrawer();
  });

  cartDrawer.addEventListener('click', (e) => {
    if (e.target.closest('[data-action="close-drawer"]')) closeDrawer();
  });

  document.addEventListener('click', (e) => {
    const dec = e.target.closest('.qty-dec');
    const inc = e.target.closest('.qty-inc');
    const rem = e.target.closest('.remove-item');
    if (dec || inc || rem){
      const parent = (dec || inc || rem).closest('.cart-item');
      const id = parent && parent.dataset && parent.dataset.id;
      if (!id) return;
      if (dec){
        const item = cart.find(x=>x.id===id);
        if (!item) return;
        updateCartQty(id, Math.max(1, Number(item.qty) - 1));
      } else if (inc){
        const item = cart.find(x=>x.id===id);
        if (!item) return;
        updateCartQty(id, Math.min(999, Number(item.qty) + 1));
      } else if (rem){
        // confirm removal quickly
        if (confirm('Remove this item from cart?')) removeFromCart(id);
      }
    }
  });

  applyPromoBtn.addEventListener('click', (e) => {
    applyPromo(promoInput.value);
  });

  promoInput.addEventListener('keyup', (e) => {
    if (e.key === 'Enter') applyPromo(promoInput.value);
  });

  document.getElementById('shop-btn')?.addEventListener('click', (e) => {
    closeDrawer();
    // optional: scroll to products or focus search — keep generic:
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  checkoutBtn.addEventListener('click', (e) => {
    if (cart.length === 0) return;
    // Example checkout stub — replace with your real flow (server or payment)
    const totals = computeTotals();
    const checkoutPayload = { cart, totals, promo: activePromo };
    console.log('Checkout payload:', checkoutPayload);
    // For now, simulate checkout:
    alert(`Proceeding to checkout — total ${fmt(totals.total)}. (Replace this with real checkout.)`);
    // optionally clear cart on successful checkout
    // cart = []; persistCart(); renderCartDrawer();
  });

  // initial render
  renderCartDrawer();

  /* -------------------------
     Simple focus trap for drawer
     ------------------------- */
  let previousFocused = null;
  function trapFocus(root){
    previousFocused = document.activeElement;
    const focusables = Array.from(root.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])'))
                            .filter(el => el.offsetParent !== null);
    if (focusables.length) focusables[0].focus();
    root.addEventListener('keydown', handleTrap);
  }
  function releaseFocus(root){
    root.removeEventListener('keydown', handleTrap);
    if (previousFocused) previousFocused.focus();
    previousFocused = null;
  }
  function handleTrap(e){
    if (e.key !== 'Tab') return;
    const root = cartDrawer;
    const focusables = Array.from(root.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])'))
                            .filter(el => el.offsetParent !== null);
    if (!focusables.length) return;
    const first = focusables[0], last = focusables[focusables.length - 1];
    if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
    else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
  }

})();

  /* ===== Menu 'Add' toggle behavior (put after your cart helpers) ===== */
(function(){
  const doc = document;
  const toBtnHtml = (added) => added
    ? '<i class="fa fa-trash"></i> Remove'
    : '<i class="fa fa-plus-circle"></i> Add';

  function getItemKeyFromButton(btn){
    return btn.dataset.item || btn.closest('.menu-item')?.dataset.category || btn.closest('.menu-item')?.dataset.id || null;
  }

  // Remove all items added by quick add for a given itemKey
  function removeItemsByKey(itemKey){
    if (!itemKey) return;
    // match by product name (fallback) if available in CATALOG
    const cfgName = (window.CATALOG && window.CATALOG[itemKey] && window.CATALOG[itemKey].name) || null;
    // remove matching cart entries
    window.cart = (window.cart || []).filter(it => {
      if (cfgName) return it.name !== cfgName;
      return !(it.productId === itemKey || (it.id || '').startsWith(itemKey + '-'));
    });
    if (typeof persistCart === 'function') persistCart();
    if (typeof renderCartDrawer === 'function') renderCartDrawer();
  }

  // Sync buttons on load (if user has items in cart from previous session)
  function syncAddButtons(){
    const buttons = doc.querySelectorAll('[data-action="add-to-cart"]');
    buttons.forEach(btn => {
      const key = getItemKeyFromButton(btn);
      const cfgName = (window.CATALOG && window.CATALOG[key] && window.CATALOG[key].name) || key;
      const exists = (window.cart || []).some(it => it.name === cfgName || it.productId === key || (it.id || '').startsWith((key||'') + '-'));
      if (exists) {
        btn.dataset.added = 'true';
        btn.classList.add('added');
        btn.innerHTML = toBtnHtml(true);
      } else {
        btn.dataset.added = 'false';
        btn.classList.remove('added');
        btn.innerHTML = toBtnHtml(false);
      }
    });
  }

  // Capture-phase listener — prevents other click handlers (Paystack) from firing for these Add buttons.
  doc.addEventListener('click', function(ev){
    const btn = ev.target.closest('[data-action="add-to-cart"]');
    if (!btn) return;
    // intercept
    ev.preventDefault();
    ev.stopImmediatePropagation && ev.stopImmediatePropagation();
    ev.stopPropagation();

    const key = getItemKeyFromButton(btn);
    // If it's already added -> remove matching items
    if (btn.dataset.added === 'true') {
      removeItemsByKey(key);
      btn.dataset.added = 'false';
      btn.classList.remove('added');
      btn.innerHTML = toBtnHtml(false);
      if (typeof toast === 'function') toast('Removed from cart');
      return;
    }

    // Otherwise, add default item (same behaviour your quick add used)
    const cfg = (window.CATALOG && window.CATALOG[key]) ? window.CATALOG[key] : null;
    if (!cfg) {
      // Fallback: add a basic item using button data-price if present
      const price = Number(btn.dataset.price || 0);
      const item = { id: `${key || 'item'}-${Date.now()}`, name: key || 'Item', qty: 1, unitPrice: price, optionsSummary: 'Default' };
      if (typeof addToCartObj === 'function') addToCartObj(item);
      else {
        window.cart = window.cart || []; window.cart.push(item);
        persistCart();
        renderCartDrawer();
      }
      btn.dataset.added = 'true';
      btn.classList.add('added');
      btn.innerHTML = toBtnHtml(true);
      if (typeof toast === 'function') toast('Added to cart');
      return;
    }

    // add using catalog default size
    const size = (cfg.sizes && cfg.sizes[0]) ? cfg.sizes[0] : { price: 0, label: 'Default' };
    const cartItem = {
      id: `${key}-${Date.now()}`,
      productId: cfg.id || key,
      name: cfg.name || key,
      qty: 1,
      unitPrice: Number(size.price || 0),
      optionsSummary: size.label || 'Default'
    };
    if (typeof addToCartObj === 'function') addToCartObj(cartItem);
    else {
      window.cart = window.cart || []; window.cart.push(cartItem);
      persistCart();
      renderCartDrawer();
    }

    btn.dataset.added = 'true';
    btn.classList.add('added');
    btn.innerHTML = toBtnHtml(true);
    if (typeof toast === 'function') toast('Added to cart');
  }, true); // use capture to intercept before other handlers

  // run sync once on DOM ready (and whenever cart persists)
  document.addEventListener('DOMContentLoaded', syncAddButtons);
  // also sync after cart persistence if your persistCart is called globally
  const origPersist = window.persistCart;
  window.persistCart = function wrappedPersist(){
    try { if (typeof origPersist === 'function') origPersist(); } catch(e){}
    syncAddButtons();
  };
})();

  /* ===== Robust mobile nav toggle & panel (paste near end of body) ===== */
(function(){
  const doc = document;
  const hamburger = doc.querySelector('.hamburger');
  if (!hamburger) return;

  // create overlay / panel references (use existing elements if present)
  let overlay = doc.getElementById('mobile-overlay');
  if (!overlay) {
    overlay = doc.createElement('div'); overlay.id = 'mobile-overlay'; overlay.className = 'mobile-overlay'; overlay.hidden = true;
    doc.body.appendChild(overlay);
  }

  let panel = doc.getElementById('mobile-panel');
  if (!panel) {
    // mobile-panel markup should exist per instructions; if not, create minimal
    panel = doc.createElement('nav');
    panel.id = 'mobile-panel';
    panel.className = 'mobile-panel';
    panel.setAttribute('role','dialog');
    panel.setAttribute('aria-modal','true');
    panel.setAttribute('aria-label','Mobile menu');
    panel.hidden = true;
    panel.innerHTML = '<div class="mobile-panel-inner"><header class="mobile-panel-head"><a class="brand mobile-brand" href="/"><div class="logo"><i class="fa fa-utensils"></i></div><div class="brand-text"><strong>WRAP DISTRICT</strong><small>Fresh</small></div></a><button class="icon-btn mobile-close" aria-label="Close menu"><i class="fa fa-times"></i></button></header><div class="mobile-panel-body"><div class="mobile-nav-container"></div></div></div>';
    doc.body.appendChild(panel);
  }



  // container that will hold mobile nav links
  const mobileNavContainer = panel.querySelector('.mobile-nav-container');

  // clone main nav-list into mobile panel, but avoid duplicating if already present
  function cloneNav() {
    const mainNav = doc.querySelector('.main-nav .nav-list');
    if (!mainNav) return;
    // clone only once
    if (mobileNavContainer.querySelector('.nav-list')) return;
    const clone = mainNav.cloneNode(true);
    // remove roles that don't fit here (keep semantics simple)
    clone.querySelectorAll('[role]').forEach(n => n.removeAttribute('role'));
    mobileNavContainer.appendChild(clone);
    // ensure links close panel on click
    clone.querySelectorAll('a').forEach(a => a.addEventListener('click', (ev) => {
      // let anchor work normally (in-page anchors will scroll). Close panel afterwards.
      closeMobileNav();
    }));
  }

  // focus trap helpers
  let previousActive = null;
  function trapFocus(root) {
    previousActive = document.activeElement;
    const focusables = Array.from(root.querySelectorAll('a[href], button:not([disabled]), input, textarea, select, [tabindex]:not([tabindex="-1"])'))
      .filter(n => n.offsetParent !== null);
    if (focusables.length) focusables[0].focus();
    root._focusHandler = function(e){
      if (e.key !== 'Tab') return;
      const first = focusables[0], last = focusables[focusables.length - 1];
      if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
      else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
    };
    root.addEventListener('keydown', root._focusHandler);
  }
  function releaseFocus(root){
    if (!root || !root._focusHandler) return;
    root.removeEventListener('keydown', root._focusHandler);
    root._focusHandler = null;
    if (previousActive) previousActive.focus();
    previousActive = null;
  }

  // open / close
  function openMobileNav() {
    cloneNav();
    overlay.hidden = false; overlay.setAttribute('aria-hidden', 'false'); overlay.classList.add('show');
    panel.hidden = false; panel.setAttribute('aria-hidden', 'false');
    document.documentElement.classList.add('mobile-nav-open', 'no-scroll');
    hamburger.classList.add('open');
    // swap hamburger icon to X (we replace innerHTML for simplicity)
    const icon = hamburger.querySelector('i');
    if (icon) icon.className = 'fa fa-times';
    trapFocus(panel);
  }
  function closeMobileNav() {
    overlay.hidden = true; overlay.setAttribute('aria-hidden', 'true'); overlay.classList.remove('show');
    panel.hidden = true; panel.setAttribute('aria-hidden', 'true');
    document.documentElement.classList.remove('mobile-nav-open', 'no-scroll');
    hamburger.classList.remove('open');
    const icon = hamburger.querySelector('i');
    if (icon) icon.className = 'fa fa-bars';
    releaseFocus(panel);
  }

  // event wiring
  hamburger.addEventListener('click', (e) => {
    const isOpen = document.documentElement.classList.contains('mobile-nav-open');
    if (isOpen) closeMobileNav(); else openMobileNav();
  });

  // close button inside panel
  panel.querySelectorAll('.mobile-close').forEach(b => b.addEventListener('click', closeMobileNav));

  // overlay click closes
  overlay.addEventListener('click', closeMobileNav);

  // ESC closes
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && document.documentElement.classList.contains('mobile-nav-open')) closeMobileNav(); });

  // if window resizes to desktop, ensure panel closed
  window.addEventListener('resize', () => { if (window.matchMedia('(min-width: 921px)').matches) closeMobileNav(); });

  // initial clone on load
  document.addEventListener('DOMContentLoaded', cloneNav);
})();


 
</script>
  <script>
     /* ===== Builder Summary wiring ===== */
(function(){
  const modal = document.getElementById('builder-modal');
  if (!modal) return;

  // Elements inside summary
  const summaryPanel = modal.querySelector('[data-step-panel="summary"]');
  if (!summaryPanel) return;
  const chipsWrap = summaryPanel.querySelector('.selected-chips');
  const baseEl = summaryPanel.querySelector('#summary-base');
  const extrasEl = summaryPanel.querySelector('#summary-extras');
  const deliveryEl = summaryPanel.querySelector('#summary-delivery');
  const qtyEl = summaryPanel.querySelector('#summary-qty');
  const decBtn = summaryPanel.querySelector('.summary-dec');
  const incBtn = summaryPanel.querySelector('.summary-inc');
  const totalEl = summaryPanel.querySelector('#summary-total');
  const addBtn = summaryPanel.querySelector('#summary-add');
  const promoInput = summaryPanel.querySelector('#summary-promo');
  const applyPromo = summaryPanel.querySelector('#summary-apply-promo');
  const promoMsg = summaryPanel.querySelector('#summary-promo-msg');

  // Promo examples (simple)
  const SUMMARY_PROMOS = {
    'TD10': { type:'percentage', value:10, label:'10% off' },
    'GHC5': { type:'fixed', value:5, label:'GHC 5 off' }
  };
  let activePromo = null;

  // helper to format price (reuse existing fmt if present)
  const _fmt = (n) => (typeof fmt === 'function') ? fmt(n) : `GHC ${Number(n).toFixed(2)}`;

  // compute breakdown from builderState & CATALOG (same logic used elsewhere)
  function computeSummary() {
    if (!window.builderState || !window.CATALOG) return { base:0, extras:0, delivery:0, qty:1, total:0, unit:0, details:[] };
    const st = window.builderState;
    const cfg = window.CATALOG[st.itemKey];
    if (!cfg) return { base:0, extras:0, delivery:0, qty:1, total:0, unit:0, details:[] };

    const sizeObj = (cfg.sizes || []).find(s => s.id === st.size) || cfg.sizes[0] || { price:0 };
    const proteinObj = (cfg.proteins || []).find(p => p.id === st.protein) || { price:0, label: '' };

    let base = Number(sizeObj.price || 0) + Number(proteinObj.price || 0);
    let extras = 0;
    const details = [];

    // fillings (builderState.fillings might be a Set or array)
    const fillingsSet = st.fillings instanceof Set ? st.fillings : new Set(st.fillings || []);
    (cfg.fillings || []).forEach(f => {
      if (fillingsSet.has(f.id)) {
        extras += Number(f.price || 0);
        details.push({ type:'filling', id:f.id, label:f.label, price: Number(f.price || 0) });
      }
    });

    // sauces
    const saucesSet = st.sauces instanceof Set ? st.sauces : new Set(st.sauces || []);
    (cfg.sauces || []).forEach(s => {
      if (saucesSet.has(s.id)) {
        // sauces often free but include if price present
        extras += Number(s.price || 0);
        details.push({ type:'sauce', id:s.id, label:s.label, price: Number(s.price || 0) });
      }
    });

    const deliveryFee = (st.delivery === 'delivery') ? 10 : 0;
    const qty = st.qty || 1;

    const unit = base + extras;
    let subtotal = (unit + deliveryFee) * qty;
    let discount = 0;
    if (activePromo) {
      if (activePromo.type === 'percentage') discount = subtotal * (activePromo.value/100);
      else if (activePromo.type === 'fixed') discount = activePromo.value;
      discount = Math.min(discount, subtotal);
    }
    const total = subtotal - discount;

    // options summary list (for chips)
    const opts = [
      { label: `Size: ${sizeObj.label}`, key: 'size' },
      proteinObj.label ? { label: `Protein: ${proteinObj.label}`, key: 'protein' } : null
    ].filter(Boolean);

    // include fillings & sauces as separate entries
    details.forEach(d => opts.push({ label: `${d.label}${d.price ? ` (+${d.price})` : ''}`, key: `${d.type}:${d.id}` }));

    return { base, extras, delivery: deliveryFee, qty, unit, total, subtotal, discount, details, opts };
  }

  // render the summary UI from builderState
  function renderSummary() {
    if (!summaryPanel) return;
    const st = window.builderState;
    if (!st) {
      // blank state
      chipsWrap.innerHTML = `<div class="muted">No selection</div>`;
      baseEl.textContent = _fmt(0); extrasEl.textContent = _fmt(0); deliveryEl.textContent = _fmt(0); qtyEl.textContent = '1'; totalEl.textContent = _fmt(0);
      addBtn.disabled = true;
      return;
    }

    const out = computeSummary();
    // chips
    chipsWrap.innerHTML = '';
    out.opts.forEach(opt => {
      const c = document.createElement('button');
      c.type = 'button';
      c.className = 'chip';
      c.setAttribute('role','button');
      c.setAttribute('aria-pressed','false');
      c.dataset.optKey = opt.key;
      c.innerHTML = `<span class="chip-label">${esc(opt.label)}</span><span class="remove" aria-hidden="true">&times;</span>`;
      // clicking chip removes the option when possible
      c.addEventListener('click', (ev) => {
        ev.preventDefault();
        // parse key — size/protein cannot be removed via chips (we'll prevent that)
        if (opt.key === 'size' || opt.key === 'protein') {
          // focus the stepper to let user change size/protein
          const stepBtn = modal.querySelector('.builder-stepper .step[data-step="size"]');
          if (stepBtn) stepBtn.click();
          return;
        }
        // for details like filling:something or sauce:something, remove from builderState
        if (opt.key && opt.key.indexOf(':') > -1) {
          const [type, id] = opt.key.split(':');
          if (type === 'filling' || type === 'fillings') {
            if (st.fillings && st.fillings.delete) { st.fillings.delete(id); }
            else if (Array.isArray(st.fillings)) st.fillings = st.fillings.filter(x => x !== id);
          } else if (type === 'sauce' || type === 'sauces') {
            if (st.sauces && st.sauces.delete) { st.sauces.delete(id); }
            else if (Array.isArray(st.sauces)) st.sauces = st.sauces.filter(x => x !== id);
          }
          // update visual selection in tiles (if present)
          const tile = modal.querySelector(`[data-step-panel] .option-card[data-opt-id="${id}"]`);
          if (tile) tile.classList.remove('selected');
          // recalc & re-render
          if (typeof updateBuilderPreview === 'function') updateBuilderPreview();
          renderSummary();
        }
      });
      chipsWrap.appendChild(c);
    });

    // numbers
    baseEl.textContent = _fmt(out.base * out.qty);
    extrasEl.textContent = _fmt(out.extras * out.qty);
    deliveryEl.textContent = _fmt(out.delivery * out.qty);
    qtyEl.textContent = String(out.qty);
    totalEl.textContent = _fmt(out.total);

    addBtn.disabled = false;
  }

  // wire qty controls
  decBtn?.addEventListener('click', (e) => {
    if (!window.builderState) return;
    window.builderState.qty = Math.max(1, (window.builderState.qty || 1) - 1);
    if (typeof updateBuilderPreview === 'function') updateBuilderPreview();
    renderSummary();
  });
  incBtn?.addEventListener('click', (e) => {
    if (!window.builderState) return;
    window.builderState.qty = Math.min(99, (window.builderState.qty || 1) + 1);
    if (typeof updateBuilderPreview === 'function') updateBuilderPreview();
    renderSummary();
  });

  // promo apply
  applyPromo?.addEventListener('click', (e) => {
    const code = (promoInput.value || '').trim().toUpperCase();
    if (!code) { promoMsg.textContent = 'Enter a code'; promoMsg.style.color = '#B71C1C'; return; }
    const p = SUMMARY_PROMOS[code];
    if (!p) { promoMsg.textContent = 'Invalid code'; promoMsg.style.color = '#B71C1C'; return; }
    activePromo = p;
    promoMsg.textContent = `Applied: ${p.label}`;
    promoMsg.style.color = '';
    renderSummary();
  });

  // Add to cart from summary: prefer to reuse existing preview add button
  addBtn?.addEventListener('click', (e) => {
    e.preventDefault();
    // try to trigger preview add-to-cart button (reuse existing logic)
    const previewAdd = modal.querySelector('.preview-actions [data-action="add-to-cart"], .preview-actions .btn.btn-cta');
    if (previewAdd) {
      previewAdd.click();
      // brief feedback on summary add button
      addBtn.classList.add('added');
      addBtn.innerHTML = '<i class="fa fa-check"></i> Added';
      setTimeout(()=> { addBtn.classList.remove('added'); addBtn.innerHTML = '<i class="fa fa-shopping-cart"></i> Add to Cart'; }, 900);
      return;
    }

    // fallback: build item & call addToCartObj
    try {
      const st = window.builderState;
      const cfg = window.CATALOG && window.CATALOG[st.itemKey];
      if (!cfg) { toast && toast('Item not available'); return; }
      const sizeObj = (cfg.sizes || []).find(s => s.id === st.size) || cfg.sizes[0];
      const proteinObj = (cfg.proteins || []).find(p => p.id === st.protein) || { label: '' };

      let unit = (sizeObj ? Number(sizeObj.price || 0) : 0) + (proteinObj ? Number(proteinObj.price || 0) : 0);
      (cfg.fillings || []).forEach(f => { if ((st.fillings && st.fillings.has && st.fillings.has(f.id)) || (Array.isArray(st.fillings) && st.fillings.includes(f.id))) unit += Number(f.price || 0); });
      (cfg.sauces || []).forEach(s => { if ((st.sauces && st.sauces.has && st.sauces.has(s.id)) || (Array.isArray(st.sauces) && st.sauces.includes(s.id))) unit += Number(s.price || 0); });

      const fillingsArr = (cfg.fillings || []).filter(f => (st.fillings && st.fillings.has && st.fillings.has(f.id)) || (Array.isArray(st.fillings) && st.fillings.includes(f.id))).map(f => f.label);
      const saucesArr = (cfg.sauces || []).filter(s => (st.sauces && st.sauces.has && st.sauces.has(s.id)) || (Array.isArray(st.sauces) && st.sauces.includes(s.id))).map(s => s.label);

      const optionsSummary = [
        `Size: ${sizeObj.label}`,
        proteinObj.label ? `Protein: ${proteinObj.label}` : null,
        fillingsArr.length ? `Fillings: ${fillingsArr.join(', ')}` : null,
        saucesArr.length ? `Sauces: ${saucesArr.join(', ')}` : null,
        st.delivery === 'delivery' ? 'Delivery' : 'Pickup'
      ].filter(Boolean).join(' • ');

      const item = {
        id: `${st.itemKey}-${Date.now()}`,
        name: cfg.name,
        qty: st.qty || 1,
        unitPrice: Number(unit.toFixed(2)),
        optionsSummary,
        image: cfg.previewImageKey ? ( (window.IMAGES && window.IMAGES[cfg.previewImageKey]) || '' ) : ''
      };

      if (typeof addToCartObj === 'function') addToCartObj(item);
      else {
        window.cart = window.cart || [];
        window.cart.push(item);
        persistCart && persistCart();
        renderCartDrawer && renderCartDrawer();
      }

      // UX: confirm & close builder
      toast && toast('Added to cart');
      setTimeout(()=> { if (typeof closeBuilder === 'function') closeBuilder(); }, 260);

    } catch (err) {
      console.warn('summary add failed', err);
      toast && toast('Could not add item');
    }
  });

  // ensure summary re-renders when the builder preview updates
  const origUpdate = window.updateBuilderPreview;
  window.updateBuilderPreview = function() {
    try { origUpdate && origUpdate(); } catch (e) { console.warn('origUpdate error', e); }
    try { renderSummary(); } catch (e) { console.warn('renderSummary error', e); }
  };

  // render when summary step shows (in case user navigates manually)
  (function wireStepper() {
    modal.querySelectorAll('.builder-stepper .step').forEach(s => {
      s.addEventListener('click', () => {
        const step = s.dataset.step;
        if (step === 'summary') setTimeout(renderSummary, 40);
      });
    });
    // also render on open if summary is visible
    document.addEventListener('click', (e) => {
      const openBuilderBtn = e.target.closest('[data-action="open-builder"], [data-action="open-builder"] *');
      if (openBuilderBtn) setTimeout(renderSummary, 120);
    });
  })();

  // initial render
  setTimeout(renderSummary, 120);
})();

    /* ===== Builder modal UX enhancements ===== */
(function(){
  const modal = document.getElementById('builder-modal') || document.getElementById('build-modal');
  if (!modal) return;

  // DOM refs (support both modal variants)
  const previewImgWrap = modal.querySelector('.preview-image') || modal.querySelector('[data-preview-image]') || null;
  const previewImg = previewImgWrap ? previewImgWrap.querySelector('img') : null;
  const previewTitle = modal.querySelector('.preview-title');
  const previewPrice = modal.querySelector('.preview-price');
  const previewActions = modal.querySelector('.preview-actions');
  const optionsGridSelector = '[data-step-panel] .options-grid';
  const isMobile = () => window.matchMedia('(max-width:880px)').matches;

  // small helper: set preview image by key or url
  function setPreviewImage(keyOrUrl) {
    if (!previewImg && !previewImgWrap) return;
    if (previewImg) {
      // if key provided, use applyImageToElement (existing)
      if (keyOrUrl && applyImageToElement) {
        applyImageToElement(previewImg, keyOrUrl);
      } else {
        previewImg.src = keyOrUrl || previewImg.src || '';
      }
    } else if (previewImgWrap && applyImageToElement) {
      applyImageToElement(previewImgWrap, keyOrUrl);
    }
  }

  // wire option-card clicks to update preview image/title
  modal.addEventListener('click', (e) => {
    const card = e.target.closest('.option-card');
    if (!card) return;
    // card may have data-imageKey
    const key = card.dataset.imageKey || card.dataset.optId || '';
    // set preview image if key looks usable
    if (key && typeof applyImageToElement === 'function') setPreviewImage(key);
    // gently emphasize preview price when selection changes
    const priceEl = modal.querySelector('.preview-price');
    if (priceEl) {
      priceEl.classList.add('pulse');
      setTimeout(()=> priceEl.classList.remove('pulse'), 420);
    }
  });

  // on builder open, seed preview image from product config if available
  document.addEventListener('click', (e) => {
    const openBtn = e.target.closest('[data-action="open-builder"], .open-build');
    if (!openBtn) return;
    // try to get product key
    const item = openBtn.dataset.item || (openBtn.getAttribute('data-product') && (() => {
      try { return JSON.parse(openBtn.getAttribute('data-product') || '{}').id; } catch(e){ return null; }
    })());
    setTimeout(() => {
      // try to set preview from builderState or catalog
      if (window.builderState && window.CATALOG) {
        const cfg = window.CATALOG[window.builderState.itemKey || item];
        if (cfg && cfg.previewImageKey) setPreviewImage(cfg.previewImageKey);
      }
    }, 90);
  });

  // On narrow screens: add a "Preview" toggle to collapse/expand preview quickly
  function addPreviewToggle() {
    if (!isMobile()) return;
    if (!modal) return;
    if (modal.querySelector('.preview-toggle')) return;
    const toggle = document.createElement('button');
    toggle.className = 'preview-toggle btn btn-outline';
    toggle.type = 'button';
    toggle.innerHTML = '<i class="fa fa-eye"></i> Preview';
    toggle.style.marginBottom = '8px';
    const leftCol = modal.querySelector('.modal-left') || modal.querySelector('.modal-shell');
    if (leftCol) leftCol.insertBefore(toggle, leftCol.firstChild);
    toggle.addEventListener('click', () => {
      const pr = modal.querySelector('.modal-right');
      if (!pr) return;
      const isHidden = pr.hidden || window.getComputedStyle(pr).display === 'none';
      pr.hidden = !isHidden;
      toggle.classList.toggle('active', !isHidden);
      if (!isHidden) toggle.innerHTML = '<i class="fa fa-eye-slash"></i> Hide preview';
      else toggle.innerHTML = '<i class="fa fa-eye"></i> Preview';
    });
  }

  // run initially
  addPreviewToggle();

  // re-run on resize (debounced)
  let _rto = null;
  window.addEventListener('resize', () => {
    if (_rto) clearTimeout(_rto);
    _rto = setTimeout(() => {
      addPreviewToggle();
    }, 120);
  });

  // small a11y: ensure preview-actions Add to Cart is visible on mobile by cloning into footer when needed
  function ensureMobileCTA() {
    if (!isMobile()) return;
    const mobileFooter = modal.querySelector('.modal-foot');
    const existingClone = modal.querySelector('.mobile-cta-clone');
    if (!existingClone && previewActions && mobileFooter) {
      const clone = previewActions.cloneNode(true);
      clone.classList.add('mobile-cta-clone');
      clone.style.display = 'flex';
      clone.style.gap = '8px';
      clone.style.marginTop = '8px';
      clone.querySelectorAll('button').forEach(b => b.addEventListener('click', (ev) => {
        // forward clicks to original actions (match by data-action or class)
        const action = b.getAttribute('data-action') || '';
        if (action === 'add-to-cart') {
          const orig = modal.querySelector('.preview-actions [data-action="add-to-cart"], .preview-actions .btn.btn-cta');
          if (orig) orig.click();
        } else {
          // fallback: try to click the original button with same class/text
          const label = b.textContent.trim();
          const orig = Array.from(modal.querySelectorAll('.preview-actions .btn')).find(o => o.textContent.trim() === label);
          if (orig) orig.click();
        }
      }));
      mobileFooter.appendChild(clone);
    }
  }
  ensureMobileCTA();
  window.addEventListener('resize', () => setTimeout(ensureMobileCTA, 120));

  // expose small API for debug
  window._builder_preview = { setPreviewImage, ensureMobileCTA };
})();

    /* ======= Cart repair & robust binding (paste near end of scripts) ======= */
(function(){
  'use strict';

  const STORAGE_KEY = 'wrapdistrict_cart_v3'; // match existing key if you used another, change here
  // Find an actual cart drawer element robustly (support duplicate IDs or different class names)
  function findCartDrawer() {
    // prefer an element with id cart-drawer that is in the document body and visible
    const byIdAll = Array.from(document.querySelectorAll('#cart-drawer, .cart-drawer'));
    if (!byIdAll.length) return null;
    // prefer the last appended to body (likely the intended one)
    for (let i = byIdAll.length - 1; i >= 0; i--) {
      const el = byIdAll[i];
      if (document.body.contains(el)) return el;
    }
    return byIdAll[0];
  }

  const drawer = findCartDrawer();
  if (!drawer) { console.warn('Cart repair: no cart drawer found'); return; }

  // canonical selectors inside drawer (support multiple variants)
  const itemsListSelector = '.cart-items, #cart-items, .cart-items-list';
  const emptyBlockSelector = '.cart-empty, #cart-empty';
  const subtotalSel = '#cart-subtotal, .cart-subtotal';
  const deliverySel = '#cart-delivery, .cart-delivery';
  const totalSel = '#cart-total, .cart-total';
  const badgeSelectors = ['#cart-count','#cart-badge','.cart-badge'];

  // load/save
  function loadCartFromStorage() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : [];
    } catch (e) { return []; }
  }
  function saveCartToStorage(c) {
    try { localStorage.setItem(STORAGE_KEY, JSON.stringify(c)); } catch(e){ console.warn('persist err', e); }
  }

  // in-memory cart
  let cart = window.WrapDistrict && Array.isArray(window.WrapDistrict.cart) ? window.WrapDistrict.cart : (window.cart || loadCartFromStorage() || []);
  // ensure we sync to window for other scripts
  window.cart = cart;
  window.WrapDistrict = window.WrapDistrict || {};
  window.WrapDistrict.cart = cart;

  // small format
  const fmt = (n) => `GHC ${Number(n || 0).toFixed(2)}`;

  // compute totals (subtotal, delivery, total). Delivery default 0 (can be changed via radio)
  let activeDeliveryFee = (cart.length ? 10 : 0);

  function computeTotals() {
    const subtotal = cart.reduce((s,it) => s + (Number(it.unitPrice || 0) * Number(it.qty || 1)), 0);
    const delivery = cart.length ? activeDeliveryFee : 0;
    const total = subtotal + delivery;
    return { subtotal: round2(subtotal), delivery: round2(delivery), total: round2(total) };
  }
  function round2(n){ return Math.round(Number(n || 0) * 100) / 100; }

  // DOM refs
  const itemsList = drawer.querySelector(itemsListSelector);
  const emptyBlock = drawer.querySelector(emptyBlockSelector);
  const subtotalEl = drawer.querySelector(subtotalSel);
  const deliveryEl = drawer.querySelector(deliverySel);
  const totalEl = drawer.querySelector(totalSel);

  // update cart badges (header)
  function updateCartBadges() {
    const count = cart.reduce((s,it) => s + Number(it.qty||0), 0);
    badgeSelectors.forEach(sel => {
      const el = document.querySelector(sel);
      if (!el) return;
      el.textContent = String(count);
      el.setAttribute('data-count', String(count));
      // small pulse
      el.classList && el.classList.add('pulse');
      setTimeout(()=> el.classList && el.classList.remove('pulse'), 700);
    });
  }

  // Render the cart drawer contents (stable ids)
  function renderCartUI() {
    // update items list
    if (itemsList) {
      itemsList.innerHTML = '';
      if (!cart.length) {
        if (emptyBlock) emptyBlock.style.display = '';
      } else {
        if (emptyBlock) emptyBlock.style.display = 'none';
        cart.forEach(item => {
          const li = document.createElement('li');
          li.className = 'cart-item';
          li.dataset.itemId = item.id || item.productId || (`item-${Date.now()}`);
          li.innerHTML = `
            <img src="${escapeHtml(item.image || '')}" alt="${escapeHtml(item.name || '')}" onerror="this.src='${(window.IMAGES && window.IMAGES['thumb-shawarma'])||''}'" />
            <div class="details">
              <strong class="name">${escapeHtml(item.name || '')}</strong>
              <div class="desc">${escapeHtml(item.optionsSummary || (item.variant || ''))}</div>
            </div>
            <div class="meta">
              <div class="price">${fmt(Number(item.unitPrice || 0) * Number(item.qty || 1))}</div>
              <div class="qty-controls" role="group" aria-label="Quantity controls">
                <button type="button" class="qty-dec" aria-label="Decrease quantity">−</button>
                <div class="qty-value" aria-live="polite">${Number(item.qty || 1)}</div>
                <button type="button" class="qty-inc" aria-label="Increase quantity">+</button>
              </div>
              <button class="remove-item" aria-label="Remove item"><i class="fa fa-trash"></i></button>
            </div>
          `;
          itemsList.appendChild(li);
        });
      }
    }

    // update totals
    const t = computeTotals();
    if (subtotalEl) subtotalEl.textContent = fmt(t.subtotal);
    if (deliveryEl) deliveryEl.textContent = fmt(t.delivery);
    if (totalEl) totalEl.textContent = fmt(t.total);

    // ensure global expose
    window.cart = cart;
    window.WrapDistrict.cart = cart;
  }

  // safe escape
  function escapeHtml(s) { return String(s || '').replace(/[&<>"']/g, c => ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c])); }

  // helper to find item index by id
  function findIndexById(id) {
    return cart.findIndex(x => (String(x.id || x.productId || '') === String(id)));
  }

  // persist + UI refresh wrapper
  function persistAndRender() {
    saveCartToStorage(cart);
    updateCartBadges();
    renderCartUI();
  }

  // wrap existing addToCartObj if it exists, otherwise provide one
  const _existingAdd = window.addToCartObj;
  window.addToCartObj = function addToCartOverride(item) {
    try {
      if (typeof _existingAdd === 'function') {
        // call existing implementation (keeps other code paths working)
        _existingAdd(item);
        // try to reload from storage (in case existing add persisted)
        cart = loadCartFromStorage();
      } else {
        // conservative add: merge by productId+variant+extras
        const matchIndex = cart.findIndex(ci => ci.productId === item.productId
          && ci.variant === item.variant
          && JSON.stringify(ci.extras || {}) === JSON.stringify(item.extras || {}));
        if (matchIndex > -1) {
          cart[matchIndex].qty = Math.min(999, (cart[matchIndex].qty || 0) + (item.qty || 1));
        } else {
          cart.push(Object.assign({}, item, { qty: item.qty || 1 }));
        }
      }
    } catch (err) {
      console.warn('addToCartOverride error', err);
      // fallback: push raw item
      try { cart.push(Object.assign({}, item, { qty: item.qty || 1 })); } catch(e){}
    }
    // persist & render
    persistAndRender();
  };

  // open/close drawer helpers
  function openCartDrawer() {
    // prefer method on page if exists
    if (typeof window.openCartDrawer === 'function') try { window.openCartDrawer(); return; } catch(e){}
    // otherwise toggle drawer visibility
    drawer.hidden = false;
    drawer.setAttribute('aria-hidden','false');
    document.documentElement.classList.add('no-scroll');
    // focus first interactive element for keyboard users
    const focusable = drawer.querySelector('button, [href], input, [tabindex]:not([tabindex="-1"])');
    focusable && focusable.focus();
    renderCartUI();
  }
  function closeCartDrawer() {
    if (typeof window.closeCartDrawer === 'function') try { window.closeCartDrawer(); return; } catch(e){}
    drawer.hidden = true;
    drawer.setAttribute('aria-hidden','true');
    document.documentElement.classList.remove('no-scroll');
  }

  // delegate clicks inside itemsList for qty and remove
  if (itemsList) {
    itemsList.addEventListener('click', (ev) => {
      const inc = ev.target.closest('.qty-inc');
      const dec = ev.target.closest('.qty-dec');
      const rem = ev.target.closest('.remove-item');
      const li = (inc || dec || rem) ? (inc || dec || rem).closest('.cart-item') : null;
      if (!li) return;
      const id = li.dataset.itemId;
      const idx = findIndexById(id);
      if (idx === -1) return;
      ev.preventDefault();

      if (inc) {
        cart[idx].qty = Math.min(999, Number(cart[idx].qty || 0) + 1);
        persistAndRender();
        return;
      }
      if (dec) {
        cart[idx].qty = Math.max(1, Number(cart[idx].qty || 0) - 1);
        persistAndRender();
        return;
      }
      if (rem) {
        // animate removal if you have CSS for .removing
        const el = li;
        el.classList.add('removing');
        setTimeout(() => {
          cart.splice(idx, 1);
          persistAndRender();
        }, 220);
        return;
      }
    });

    // keyboard support for qty (Enter triggers the clicked control)
    itemsList.addEventListener('keydown', (ev) => {
      if (ev.key !== 'Enter') return;
      const btn = ev.target.closest('.qty-dec, .qty-inc, .remove-item');
      btn && btn.click();
    });
  }

  // bind open/close triggers globally (handles buttons in header etc)
  document.addEventListener('click', (ev) => {
    const open = ev.target.closest('[data-action="open-cart"], .cart-btn, #cart-toggle, .cart-toggle, .icon-btn.cart-btn');
    if (open) { ev.preventDefault(); openCartDrawer(); return; }
    const close = ev.target.closest('[data-action="close-cart"], .drawer-close, .cart-close, #cart-drawer .cart-close, .close-cart');
    if (close) { ev.preventDefault(); closeCartDrawer(); return; }
  });

  // wire delivery radio inputs inside drawer (if present)
  function bindDeliveryInputs() {
    try {
      const radios = drawer.querySelectorAll('input[type="radio"][name="delivery"], input[type="radio"][name="delivery-type"]');
      if (!radios || !radios.length) return;
      radios.forEach(r => {
        r.addEventListener('change', (e) => {
          const val = e.target.value;
          // if value is numeric treat as fee, if 'delivery' apply GHC10
          if (!isNaN(Number(val))) activeDeliveryFee = Number(val);
          else activeDeliveryFee = (String(val).toLowerCase().includes('delivery') ? 10 : 0);
          persistAndRender();
        });
      });
      // set initial from checked input if present
      const checked = Array.from(radios).find(r => r.checked);
      if (checked) {
        const v = checked.value;
        activeDeliveryFee = (!isNaN(Number(v))) ? Number(v) : (String(v).toLowerCase().includes('delivery') ? 10 : 0);
      }
    } catch (e) { console.warn('bindDeliveryInputs err', e); }
  }
  bindDeliveryInputs();

  // wire apply promo / clear cart / checkout inside drawer (if present)
  (function bindDrawerActions(){
    const clear = drawer.querySelector('[data-action="clear-cart"], .clear-cart');
    if (clear) {
      clear.addEventListener('click', (e) => {
        e.preventDefault();
        if (!cart.length) return;
        if (!confirm('Clear your cart?')) return;
        cart = []; persistAndRender();
      });
    }
    const checkout = drawer.querySelector('[data-action="checkout-paystack"], .checkout, #checkout-btn, .btn.checkout');
    if (checkout) {
      checkout.addEventListener('click', (e) => {
        e.preventDefault();
        if (!cart.length) { window.toast && window.toast('Cart is empty'); return; }
        // keep original flow if available
        if (typeof window.openPaystackCheckout === 'function') {
          window.openPaystackCheckout({ amountGhc: cart.reduce((s,it)=>s + Number(it.unitPrice || 0) * Number(it.qty || 1), 0), reference: `cart-${Date.now()}` });
          return;
        }
        // fallback: show totals
        const t = computeTotals();
        alert(`Checkout — total ${fmt(t.total)} (this is a stub; wire your checkout).`);
      });
    }
  })();

  // initial render
  persistAndRender();

  // expose debug API
  window.CartAPI = {
    open: openCartDrawer,
    close: closeCartDrawer,
    cart: cart,
    persist: () => { saveCartToStorage(cart); renderCartUI(); },
    add: (it) => { window.addToCartObj(it); }
  };

  console.info('Cart repair module initialized — drawer:', drawer);
})();

    /* ===== Hero behavior: reliable ORDER & SEE MENU on mobile + responsive height tweak ===== */
(function(){
  const orderBtn = document.getElementById('vd-order');
  const seeMenuBtn = document.getElementById('vd-see-menu');
  const hero = document.getElementById('hero');
  const headerHeight = (() => {
    const h = document.querySelector('.site-header');
    return (h && parseInt(window.getComputedStyle(h).height || 64, 10)) || 64;
  })();

  function safeScrollToMenu() {
    const el = document.querySelector('#menu') || document.querySelector('.menu-section');
    if (!el) return;
    el.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  // behavior for ORDER button:
  // If VD_HERO (your hero helper) has a current slide with a key that maps to CATALOG -> openBuilder
  // fallback: scroll to menu and quick-add default item if catalog exists
  function orderHandler(e) {
    e && e.preventDefault();
    try {
      const cur = (window.VD_HERO && window.VD_HERO.current && window.VD_HERO.current()) || 0;
      const slides = (window.VD_HERO && window.VD_HERO.slides) || window.slidesData || [];
      const slide = slides[cur] || {};
      const key = slide.key || slide.id || null;
      if (key && window.CATALOG && window.CATALOG[key] && typeof window.openBuilder === 'function') {
        window.openBuilder(key);
        return;
      }
      // fallback: if catalog has any item, open its builder or quick-add the first
      if (window.CATALOG) {
        const first = Object.keys(window.CATALOG)[0];
        if (first && typeof window.openBuilder === 'function') { window.openBuilder(first); return; }
      }
      // otherwise scroll to menu
      safeScrollToMenu();
    } catch (err) {
      console.warn('orderHandler error', err);
      safeScrollToMenu();
    }
  }

  // SEE MENU always scrolls to menu
  function seeMenuHandler(e) { e && e.preventDefault(); safeScrollToMenu(); }

  if (orderBtn) { orderBtn.removeEventListener && orderBtn.removeEventListener('click', orderHandler); orderBtn.addEventListener('click', orderHandler); }
  if (seeMenuBtn) { seeMenuBtn.removeEventListener && seeMenuBtn.removeEventListener('click', seeMenuHandler); seeMenuBtn.addEventListener('click', seeMenuHandler); }

  // make dots touch-friendly: increase tap area by adding pointer cursor + larger hitbox
  document.querySelectorAll('.vd-dot').forEach(d => {
    d.style.touchAction = 'manipulation';
    d.style.cursor = 'pointer';
    d.setAttribute('aria-role','button');
  });

  // Keep hero min-height tuned after header height (useful for small phones with varying header)
  function adjustHeroHeight() {
    if (!hero) return;
    const vw = window.innerHeight || document.documentElement.clientHeight;
    // target about 60vh on small screens, 80vh on larger
    const isSmall = window.matchMedia('(max-width:720px)').matches;
    const targetVH = isSmall ? 0.60 : 0.80;
    const minPx = Math.max(320, Math.floor(vw * targetVH) - headerHeight);
    hero.style.minHeight = `calc(${minPx}px)`;
  }
  window.addEventListener('resize', adjustHeroHeight);
  window.addEventListener('orientationchange', adjustHeroHeight);
  setTimeout(adjustHeroHeight, 80);
})();

    
  </script>
</html>
