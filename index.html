<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wrap District — Mobile</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ----------------------------
  APPETIZING COLOR THEME — Food-focused
  Replace the original :root and body background rules with this block.
  ---------------------------- */
:root{
  /* Primary palette — warm & appetizing */
  --accent-1: #FF6A00;        /* vibrant orange - primary CTA */
  --accent-2: #FFD166;        /* warm golden yellow - highlight */
  --accent-3: #78C267;        /* fresh green - freshness / success */
  --accent-4: #D96A2B;        /* secondary orange (for subtle contrast) */

  /* Neutral / text */
  --bg-start: #0b0b0b;        /* deep charcoal for dramatic food photography */
  --bg-end:   #20140d;        /* warm deep brown tint */
  --muted:    #E6E1DC;        /* off-white for readable small text */
  --muted-2:  rgba(230,225,220,0.78);
  --text:     #FFF9F6;        /* main content text */

  /* Glass / cards */
  --glass: rgba(255,255,255,0.03);
  --glass-2: rgba(255,255,255,0.02);
  --glass-border: rgba(255,255,255,0.04);

  /* Shadows / radii */
  --card-shadow: 0 12px 40px rgba(0,0,0,0.65);
  --accent-shadow: 0 10px 30px rgba(255,106,0,0.12);
  --radius-lg: 14px;
  --radius-sm: 10px;

  --max-width: 420px;
  --safe-top: env(safe-area-inset-top, 12px);
}

/* Page background — warm, slightly textured gradient to make food photos pop */
body {
  background: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);
  color: var(--text);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  margin: 0;
  -webkit-text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Small tweaks to key UI pieces to match the palette */
.logo-mark{
  background: linear-gradient(135deg, var(--accent-1), var(--accent-4));
  color: #111; /* dark text on bright badge gives premium stamp look */
  font-weight:900;
  padding:6px 10px;
  border-radius:8px;
  font-size:16px;
  letter-spacing:1px;
  box-shadow: 0 8px 26px rgba(217,106,43,0.10), inset 0 -2px 0 rgba(0,0,0,0.06);
}

.logo-name{
  color: var(--accent-2);
  font-weight:700;
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:1px;
}

/* CTAs — primary and ghost tuned for better contrast */
.btn.primary{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: var(--accent-shadow);
  border: 0;
}
.btn.ghost{
  background: rgba(255,255,255,0.03);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* Slide eyebrow & titles tuned */
.eyebrow{ color: var(--accent-2); font-weight: 800; }
.slide-title{ color: var(--text); text-shadow: 0 10px 30px rgba(0,0,0,0.6); }
.slide-sub{ color: var(--muted-2); }

/* Accent icon colors used around slides */
.art-icon{ color: rgba(255,230,200,0.95); }

/* Cart badge uses the same appetizing gradient */
.cart-count, .cart-mini-count {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  box-shadow: var(--accent-shadow);
}

/* Menu cards: slightly warmer surfaces to read as food cards */
.menu-item{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: var(--radius-lg);
  padding: 10px;
  box-shadow: var(--card-shadow);
  border: 1px solid var(--glass-border);
}

/* Price chips: make them pop without feeling loud */
.menu-item::after{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  padding:6px 10px;
  border-radius:999px;
}

/* Promo badges */
.badge, .promo-badge, .promo-badge-small{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:900;
}

/* Cart lines warm accent for quantities */
.line-qty{ color: var(--accent-2); font-weight:900; }

/* Promo countdown chip tuned */
.promo-countdown-chip{ background: linear-gradient(90deg, var(--accent-1), var(--accent-2)); color:#111; }

/* Modal inner highlight for promo */
.entry-promo .modal-inner{
  background: linear-gradient(90deg, rgba(255,106,0,0.07), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,204,51,0.08);
}

/* Small accessibility improvement: ensure links on dark backgrounds are readable */
a { color: var(--accent-2); text-decoration: none; }



/* ---------- STICKY HEADER ---------- */
.sticky-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: calc(56px + var(--safe-top));
  padding-top: var(--safe-top);
  z-index: 1200;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(8px) saturate(130%);
  background: linear-gradient(180deg, rgba(10,10,10,0.6), rgba(10,10,10,0.45));
  border-bottom: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 6px 18px rgba(0,0,0,0.45);
}

/* header inner row */
.header-inner{
  width: 100%;
  max-width: var(--max-width);
  display:flex;
  align-items:center;
  gap:12px;
  padding:8px 14px;
  box-sizing: border-box;
}

/* Logo (left) */
.logo{
  display:flex;
  align-items:center;
  gap:8px;
  flex: 1 1 auto;
  cursor: default;
  user-select: none;
}
.logo-mark{
  background: linear-gradient(135deg, var(--accent-1), #ff8c2b);
  color: #111;
  font-weight:900;
  padding:6px 10px;
  border-radius:8px;
  font-size:16px;
  letter-spacing:1px;
  box-shadow: 0 6px 18px rgba(255,106,0,0.12), inset 0 -2px 0 rgba(0,0,0,0.08);
}
.logo-name{
  color: var(--accent-2);
  font-weight:700;
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:1px;
}

/* Icon buttons (cart, hamburger) */
.icon-btn{
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:20px;
  line-height:1;
  padding:8px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
  -webkit-tap-highlight-color: transparent;
}
.icon-btn:active{ transform: translateY(1px) scale(.995); }

/* Cart button specifically */
.cart-btn{
  position: relative;
  margin-right: 6px;
  color: var(--accent-2);
  font-size:20px;
  min-width:44px;
  min-height:44px;
  display:inline-grid;
  place-items:center;
}

/* cart count badge */
.cart-count{
  position: absolute;
  top: 6px;
  right: 6px;
  transform: translate(25%, -10%);
  background: linear-gradient(180deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  font-size:12px;
  padding:4px 6px;
  border-radius:999px;
  box-shadow: 0 6px 16px rgba(255,106,0,0.14);
  border: 2px solid rgba(255,255,255,0.05);
  min-width: 22px;
  text-align:center;
}

/* Hamburger on far right */
.ham-btn{
  color: var(--muted);
  font-size:20px;
  width:44px;
  height:44px;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* Ensure header elements are keyboard-focusable and visible */
.icon-btn:focus{ outline: 3px solid rgba(255,204,51,0.12); outline-offset: 3px; }

/* ---------- HERO SLIDESHOW (mobile-first, full-bleed) ---------- */
.hero-slideshow{
  margin-top: calc(56px + var(--safe-top)); /* push content under fixed header */
  width: 100%;
  max-width: var(--max-width);
  margin-left: auto;
  margin-right: auto;
  position: relative;
  overflow: visible;
  padding-bottom: 10px;
}

/* Slide wrapper */
.slides{
  position: relative;
  width: 100%;
  height: 66vh; /* large visual on phones */
  max-height: 560px;
  min-height: 360px;
  border-bottom-left-radius: 22px;
  border-bottom-right-radius: 22px;
  overflow: clip;
  box-shadow: var(--card-shadow);
}

/* Each slide - JS toggles display:block/none; keep transitions for overlay */
.slide{
  position: absolute;
  inset: 0;
  display: none; /* JS will set block for active one */
  will-change: opacity, transform;
}

/* full-bleed image */
.slide-img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  -webkit-user-drag: none;
  transform-origin: center center;
  transition: transform 900ms cubic-bezier(.2,.9,.3,1);
  filter: saturate(1.05) contrast(1.02);
  transform: scale(1.02);
}

/* subtle parallax on active slide */
.slide[style*="display: block"] .slide-img {
  transform: scale(1);
}

/* gradient overlay + frosted glass content */
.slide-overlay{
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(10,10,10,0.08) 0%, rgba(0,0,0,0.55) 70%);
  display: flex;
  align-items: flex-end;
  padding: 18px;
  box-sizing: border-box;
}

/* Slide content container (frosted card) */
.slide-content{
  width: 100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: 14px;
  padding: 14px;
  backdrop-filter: blur(6px) saturate(120%);
  border: 1px solid var(--glass-border);
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  display: flex;
  flex-direction: column;
  gap:8px;
  transform: translateY(8px);
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease;
}
/* ===== Header: larger cart icon, smaller badge ===== */
.cart-btn{
  position: relative;
  margin-right: 6px;
  color: var(--accent-2);
  /* made the icon visually larger and a bit more tappable */
  font-size: 26px;        /* was 20px */
  min-width:52px;        /* increased tap area */
  min-height:52px;
  display:inline-grid;
  place-items:center;
  border-radius:12px;
}
/* ---------- HERO IMAGE IMPROVEMENT (replace existing .slide-img block) ---------- */

/* show full image without aggressive cropping; keeps it centered and avoids upscaling */
.slide-img{
  width: 100%;
  height: 100%;
  object-fit: contain;        /* show the whole image (no crop) */
  object-position: center;    /* keeps the subject centered */
  display: block;
  -webkit-user-drag: none;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), filter 300ms ease;
  filter: saturate(1.03) contrast(1.02);
  transform: scale(1);        /* remove the intentional zoom */
  background-color: #000;     /* hides any tiny gaps with a neutral background */
}

/* keep slide-content animation behavior but no scale-change on active state */
.slide[style*="display: block"] .slide-img {
  transform: scale(1);
}

  .slide-img{
  width:100%;
  height:100%;
  object-fit: cover;   /* still fills container */
  object-position: center;
  transform: scale(0.98);   /* slight zoom-out to reduce aggressive cropping */
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), filter 300ms ease;
  filter: saturate(1.03) contrast(1.02);
}
.slide[style*="display: block"] .slide-img { transform: scale(0.98); }
  
/* cart count badge — smaller, tighter, and repositioned */
.cart-count{
  position: absolute;
  top: 6px;
  right: 6px;
  transform: translate(35%, -35%); /* nudged so it sits nicely on a bigger icon */
  background: linear-gradient(180deg, var(--accent-1), var(--accent-2));
  color: #111;
  font-weight:800;
  font-size:10px;        /* reduced from 12px */
  padding:3px 5px;       /* reduced padding for compactness */
  border-radius:999px;
  box-shadow: 0 6px 16px rgba(255,106,0,0.14);
  border: 2px solid rgba(255,255,255,0.05);
  min-width: 18px;       /* slightly smaller */
  text-align:center;
  line-height:1;
}

/* Keep the badge readable on very small screens */
@media (max-width:360px){
  .cart-btn{ font-size:24px; min-width:48px; min-height:48px; }
  .cart-count{ font-size:9px; padding:2px 5px; min-width:16px; transform: translate(35%, -40%); }
}
/* When slide is active, lift the card a bit */
.slide[style*="display: block"] .slide-content {
  transform: translateY(0);
  opacity: 1;
}

/* Eyebrow small label */
.eyebrow{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:12px;
  color: var(--accent-2);
  font-weight:700;
  text-transform:uppercase;
}

/* Headline */
.slide-title{
  font-size:20px;
  line-height:1.05;
  margin:0;
  color: #fff;
  text-shadow: 0 8px 30px rgba(0,0,0,0.6);
  letter-spacing: -0.2px;
  font-weight:800;
}

/* sub text */
.slide-sub{
  font-size:13px;
  color: rgba(255,255,255,0.86);
  margin:0;
}

/* CTA Buttons inside slides */
.slide-ctas{
  display:flex;
  gap:8px;
  margin-top:6px;
  flex-wrap:wrap;
}

/* Buttons style (used across site) */
.btn{
  border: 0;
  padding:10px 12px;
  border-radius: 12px;
  font-weight:700;
  font-size:13px;
  display:inline-flex;
  gap:8px;
  align-items:center;
  justify-content:center;
  min-height:44px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
}
.btn.primary{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
}
.btn.ghost{
  background: rgba(255,255,255,0.03);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* small / tiny */
.btn.small{ padding:8px 10px; font-size:13px; border-radius:10px; min-height:36px; }

/* decorative art icons floating around slide content */
.slide-art{
  position: absolute;
  right: 14px;
  top: 12px;
  display:flex;
  gap:8px;
  z-index: 15;
  pointer-events: none;
}
.art-icon{
  font-size:20px;
  color: rgba(255,255,255,0.9);
  opacity: 0.95;
  transform-origin: center;
  filter: drop-shadow(0 6px 20px rgba(0,0,0,0.4));
  animation: float 6s ease-in-out infinite;
}
.art-icon:nth-child(2){ animation-delay: 1.2s; transform: scale(.92); }

/* slide promo specific look */
.slide-promo .slide-content{
  border: 1px solid rgba(255,204,51,0.12);
  background: linear-gradient(180deg, rgba(255,106,0,0.06), rgba(255,255,255,0.02));
}

/* slideshow controls (bottom center) */
.slideshow-controls{
  position: absolute;
  left: 0;
  right: 0;
  bottom: 8px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:12px;
  z-index: 30;
  pointer-events: none;
}
.slideshow-controls .icon-btn { pointer-events: auto; background: rgba(0,0,0,0.45); color: #fff; border-radius: 10px; padding:8px; }

/* dots */
.slide-dots{
  display:flex;
  gap:8px;
  align-items:center;
  pointer-events: auto;
}
.dot{
  width:10px;
  height:10px;
  border-radius:999px;
  background: rgba(255,255,255,0.18);
  border: 1px solid rgba(255,255,255,0.04);
  padding:0;
}
.dot.is-active{
  width:34px;
  border-radius:999px;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  box-shadow: 0 8px 20px rgba(255,106,0,0.14);
}

/* ---------- Accessibility / touch improvements ---------- */
.icon-btn, .btn { touch-action: manipulation; -webkit-user-select: none; user-select: none; }
.slide .slide-content a, .slide .slide-content button { -webkit-tap-highlight-color: transparent; }

/* ---------- Animations ---------- */
@keyframes float{
  0% { transform: translateY(0) rotate(-2deg); opacity: .95; }
  50% { transform: translateY(-8px) rotate(2deg); opacity: 1; }
  100% { transform: translateY(0) rotate(-2deg); opacity: .95; }
}

/* ---------- Responsive tweaks for very small phones ---------- */
@media (max-width:360px){
  .slide-title { font-size:18px; }
  .slide-sub { font-size:12px; }
  .slide-content { padding: 12px; border-radius: 12px; }
  .slides { height: 62vh; min-height: 320px; }
}

/* ---------- Desktop (wider) graceful scale (won't be used as primary) ---------- */
@media (min-width: 640px){
  .hero-slideshow{ margin-top: calc(64px + var(--safe-top)); }
  .slides { height: 56vh; }
  .slide-title { font-size: 28px; }
  .slide-sub { font-size: 15px; }
}

/* ---------- Tiny utility classes used in body markup ---------- */
.hidden { display: none !important; }
.container-small { padding: 14px; max-width: var(--max-width); margin: 0 auto; box-sizing: border-box; }

</style>
  <style>
/* =========================
   Wrap District — Cart / Cart Drawer Styling (Mobile-first, gorgeous)
   Complements header & hero styles. Drop into your stylesheet.
   ========================= */

/* Reuse theme variables from earlier; provide fallbacks */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --bg-card: rgba(17,17,17,0.85);
  --glass-strong: rgba(255,255,255,0.04);
  --glass-soft: rgba(255,255,255,0.02);
  --shadow-xl: 0 22px 50px rgba(0,0,0,0.6);
  --radius-lg: 16px;
  --radius-sm: 10px;
  --cart-header-h: 72px;
  --cart-footer-h: 96px;
  --max-width: 420px;
}

/* ---------- CART DRAWER (off-canvas) ---------- */
.cart-drawer{
  position: fixed;
  top: 0;
  right: 0;
  width: 94%;
  max-width: var(--max-width);
  height: 100vh;
  background: linear-gradient(180deg, rgba(12,12,12,0.96), rgba(8,8,8,0.98));
  box-shadow: -28px 0 60px rgba(0,0,0,0.65);
  z-index: 1400;
  transform: translateX(110%);
  transition: transform 420ms cubic-bezier(.2,.9,.3,1), opacity 300ms ease;
  opacity: 0;
  display: none; /* JS toggles block + aria-hidden */
  border-left: 1px solid rgba(255,255,255,0.03);
  overflow: hidden;
  border-top-left-radius: 18px;
  border-bottom-left-radius: 18px;
}

/* When visible (JS sets aria-hidden="false" and display:block) */
.cart-drawer[aria-hidden="false"]{
  transform: translateX(0);
  opacity: 1;
  display: block;
}

/* ---------- Cart header ---------- */
.cart-header{
  height: var(--cart-header-h);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 14px 14px;
  gap:10px;
  box-sizing: border-box;
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-bottom: 1px solid rgba(255,255,255,0.03);
  position: relative;
  backdrop-filter: blur(6px) saturate(120%);
}
.cart-header h3{
  margin:0;
  font-size:16px;
  letter-spacing: .2px;
  color: var(--accent-2);
  font-weight:800;
  display:flex;
  align-items:center;
  gap:10px;
}
.cart-header .cart-mini-count{
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color:#111;
  font-weight:900;
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  box-shadow: 0 8px 30px rgba(255,106,0,0.12);
  border: 2px solid rgba(255,255,255,0.04);
}

/* close button */
#cart-close{
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:18px;
  padding:8px;
  border-radius:10px;
}
#cart-close:focus{ outline: 3px solid rgba(255,204,51,0.10); outline-offset:2px; }

/* ---------- Cart body (scrollable) ---------- */
.cart-body{
  padding: 12px;
  height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h));
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

    /* ---------- Cart: thumbnails + sticky footer polish (add after your cart styles) ---------- */

/* thumbnail inside cart line */
.cart-thumb{
  width:64px;
  height:56px;
  object-fit: cover;
  border-radius:8px;
  flex: 0 0 64px;
  margin-right:12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.45);
  border: 1px solid rgba(255,255,255,0.03);
}

/* adjust cart-line left area to align image + text nicely */
.cart-line .line-left{
  display:flex;
  align-items:center;
  gap:12px;
}

/* make footer sticky and slightly elevated */
.cart-footer{
  position: sticky;
  bottom: 0;
  z-index: 60;
  height: var(--cart-footer-h);
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(6,6,6,0.96), rgba(8,8,8,0.98));
  backdrop-filter: blur(6px) saturate(120%);
  box-shadow: 0 -8px 28px rgba(0,0,0,0.6);
  box-sizing: border-box;
}

/* give cart-body bottom padding so content never hides under sticky footer */
.cart-body{
  padding-bottom: calc(var(--cart-footer-h) + 18px);
}

/* small condensed summary inside footer for immediate totals */
.cart-footer .footer-summary{
  display:flex;
  align-items:center;
  gap:12px;
  min-width: 0;
  flex: 1 1 auto;
}
.cart-footer .footer-summary .total-label{ color: rgba(255,255,255,0.85); font-weight:800; font-size:13px; }
.cart-footer .footer-summary .total-value{ font-weight:900; font-size:16px; color: var(--accent-2); }

/* make checkout/clear buttons share space nicely on small screens */
.cart-footer .footer-actions{
  display:flex;
  gap:8px;
  width: 48%;
  min-width: 160px;
  justify-content: flex-end;
}

/* ensure cart-drawer content height calculation still works on larger screens */
@media (min-width: 640px) {
  .cart-body{ height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h)); }
}
    
/* Nice custom scrollbar (WebKit) */
.cart-body::-webkit-scrollbar{ width:8px; }
.cart-body::-webkit-scrollbar-thumb{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,0.3);
}

/* Empty cart message */
.cart-items .empty{
  padding: 28px 12px;
  text-align: center;
  color: rgba(255,255,255,0.75);
  font-weight:700;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius: 12px;
  margin: 6px 0 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.45) inset;
}

/* ---------- Cart line items ---------- */
.cart-items{ list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:10px; }

.cart-line{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 8px 28px rgba(0,0,0,0.45);
}

/* Free promo lines look lighter and friendly */
.cart-line.cart-free{
  background: linear-gradient(180deg, rgba(34,34,34,0.65), rgba(20,20,20,0.6));
  border: 1px dashed rgba(255,204,51,0.09);
  color: var(--accent-2);
}

/* left area - title & meta */
.line-left{
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width: 0;
  flex: 1 1 auto;
}
.line-title{
  font-size:14px;
  font-weight:800;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.line-meta{
  color: rgba(255,255,255,0.66);
  font-size:13px;
  font-weight:700;
}

/* right area - controls */
.line-controls{
  display:flex;
  align-items:center;
  gap:8px;
  flex: 0 0 auto;
}

/* round quantity controls */
.icon-btn.cart-increase, .icon-btn.cart-decrease, .icon-btn.cart-remove {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.04);
  width:40px;
  height:40px;
  display:inline-grid;
  place-items:center;
  border-radius:10px;
  color: var(--muted);
  font-size:16px;
  transition: transform 150ms ease, background 180ms ease, color 180ms ease;
}
.icon-btn.cart-increase:hover, .icon-btn.cart-decrease:hover {
  transform: translateY(-3px);
  color: var(--accent-2);
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
}
.icon-btn.cart-remove{ color: rgba(255,140,100,0.95); border-color: rgba(255,140,100,0.06); }
.icon-btn.cart-remove:hover{ transform: translateY(-3px); color: #ff6a00; }

/* quantity number inside meta (if present) */
.line-qty{ font-weight:900; color: var(--accent-2); }

/* ---------- Promo / discount block ---------- */
.cart-promo{
  margin-top: 12px;
  padding: 12px;
  border-radius: 12px;
  background: linear-gradient(90deg, rgba(255,204,51,0.06), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,204,51,0.08);
  display:flex;
  flex-direction:column;
  gap:8px;
}
.promo-applied{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.promo-label{ font-weight:800; color: #fff; }
.promo-value{ font-weight:900; color: #111; background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); padding:6px 10px; border-radius:999px; }

/* helper row */
.promo-cta{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:6px; }
#add-missing{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:8px 10px;
  border-radius:10px;
  border:0;
  font-weight:800;
  min-width:120px;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
}
.promo-cta small{ color: rgba(255,255,255,0.78); font-weight:700; }

/* ---------- Cart summary ---------- */
.cart-summary{
  margin-top: 14px;
  padding: 12px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  display:flex;
  flex-direction:column;
  gap:8px;
}
.summary-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  color: rgba(255,255,255,0.9);
  font-weight:700;
  font-size:15px;
  padding:6px 0;
}
.summary-row.total{
  font-size:18px;
  color:#fff;
  font-weight:900;
  border-top: 1px dashed rgba(255,255,255,0.04);
  padding-top:10px;
}

/* ---------- Cart footer (checkout actions) ---------- */
.cart-footer{
  height: var(--cart-footer-h);
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,0.03);
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:space-between;
  background: linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.04));
  box-sizing: border-box;
}
.btn.fullwidth{ width: 100%; padding: 14px; font-size:16px; border-radius:12px; }
.btn.primary.fullwidth{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  box-shadow: 0 12px 36px rgba(255,106,0,0.14);
}
.btn.ghost.fullwidth{
  background: transparent;
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.04);
}

/* small / tiny btn used in promo helper */
.btn.tiny{ padding:8px 10px; border-radius:10px; font-weight:800; }

/* ---------- Utility & focus ---------- */
.cart-drawer :focus { outline: none; }
.cart-drawer button:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 3px; border-radius: 10px; }

/* ---------- Micro animations ---------- */
.cart-line { transition: transform 250ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease; }
.cart-line:hover { transform: translateY(-3px); box-shadow: 0 30px 60px rgba(0,0,0,0.55); }

/* ---------- Responsive tweaks ---------- */
@media (min-width: 640px){
  .cart-drawer{
    width: 420px;
  }
  .cart-body{ height: calc(100vh - var(--cart-header-h) - var(--cart-footer-h)); }
  .cart-header h3{ font-size:18px; }
  .cart-line{ padding:14px; }
}

/* ---------- Small polish: badges used inside cart if any ---------- */
.badge-inline{
  background: rgba(255,204,51,0.08);
  color: var(--accent-2);
  font-weight:800;
  padding:6px 8px;
  border-radius: 999px;
  font-size:12px;
  border: 1px solid rgba(255,204,51,0.08);
}

/* ---------- End of cart styles ---------- */
</style>

  <style>
/* =========================
   Wrap District — Menu Section Styling (Mobile-first, ultra-appealing & appetizing)
   Use with the existing header / hero / cart styles. Focused on:
   - bold food photography cards
   - clear pricing tiers & CTA
   - tasty color palette, gradients, micro-anim
   ========================= */

/* Fallback theme variables (will reuse if already defined) */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --card-bg: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  --glass: rgba(255,255,255,0.03);
  --shadow-lg: 0 18px 40px rgba(0,0,0,0.6);
  --radius-lg: 14px;
  --radius-md: 12px;
  --max-width: 420px;
}

/* Container for menu section */
.menu-section{
  width: 100%;
  max-width: var(--max-width);
  margin: 12px auto 28px;
  padding: 0 14px;
  box-sizing: border-box;
}

/* Section heading */
.section-title{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:18px;
  color: var(--accent-2);
  font-weight:900;
  margin-bottom:8px;
  text-transform: none;
}
.section-sub{
  color: rgba(255,255,255,0.78);
  font-size:13px;
  margin-bottom:12px;
}

/* Menu grid (vertical list on mobile) */
.menu-grid{
  display:flex;
  flex-direction:column;
  gap:14px;
}

    /* ------- Menu container & tabs polish (add after menu styles) ------- */
.menu-container {
  padding: 12px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(6,6,6,0.92), rgba(12,12,12,0.95));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.55);
}

/* tabs */
.menu-tabs {
  display:flex;
  gap:8px;
  overflow-x:auto;
  padding: 8px 4px 12px;
  -webkit-overflow-scrolling: touch;
}
.menu-tabs .tab-btn {
  white-space:nowrap;
  flex:0 0 auto;
  border:0;
  padding:8px 12px;
  border-radius: 999px;
  background: rgba(255,255,255,0.02);
  color: var(--muted);
  font-weight:900;
  font-size:13px;
  cursor:pointer;
  outline: none;
  border: 1px solid rgba(255,255,255,0.02);
}
.menu-tabs .tab-btn.is-active {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color: #111;
  box-shadow: 0 12px 36px rgba(255,106,0,0.10);
}

/* visually distinct card: left accent + stronger contrast */
.menu-item {
  position: relative;
  padding: 12px;
  border-radius: 12px;
  display:block;
  transition: transform 220ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease;
  border-left: 6px solid transparent;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
}
.menu-item:focus,
.menu-item:hover {
  transform: translateY(-6px);
  box-shadow: 0 36px 80px rgba(0,0,0,0.6);
  border-left-color: rgba(255,106,0,0.95);
  outline: none;
}

/* larger, rounder thumbnail so items are easier to distinguish */
.item-thumb {
  width:110px;
  height:86px;
  border-radius:12px;
  flex:0 0 110px;
  object-fit: cover;
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 8px 28px rgba(0,0,0,0.45);
}

/* stronger title contrast */
.item-title { font-size:16px; color:#fff; }

/* small spacing improvements */
.menu-grid { display:flex; flex-direction:column; gap:14px; }

/* On larger widths show two-column grid */
@media (min-width: 540px) {
  .menu-grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
}

/* increase hit-target for add/remove on mobile */
.action-row .btn { min-width:48px; padding:10px 14px; }

/* small focus ring for keyboard users */
.menu-item:focus { box-shadow: 0 8px 30px rgba(0,0,0,0.55), 0 0 0 3px rgba(255,204,51,0.06); }
    
/* Each menu card */
.menu-item{
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 10px;
  box-shadow: var(--shadow-lg);
  border: 1px solid rgba(255,255,255,0.03);
  overflow: hidden;
  transition: transform 240ms cubic-bezier(.2,.9,.3,1), box-shadow 240ms ease;
}

/* Lift on hover/tap */
.menu-item:active,
.menu-item:hover{
  transform: translateY(-6px);
  box-shadow: 0 36px 80px rgba(0,0,0,0.6);
}

/* Top row: image + meta */
.item-top{
  display:flex;
  gap:12px;
  align-items:flex-start;
}

/* Round-edge image thumb */
.item-thumb{
  width:94px;
  height:84px;
  object-fit:cover;
  border-radius:12px;
  flex: 0 0 94px;
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 10px 30px rgba(0,0,0,0.45);
  transform-origin: center;
  transition: transform 420ms cubic-bezier(.2,.9,.3,1);
}

/* Zoom subtle on hover */
.menu-item:hover .item-thumb{ transform: scale(1.03) rotate(-0.5deg); }

/* Title + desc area */
.item-meta{
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width: 0;
}
.item-title{
  font-size:16px;
  color: #fff;
  font-weight:900;
  line-height:1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  display:flex;
  align-items:center;
  gap:8px;
}
.item-desc{
  color: rgba(255,255,255,0.78);
  font-size:13px;
  margin-top:2px;
}

/* Badges (promo, small) */
.badge, .promo-badge, .promo-badge-small{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  font-size:11px;
  padding:6px 8px;
  border-radius:999px;
  box-shadow: 0 10px 26px rgba(255,106,0,0.12);
  border: 1px solid rgba(255,255,255,0.04);
  display:inline-flex;
  align-items:center;
  gap:8px;
}

/* Smaller badge variant */
.promo-badge-small{ padding:4px 6px; font-size:11px; font-weight:800; background: rgba(255,255,255,0.03); color: var(--accent-2); border:1px solid rgba(255,255,255,0.03); box-shadow:none; }

/* Item config area (selects, addons) */
.item-config{
  margin-top:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Labels */
.label{ font-size:12px; color: var(--muted); font-weight:800; text-transform:uppercase; letter-spacing: .8px; }

/* Custom styled select (appearance: none replacement) */
.select{
  appearance: none;
  -webkit-appearance: none;
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border: 1px solid rgba(255,255,255,0.04);
  color: #fff;
  font-weight:800;
  font-size:14px;
  outline: none;
  box-shadow: 0 6px 20px rgba(0,0,0,0.45) inset;
  background-image: linear-gradient(45deg, rgba(255,255,255,0.06) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.06) 50%, rgba(255,255,255,0.06) 75%, transparent 75%, transparent);
  background-size: 12px 12px;
  background-position: right 12px center;
}

/* Add-ons row */
.addons-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* Styled addon checkbox label */
.addon{
  display:flex;
  gap:8px;
  align-items:center;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  padding:8px 10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.03);
  font-weight:800;
  color: var(--muted);
  font-size:13px;
  cursor: pointer;
  transition: transform 180ms ease, box-shadow 200ms ease;
}

/* Hide native checkbox visually but keep accessible */
.addon input[type="checkbox"]{
  appearance:none;
  -webkit-appearance:none;
  width:18px;
  height:18px;
  border-radius:6px;
  border:2px solid rgba(255,255,255,0.06);
  background: transparent;
  margin:0;
  display:inline-block;
}

/* Checked state */
.addon input[type="checkbox"]:checked{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  border-color: rgba(255,255,255,0.02);
  box-shadow: 0 6px 18px rgba(255,106,0,0.12);
}

/* Text near checkbox */
.addon span{ font-weight:800; color: rgba(255,255,255,0.9); font-size:13px; }

/* Actions row: price + buttons */
.item-actions{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-top:8px;
}

/* Price display */
.price-row{
  display:flex;
  flex-direction:column;
  gap:4px;
  align-items:flex-start;
}
.price-label{ font-size:12px; color: var(--muted); font-weight:800; }
.item-price{ font-size:16px; font-weight:900; color: var(--accent-2); }

/* Action buttons */
.action-row{ display:flex; gap:8px; align-items:center; }
.add-btn, .remove-btn{
  border:0;
  padding:10px 12px;
  border-radius:12px;
  font-weight:900;
  font-size:13px;
  min-height:44px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
  transition: transform 160ms ease, box-shadow 200ms ease;
}
.add-btn{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
  border: 1px solid rgba(255,255,255,0.02);
}
.remove-btn{
  background: rgba(255,255,255,0.02);
  color: var(--muted);
  border: 1px solid rgba(255,255,255,0.03);
}

/* Hidden utility */
.hidden{ display:none !important; }

/* Micro interactions */
.add-btn:active, .remove-btn:active{ transform: translateY(1px) scale(.995); }
.menu-item:hover .add-btn{ transform: translateY(-3px); }

/* Price chip inside card for quick glance (top-right) */
.menu-item::after{
  content: attr(data-price);
  position: absolute;
  right: 18px;
  top: 12px;
  font-size:12px;
  font-weight:900;
  color:#111;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  padding:6px 10px;
  border-radius:999px;
  box-shadow: 0 10px 26px rgba(255,106,0,0.12);
  display:none; /* hidden by default; optional */
}

/* Promo microcopy when tapping eligible item (small note area) */
.menu-item .promo-note{
  margin-top:8px;
  background: rgba(255,255,255,0.02);
  padding:8px 10px;
  border-radius:10px;
  color: rgba(255,255,255,0.86);
  font-size:13px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

/* "Add missing items" small CTA inside menu (non-blocking) */
.menu-item .promo-cta-small{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:6px 8px;
  border-radius:8px;
  font-weight:900;
  font-size:12px;
}

/* Accessibility & touch improvements */
.select, .add-btn, .remove-btn, .addon, .item-thumb { -webkit-tap-highlight-color: transparent; touch-action: manipulation; }

/* Responsive adjustments */
@media (min-width: 420px){
  .menu-grid{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:16px;
  }
  .item-thumb{ width:120px; height:100px; flex:0 0 120px; border-radius:14px; }
  .item-title{ font-size:17px; }
}

/* Small polish: shimmer on price value when user changes options */
.item-price .price-value {
  display:inline-block;
  transition: transform 220ms cubic-bezier(.2,.9,.3,1);
}
.item-price.updated .price-value { transform: translateY(-4px); }

    /* ==========================
   Preorder Modal Styles
   Matches site variables (uses --accent-1 / --accent-2)
   Mobile-first, accessible, animated, with sticky CTA bar
   ========================== */

.preorder-modal { /* overlay wrapper */
  position: fixed;
  inset: 0;
  display: none; /* JS toggles display / aria-modal */
  align-items: flex-end; /* slide-up from bottom on mobile */
  justify-content: center;
  z-index: 2200;
  background: rgba(6,6,6,0.6);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
  padding: 12px;
  box-sizing: border-box;
}

/* show when aria-modal true */
.preorder-modal[aria-modal="true"] {
  display: flex;
  animation: preorder-overlay-in 260ms cubic-bezier(.2,.9,.3,1);
}

/* inner card */
.preorder-modal .modal-inner-preorder {
  width: 100%;
  max-width: 420px;
  border-radius: 14px 14px 8px 8px;
  background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(8,8,8,0.98));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  transform: translateY(18px);
  animation: preorder-card-in 360ms cubic-bezier(.2,.9,.3,1) forwards;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* header row */
.preorder-modal .preorder-header {
  display:flex;
  gap:12px;
  align-items:center;
  padding: 14px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
}
.preorder-modal .preorder-header .thumb {
  width:72px;
  height:64px;
  border-radius:10px;
  object-fit:cover;
  flex: 0 0 72px;
  border:1px solid rgba(255,255,255,0.04);
  box-shadow: 0 8px 30px rgba(0,0,0,0.45);
}
.preorder-modal .preorder-header .meta {
  flex: 1 1 auto;
  min-width:0;
}
.preorder-modal .preorder-header .meta .title {
  font-size:16px;
  font-weight:900;
  color:#fff;
  margin:0 0 4px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.preorder-modal .preorder-header .meta .subtitle {
  font-size:13px;
  color: rgba(255,255,255,0.82);
  margin:0;
}

/* countdown / weekday chip */
.preorder-modal .preorder-when {
  display:flex;
  gap:8px;
  align-items:center;
  padding: 12px 14px;
  border-bottom: 1px dashed rgba(255,255,255,0.02);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
}
.preorder-modal .countdown-chip {
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:8px 10px;
  border-radius:999px;
  font-weight:900;
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  color:#111;
  box-shadow: 0 12px 30px rgba(255,106,0,0.12);
  font-size:13px;
}

/* form area */
.preorder-modal .preorder-body {
  padding: 12px 14px 84px; /* bottom padding to allow for sticky CTA bar */
  display:flex;
  flex-direction:column;
  gap:12px;
  max-height: calc(100vh - 220px);
  overflow:auto;
}

/* qty + extras row */
.preorder-modal .row {
  display:flex;
  gap:10px;
  align-items:center;
  justify-content:space-between;
}

/* quantity control */
.preorder-modal .qty-control {
  display:flex;
  gap:8px;
  align-items:center;
}
.preorder-modal .qty-control button {
  width:40px;
  height:40px;
  border-radius:10px;
  border:0;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  color:var(--muted);
  font-weight:900;
  font-size:18px;
}
.preorder-modal .qty-control .qty-value {
  min-width:36px;
  text-align:center;
  font-weight:900;
  color: var(--accent-2);
}

/* date/time picker row */
.preorder-modal .datetime {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.preorder-modal .datetime input[type="date"],
.preorder-modal .datetime input[type="time"],
.preorder-modal .datetime select,
.preorder-modal .datetime .prefetch-select {
  padding:10px 12px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:800;
  font-size:14px;
  box-sizing:border-box;
}

/* extras list */
.preorder-modal .extras {
  display:flex;
  flex-direction:column;
  gap:8px;
}
.preorder-modal .extras label {
  display:flex;
  gap:10px;
  align-items:center;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  cursor:pointer;
  font-weight:800;
  color: var(--muted);
}
.preorder-modal .extras input[type="checkbox"] {
  width:18px;
  height:18px;
  border-radius:6px;
  border:2px solid rgba(255,255,255,0.06);
  appearance:none;
  -webkit-appearance:none;
}
.preorder-modal .extras input[type="checkbox"]:checked {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  border-color: rgba(255,255,255,0.02);
}

/* contact inputs */
.preorder-modal .contact-row {
  display:flex;
  gap:8px;
  flex-direction:column;
}
.preorder-modal .contact-row input[type="text"],
.preorder-modal .contact-row input[type="tel"],
.preorder-modal .contact-row input[type="email"] {
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:800;
  font-size:14px;
  box-sizing:border-box;
}

/* small helper text */
.preorder-modal .helper {
  font-size:13px;
  color: rgba(255,255,255,0.75);
  margin-top:2px;
}

/* sticky CTA bar (fixed to modal bottom) */
.preorder-modal .preorder-cta {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 12px;
  box-sizing: border-box;
  background: linear-gradient(180deg, rgba(8,8,8,0.00), rgba(0,0,0,0.6));
  border-top: 1px solid rgba(255,255,255,0.03);
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:space-between;
}
.preorder-modal .preorder-cta .price {
  font-weight:900;
  font-size:16px;
  color: var(--accent-2);
  min-width:120px;
  text-align:left;
}
.preorder-modal .preorder-cta .btn {
  min-width: 140px;
  padding:12px 14px;
  border-radius:12px;
  font-weight:900;
}

/* disabled state for submit */
.preorder-modal .btn[disabled] {
  opacity: 0.4;
  transform: none;
  pointer-events: none;
}

/* small close button top-right */
.preorder-modal .preorder-close {
  position:absolute;
  right: 10px;
  top: 8px;
  background: transparent;
  border: 0;
  color: var(--muted);
  font-size:18px;
  padding:8px;
  z-index: 10;
}

/* success state/shimmer for confirmation */
.preorder-modal .success {
  display:none;
  padding:18px;
  text-align:center;
  color: var(--accent-2);
  font-weight:900;
}
.preorder-modal.success-visible .success { display:block; }
.preorder-modal.success-visible .modal-inner-preorder { opacity: 0.2; pointer-events: none; }

/* Animations */
@keyframes preorder-overlay-in {
  from { opacity: 0; } to { opacity: 1; }
}
@keyframes preorder-card-in {
  from { transform: translateY(22px); opacity: 0; } to { transform: translateY(0); opacity: 1; }
}

/* Responsive tweaks for larger screens */
@media (min-width: 640px) {
  .preorder-modal { align-items: center; padding: 30px; }
  .preorder-modal .modal-inner-preorder { width: 560px; border-radius: 12px; }
  .preorder-modal .preorder-body { padding-bottom: 16px; max-height: calc(100vh - 160px); }
  .preorder-modal .preorder-cta { position: relative; background: transparent; border-top: none; }
}
/* End of menu styles */
</style>
  <style>
    /* -------------------------
   INPUT VISIBILITY FIX — paste after your other styles
   Applies to #checkout-page (Complete Order) and menu controls (.select, .addon)
   ------------------------- */

:root{
  /* fallback highlight when needed */
  --input-bg: rgba(255,255,255,0.03);
  --input-border: rgba(255,255,255,0.10);
  --placeholder: rgba(255,255,255,0.72);
  --input-focus: rgba(255,204,51,0.16);
}

/* Generic inputs / textareas used in checkout & preorders */
#checkout-page .input,
#preorder-modal .input,
#checkout-full-modal .input,
.input, input[type="text"], input[type="tel"], input[type="email"], textarea,
.select {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  /* slightly brighter so it sits above the page background */
  border: 1px solid var(--input-border);
  color: #fff !important;
  padding: 10px 12px;
  border-radius: 10px;
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.45);
  -webkit-appearance: none;
  appearance: none;
  outline: none;
}

/* Ensure placeholder text is readable */
input::placeholder, textarea::placeholder, .input::placeholder,
.select::placeholder {
  color: var(--placeholder) !important;
  opacity: 1;
}

/* Stronger focus state for accessibility */
#checkout-page .input:focus,
#preorder-modal .input:focus,
.input:focus,
.select:focus,
select:focus {
  box-shadow: 0 6px 24px var(--input-focus), inset 0 2px 6px rgba(0,0,0,0.5);
  border-color: rgba(255,204,51,0.22);
  outline: none;
  transform: translateZ(0);
}

/* Selects: show custom arrow and make the arrow visible on dark background */
.select, select {
  background-image:
    linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)),
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24'%3E%3Cpath fill='%23FFFFFF' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 14px;
  padding-right: 38px; /* room for arrow */
  cursor: pointer;
}

/* Make select text bold & clear */
.select, select { font-weight:800; color:#fff; }

/* Checkbox / addon styling — uses markup: <label class="addon"><input type="checkbox"/><span>Label</span></label> */
.addon {
  --box-size: 18px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color: rgba(255,255,255,0.92);
  cursor: pointer;
}

/* Visually hide native checkbox but keep accessible — we style a clear square instead */
.addon input[type="checkbox"] {
  -webkit-appearance: none;
  appearance: none;
  width: var(--box-size);
  height: var(--box-size);
  min-width: var(--box-size);
  display:inline-grid;
  place-items: center;
  border-radius: 6px;
  border: 2px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.02);
  margin: 0;
  transition: background 180ms ease, border-color 180ms ease, box-shadow 180ms ease, transform 120ms ease;
}

/* Unchecked: subtle contrast */
.addon input[type="checkbox"] + span { position: relative; padding-left: 0; }

/* Checked state: gradient + subtle checkmark */
.addon input[type="checkbox"]:checked {
  background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
  border-color: rgba(255,255,255,0.02);
  box-shadow: 0 8px 24px rgba(255,106,0,0.12);
  transform: translateY(-1px);
}

/* place a checkmark using adjacent span ::before for crisp vector-free rendering */
.addon input[type="checkbox"]:checked + span::before {
  content: '✔';
  position: absolute;
  left: -26px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 13px;
  color: #111;
  font-weight: 900;
  line-height: 1;
  /* give it a circle-like padding so it sits within the checkbox area visually */
  width: var(--box-size);
  height: var(--box-size);
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* ensure the text next to checkbox remains readable */
.addon span { color: rgba(255,255,255,0.95); font-weight:800; }

/* When the checkbox is focused via keyboard, show clear ring */
.addon input[type="checkbox"]:focus {
  outline: 3px solid rgba(255,204,51,0.14);
  outline-offset: 2px;
}

/* Make radio / hidden inputs / small selects visible inside modal / checkout too */
#checkout-page select, #checkout-page .input, #checkout-page textarea { color: #fff !important; }

/* Print/Save as PDF hints:
   - When printing we want input values to be visible (browser may hide backgrounds).
   - This rule brightens inputs when printing.
*/
@media print {
  input, textarea, select { background: #ffffff !important; color: #000 !important; -webkit-print-color-adjust: exact; }
  .addon input[type="checkbox"] { background: #000 !important; color:#fff !important; }
}
  </style>
  <style>
/* =========================
   Wrap District — Remaining UI: Modals, Promo Details, Mobile Nav, Entry Modal,
   Contact/Footer, Global utilities and finishing touches.
   Mobile-first, polished, accessible.
   Drop into your stylesheet after other styles.
   ========================= */

/* Reuse / fallback variables */
:root{
  --accent-1: #ff6a00;
  --accent-2: #ffcc33;
  --muted: #d7d7d7;
  --glass: rgba(255,255,255,0.03);
  --glass-strong: rgba(255,255,255,0.06);
  --bg-dark: #071013;
  --card-shadow: 0 12px 40px rgba(0,0,0,0.6);
  --max-width: 420px;
  --safe-top: env(safe-area-inset-top, 12px);
  --radius-lg: 14px;
}

/* ---------- GLOBAL / UTILITIES ---------- */
.container-small{ max-width:var(--max-width); margin:0 auto; padding:0 14px; box-sizing:border-box; }
.muted{ color: rgba(255,255,255,0.6); }
.small{ font-size:12px; color: rgba(255,255,255,0.7); }
.lead{ color: rgba(255,255,255,0.9); font-weight:700; }

/* subtle glass card */
.glass-card{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.03);
  border-radius: 12px;
  box-shadow: var(--card-shadow);
  padding: 12px;
}

/* Links */
a { color: var(--accent-2); text-decoration: none; }
a:focus, button:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 2px; }

/* ---------- MOBILE NAV (OFF-CANVAS) ---------- */
.mobile-nav{
  position: fixed;
  top: calc(56px + var(--safe-top));
  right: 0;
  left: 0;
  bottom: 0;
  background: linear-gradient(180deg, rgba(6,6,6,0.98), rgba(4,4,4,0.98));
  z-index: 1300;
  display: none;
  padding: 20px 14px;
  box-sizing: border-box;
  overflow-y: auto;
}
.mobile-nav[aria-hidden="false"]{ display:block; }
.mobile-nav-inner{ max-width: var(--max-width); margin: 0 auto; }
.mobile-nav .nav-list{ list-style:none; padding:0; margin: 20px 0; display:flex; flex-direction:column; gap:12px; }
.mobile-nav .nav-link{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 14px;
  border-radius: 10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border: 1px solid rgba(255,255,255,0.03);
  color: #fff;
  font-weight:800;
}
.mobile-nav .nav-link i{ width:20px; text-align:center; color: var(--accent-2); }

/* ---------- MODALS (generic) ---------- */
.modal{
  position: fixed;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1600;
  padding: 20px;
  background: rgba(3,3,3,0.6);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}
.modal[aria-modal="true"]{ display:flex; }

.modal .modal-inner{
  width: 100%;
  max-width: 420px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(6,6,6,0.98));
  border: 1px solid rgba(255,255,255,0.03);
  padding: 14px;
  box-shadow: 0 30px 80px rgba(0,0,0,0.65);
  transform: translateY(12px);
  transition: transform 260ms cubic-bezier(.2,.9,.3,1), opacity 240ms ease;
}
.modal .modal-inner .modal-body{ padding: 6px 2px; }
.modal .modal-close{ position:absolute; right:14px; top:12px; background:transparent; border:0; color:var(--muted); font-size:18px; }

/* small CTA in modal */
.modal .modal-actions{ display:flex; gap:10px; margin-top:10px; align-items:center; justify-content:flex-start; }

/* ---------- ENTRY PROMO STYLE (slide-in modal variant) ---------- */
.entry-promo.modal .modal-inner{
  background: linear-gradient(90deg, rgba(255,106,0,0.09), rgba(255,255,255,0.02));
  border: 1px solid rgba(255,204,51,0.08);
}
.entry-promo .lead{ font-size:15px; color:#fff; }

/* "Don't show again" label */
.dont-show{ display:flex; gap:8px; align-items:center; font-size:13px; color: rgba(255,255,255,0.8); margin-top:10px; }
.dont-show input{ width:18px; height:18px; }

/* ---------- PROMO DETAILS SECTION (in-page) ---------- */
.promo-detail{
  width: 100%;
  max-width: var(--max-width);
  margin: 6px auto 18px;
  padding: 0 14px;
  box-sizing: border-box;
}
.promo-copy{
  margin-top:8px;
  display:flex;
  gap:12px;
  flex-direction:column;
}
.promo-copy p{ margin: 6px 0; color: rgba(255,255,255,0.9); font-weight:700; }
.promo-help{ margin-top:8px; color: rgba(255,255,255,0.78); font-size:13px; }

/* Promo countdown inline chip used elsewhere */
.promo-countdown-chip{
  display:inline-flex;
  gap:8px;
  align-items:center;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  padding:8px 10px;
  border-radius: 999px;
  font-weight:900;
  box-shadow: 0 12px 30px rgba(255,106,0,0.12);
}

/* ---------- PROMO DETAILS - HELPFUL MICROCOPY ---------- */
.promo-note-inline{
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:space-between;
  background: rgba(255,255,255,0.02);
  padding:10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.02);
  color: rgba(255,255,255,0.9);
}

/* ---------- CONTACT / FOOTER ---------- */
.site-footer{
  width:100%;
  max-width: var(--max-width);
  margin: 20px auto 40px;
  padding: 12px 14px;
  box-sizing: border-box;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
}
.footer-row{
  display:flex;
  gap:12px;
  justify-content:space-between;
  align-items:flex-start;
  flex-direction:row;
}
.footer-left, .footer-right{ flex:1 1 50%; }
.footer-left h4, .footer-right h4{ margin:0 0 6px; color: var(--accent-2); font-weight:900; }
.footer-left p, .footer-right p{ margin:6px 0; color: rgba(255,255,255,0.8); font-weight:700; }
.footer-bottom{ margin-top:12px; text-align:center; color: rgba(255,255,255,0.6); font-size:12px; }

/* Footer small screen layout */
@media (max-width:520px){
  .footer-row{ flex-direction:column; gap:10px; }
}

/* ---------- TOAST / TEMP FEEDBACK (inline) ---------- */
.toast {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 14px;
  z-index: 1800;
  background: rgba(0,0,0,0.7);
  color: #fff;
  padding: 10px 14px;
  border-radius: 999px;
  font-weight:800;
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  display:none;
}
.toast.show{ display:block; animation: toast-in 320ms cubic-bezier(.2,.9,.3,1); }
@keyframes toast-in { from { opacity:0; transform: translateX(-50%) translateY(8px); } to { opacity:1; transform: translateX(-50%) translateY(0); } }

/* ---------- FORMS / INPUTS (if used in future) ---------- */
.input, input[type="text"], input[type="tel"], textarea {
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  color:#fff;
  font-weight:700;
  box-sizing: border-box;
}

/* ---------- SMALL POLISH: focus ring for keyboard users ---------- */
:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset:2px; border-radius:8px; }

/* ---------- PRINT & REDUCTION (if user prints) ---------- */
@media print {
  body * { visibility: hidden; }
  #cart-drawer, #cart-drawer * { visibility: visible; }
}
/* -------------------------
   Premium Mobile-First Footer
   Paste this after existing styles (overrides old .site-footer)
   ------------------------- */
.site-footer {
  width: 100%;
  max-width: 420px;
  margin: 18px auto 34px;
  box-sizing: border-box;
  padding: 14px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(18,18,18,0.98), rgba(8,8,8,0.95));
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  color: #fff;
  font-weight: 700;
  -webkit-font-smoothing: antialiased;
}

/* Top callout */
.footer-top {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}
.footer-brand {
  display:flex;
  gap:10px;
  align-items:center;
}
.footer-brand .logo-mark { font-size:14px; padding:6px 10px; border-radius:10px; }
.footer-brand .tagline { font-size:13px; color: rgba(255,255,255,0.88); font-weight:900; }

/* CTA group */
.footer-ctas { display:flex; gap:8px; align-items:center; }
.btn-footer {
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:12px;
  font-weight:900;
  font-size:14px;
  border:0;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;
}
.btn-order {
  background: linear-gradient(90deg, var(--accent-1, #FF6A00), var(--accent-2, #FFD166));
  color:#111;
  box-shadow: 0 12px 36px rgba(255,106,0,0.12);
}
.btn-wa {
  background: rgba(255,255,255,0.03);
  color: var(--accent-2, #FFD166);
  border: 1px solid rgba(255,255,255,0.04);
}

/* Footer content layout */
.footer-grid {
  display:flex;
  gap:12px;
  margin-top:6px;
  align-items:flex-start;
  justify-content:space-between;
  flex-direction:column;
}
.footer-row {
  display:flex;
  gap:10px;
  align-items:flex-start;
  justify-content:space-between;
  width:100%;
}
.footer-left, .footer-right {
  width:100%;
}

/* contact list */
.contact-list { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
.contact-row { display:flex; gap:10px; align-items:center; color: rgba(255,255,255,0.9); font-weight:800; font-size:14px; }
.contact-row i { color: var(--accent-2, #FFD166); min-width:22px; text-align:center; }

/* small meta blocks */
.meta-block { margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:space-between; }
.meta-block .hours { color: rgba(255,255,255,0.85); font-weight:800; }
.meta-block .delivery { color: rgba(255,255,255,0.78); font-weight:700; font-size:14px; }

/* pickup / map small row */
.pickup {
  margin-top:10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:10px;
  border-radius:10px;
  border: 1px solid rgba(255,255,255,0.03);
  display:flex;
  align-items:center;
  gap:10px;
  color: rgba(255,255,255,0.88);
  font-weight:800;
  font-size:13px;
}

/* bottom legal line */
.footer-bottom {
  margin-top:12px;
  font-size:12px;
  color: rgba(255,255,255,0.6);
  text-align:center;
}

/* responsive layout — two columns on wider phones */
@media (min-width: 420px) {
  .footer-grid { flex-direction: row; }
  .footer-left, .footer-right { width: 50%; }
  .footer-top { gap: 18px; }
}

/* small accessibility */
.site-footer a { color: inherit; text-decoration: none; }
.site-footer button:focus, .site-footer a:focus { outline: 3px solid rgba(255,204,51,0.10); outline-offset: 3px; border-radius:10px; }
    
/* ---------- END of remaining UI styles ---------- */
</style>
</head>
<body>
  <!-- STICKY HEADER (mobile-first: only logo, cart with badge, hamburger) -->
  <header id="site-header" class="sticky-header" role="banner" aria-live="polite">
    <div class="header-inner">
      <!-- Logo (left) -->
      <div class="logo" aria-label="Wrap District logo">
        <span class="logo-mark">WRAP</span>
        <span class="logo-name">District</span>
      </div>

      <!-- Cart (center/right) -->
      <button id="cart-toggle" class="icon-btn cart-btn" aria-haspopup="dialog" aria-controls="cart-drawer" aria-label="Open cart">
        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
        <span id="cart-count" class="cart-count" aria-live="polite">0</span>
      </button>

      <!-- Hamburger -->
      <button id="hamburger" class="icon-btn ham-btn" aria-expanded="false" aria-controls="mobile-nav" aria-label="Open menu">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </div>
  </header>

  <!-- MOBILE NAV (off-canvas) -->
  <nav id="mobile-nav" class="mobile-nav" aria-hidden="true">
    <div class="mobile-nav-inner">
      <button id="nav-close" class="icon-btn" aria-label="Close menu"><i class="fa fa-times"></i></button>
      <ul class="nav-list">
        <li><a href="#hero" class="nav-link"><i class="fa fa-home"></i> Home</a></li>
        <li><a href="#menu" class="nav-link"><i class="fa fa-list"></i> Menu</a></li>
        <li><a href="#promo" class="nav-link"><i class="fa fa-bullhorn"></i> Promo</a></li>
        <li><a href="#contact" class="nav-link"><i class="fa fa-map-marker"></i> Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- HERO: Mobile-first slideshow with 3 slides -->
  <main id="main">
    <section id="hero" class="hero-slideshow" aria-roledescription="carousel" aria-label="Hero slideshow">
      <div class="slides" id="slides">
        <!-- Slide 1: Business introduction (wraps & brand) -->
        <article class="slide" data-slide-index="0" aria-hidden="false">
          <img class="slide-img" src="hero-shawarma-large.jpg" alt="Close up shawarma wrap">
          <div class="slide-overlay">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-fire"></i> Fresh & Hot</p>
              <h1 class="slide-title">Shawarma & Wraps — Made to Order</h1>
              <p class="slide-sub">Premium fillings, house sauces, and fast delivery to Tema Community 25.</p>
              <div class="slide-ctas">
                <a href="#menu" class="btn primary"><i class="fa fa-utensils"></i> See Menu</a>
                <button class="btn ghost" data-action="order-now" data-feature="shawarma"><i class="fa fa-phone"></i> Order via WhatsApp</button>
              </div>
              <!-- decorative icons/artwork -->
              <div class="slide-art">
                <i class="fa fa-leaf art-icon"></i>
                <i class="fa fa-star art-icon"></i>
              </div>
            </div>
          </div>
        </article>

        <!-- Slide 2: Business highlight (fries & rice) -->
        <article class="slide" data-slide-index="1" aria-hidden="true">
          <img class="slide-img" src="hero-fries-large.jpg" alt="Loaded fries">
          <div class="slide-overlay">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-thumbs-up"></i> Crowd Favorite</p>
              <h2 class="slide-title">Loaded Fries • Fried Rice • Angwamo</h2>
              <p class="slide-sub">Generous portions, tasty toppings, and affordable tiers.</p>
              <div class="slide-ctas">
                <a href="#menu" class="btn primary"><i class="fa fa-list-alt"></i> Explore Portions</a>
                <a href="#promo" class="btn ghost"><i class="fa fa-gift"></i> Current Deals</a>
              </div>
              <div class="slide-art">
                <i class="fa fa-bolt art-icon"></i>
                <i class="fa fa-heart art-icon"></i>
              </div>
            </div>
          </div>
        </article>

        <!-- Slide 3: Promo -->
        <article class="slide" data-slide-index="2" aria-hidden="true">
          <img class="slide-img" src="promo-shawarma.jpg" alt="Promo: buy 2 get 1">
          <div class="slide-overlay slide-promo">
            <div class="slide-content">
              <p class="eyebrow"><i class="fa fa-clock"></i> Limited Time</p>
              <h2 class="slide-title">Tuesday Promo — Buy 2 Shawarmas, Get 1 Free</h2>
              <p class="slide-sub">Loaded Fries come with a free Coke when ordered during promo hours.</p>

           <!-- inside your Slide 3 slide-content where promo-cta-row exists -->
<div class="promo-cta-row">
  <button class="btn primary" data-action="apply-promo" data-promo-code="TUES-B2G1">
    <i class="fa fa-tag"></i> Claim Promo
  </button>

  <button class="btn ghost" data-action="learn-more" aria-controls="promo-details">
    <i class="fa fa-info-circle"></i> Details
  </button>

  <!-- NEW: Preorder button for the upcoming promo -->
  <button class="btn primary" data-action="preorder-promo" id="promo-preorder-btn">
    <i class="fa fa-calendar-check"></i> Preorder for next promo
  </button>
</div>

              <div class="promo-urgency">
                <span class="promo-countdown" id="promo-countdown" aria-live="polite">Promo ends in: <strong id="promo-timer">—</strong></span>
                <small class="promo-note">Next promo: Tuesdays • Add 2 Shawarmas to auto-apply.</small>
              </div>
            </div>
          </div>
        </article>
      </div>

      <!-- slideshow controls -->
      <div class="slideshow-controls">
        <button class="slide-prev icon-btn" aria-label="Previous slide"><i class="fa fa-chevron-left"></i></button>
        <div id="slide-dots" class="slide-dots" role="tablist" aria-label="Slide dots">
          <button class="dot is-active" data-index="0" aria-label="Slide 1"></button>
          <button class="dot" data-index="1" aria-label="Slide 2"></button>
          <button class="dot" data-index="2" aria-label="Slide 3"></button>
        </div>
        <button class="slide-next icon-btn" aria-label="Next slide"><i class="fa fa-chevron-right"></i></button>
      </div>
    </section>

    <!-- MENU: mobile-friendly, card-based, not a long table -->
<!-- MENU: mobile-friendly, card-based, improved -->
<section id="menu" class="menu-section" aria-labelledby="menu-heading">
  <div class="container-small">
    <h2 id="menu-heading" class="section-title"><i class="fa fa-utensils"></i> Menu</h2>
    <p class="section-sub">Tap an item to configure size, protein and add-ons. Use the tabs to filter quickly.</p>

    <!-- Category tabs (mobile horizontal scroll) -->
    <div class="menu-tabs" role="tablist" aria-label="Menu categories">
      <button class="tab-btn is-active" data-cat="all" role="tab" aria-selected="true">All</button>
      <button class="tab-btn" data-cat="wraps" role="tab">Wraps</button>
      <button class="tab-btn" data-cat="fries" role="tab">Fries</button>
      <button class="tab-btn" data-cat="rice" role="tab">Rice</button>
      <button class="tab-btn" data-cat="angwamo" role="tab">Angwamo</button>
      <button class="tab-btn" data-cat="noodles" role="tab">Noodles</button>
    </div>

    <!-- visual container for menu items -->
    <div class="menu-container glass-card">
      <div class="menu-grid" id="menu-grid">
        <!-- Shawarma (structured pricing tiers) -->
        <article class="menu-item" id="item-shawarma" data-item-id="shawarma" data-category="wraps" data-promo="buy2get1" tabindex="0">
          <!-- ...same inner markup as before (keeps selects/addons) ... -->
          <div class="item-top">
            <img class="item-thumb" src="thumb-shawarma.jpg" alt="Shawarma thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Shawarma <span class="badge promo-badge">Buy 2 → 1 Free</span></h3>
              <p class="item-desc">Choose size, then protein. Clear pricing tiers.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Size</label>
            <select class="select size-select" name="shawarma-size" aria-label="Shawarma size" data-item="shawarma">
              <option value="45" data-size-key="lite">Lite — GHC 45</option>
              <option value="55" data-size-key="classic">Classic — GHC 55</option>
              <option value="70" data-size-key="district-max">District Max — GHC 70</option>
            </select>

            <label class="label">Protein</label>
            <select class="select protein-select" name="shawarma-protein" aria-label="Shawarma protein" data-item="shawarma">
              <option value="0" data-protein="none">No meat (Veg) — +GHC 0</option>
              <option value="5" data-protein="chicken">Chicken — +GHC 5</option>
              <option value="10" data-protein="beef">Beef — +GHC 10</option>
              <option value="15" data-protein="mixed">Mixed — +GHC 15</option>
            </select>

            <div class="item-addons">
              <label class="label">Extras</label>
              <div class="addons-row">
                <label class="addon">
                  <input type="checkbox" class="addon-checkbox" value="5" data-addon-key="extra-sauce" />
                  <span>Extra Sauce (+GHC 5)</span>
                </label>
                <label class="addon">
                  <input type="checkbox" class="addon-checkbox" value="10" data-addon-key="cheese" />
                  <span>Extra Cheese (+GHC 10)</span>
                </label>
              </div>
            </div>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">45</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="shawarma">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="shawarma">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Loaded Fries -->
        <article class="menu-item" id="item-fries" data-item-id="loaded-fries" data-category="fries" data-promo="freecoke" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="thumb-fries.jpg" alt="Loaded fries thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Loaded Fries <span class="badge promo-badge-small">Free Coke</span></h3>
              <p class="item-desc">Choose portion & add protein/cheese.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Portion</label>
            <select class="select portion-select" name="fries-portion" aria-label="Fries portion" data-item="loaded-fries">
              <option value="55" data-size="regular">Regular — GHC 55</option>
              <option value="65" data-size="large">Large — GHC 65</option>
            </select>

            <label class="label">Toppings</label>
            <div class="addons-row">
              <label class="addon">
                <input type="checkbox" class="addon-checkbox" value="15" data-addon-key="extra-chicken" />
                <span>Extra Chicken (+GHC 15)</span>
              </label>
              <label class="addon">
                <input type="checkbox" class="addon-checkbox" value="10" data-addon-key="extra-cheese" />
                <span>Extra Cheese (+GHC 10)</span>
              </label>
            </div>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">55</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="loaded-fries">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="loaded-fries">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Fried Rice -->
        <article class="menu-item" id="item-fried-rice" data-item-id="fried-rice" data-category="rice" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="hero-friedrice-large.jpg" alt="Fried rice thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Fried Rice</h3>
              <p class="item-desc">Classic spiced fried rice — choose protein.</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Choice</label>
            <select class="select protein-select" name="rice-protein" aria-label="Fried rice protein" data-item="fried-rice">
              <option value="60" data-protein="chicken">Classic (+Chicken) — GHC 60</option>
              <option value="60" data-protein="beef">Beef (+Beef) — GHC 60</option>
              <option value="60" data-protein="gizzard">Gizzard (+Gizzard) — GHC 60</option>
            </select>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">60</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="fried-rice">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="fried-rice">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Loaded Angwamo -->
        <article class="menu-item" id="item-angwamo" data-item-id="loaded-angwamo" data-category="angwamo" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="hero-angwamo-large.jpg" alt="Angwamo thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Loaded Angwamo</h3>
              <p class="item-desc">Tiered: Basic / Classic / Max</p>
            </div>
          </div>

          <div class="item-config">
            <label class="label">Tier</label>
            <select class="select tier-select" name="angwamo-tier" aria-label="Angwamo tier" data-item="loaded-angwamo">
              <option value="55" data-tier="basic">Basic — GHC 55</option>
              <option value="60" data-tier="classic">Classic — GHC 60</option>
              <option value="70" data-tier="max">Max — GHC 70</option>
            </select>

            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Total</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">55</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="loaded-angwamo">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="loaded-angwamo">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Noodles -->
        <article class="menu-item" id="item-noodles" data-item-id="noodles" data-category="noodles" tabindex="0">
          <div class="item-top">
            <img class="item-thumb" src="thumb-noodle.jpg" alt="Noodles thumbnail">
            <div class="item-meta">
              <h3 class="item-title">Noodles</h3>
              <p class="item-desc">Assorted proteins available — GHC 50</p>
            </div>
          </div>

          <div class="item-config">
            <div class="item-actions">
              <div class="price-row">
                <span class="price-label">Price</span>
                <strong class="item-price" data-price-display>GHC <span class="price-value">50</span></strong>
              </div>

              <div class="action-row">
                <button class="btn small add-btn" data-action="add" data-item-id="noodles">
                  <i class="fa fa-plus-circle"></i> Add
                </button>
                <button class="btn small remove-btn hidden" data-action="remove" data-item-id="noodles">
                  <i class="fa fa-minus-circle"></i> Remove
                </button>
              </div>
            </div>
          </div>
        </article>

      </div> <!-- .menu-grid -->
    </div> <!-- .menu-container -->
  </div>
</section>

    <!-- PROMO DETAILS (collapsible region referenced by the slide CTA) -->
    <section id="promo" class="promo-detail" aria-labelledby="promo-heading">
      <div class="container-small">
        <h2 id="promo-heading" class="section-title"><i class="fa fa-gift"></i> Promo</h2>
        <div id="promo-details" class="promo-copy">
          <p><strong>Buy 2 Shawarmas, Get 1 Free (Tuesdays)</strong> — Promo applies automatically at checkout. Add two qualifying shawarmas and the third will be discounted to free.</p>
          <p><strong>Loaded Fries</strong> — Get a free Coke when purchasing during promo hours. Free item will appear in cart once qualifying product is added.</p>
         <!-- somewhere inside #promo-details (promo-copy) -->
<div style="margin-top:10px;">
  <button class="btn primary" data-action="preorder-promo">Preorder for next Tuesday Promo</button>
</div>
          <div class="promo-help">
            <small id="promo-helper" class="muted">Tip: use the "Add missing items" button in cart to reach a promo threshold instantly.</small>
          </div>
        </div>
      </div>
    </section>

    <!-- CART DRAWER (off-canvas, mobile-friendly) -->
    <aside id="cart-drawer" class="cart-drawer" role="dialog" aria-label="Shopping cart" aria-hidden="true">
      <div class="cart-header">
        <h3>Your Cart <span class="cart-mini-count" id="cart-mini-count">0</span></h3>
        <button class="icon-btn" id="cart-close" aria-label="Close cart"><i class="fa fa-times"></i></button>
      </div>

      <div class="cart-body" id="cart-body">
        <!-- line items will be injected here by JS -->
        <ul id="cart-items" class="cart-items" aria-live="polite"></ul>

        <!-- promo helper / discount line -->
        <div id="cart-promo" class="cart-promo hidden" aria-live="polite">
          <div class="promo-applied">
            <span class="promo-label">Promo discount</span>
            <span class="promo-value" id="promo-discount">-GHC 0</span>
          </div>
          <div class="promo-cta">
            <small id="promo-help-text">Add 1 more Shawarma to get one free.</small>
            <button class="btn tiny" id="add-missing">Add missing items</button>
          </div>
        </div>

        <div class="cart-summary">
          <div class="summary-row">
            <span>Subtotal</span>
            <strong id="cart-subtotal">GHC 0</strong>
          </div>
          <div class="summary-row">
            <span>Delivery</span>
            <strong id="cart-delivery">GHC 0</strong>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <strong id="cart-total">GHC 0</strong>
          </div>
        </div>
      </div>

      <div class="cart-footer">
  <div class="footer-summary" style="display: none">
    <div>
      <div class="small">Subtotal</div>
      <div class="total-label">Total</div>
    </div>
    <div style="margin-left:auto; text-align:right;">
      <div id="footer-subtotal" class="small">GHC 0</div>
      <div id="footer-total" class="total-value">GHC 0</div>
    </div>
  </div>

  <div class="footer-actions" style="margin-left:12px;">
    <button id="checkout-btn" class="btn primary" data-action="checkout" style="min-width:120px;">
      <i class="fa fa-credit-card"></i> Pay
    </button>
    <button id="clear-cart" class="btn ghost" data-action="clear" style="min-width:80px;">
      <i class="fa fa-trash"></i>
    </button>
  </div>
</div>
    </aside>

    <!-- ENTRY PROMO MODAL / SLIDE-IN for new visitors -->
    <div id="entry-promo" class="entry-promo modal hidden" role="dialog" aria-modal="true" aria-label="Tuesday Promo">
      <div class="modal-inner">
        <button id="entry-close" class="icon-btn modal-close" aria-label="Close promo"><i class="fa fa-times"></i></button>
        <div class="modal-body">
          <h3><i class="fa fa-gift"></i> Tuesday Promo</h3>
          <p class="lead">Buy 2 Shawarmas, get one free. Valid Tuesdays. Tap to claim now.</p>
          <div class="modal-actions">
            <button class="btn primary" id="claim-promo-entry" data-promo="TUES-B2G1"><i class="fa fa-tag"></i> Claim Promo</button>
            <label class="dont-show">
              <input type="checkbox" id="dont-show-again" />
              Don't show again
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- CONTACT / FOOTER -->
<footer id="contact" class="site-footer" role="contentinfo" aria-label="Contact and footer">
  <div class="footer-top">
    <div class="footer-brand" aria-hidden="false">
      <span class="logo-mark">WRAP</span>
      <div style="display:flex;flex-direction:column;">
        <span class="logo-name" style="font-weight:900; color:var(--accent-2)">District</span>
        <small class="tagline">Fresh. Hot. Fast — Delivered to Tema</small>
      </div>
    </div>

    <div class="footer-ctas" role="group" aria-label="Footer actions">
      <!-- Order: scrolls to menu / opens cart -->
      <button id="footer-order" class="btn-footer btn-order" aria-label="Order now">
        <i class="fa fa-utensils" aria-hidden="true"></i> Order
      </button>

      <!-- WhatsApp quick contact -->
      <a id="footer-wa" class="btn-footer btn-wa" href="https://wa.me/233552509241" target="_blank" rel="noopener noreferrer" aria-label="Chat on WhatsApp">
        <i class="fa fa-whatsapp" aria-hidden="true"></i> WhatsApp
      </a>
    </div>
  </div>

  <div class="footer-grid">
    <div class="footer-left">
      <div class="contact-list">
        <div class="contact-row"><i class="fa fa-phone"></i><a href="tel:0552509241">0552509241</a></div>
        <div class="contact-row"><i class="fa fa-map-marker"></i><span>Tema Community 25, Devtraco</span></div>
        <div class="contact-row"><i class="fa fa-snapchat-ghost"></i><span>@kenneth_idk</span></div>
      </div>

      <div class="pickup" aria-hidden="false">
        <i class="fa fa-store"></i>
        <div style="flex:1;">
          <div style="font-weight:900">Pickup available</div>
          <small style="color:rgba(255,255,255,0.78)">Devtraco — Tap Order to choose Pickup or Delivery</small>
        </div>
      </div>
    </div>

    <div class="footer-right">
      <div class="meta-block">
        <div class="hours"><i class="fa fa-clock"></i>&nbsp; Hours</div>
        <div style="text-align:right">
          <div style="font-weight:900">Mon–Fri: 5pm • Sat–Sun: 9am</div>
          <div class="delivery" style="margin-top:4px">Delivery: Available — fees at checkout</div>
        </div>
      </div>

      <div style="margin-top:10px">
        <button id="footer-locate" class="btn-footer btn-wa" aria-label="Show pickup location">
          <i class="fa fa-map"></i> Our location
        </button>
      </div>
    </div>
  </div>

  <div class="footer-bottom">
    <small>© Wrap District — Built for mobile • Images and prices subject to change</small>
  </div>
</footer>
    <!-- PREORDER MODAL -->
<div id="preorder-modal" class="modal" role="dialog" style ="display: none" aria-modal="true" aria-hidden="true">
  <div class="modal-inner">
    <button class="icon-btn modal-close" id="preorder-close" aria-label="Close"><i class="fa fa-times"></i></button>
    <div class="modal-body">
      <h3><i class="fa fa-calendar-plus"></i> Preorder for next Promo</h3>
      <p class="lead">We will reserve your current cart items for the next Tuesday promo window.</p>

      <form id="preorder-form">
        <label class="label">Name</label>
        <input id="preorder-name" class="input" type="text" placeholder="Your name" required>

        <label class="label">Phone</label>
        <input id="preorder-phone" class="input" type="tel" placeholder="0550xxxxxx" required>

        <label class="label">Note (optional)</label>
        <input id="preorder-note" class="input" type="text" placeholder="Delivery/pickup notes">

        <div style="display:flex; gap:8px; margin-top:10px;">
          <button type="submit" class="btn primary" id="preorder-confirm"><i class="fa fa-check"></i> Confirm Preorder</button>
          <button type="button" class="btn ghost" id="preorder-cancel">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
  </main>
 
  <style>
/* Checkout page (in-file, not a modal) — REPLACED: ensures it sits below the header and is scrollable on mobile */
#checkout-page {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 3200;
  background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6));
  /* place checkout below the fixed header so it doesn't get overlapped by browser UI */
  align-items: flex-start;
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
  /* allow the page container itself to scroll if content taller than viewport */
  overflow: auto;
}
#checkout-page[aria-hidden="false"] { display: flex; }

/* keep the inner dialog visually below the header and inside safe area */
#checkout-inner {
  width: 100%;
  max-width: 920px;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  background: linear-gradient(180deg,#080808,#050505);
  color: #fff;
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 0;
  /* push the dialog down so it appears like a page below your header + safe-area */
  margin-top: calc(56px + var(--safe-top, 12px) + 12px);
  /* keep the dialog height bounded so inner columns can scroll independently */
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 48px));
}
@media (max-width: 900px) { #checkout-inner { grid-template-columns: 1fr; } }

/* left and right columns should scroll individually */
.checkout-left {
  padding: 16px 18px;
  max-height: 100%;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}
.checkout-right {
  padding: 16px 18px;
  border-left: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  overflow: auto;
  max-height: 100%;
  -webkit-overflow-scrolling: touch;
}

/* small banner to highlight delivery-not-included message (style used by script) */
#checkout-delivery-note {
  display: block;
  margin-top: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  background: linear-gradient(90deg, rgba(255,160,80,0.06), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,160,80,0.08);
  color: rgba(255,255,255,0.9);
  font-weight:800;
  font-size:13px;
}

/* small responsive tweaks */
@media (max-width:600px){
  .checkout-right { padding-top:6px; }
  .order-line img { width:56px; height:44px; }
  .checkout-title { font-size:16px; }
}
</style>
  <style>
/* header right area inside cart header */
.cart-header .cart-header-right {
  display:flex;
  align-items:center;
  gap:10px;
  margin-left:auto;
}
.cart-header .cart-header-total {
  font-weight:900;
  color: var(--accent-2);
  font-size:14px;
  text-align:right;
  min-width:80px;
}
.cart-header .cart-header-checkout {
  border:0;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#111;
  font-weight:900;
  padding:8px 10px;
  border-radius:10px;
  display:inline-flex;
  gap:8px;
  align-items:center;
  cursor:pointer;
  box-shadow: 0 8px 26px rgba(255,106,0,0.10);
}
.cart-header .cart-header-checkout:active { transform: translateY(1px) scale(.995); }
.tab-btn[role="tab"] { cursor:pointer; }
</style>


<style>
/* Basic modal sizing tweaks (uses existing .modal/.modal-inner from your CSS) */
#product-modal .modal-inner { max-width:520px; width:100%; padding:0; border-radius:14px; overflow:hidden; }
#product-modal .pm-header{ display:flex; gap:12px; padding:12px; align-items:center; background:linear-gradient(180deg, rgba(10,10,10,0.98), rgba(6,6,6,0.98)); border-bottom:1px solid rgba(255,255,255,0.03);}
#product-modal .pm-thumb{ width:110px; height:86px; object-fit:cover; border-radius:10px; flex: 0 0 110px; border:1px solid rgba(255,255,255,0.04); }
#product-modal .pm-title{ font-weight:900; color:#fff; font-size:16px; margin:0; }
#product-modal .pm-body{ padding:12px; max-height:60vh; overflow:auto; background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(8,8,8,0.98)); }
#product-modal .pm-footer{ display:flex; gap:8px; align-items:center; justify-content:space-between; padding:12px; border-top:1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(8,8,8,0.98), rgba(6,6,6,0.98)); }
#product-modal .pm-price{ font-weight:900; color:var(--accent-2); font-size:18px; }
#product-modal .pm-actions .btn{ min-width:120px; }
</style>

<!-- modal skeleton -->
<div id="product-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;">
  <div class="modal-inner">
    <button class="icon-btn modal-close" id="pm-close" aria-label="Close"><i class="fa fa-times"></i></button>
    <div class="pm-header">
      <img src="" alt="" class="pm-thumb" id="pm-thumb">
      <div style="flex:1; min-width:0">
        <h3 class="pm-title" id="pm-title"></h3>
        <div class="small muted" id="pm-desc"></div>
      </div>
    </div>
    <div class="pm-body" id="pm-body">
      <!-- cloned .item-config will be inserted here -->
    </div>
    <div class="pm-footer">
      <div class="pm-price" id="pm-price">GHC 0</div>
      <div class="pm-actions">
        <button id="pm-add" class="btn primary"><i class="fa fa-plus-circle"></i> Add to cart</button>
        <button id="pm-cancel" class="btn ghost">Cancel</button>
      </div>
    </div>
  </div>
</div>
<!-- ========== PAYSTACK FRONTEND: Checkout modal, handlers, InlineJS ========== -->
<!-- InlineJS CDN (Popup V2) - required for resumeTransaction() -->
<script src="https://js.paystack.co/v2/inline.js"></script>

<!-- ======= Enhanced Checkout + Map Picker (paste before </body>) ======= -->

<!-- Leaflet (Map) CSS & JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* Checkout modal (full form) */
#checkout-full-modal { display:none; position:fixed; inset:0; z-index:3000; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; padding:12px; }
#checkout-full-modal[aria-hidden="false"] { display:flex; }
.checkout-full-inner { width:100%; max-width:720px; border-radius:12px; background:linear-gradient(180deg,#0b0b0b,#070707); border:1px solid rgba(255,255,255,0.04); box-shadow:0 40px 120px rgba(0,0,0,0.7); color:#fff; padding:0; overflow:hidden; display:grid; grid-template-columns: 1fr 360px; gap:0; }
@media (max-width:900px) { .checkout-full-inner { grid-template-columns: 1fr; } }

.checkout-left { padding:16px 18px; }
.checkout-right { padding:16px 18px; border-left:1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); overflow:auto; max-height: 82vh; }

.checkout-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
.checkout-title { color:var(--accent-2); font-weight:900; font-size:18px; margin:0; }

.form-row { display:flex; gap:8px; margin-bottom:10px; }
.form-col { flex:1; display:flex; flex-direction:column; gap:6px; }
.input, select, textarea { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#fff; font-weight:800; box-sizing:border-box; }
.input[readonly] { cursor:pointer; background: rgba(255,255,255,0.01); }
.small-muted { color: rgba(255,255,255,0.72); font-size:13px; }

.order-line { display:flex; gap:8px; align-items:center; margin-bottom:10px; }
.order-line img { width:64px; height:48px; object-fit:cover; border-radius:8px; border:1px solid rgba(255,255,255,0.04); }
.order-line .ol-meta { flex:1; min-width:0; }
.order-line .ol-meta strong { display:block; font-weight:900; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.order-line .ol-meta small { color: rgba(255,255,255,0.75); }
.order-line .ol-price { font-weight:900; color:var(--accent-2); min-width:70px; text-align:right; }

.checkout-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
.btn.full { padding:12px 16px; border-radius:12px; font-weight:900; min-width:140px; }
.btn.primary.full { background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); color:#111; border:0; box-shadow: 0 12px 36px rgba(255,106,0,0.12); }

/* Map modal */
#map-modal { display:none; position:fixed; inset:0; z-index:3600; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; padding:8px; }
#map-modal[aria-hidden="false"] { display:flex; }
.map-inner { width:100%; max-width:920px; height:78vh; border-radius:12px; overflow:hidden; background:#fff; display:flex; flex-direction:column; }
.map-top { display:flex; gap:8px; padding:8px; align-items:center; background:#fff; border-bottom:1px solid #eee; }
.map-search { flex:1; padding:8px 12px; border-radius:8px; border:1px solid #ddd; }
#map { flex:1; }
.map-results { max-height:160px; overflow:auto; background:#fff; border-top:1px solid #eee; }
.map-result { padding:8px 10px; border-bottom:1px solid #f1f1f1; cursor:pointer; }
.map-result:hover { background:#f7f7f7; }

.map-actions { display:flex; gap:10px; padding:8px; justify-content:flex-end; background:#fff; border-top:1px solid #eee; }

.toast.wrap-toast { position:fixed; left:50%; transform:translateX(-50%); bottom:18px; z-index:4000; background:rgba(0,0,0,0.85); color:#fff; padding:10px 14px; border-radius:999px; font-weight:800; display:none; }
.toast.wrap-toast.show { display:block; animation: toast-in 320ms cubic-bezier(.2,.9,.3,1); }

</style>



<!-- ===== In-page Checkout Section (Task 3) ===== -->
<style>
/* Checkout page (in-file, not a modal) */
#checkout-page { display: none; position: fixed; inset: 0; z-index: 3200; background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6)); align-items: center; justify-content: center; padding: 12px; box-sizing: border-box; }
#checkout-page[aria-hidden="false"] { display: flex; }
#checkout-inner { width: 100%; max-width: 920px; border-radius: 12px; overflow: hidden; box-shadow: 0 40px 120px rgba(0,0,0,0.7); background: linear-gradient(180deg,#080808,#050505); color: #fff; display: grid; grid-template-columns: 1fr 360px; gap:0; }
@media (max-width: 900px) { #checkout-inner { grid-template-columns: 1fr; } }

.checkout-left { padding: 16px 18px; max-height: 90vh; overflow:auto; }
.checkout-right { padding: 16px 18px; border-left: 1px solid rgba(255,255,255,0.03); background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); overflow:auto; max-height: 90vh; }

.checkout-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
.checkout-title { color: var(--accent-2); font-weight:900; font-size:18px; margin:0; }

.form-row { display:flex; gap:8px; margin-bottom:10px; }
.form-col { flex:1; display:flex; flex-direction:column; gap:6px; }
.input, select, textarea { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#fff; font-weight:800; box-sizing:border-box; }
.input[readonly] { cursor:pointer; background: rgba(255,255,255,0.01); }

.order-line { display:flex; gap:8px; align-items:center; margin-bottom:10px; }
.order-line img { width:64px; height:48px; object-fit:cover; border-radius:8px; border:1px solid rgba(255,255,255,0.04); }
.order-line .ol-meta { flex:1; min-width:0; }
.order-line .ol-meta strong { display:block; font-weight:900; color:#fff; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.order-line .ol-meta small { color: rgba(255,255,255,0.75); }
.order-line .ol-price { font-weight:900; color:var(--accent-2); min-width:70px; text-align:right; }

.checkout-actions { display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
.btn.full { padding:12px 16px; border-radius:12px; font-weight:900; min-width:140px; }
.btn.primary.full { background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); color:#111; border:0; box-shadow: 0 12px 36px rgba(255,106,0,0.12); }

/* small helper area */
.checkout-note { color: rgba(255,255,255,0.78); font-size:13px; margin-top:12px; }

/* header close button */
#checkout-close { background:transparent; border:0; color: var(--muted); font-size:18px; padding:8px; }

/* subtle responsive */
@media (max-width:600px){
  .checkout-right { padding-top:6px; }
  .order-line img { width:56px; height:44px; }
  .checkout-title { font-size:16px; }
}
</style>

<section id="checkout-page" aria-hidden="true" role="dialog" aria-label="Checkout page">
  <div id="checkout-inner" role="document">
    <div class="checkout-left">
      <div class="checkout-header">
        <h3 class="checkout-title"><i class="fa fa-shopping-basket"></i> Complete Order</h3>
        <div>
          <button id="checkout-close" class="icon-btn" aria-label="Close checkout"><i class="fa fa-times"></i></button>
        </div>
      </div>

      <div>
        <div class="form-row">
          <div class="form-col">
            <label class="small-muted">Full name *</label>
            <input id="cf-name" class="input" type="text" placeholder="Jane Doe" required />
          </div>
          <div class="form-col">
            <label class="small-muted">Phone *</label>
            <input id="cf-phone" class="input" type="tel" placeholder="0550xxxxxx" required />
          </div>
        </div>

        <div class="form-row">
          <div class="form-col">
            <label class="small-muted">Email *</label>
            <input id="cf-email" class="input" type="email" placeholder="you@example.com" required />
          </div>
          <div class="form-col">
            <label class="small-muted">Order type *</label>
            <select id="cf-type" class="input">
              <option value="delivery">Delivery</option>
              <option value="pickup">Pickup</option>
            </select>
          </div>
        </div>

        <div style="margin-top:6px;">
          <label class="small-muted">Your Address*</label>
        <input id="cf-address" class="input" type="text" placeholder="Enter delivery address (only when Delivery selected)" readonly />
          <input type="hidden" id="cf-lat" />
          <input type="hidden" id="cf-lon" />
        </div>

        <div class="form-row" style="margin-top:10px;">
          <div class="form-col">
            <label class="small-muted">Preferred date</label>
            <input id="cf-date" class="input" type="date" />
          </div>
          <div class="form-col">
            <label class="small-muted">Preferred time</label>
            <input id="cf-time" class="input" type="time" />
          </div>
        </div>

        <div style="margin-top:10px;">
          <label class="small-muted">Notes (delivery/pickup instructions)</label>
          <textarea id="cf-note" class="input" rows="3" placeholder="e.g., knock twice, leave at gate"></textarea>
        </div>

        <div style="margin-top:12px;">
          <label class="small-muted">Payment method</label>
          <select id="cf-paymethod" class="input">
            <option value="paystack">Pay with Card / Mobile Money (Paystack)</option>
            <option value="cash">Cash on Delivery</option>
          </select>
        </div>

        <div class="checkout-actions">
          <button id="cf-submit" class="btn primary full">Confirm & Pay</button>
          <button id="cf-cancel" class="btn ghost full">Cancel</button>
        </div>

      <div id="cart-delivery-note" class="small-muted" style="margin-top:8px; padding:10px; border-radius:10px; background: linear-gradient(90deg, rgba(255,160,80,0.04), rgba(255,255,255,0.01)); border:1px solid rgba(255,160,80,0.06);">
         <strong>Important:</strong> The checkout price shown <em>does NOT</em> include delivery fees. Delivery fee will be estimated after checkout based on your address and communicated to you.
       </div>
 
      </div>
    </div>

    <aside class="checkout-right" aria-label="Order summary">
      <h4 style="margin:0 0 10px 0; color:var(--accent-2); font-weight:900;">Your order</h4>
      <div id="cf-order-lines" style="margin-bottom:6px;">
        <!-- order lines injected here -->
      </div>

      <div style="border-top:1px dashed rgba(255,255,255,0.04); padding-top:10px; margin-top:12px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div class="small-muted">Subtotal</div>
          <div id="cf-subtotal" class="small-muted">GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
          <div class="small-muted">Delivery</div>
          <div id="cf-delivery" class="small-muted">GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
          <div class="small-muted">Promo</div>
          <div id="cf-promo" class="small-muted">-GHC 0</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px; font-weight:900; color:#fff;">
          <div>Total</div>
          <div id="cf-total" style="color:var(--accent-2)">GHC 0</div>
        </div>
      </div>

      <div style="margin-top:12px;" class="small-muted">
        Please confirm your details before proceeding. You will receive an email & SMS after payment.
      </div>
    </aside>
  </div>
</section>
  <!-- ========== ORDER CONFIRMATION MODAL (shows after successful payment + reload) ========= -->
<style>
/* Confirmation modal styles */
#order-confirmation-modal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 8000;
  background: rgba(0,0,0,0.6);
  align-items: center;
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
}
#order-confirmation-modal[aria-hidden="false"] { display:flex; }

.oc-inner {
  width: 100%;
  max-width: 720px;
  border-radius: 12px;
  background: linear-gradient(180deg,#0b0b0b,#060606);
  color: #fff;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
}
.oc-header { display:flex; gap:12px; align-items:center; justify-content:space-between; }
.oc-title { font-size:18px; font-weight:900; color: var(--accent-2, #FFD166); margin:0; }
.oc-body { display:flex; gap:12px; flex-direction:column; max-height: 60vh; overflow:auto; padding:6px 0; }
.oc-grid { display:grid; grid-template-columns: 1fr 160px; gap:12px; align-items:start; }
.oc-lines { border-top:1px dashed rgba(255,255,255,0.04); padding-top:8px; }
.oc-line { display:flex; justify-content:space-between; gap:8px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,0.02); }
.oc-total { font-weight:900; color: var(--accent-2, #FFD166); font-size:18px; }
.oc-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }
.btn.print { padding:10px 12px; border-radius:10px; font-weight:900; background: linear-gradient(90deg, var(--accent-1, #FF6A00), var(--accent-2, #FFD166)); color:#111; border:0; }
.btn.ok { padding:10px 12px; border-radius:10px; font-weight:900; background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.06); }

/* print-only styles: print only modal content */
@media print {
  body * { visibility: hidden; }
  #order-confirmation-modal, #order-confirmation-modal * { visibility: visible; }
  #order-confirmation-modal { position: static; background: #fff; }
  .oc-inner { box-shadow: none; background: #fff; color: #000; }
}
</style>

<div id="order-confirmation-modal" role="dialog" aria-hidden="true" aria-label="Order confirmation">
  <div class="oc-inner" role="document">
    <div class="oc-header">
      <h3 class="oc-title"><i class="fa fa-check-circle"></i> Order Confirmed</h3>
      <button id="oc-close" class="icon-btn" aria-label="Close confirmation"><i class="fa fa-times"></i></button>
    </div>

    <div class="oc-body">
      <div id="oc-summary" class="oc-grid">
        <div>
          <div><strong>Reference:</strong> <span id="oc-ref">—</span></div>
          <div><strong>Name:</strong> <span id="oc-name">—</span></div>
          <div><strong>Phone:</strong> <span id="oc-phone">—</span></div>
          <div><strong>Email:</strong> <span id="oc-email">—</span></div>
          <div><strong>Order type:</strong> <span id="oc-type">—</span></div>
          <div><strong>Address:</strong> <span id="oc-address">—</span></div>
          <div><strong>Notes:</strong> <span id="oc-note">—</span></div>
        </div>
        <div style="text-align:right;">
          <div class="small-muted">Placed at</div>
          <div id="oc-ts" style="font-weight:800;margin-bottom:10px">—</div>
          <div class="oc-total" id="oc-total">GHC 0</div>
        </div>
      </div>

      <div class="oc-lines" id="oc-lines">
        <!-- order lines inserted here -->
      </div>

      <div style="margin-top:8px" class="small-muted">
        <p><strong>Important:</strong> Delivery fee is calculated separately and will be communicated after we confirm your exact location. The total shown at checkout did <em>not</em> include delivery unless explicitly shown as added.</p>
        <p>Please keep this reference for inquiries. We will contact you (phone/SMS/WhatsApp) with an estimated delivery fee and ETA.</p>
      </div>
    </div>

    <div class="oc-actions">
      <button id="oc-print" class="btn print"><i class="fa fa-file-pdf"></i> Save as PDF</button>
      <button id="oc-ok" class="btn ok">Okay</button>
    </div>
  </div>
</div>


<style>
/* CHECKOUT PAGE — unified, mobile-friendly, scrollable under fixed header */
#checkout-page {
  display: none;
  position: fixed;
  inset: 0;                 /* fill viewport */
  z-index: 3200;
  background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.6));
  /* place checkout below header and allow page-level scroll if content taller than viewport */
  align-items: flex-start;                  /* ensures top-aligned so margin-top works predictably */
  justify-content: center;
  padding: 12px;
  box-sizing: border-box;
  overflow: auto;                           /* page can scroll if inner is taller than viewport */
  -webkit-overflow-scrolling: touch;
}

/* show when opened */
#checkout-page[aria-hidden="false"] { display: flex; }

/* Inner dialog
   - Use margin-top to sit under the sticky header safely
   - Use max-height so inner columns can scroll independently
*/
#checkout-inner {
  width: 100%;
  max-width: 920px;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7);
  background: linear-gradient(180deg,#080808,#050505);
  color: #fff;
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 0;
  margin: calc(56px + var(--safe-top,12px) + 12px) auto 24px; /* pushes it below fixed header */
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 48px)); /* keeps dialog within viewport */
  box-sizing: border-box;
}

/* On narrow screens stack into single column */
@media (max-width: 900px) {
  #checkout-inner { grid-template-columns: 1fr; max-width: 680px; }
}

/* Left & right columns scroll independently */
.checkout-left,
.checkout-right {
  padding: 16px 18px;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  max-height: calc(100%); /* ensures columns don't overflow the dialog */
  box-sizing: border-box;
}

/* Right column: give it a visual top so "Your order" stays visible while lines scroll */
.checkout-right {
  border-left: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  position: relative;
}

/* Make the "Your order" heading sticky within the right column so the user always sees the header.
   The order lines themselves scroll under it. This prevents the feeling that the section is "stuck". */
.checkout-right > h4 {
  position: sticky;
  top: 0;
  z-index: 5;
  margin: 0 0 10px 0;
  padding-top: 6px;
  background: transparent; /* inherits dialog BG */
  color: var(--accent-2);
  font-weight: 900;
}

/* constrain the order lines area so it scrolls nicely */
#cf-order-lines {
  overflow: auto;
  max-height: calc(100vh - (56px + var(--safe-top,12px) + 240px)); /* adapt so lines area remains scrollable */
  -webkit-overflow-scrolling: touch;
}

/* Make the checkout close button comfortable to tap */
#checkout-close { background: transparent; border: 0; color: var(--muted); font-size: 18px; padding: 8px; cursor: pointer; }

/* small responsive tweaks */
@media (max-width: 600px) {
  #checkout-inner { margin-top: calc(56px + var(--safe-top, 12px) + 6px); padding-bottom: 8px; }
  .checkout-right { border-left: none; border-top: 1px solid rgba(255,255,255,0.03); }
  .checkout-right > h4 { top: 0; }
  #cf-order-lines { max-height: calc(60vh); }
}
</style>


  <!-- Task 3: Promo slideshow (paste after your scripts, before </body>) -->
<style>
/* Promo slideshow styles — mobile-first, uses your accent variables */
.promo-carousel {
  width:100%;
  max-width: var(--max-width,420px);
  margin: 8px auto 18px;
  position: relative;
  box-sizing: border-box;
  overflow: visible;
}
.promo-carousel .pc-slides { position: relative; width:100%; height: 42vh; min-height:220px; border-radius:14px; overflow: clip; box-shadow: var(--card-shadow); }
.promo-carousel .pc-slide {
  position: absolute; inset:0;
  display: none;
  will-change: transform, opacity;
  transition: opacity 520ms cubic-bezier(.2,.9,.3,1), transform 520ms cubic-bezier(.2,.9,.3,1);
  background-size: cover;
  background-position: center;
}
.promo-carousel .pc-slide.is-active { display:block; opacity:1; transform: none; }
.promo-carousel .pc-slide .overlay {
  position:absolute; inset:0;
  background: linear-gradient(180deg, rgba(0,0,0,0.18) 0%, rgba(0,0,0,0.55) 70%);
  display:flex; align-items:flex-end; padding:14px; box-sizing:border-box;
}
.promo-card {
  width:100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: 12px;
  padding: 12px;
  box-sizing:border-box;
  backdrop-filter: blur(6px) saturate(120%);
  display:flex; gap:10px; align-items:center;
}
.promo-left { flex:0 0 72px; display:flex; align-items:center; justify-content:center; }
.promo-left .pc-ico { font-size:34px; color: #fff; opacity:0.98; text-shadow: 0 6px 20px rgba(0,0,0,0.6); }
.promo-right { flex:1 1 auto; min-width:0; display:flex; flex-direction:column; gap:6px; }
.promo-eyebrow { font-size:12px; color:var(--accent-2); font-weight:900; text-transform:uppercase; letter-spacing:0.8px; }
.promo-title { font-size:16px; font-weight:900; color:#fff; margin:0; line-height:1.05; }
.promo-desc { font-size:13px; color: rgba(255,255,255,0.9); }
.promo-cta-row { display:flex; gap:8px; margin-top:8px; align-items:center; }
.promo-cta-row .btn { min-height:40px; padding:8px 12px; font-weight:900; border-radius:10px; }

.promo-controls { position:absolute; left:12px; right:12px; bottom:12px; display:flex; align-items:center; justify-content:space-between; gap:8px; pointer-events:none; }
.pc-dots { display:flex; gap:8px; align-items:center; pointer-events:auto; }
.pc-dot { width:8px; height:8px; border-radius:999px; background: rgba(255,255,255,0.18); border:1px solid rgba(255,255,255,0.04); padding:0; }
.pc-dot.is-active { width:34px; background: linear-gradient(90deg,var(--accent-1),var(--accent-2)); box-shadow: 0 8px 20px rgba(255,106,0,0.14); border-radius:999px; }

.pc-nav { display:flex; gap:8px; pointer-events:auto; }
.pc-nav .icon-btn { background: rgba(0,0,0,0.45); color:#fff; border-radius:10px; padding:8px; }

@media (max-width:360px){
  .promo-left { flex:0 0 56px; }
  .promo-left .pc-ico { font-size:28px; }
  .promo-title { font-size:15px; }
  .promo-card { padding:10px; border-radius:10px; }
}
</style>


<style>
/* Override / enhancement for cart drawer footer behavior */
.cart-drawer {
  /* make the drawer a column flex container so footer stays pinned */
  display: flex !important;
  flex-direction: column;
  justify-content: space-between;
  height: 100vh;          /* fill viewport so footer anchors to bottom */
  overflow: hidden;       /* inner scrolling happens in .cart-body */
}

/* .cart-body becomes the scrollable area */
.cart-body {
  flex: 1 1 auto;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  /* ensure content never gets hidden under footer */
  padding-bottom: calc(var(--cart-footer-h, 96px) + 18px);
}

/* footer pinned inside flex layout */
.cart-footer {
  position: relative;     /* keep it in flow but pinned to bottom via flex */
  z-index: 60;
  flex: 0 0 var(--cart-footer-h, 96px);
  height: var(--cart-footer-h, 96px);
  box-shadow: 0 -10px 36px rgba(0,0,0,0.55);
  border-top: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(180deg, rgba(6,6,6,0.98), rgba(8,8,8,0.98));
  box-sizing: border-box;
}

/* compact the footer on very small screens to avoid being too tall */
@media (max-width: 380px) {
  :root { --cart-footer-h: 84px; }
  .cart-footer { height: var(--cart-footer-h); }
  .footer-summary .total-label { font-size: 12px; }
  .footer-summary .total-value { font-size: 14px; }
}

/* ensure checkout button remains visible & tappable */
.cart-footer .footer-actions { align-items: center; gap: 8px; }
.cart-footer .btn.primary { min-width: 120px; }

/* small improvement: when drawer is open, slightly dim body (applies when JS adds class) */
body.cart-open::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.28);
  z-index: 1350; /* behind the drawer (drawer 1400) */
  pointer-events: none;
}
</style>

<script>
/*
  Consolidated script for Wrap District — full-page behavior.
  - Replaces all previous <script> blocks: menu tabs, mobile nav, cart management,
    product modal, promo carousel/countdown, checkout, preorder, order confirmation,
    and small UI helpers.
  - Self-contained, attaches key functions to window for compatibility (computeCartTotals, renderCart, openCheckoutPage, etc).
  - Designed to work with the HTML/CSS you provided.
*/
(function () {
  'use strict';

  /* -------------------------
     Utility helpers and config
  ------------------------- */
  const STORE_COORDS = { lat: 5.6600, lon: 0.0190 }; // update if needed
  const DELIVERY_CONFIG = {
    baseFee: 6,
    perKm: 2.5,
    minFee: 4,
    maxFee: 60,
    freeWithinKm: 0.8
  };
  const PAYSTACK_PUBLIC_KEY = 'pk_test_297586e51710e83d3c159bfe71ff45c7e23411fa'; // replace with live key if needed

  const qs = (sel, ctx = document) => ctx.querySelector(sel);
  const qsa = (sel, ctx = document) => Array.from((ctx || document).querySelectorAll(sel));
  const fmtGhc = (n) => `GHC ${Math.round(Number(n || 0))}`;
  const escapeHtml = (s = '') => String(s).replace(/&/g, '&amp;').replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');

  /* -------------------------
     Persistent cart storage & model
     window.cart is an object keyed by unique line ids
  ------------------------- */
  const CART_STORAGE_KEY = 'wrap_cart_v2';

  function loadCart() {
    try {
      const raw = localStorage.getItem(CART_STORAGE_KEY);
      const parsed = raw ? JSON.parse(raw) : {};
      // ensure object format
      if (parsed && typeof parsed === 'object') {
        window.cart = parsed;
        return parsed;
      }
    } catch (e) { console.warn('loadCart error', e); }
    window.cart = {};
    return window.cart;
  }

  function saveCart() {
    try {
      localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(window.cart || {}));
    } catch (e) { console.warn('saveCart error', e); }
  }

  // Generate a stable key for a line using item id + normalized meta
  function makeLineKey(itemId, meta) {
    try {
      const normalized = Object.keys(meta || {}).sort().map(k => `${k}:${JSON.stringify(meta[k])}`).join('|');
      return `${itemId}__${hashString(normalized)}`;
    } catch (e) { return `${itemId}__${Date.now()}`; }
  }

  function hashString(s) {
    // simple hash to keep keys short
    let h = 0;
    for (let i = 0; i < s.length; i++) {
      h = ((h << 5) - h) + s.charCodeAt(i);
      h |= 0;
    }
    return Math.abs(h).toString(36);
  }

  /* -------------------------
     Promo logic
     - buy2get1 for shawarma: for each 3 qualifying shawarmas, one unit is free
     - freecoke for fries: add a free Coke line when qualifying fries present
  ------------------------- */
  function applyPromos(cartObj) {
    // returns an object with promoDiscount number and possibly modified lines (e.g., free items)
    const result = { promoDiscount: 0, freeLines: [] };

    // simple counters
    let shawarmaCount = 0;
    let shawarmaUnitPrice = 0;
    let friesCount = 0;
    // iterate lines
    Object.values(cartObj).forEach(line => {
      const id = (line.baseId || '').toLowerCase();
      if (id.includes('shawarma')) {
        shawarmaCount += Number(line.qty || 0);
        // approximate unit price (if lines may differ per option, use unitPrice)
        shawarmaUnitPrice = Number(line.unitPrice || shawarmaUnitPrice || 0);
      }
      if (id.includes('fries') || id.includes('loaded-fries')) {
        friesCount += Number(line.qty || 0);
      }
    });

    // buy 2 get 1 free (for every 3 shawarmas, discount one cheapest unitPrice)
    if (shawarmaCount >= 3) {
      const freeUnits = Math.floor(shawarmaCount / 3);
      // determine discount: assume uniform price, else approximate by average unitPrice
      const discount = freeUnits * (shawarmaUnitPrice || 0);
      result.promoDiscount += Math.round(discount);
    }

    // Fries -> free Coke: For each qualifying fries line >=1, add a "Free Coke" free line once
    if (friesCount > 0) {
      // Ensure we don't add duplicate free coke lines by checking cartObj for _free_coke flag lines
      const alreadyHas = Object.values(cartObj).some(l => l.isFree && (l.baseId || '').toLowerCase().includes('free-coke'));
      if (!alreadyHas) {
        result.freeLines.push({
          id: `free-coke-${Date.now()}`,
          baseId: 'free-coke',
          title: 'Free Coke',
          qty: 1,
          unitPrice: 0,
          isFree: true,
          meta: {}
        });
      }
    }

    return result;
  }

  /* -------------------------
     Totals computation - exposed as computeCartTotals()
     returns { subtotal, promoDiscount, delivery, total, lines (array) }
  ------------------------- */
  function computeCartTotals() {
    const cartObj = window.cart || {};
    let subtotal = 0;
    const lines = [];
    Object.keys(cartObj).forEach(k => {
      const l = cartObj[k];
      const unit = Number(l.unitPrice || 0);
      const qty = Number(l.qty || 1);
      subtotal += unit * qty;
      lines.push(Object.assign({}, l));
    });

    // promo application
    const promo = applyPromos(cartObj);
    // merge promo.freeLines into lines (not persisted into cart unless addFreeLines() called explicitly)
    if (promo.freeLines && promo.freeLines.length) {
      promo.freeLines.forEach(fl => lines.push(Object.assign({}, fl)));
    }

    const promoDiscount = Math.round(promo.promoDiscount || 0);
    const delivery = 0; // delivery computed later in checkout context; here default 0
    const total = Math.max(0, subtotal - promoDiscount + delivery);
    return { subtotal: Math.round(subtotal), promoDiscount, delivery, total, lines };
  }

  // Expose computeCartTotals globally
  window.computeCartTotals = computeCartTotals;

  /* -------------------------
     DOM render: renderCart()
     fills #cart-items and updates counts & totals
  ------------------------- */
  function renderCart() {
    const cartObj = window.cart || {};
    const cartItemsEl = qs('#cart-items');
    const cartCountEl = qs('#cart-count');
    const cartMiniCountEl = qs('#cart-mini-count');
    const cartSubtotalEl = qs('#cart-subtotal');
    const cartTotalEl = qs('#cart-total');
    const cartHeaderTotalEl = qs('#cart-header-total');
    const footerSubtotalEl = qs('#footer-subtotal');
    const footerTotalEl = qs('#footer-total');

    if (!cartItemsEl) return;

    cartItemsEl.innerHTML = ''; // clear

    // Build list items
    const keys = Object.keys(cartObj || {});
    if (!keys.length) {
      const li = document.createElement('li');
      li.className = 'empty';
      li.innerText = 'Your cart is empty.';
      cartItemsEl.appendChild(li);
    } else {
      keys.forEach(k => {
        const line = cartObj[k];
        const li = document.createElement('li');
        li.className = 'cart-line';
        li.dataset.cartKey = k;

        // left area
        const left = document.createElement('div');
        left.className = 'line-left';
        left.style.display = 'flex';
        left.style.gap = '12px';
        left.style.alignItems = 'center';

        const img = document.createElement('img');
        img.className = 'cart-thumb';
        img.src = line.imageSrc || (line.meta && line.meta.image) || 'placeholder-thumb.png';
        img.alt = line.title || '';
        left.appendChild(img);

        const titleWrap = document.createElement('div');
        titleWrap.style.minWidth = '0';
        const title = document.createElement('div');
        title.className = 'line-title';
        title.innerText = line.title || 'Item';
        titleWrap.appendChild(title);

        const meta = document.createElement('div');
        meta.className = 'line-meta';
        // show meta succinctly: size/protein/addons
        const metaParts = [];
        try {
          if (line.meta) {
            if (line.meta.size) metaParts.push(String(line.meta.size));
            if (line.meta.protein) metaParts.push(String(line.meta.protein));
            if (Array.isArray(line.meta.addons) && line.meta.addons.length) {
              metaParts.push(line.meta.addons.map(a => a.label || a.key || a).join(', '));
            }
          }
        } catch (e) { /* ignore */ }
        meta.innerText = metaParts.join(' • ');
        titleWrap.appendChild(meta);

        left.appendChild(titleWrap);

        // right controls
        const right = document.createElement('div');
        right.className = 'line-controls';
        right.style.display = 'flex';
        right.style.alignItems = 'center';
        right.style.gap = '8px';

        const qtyBtnDec = document.createElement('button');
        qtyBtnDec.className = 'icon-btn cart-decrease';
        qtyBtnDec.title = 'Decrease quantity';
        qtyBtnDec.innerHTML = '<i class="fa fa-minus"></i>';
        qtyBtnDec.addEventListener('click', (e) => {
          e.preventDefault();
          changeQty(k, -1);
        });

        const qtyNum = document.createElement('div');
        qtyNum.className = 'line-qty';
        qtyNum.innerText = String(line.qty || 1);
        qtyNum.style.minWidth = '28px';
        qtyNum.style.textAlign = 'center';

        const qtyBtnInc = document.createElement('button');
        qtyBtnInc.className = 'icon-btn cart-increase';
        qtyBtnInc.title = 'Increase quantity';
        qtyBtnInc.innerHTML = '<i class="fa fa-plus"></i>';
        qtyBtnInc.addEventListener('click', (e) => {
          e.preventDefault();
          changeQty(k, 1);
        });

        const removeBtn = document.createElement('button');
        removeBtn.className = 'icon-btn cart-remove';
        removeBtn.title = 'Remove';
        removeBtn.innerHTML = '<i class="fa fa-trash"></i>';
        removeBtn.addEventListener('click', (e) => {
          e.preventDefault();
          removeLine(k);
        });

        const lineTotal = document.createElement('div');
        lineTotal.className = 'line-total';
        lineTotal.style.fontWeight = '900';
        lineTotal.style.color = 'var(--accent-2)';
        lineTotal.style.minWidth = '72px';
        lineTotal.style.textAlign = 'right';
        lineTotal.innerText = fmtGhc((line.unitPrice || 0) * (line.qty || 1));

        right.appendChild(qtyBtnDec);
        right.appendChild(qtyNum);
        right.appendChild(qtyBtnInc);
        right.appendChild(removeBtn);
        right.appendChild(lineTotal);

        li.appendChild(left);
        li.appendChild(right);
        cartItemsEl.appendChild(li);
      });
    }

    // totals
    const totals = computeCartTotals();
    cartSubtotalEl && (cartSubtotalEl.innerText = fmtGhc(totals.subtotal));
    cartTotalEl && (cartTotalEl.innerText = fmtGhc(totals.total));
    cartHeaderTotalEl && (cartHeaderTotalEl.innerText = fmtGhc(totals.total));
    footerSubtotalEl && (footerSubtotalEl.innerText = fmtGhc(totals.subtotal));
    footerTotalEl && (footerTotalEl.innerText = fmtGhc(totals.total));

    // counts
    const totalItems = Object.values(window.cart || {}).reduce((s, l) => s + Number(l.qty || 0), 0);
    cartCountEl && (cartCountEl.innerText = String(totalItems));
    cartMiniCountEl && (cartMiniCountEl.innerText = String(totalItems));

    // show/hide promo helper in cart (simple heuristic)
    const cartPromoEl = qs('#cart-promo');
    if (cartPromoEl) {
      if (totals.promoDiscount > 0 || (totals.lines && totals.lines.some(l => (l.baseId||'').includes('free-coke')))) {
        cartPromoEl.classList.remove('hidden');
        const promoDiscountEl = qs('#promo-discount');
        if (promoDiscountEl) promoDiscountEl.innerText = `-GHC ${totals.promoDiscount}`;
        const promoHelp = qs('#promo-help-text');
        if (promoHelp) promoHelp.innerText = computePromoHelpText();
      } else {
        cartPromoEl.classList.add('hidden');
      }
    }

    saveCart();
  }

  // Expose renderCart globally
  window.renderCart = renderCart;

  function computePromoHelpText() {
    // Simple helper text for cart promo area based on current cart
    const cartObj = window.cart || {};
    const totals = computeCartTotals();
    // If shawarma near threshold
    const shawarmaCount = Object.values(cartObj).reduce((s, l) => s + ((l.baseId || '').toLowerCase().includes('shawarma') ? Number(l.qty || 0) : 0), 0);
    if (shawarmaCount > 0 && shawarmaCount % 3 !== 0) {
      const need = 3 - (shawarmaCount % 3);
      return `Add ${need} more shawarma${need > 1 ? 's' : ''} to get one free.`;
    }
    if (totals.promoDiscount > 0) return `Promo applied: -GHC ${totals.promoDiscount}`;
    return 'Tip: add qualifying items to trigger promos like Buy 2 Get 1 Free.';
  }

  function changeQty(key, delta) {
    if (!window.cart || !window.cart[key]) return;
    const cur = Number(window.cart[key].qty || 0);
    const next = Math.max(0, cur + delta);
    if (next === 0) {
      delete window.cart[key];
    } else {
      window.cart[key].qty = next;
    }
    saveCart();
    renderCart();
  }

  function removeLine(key) {
    if (!window.cart || !window.cart[key]) return;
    delete window.cart[key];
    saveCart();
    renderCart();
  }

  /* -------------------------
     Add item to cart (from menu or product modal)
     - accepts itemId, title, unitPrice, qty (1 default), imageSrc, meta object
  ------------------------- */
  function addToCart({ itemId, title, unitPrice = 0, qty = 1, imageSrc = '', meta = {} }) {
    loadCart(); // ensure window.cart exists
    const key = makeLineKey(itemId, meta);
    if (window.cart[key]) {
      window.cart[key].qty = Number(window.cart[key].qty || 0) + Number(qty || 1);
    } else {
      window.cart[key] = {
        baseId: itemId,
        title: title || 'Item',
        unitPrice: Number(unitPrice || 0),
        qty: Number(qty || 1),
        imageSrc: imageSrc || '',
        meta: meta || {}
      };
    }
    saveCart();
    renderCart();
    showToast(`${title} added to cart`);
  }

  // Expose addToCart for product modal convenience
  window.addToCart = addToCart;

  /* -------------------------
     Toast helper
  ------------------------- */
  let toastTimer = null;
  function showToast(msg, timeout = 1800) {
    let t = qs('.toast.wrap-toast');
    if (!t) {
      t = document.createElement('div');
      t.className = 'toast wrap-toast';
      t.setAttribute('role', 'status');
      t.innerText = msg;
      document.body.appendChild(t);
    }
    t.innerText = msg;
    t.classList.add('show');
    if (toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(() => {
      t.classList.remove('show');
    }, timeout);
  }

  /* -------------------------
     Mobile nav behavior
  ------------------------- */
  function setupMobileNav() {
    const mobileNav = qs('#mobile-nav');
    const hamburger = qs('#hamburger');
    const navCloseBtn = qs('#nav-close');

    if (!mobileNav || !hamburger) return;

    function openNav() {
      mobileNav.style.display = 'block';
      mobileNav.setAttribute('aria-hidden', 'false');
      hamburger.setAttribute('aria-expanded', 'true');
      try { mobileNav.focus(); } catch (e) {}
      document.body.style.overflow = 'hidden';
    }
    function closeNav() {
      mobileNav.style.display = 'none';
      mobileNav.setAttribute('aria-hidden', 'true');
      hamburger.setAttribute('aria-expanded', 'false');
      try { hamburger.focus(); } catch (e) {}
      document.body.style.overflow = '';
    }

    hamburger.addEventListener('click', (e) => {
      const expanded = hamburger.getAttribute('aria-expanded') === 'true';
      if (expanded) {
        closeNav();
      } else {
        openNav();
      }
    });

    navCloseBtn && navCloseBtn.addEventListener('click', closeNav);
    mobileNav.addEventListener('click', (e) => {
      if (e.target === mobileNav) closeNav();
    });
    document.addEventListener('keydown', (ev) => {
      if (ev.key === 'Escape' && mobileNav.getAttribute('aria-hidden') === 'false') closeNav();
    });

    // smooth-scroll nav links
    qsa('#mobile-nav a.nav-link').forEach(link => {
      link.addEventListener('click', (e) => {
        // close menu immediately
        closeNav();
        const href = (link.getAttribute('href') || '').trim();
        if (href && href.startsWith('#')) {
          e.preventDefault();
          setTimeout(() => {
            const target = document.querySelector(href);
            if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            else window.location.hash = href;
          }, 120);
        }
      }, { passive: true });
    });
  }

  /* -------------------------
     Menu tabs & filtering
  ------------------------- */
  function setupMenuTabs() {
    const tabButtons = qsa('.menu-tabs .tab-btn');
    const menuItems = qsa('.menu-item');

    if (!tabButtons.length) return;

    function applyTabFilter(cat) {
      menuItems.forEach(item => {
        const itemCat = (item.dataset.category || '').toLowerCase();
        const show = (!cat || cat === 'all') || itemCat === cat || itemCat.split(' ').includes(cat);
        item.style.display = show ? '' : 'none';
        item.setAttribute('aria-hidden', show ? 'false' : 'true');
      });
    }

    function setActiveTab(btn) {
      tabButtons.forEach(b => {
        const is = b === btn;
        b.classList.toggle('is-active', is);
        b.setAttribute('aria-selected', String(is));
        if (is) try { b.focus(); } catch (e) {}
      });
    }

    tabButtons.forEach(btn => {
      if (!btn.hasAttribute('role')) btn.setAttribute('role', 'tab');
      if (!btn.hasAttribute('tabindex')) btn.setAttribute('tabindex', '0');

      btn.addEventListener('click', (e) => {
        const cat = (btn.dataset.cat || '').toLowerCase();
        setActiveTab(btn);
        applyTabFilter(cat);
      });

      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          btn.click();
        }
      });
    });

    const initial = tabButtons.find(b => b.classList.contains('is-active')) || tabButtons[0];
    if (initial) {
      setActiveTab(initial);
      applyTabFilter((initial.dataset.cat || 'all').toLowerCase());
    }
  }

  /* -------------------------
     Cart drawer open/close wiring
  ------------------------- */
  function setupCartDrawer() {
    const cartToggle = qs('#cart-toggle');
    const cartDrawer = qs('#cart-drawer');
    const cartClose = qs('#cart-close');

    if (!cartDrawer) return;

    function openCart() {
      cartDrawer.style.display = 'block';
      cartDrawer.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      try { cartDrawer.focus(); } catch (e) {}
      renderCart();
    }
    function closeCart() {
      cartDrawer.style.display = 'none';
      cartDrawer.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      try { cartToggle && cartToggle.focus(); } catch (e) {}
    }

    cartToggle && cartToggle.addEventListener('click', (e) => {
      const hidden = cartDrawer.getAttribute('aria-hidden') !== 'false';
      if (hidden) openCart(); else closeCart();
    });

    cartClose && cartClose.addEventListener('click', closeCart);
    // clicking outside the drawer closes it
    cartDrawer.addEventListener('click', (e) => {
      if (e.target === cartDrawer) closeCart();
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && cartDrawer.getAttribute('aria-hidden') === 'false') closeCart();
    });

    // clear cart button
    const clearBtn = qs('#clear-cart');
    clearBtn && clearBtn.addEventListener('click', () => {
      if (!confirm('Clear cart?')) return;
      window.cart = {};
      saveCart();
      renderCart();
      showToast('Cart cleared');
    });

    // Add missing (promo helper) — simple implementation: add one shawarma lite if buy2get1 near threshold
    const addMissing = qs('#add-missing');
    addMissing && addMissing.addEventListener('click', () => {
      // determine nearest promo need
      const cartObj = window.cart || {};
      const shawarmaCount = Object.values(cartObj).reduce((s, l) => s + ((l.baseId || '').toLowerCase().includes('shawarma') ? Number(l.qty || 0) : 0), 0);
      if (shawarmaCount % 3 === 0) {
        showToast('Cart already meets the promo condition');
        return;
      }
      const need = 3 - (shawarmaCount % 3);
      for (let i = 0; i < need; i++) {
        addToCart({ itemId: 'shawarma', title: 'Shawarma', unitPrice: 45, qty: 1, imageSrc: 'thumb-shawarma.jpg', meta: { size: 'classic' } });
      }
      renderCart();
      showToast(`Added ${need} shawarma${need>1?'s':''} to reach promo`);
    });
  }

  /* -------------------------
     Attach add/remove buttons in menu (delegation)
     - Handles computing unit price from selects and addons
  ------------------------- */
  function setupMenuAddButtons() {
    // compute price from a menu-item element
    function computeItemUnitPrice(menuItem) {
      let total = 0;
      // selects
      qsa('select', menuItem).forEach(s => {
        total += Number(s.value || 0);
      });
      // checkboxes with class addon-checkbox
      qsa('input.addon-checkbox', menuItem).forEach(cb => {
        if (cb.checked) total += Number(cb.value || 0);
      });
      // if the menu-item has a .price-value span, fallback to that if total is zero
      if (total === 0) {
        const pv = qs('.price-value', menuItem);
        if (pv) total = Number(pv.innerText || 0);
      }
      return Math.round(total);
    }

    // capture add clicks
    document.addEventListener('click', (e) => {
      const el = e.target.closest && e.target.closest('.add-btn');
      if (!el) return;
      e.preventDefault();
      const itemId = el.dataset.itemId || el.closest('.menu-item')?.dataset.itemId || el.closest('.menu-item')?.id || 'item';
      const menuItem = el.closest('.menu-item');
      const title = (menuItem && (qs('.item-title', menuItem)?.innerText || 'Item')) || 'Item';
      const imageSrc = menuItem && (qs('.item-thumb', menuItem)?.src || '');
      // assemble meta from selects and addons
      const meta = {};
      qsa('select', menuItem).forEach(s => {
        const name = s.name || s.className || ('sel_' + Math.random().toString(36).slice(2,6));
        meta[name] = { text: s.options[s.selectedIndex]?.text || s.value, value: s.value };
      });
      const addons = [];
      qsa('.addon input[type="checkbox"]', menuItem).forEach(cb => {
        if (cb.checked) {
          addons.push({ key: cb.dataset.addonKey || cb.value, label: cb.closest('.addon')?.querySelector('span')?.innerText || cb.value, value: Number(cb.value || 0) });
        }
      });
      if (addons.length) meta.addons = addons;
      const unitPrice = computeItemUnitPrice(menuItem);
      addToCart({ itemId, title, unitPrice, qty: 1, imageSrc, meta });
    });

    // capture remove button (in menu card) if present (some markup shows remove-btn)
    document.addEventListener('click', (e) => {
      const el = e.target.closest && e.target.closest('.remove-btn');
      if (!el) return;
      e.preventDefault();
      // best-effort: find an existing cart key for this itemId and decrement/remove
      const itemId = el.dataset.itemId || el.closest('.menu-item')?.dataset.itemId;
      if (!itemId) {
        showToast('Cannot locate item to remove');
        return;
      }
      // find any matching cart key
      const cartObj = window.cart || {};
      const found = Object.keys(cartObj).find(k => (cartObj[k].baseId || '').toLowerCase() === itemId.toLowerCase());
      if (found) {
        changeQty(found, -1);
        showToast('Item removed');
      } else {
        showToast('Item not in cart');
      }
    });
  }

  /* -------------------------
     Product modal behavior
     - opens when clicking .item-thumb or .item-title
     - clones .item-config into modal, allows edits, then adds selections to cart
  ------------------------- */
  function setupProductModal() {
    const modal = qs('#product-modal');
    if (!modal) return;
    const pmThumb = qs('#pm-thumb', modal);
    const pmTitle = qs('#pm-title', modal);
    const pmDesc = qs('#pm-desc', modal);
    const pmBody = qs('#pm-body', modal);
    const pmPrice = qs('#pm-price', modal);
    const pmAdd = qs('#pm-add', modal);
    const pmCancel = qs('#pm-cancel', modal);
    const pmClose = qs('#pm-close', modal);

    let activeMenuItem = null;
    let clonedConfig = null;

    function calculatePriceFromContainer(container) {
      let total = 0;
      qsa('select', container).forEach(s => { total += Number(s.value || 0); });
      qsa('input.addon-checkbox, input[type="checkbox"]', container).forEach(cb => { if (cb.checked) total += Number(cb.value || 0); });
      if (total === 0) {
        const fallback = Number(qs('.price-value', container)?.innerText || 0);
        if (fallback) total = fallback;
      }
      return Math.round(total);
    }

    function updateModalPrice() {
      if (!clonedConfig || !pmPrice) return;
      const p = calculatePriceFromContainer(clonedConfig);
      pmPrice.innerText = fmtGhc(p);
    }

    function openProductModal(menuItem) {
      if (!menuItem) return;
      activeMenuItem = menuItem;
      const thumb = qs('.item-thumb', menuItem);
      const title = (qs('.item-title', menuItem)?.innerText || 'Item');
      const desc = qs('.item-desc', menuItem)?.innerText || '';

      pmThumb.src = thumb?.src || '';
      pmThumb.alt = title;
      pmTitle.innerText = title;
      pmDesc.innerText = desc;

      pmBody.innerHTML = '';
      const config = qs('.item-config', menuItem);
      clonedConfig = config ? config.cloneNode(true) : null;

      if (clonedConfig) {
        // remove duplicate IDs
        qsa('[id]', clonedConfig).forEach(el => el.removeAttribute('id'));
        // ensure inputs are interactive
        pmBody.appendChild(clonedConfig);
        qsa('select, input[type="checkbox"]', clonedConfig).forEach(inp => inp.addEventListener('change', updateModalPrice));
      } else {
        const fallback = document.createElement('div');
        fallback.className = 'glass-card small';
        fallback.innerText = 'No configurable options for this item.';
        pmBody.appendChild(fallback);
      }
      updateModalPrice();
      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      setTimeout(() => { try { pmClose && pmClose.focus(); } catch (e) {} }, 80);
    }

    function closeProductModal() {
      pmBody.innerHTML = '';
      clonedConfig = null;
      activeMenuItem = null;
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }

    // attach openers for existing menu items and future ones via delegation
    document.addEventListener('click', (e) => {
      const clicked = e.target;
      const thumb = clicked.closest && clicked.closest('.item-thumb');
      const title = clicked.closest && clicked.closest('.item-title');
      const opener = thumb || title;
      if (!opener) return;
      const menuItem = opener.closest('.menu-item');
      if (!menuItem) return;
      e.preventDefault();
      openProductModal(menuItem);
    });

    pmAdd && pmAdd.addEventListener('click', () => {
      if (!activeMenuItem) { closeProductModal(); return; }
      if (!clonedConfig) {
        // simply click add on original item
        const origAdd = qs('.add-btn', activeMenuItem);
        if (origAdd) origAdd.click();
        closeProductModal();
        return;
      }
      // Compose selection meta and copy to original
      try {
        // copy selects by name
        qsa('select', clonedConfig).forEach(cs => {
          const name = cs.name;
          if (!name) return;
          const orig = qs(`select[name="${name}"]`, activeMenuItem);
          if (orig) { orig.value = cs.value; orig.dispatchEvent(new Event('change', { bubbles: true })); }
        });
        // copy checkboxes (addon-checkbox)
        qsa('input[type="checkbox"]', clonedConfig).forEach(ccb => {
          const key = ccb.dataset.addonKey;
          let origCb = key ? qs(`input.addon-checkbox[data-addon-key="${key}"]`, activeMenuItem) : null;
          if (!origCb) {
            const labelText = ccb.closest('.addon')?.querySelector('span')?.innerText?.trim();
            if (labelText) {
              const found = qsa('.addon', activeMenuItem).map(a => ({ el: a, txt: a.querySelector('span')?.innerText?.trim() })).find(x => x.txt === labelText);
              origCb = found && found.el ? qs('input[type="checkbox"]', found.el) : null;
            }
          }
          if (origCb) { origCb.checked = !!ccb.checked; origCb.dispatchEvent(new Event('change', { bubbles: true })); }
        });

        // click original add
        const origAddBtn = qs('.add-btn', activeMenuItem);
        if (origAddBtn) {
          origAddBtn.click();
          setTimeout(() => closeProductModal(), 260);
        } else {
          closeProductModal();
          showToast('Added (fallback)');
        }
      } catch (err) {
        console.error('Error copying modal selections', err);
        closeProductModal();
      }
    });

    pmCancel && pmCancel.addEventListener('click', closeProductModal);
    pmClose && pmClose.addEventListener('click', closeProductModal);
    modal && modal.addEventListener('click', (e) => { if (e.target === modal) closeProductModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && modal.style.display === 'flex') closeProductModal(); });
  }

  /* -------------------------
     Promo countdown (next Tuesday) and handlers for promo buttons
  ------------------------- */
  function setupPromoCountdown() {
    const promoTimerEl = qs('#promo-timer');
    const promoButtons = qsa('[data-action="apply-promo"], [data-action="preorder-promo"]');

    // compute next Tuesday (0 = Sun, 1 = Mon, 2 = Tue)
    function nextWeekdayDate(targetWeekday) {
      const now = new Date();
      const d = (targetWeekday + 7 - now.getDay()) % 7;
      const next = new Date(now.getFullYear(), now.getMonth(), now.getDate() + (d === 0 ? 7 : d));
      // Set to start of day (optional) — keep promo end at 23:59 local time of Tuesday
      next.setHours(23, 59, 59, 999);
      return next;
    }

    const promoEnd = nextWeekdayDate(2); // next Tuesday end of day

    function updateCountdown() {
      if (!promoTimerEl) return;
      const now = new Date();
      const diff = promoEnd - now;
      if (diff <= 0) {
        promoTimerEl.innerText = 'Expired';
        return;
      }
      const sec = Math.floor(diff / 1000);
      const d = Math.floor(sec / 86400);
      const h = Math.floor((sec % 86400) / 3600);
      const m = Math.floor((sec % 3600) / 60);
      const s = Math.floor(sec % 60);
      promoTimerEl.innerText = (d ? (d + 'd ') : '') + `${pad(h)}h ${pad(m)}m ${pad(s)}s`;
    }
    function pad(n) { return String(n).padStart(2, '0'); }

    updateCountdown();
    setInterval(updateCountdown, 1000);

    // promo apply handlers (adds promo code to cart state and re-renders)
    qsa('[data-action="apply-promo"]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const code = btn.dataset.promoCode || btn.getAttribute('data-promo-code') || 'UNKNOWN';
        // save to localStorage as applied code for persistence
        try { localStorage.setItem('wrap_applied_promo', code); } catch (e) {}
        showToast(`Promo ${code} applied`);
        // Re-render cart so promo discount shows
        renderCart();
      });
    });

    // Preorder button: opens #preorder-modal
    qsa('[data-action="preorder-promo"]').forEach(btn => btn.addEventListener('click', (e) => {
      e.preventDefault();
      openPreorderModal();
    }));
  }

  /* -------------------------
     Preorder modal handling
  ------------------------- */
  function openPreorderModal() {
    const modal = qs('#preorder-modal');
    if (!modal) return;
    modal.style.display = 'flex';
    modal.setAttribute('aria-hidden', 'false');
    document.body.style.overflow = 'hidden';
    // prefill name/phone if available
    try {
      qs('#preorder-name') && (qs('#preorder-name').value = localStorage.getItem('wrap_user_name') || '');
      qs('#preorder-phone') && (qs('#preorder-phone').value = localStorage.getItem('wrap_user_phone') || '');
    } catch (e) {}
  }
  function closePreorderModal() {
    const modal = qs('#preorder-modal');
    if (!modal) return;
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
  }
  function setupPreorderModal() {
    const modal = qs('#preorder-modal');
    if (!modal) return;
    const closeBtn = qs('#preorder-close', modal);
    const cancelBtn = qs('#preorder-cancel', modal);
    const confirmBtn = qs('#preorder-confirm', modal);
    const form = qs('#preorder-form', modal);

    closeBtn && closeBtn.addEventListener('click', closePreorderModal);
    cancelBtn && cancelBtn.addEventListener('click', closePreorderModal);

    form && form.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = (qs('#preorder-name')?.value || '').trim();
      const phone = (qs('#preorder-phone')?.value || '').trim();
      const note = (qs('#preorder-note')?.value || '').trim();
      if (!name || !phone) { alert('Please provide name and phone'); return; }
      const cartLines = computeCartTotals().lines || [];
      const fakeOrder = {
        reference: 'PRE-' + Date.now(),
        name, phone, email: '',
        type: 'preorder',
        address: '',
        note,
        cart: cartLines,
        totals: computeCartTotals(),
        ts: new Date().toISOString()
      };
      try {
        localStorage.setItem('wrap_last_order', JSON.stringify(fakeOrder));
        localStorage.setItem('wrap_show_confirmation', '1');
      } catch (err) { /* ignore */ }
      closePreorderModal();
      // optionally clear cart? We keep cart intact for preorder
      showToast('Preorder received — we will contact you');
      setTimeout(() => window.location.reload(), 600);
    });
  }

  /* -------------------------
     Checkout page / modal handling
     - openCheckoutPage() is exposed on window
  ------------------------- */
  function haversineKm(lat1, lon1, lat2, lon2) {
    const R = 6371;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
      Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
      Math.sin(dLon / 2) * Math.sin(dLon / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
  }
  function toRad(v) { return v * Math.PI / 180; }

  function computeDeliveryFee(lat, lon) {
    if (isNaN(lat) || isNaN(lon)) return DELIVERY_CONFIG.baseFee;
    const dist = haversineKm(STORE_COORDS.lat, STORE_COORDS.lon, lat, lon);
    if (dist <= DELIVERY_CONFIG.freeWithinKm) return 0;
    let fee = DELIVERY_CONFIG.baseFee + (dist * DELIVERY_CONFIG.perKm);
    fee = Math.max(fee, DELIVERY_CONFIG.minFee);
    fee = Math.min(fee, DELIVERY_CONFIG.maxFee);
    return Math.round(fee);
  }

  function populateOrderLinesForCheckout() {
    const orderLinesWrap = qs('#cf-order-lines');
    if (!orderLinesWrap) return;
    orderLinesWrap.innerHTML = '';
    const totals = computeCartTotals();
    const lines = Object.values(window.cart || {});
    if (!lines.length) {
      orderLinesWrap.innerHTML = '<div class="small-muted">Your cart is empty.</div>';
      return;
    }
    lines.forEach(l => {
      const div = document.createElement('div');
      div.className = 'order-line';
      div.innerHTML = `
        <img src="${escapeHtml(l.imageSrc||'')}" alt="${escapeHtml(l.title||'Item')}" />
        <div class="ol-meta">
          <strong>${escapeHtml(l.title||'Item')}</strong>
          <small>${escapeHtml(Object.keys(l.meta||{}).map(k => (l.meta[k] && l.meta[k].text) ? l.meta[k].text : '').filter(Boolean).join(' • '))}</small>
        </div>
        <div class="ol-price">${fmtGhc((l.unitPrice||0) * (l.qty||1))}</div>
      `;
      orderLinesWrap.appendChild(div);
    });
  }

  function refreshCheckoutTotals() {
    const cfSubtotal = qs('#cf-subtotal');
    const cfDelivery = qs('#cf-delivery');
    const cfPromo = qs('#cf-promo');
    const cfTotal = qs('#cf-total');
    if (!cfSubtotal || !cfDelivery || !cfPromo || !cfTotal) return;

    const totals = computeCartTotals();
    const subtotal = totals.subtotal || 0;
    const promo = totals.promoDiscount || 0;

    const inpType = qs('#cf-type');
    const inpLat = qs('#cf-lat');
    const inpLon = qs('#cf-lon');
    let deliveryFee = 0;
    if (inpType && inpType.value === 'delivery') {
      const lat = parseFloat(inpLat && inpLat.value) || NaN;
      const lon = parseFloat(inpLon && inpLon.value) || NaN;
      deliveryFee = computeDeliveryFee(lat, lon);
    }

    cfSubtotal.innerText = fmtGhc(subtotal);
    cfDelivery.innerText = fmtGhc(deliveryFee);
    cfPromo.innerText = `-GHC ${promo}`;
    cfTotal.innerText = fmtGhc(Math.max(0, subtotal - promo + deliveryFee));
  }

  function openCheckoutPage() {
    const page = qs('#checkout-page');
    if (!page) return;
    // hide other modals
    qsa('.modal, #preorder-modal').forEach(m => { try { m.style.display = 'none'; m.setAttribute('aria-hidden', 'true'); } catch (e) {} });
    populateOrderLinesForCheckout();
    refreshCheckoutTotals();
    page.style.display = 'flex';
    page.setAttribute('aria-hidden', 'false');
    document.body.style.overflow = 'hidden';
    // focus first input
    setTimeout(() => {
      const first = qs('#cf-name');
      if (first) first.focus();
    }, 120);
  }

  function closeCheckoutPage() {
    const page = qs('#checkout-page');
    if (!page) return;
    page.style.display = 'none';
    page.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
  }

  function setupCheckoutPage() {
    // wire openers
    const footerPayBtn = qs('#checkout-btn');
    const headerCheckoutBtn = qs('#cart-header-checkout');
    if (footerPayBtn) footerPayBtn.addEventListener('click', (e) => { e.preventDefault(); openCheckoutPage(); });
    if (headerCheckoutBtn) headerCheckoutBtn.addEventListener('click', (e) => { e.preventDefault(); openCheckoutPage(); });

    // close/cancel
    const closeBtn = qs('#checkout-close');
    const cancelBtn = qs('#cf-cancel');
    closeBtn && closeBtn.addEventListener('click', closeCheckoutPage);
    cancelBtn && cancelBtn.addEventListener('click', closeCheckoutPage);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && qs('#checkout-page')?.getAttribute('aria-hidden') === 'false') closeCheckoutPage(); });
    qs('#checkout-page') && qs('#checkout-page').addEventListener('click', (e) => { if (e.target === qs('#checkout-page')) closeCheckoutPage(); });

    // watchers
    qs('#cf-type') && qs('#cf-type').addEventListener('change', refreshCheckoutTotals);
    qs('#cf-lat') && qs('#cf-lat').addEventListener('input', refreshCheckoutTotals);
    qs('#cf-lon') && qs('#cf-lon').addEventListener('input', refreshCheckoutTotals);

    // keep totals updated periodically (catches cart changes)
    setInterval(() => { populateOrderLinesForCheckout(); refreshCheckoutTotals(); }, 900);

    // submit handler
    const submitBtn = qs('#cf-submit');
    submitBtn && submitBtn.addEventListener('click', async (ev) => {
      ev.preventDefault();
      submitBtn.disabled = true;

      const name = (qs('#cf-name')?.value || '').trim();
      const phone = (qs('#cf-phone')?.value || '').trim();
      const email = (qs('#cf-email')?.value || '').trim();
      const type = (qs('#cf-type')?.value || 'delivery');
      const address = (qs('#cf-address')?.value || '').trim();
      const lat = (qs('#cf-lat')?.value || '').trim();
      const lon = (qs('#cf-lon')?.value || '').trim();
      const date = (qs('#cf-date')?.value || '').trim();
      const time = (qs('#cf-time')?.value || '').trim();
      const note = (qs('#cf-note')?.value || '').trim();
      const paymethod = (qs('#cf-paymethod')?.value || 'paystack');

      if (!name || !phone || !email) {
        alert('Please complete your name, phone and email.');
        submitBtn.disabled = false;
        return;
      }
      if (type === 'delivery' && !address) {
        alert('Please provide your delivery address.');
        submitBtn.disabled = false;
        return;
      }

      const cartLines = Object.values(window.cart || {}).map(l => ({
        baseId: l.baseId, title: l.title, unitPrice: l.unitPrice, qty: l.qty, meta: l.meta || {}
      }));
      if (!cartLines.length) {
        alert('Your cart is empty. Add items before checkout.');
        submitBtn.disabled = false;
        return;
      }

      const totals = computeCartTotals();
      const deliveryFee = (type === 'delivery') ? computeDeliveryFee(parseFloat(lat) || 0, parseFloat(lon) || 0) : 0;
      const totalAmount = Math.round((totals.subtotal || 0) - (totals.promoDiscount || 0) + deliveryFee);

      // Save name/phone for convenience
      try { localStorage.setItem('wrap_user_name', name); localStorage.setItem('wrap_user_phone', phone); } catch (e) {}

      if (paymethod === 'cash') {
        const fakeOrder = {
          id: 'local-' + Date.now(),
          reference: 'CASH-' + Date.now(),
          name, phone, email, type, address, lat, lon, date, time, note,
          cart: cartLines,
          totals: { subtotal: totals.subtotal, delivery: deliveryFee, promo: totals.promoDiscount, total: totalAmount },
          ts: new Date().toISOString()
        };
        try {
          localStorage.setItem('wrap_last_order', JSON.stringify(fakeOrder));
          localStorage.setItem('wrap_show_confirmation', '1');
        } catch (e) {}
        // clear cart and show confirmation after reload
        window.cart = {};
        saveCart();
        renderCart();
        closeCheckoutPage();
        window.location.reload();
        return;
      }

      // Paystack flow (inline) — if PaystackPop available and key set
      try {
        if (paymethod === 'paystack' && PAYSTACK_PUBLIC_KEY && window.PaystackPop) {
          const ref = 'PSK-' + Date.now() + '-' + Math.floor(Math.random() * 10000);
          const handler = window.PaystackPop.setup({
            key: PAYSTACK_PUBLIC_KEY,
            email: email,
            amount: Math.round(totalAmount * 100),
            currency: 'GHS',
            ref,
            onClose: function () {
              alert('Payment cancelled');
              submitBtn.disabled = false;
            },
            callback: function (response) {
              // treat as success for frontend-only flow
              const order = {
                reference: response.reference || ref,
                name, phone, email, type, address, lat, lon, date, time, note,
                cart: cartLines,
                totals: { subtotal: totals.subtotal, delivery: deliveryFee, promo: totals.promoDiscount, total: totalAmount },
                ts: new Date().toISOString()
              };
              try {
                localStorage.setItem('wrap_last_order', JSON.stringify(order));
                localStorage.setItem('wrap_show_confirmation', '1');
              } catch (e) {}
              window.cart = {};
              saveCart();
              renderCart();
              closeCheckoutPage();
              window.location.reload();
            }
          });
          handler.openIframe();
          return;
        }

        // If Paystack not available, confirm simulation
        if (paymethod === 'paystack') {
          const simulate = confirm('Paystack not available. Simulate successful payment for testing? (No money will be charged)');
          if (!simulate) {
            alert('Payment cancelled. To use real Paystack, ensure Paystack script and key are available.');
            submitBtn.disabled = false;
            return;
          }
          const order = {
            reference: 'SIM-' + Date.now(),
            name, phone, email, type, address, lat, lon, date, time, note,
            cart: cartLines,
            totals: { subtotal: totals.subtotal, delivery: deliveryFee, promo: totals.promoDiscount, total: totalAmount },
            ts: new Date().toISOString()
          };
          try {
            localStorage.setItem('wrap_last_order', JSON.stringify(order));
            localStorage.setItem('wrap_show_confirmation', '1');
          } catch (e) {}
          window.cart = {};
          saveCart();
          renderCart();
          closeCheckoutPage();
          window.location.reload();
          return;
        }
      } catch (err) {
        console.error('checkout error', err);
        alert('Checkout failed: ' + (err.message || err));
        submitBtn.disabled = false;
      }
    });
  }

  // expose openCheckoutPage globally
  window.openCheckoutPage = openCheckoutPage;

  /* -------------------------
     Order confirmation modal wiring (show if localStorage flag present)
  ------------------------- */
  function setupOrderConfirmationModal() {
    const modal = qs('#order-confirmation-modal');
    if (!modal) return;
    const btnOk = qs('#oc-ok');
    const btnClose = qs('#oc-close');
    const btnPrint = qs('#oc-print');

    function hideModal() {
      modal.setAttribute('aria-hidden', 'true');
      modal.style.display = 'none';
      document.body.style.overflow = '';
    }

    function showModal(order) {
      if (!order) return;
      qs('#oc-ref').innerText = order.reference || ('ref-' + Math.floor(Math.random() * 1000000));
      qs('#oc-name').innerText = order.name || '-';
      qs('#oc-phone').innerText = order.phone || '-';
      qs('#oc-email').innerText = order.email || '-';
      qs('#oc-type').innerText = order.type || '-';
      qs('#oc-address').innerText = order.address || '-';
      qs('#oc-note').innerText = order.note || '-';
      qs('#oc-ts').innerText = new Date(order.ts || Date.now()).toLocaleString();
      qs('#oc-total').innerText = `GHC ${Number(order.totals?.total || 0).toFixed(0)}`;

      const ocLines = qs('#oc-lines');
      ocLines.innerHTML = '';
      const lines = Array.isArray(order.cart) ? order.cart : [];
      if (!lines.length) {
        ocLines.innerHTML = '<div class="small-muted">No line items recorded.</div>';
      } else {
        lines.forEach(l => {
          const div = document.createElement('div');
          div.className = 'oc-line';
          const title = escapeHtml(l.title || l.name || 'Item');
          const qty = Number(l.qty || 1);
          const unit = Number(l.unitPrice || 0);
          div.innerHTML = `<div style="flex:1;"><strong>${title}</strong><div class="small-muted">${(l.meta && l.meta.addons) ? 'Extras: ' + l.meta.addons.map(a => escapeHtml(a.label || a.key || a)).join(', ') : ''}</div></div><div style="text-align:right;min-width:120px;">${qty} × GHC ${unit.toFixed(0)}<div style="font-weight:900;margin-top:4px">GHC ${Math.round(qty * unit).toFixed(0)}</div></div>`;
          ocLines.appendChild(div);
        });
      }

      modal.setAttribute('aria-hidden', 'false');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    btnOk && btnOk.addEventListener('click', () => {
      try {
        localStorage.removeItem('wrap_show_confirmation');
        localStorage.removeItem('wrap_last_order');
        localStorage.removeItem(CART_STORAGE_KEY);
        window.cart = {};
        saveCart();
        renderCart();
      } catch (e) {}
      hideModal();
      window.location.href = window.location.pathname;
    });
    btnClose && btnClose.addEventListener('click', () => {
      hideModal();
    });

    btnPrint && btnPrint.addEventListener('click', () => {
      try {
        const raw = localStorage.getItem('wrap_last_order');
        const order = raw ? JSON.parse(raw) : null;
        if (!order) { alert('No order data available to print.'); return; }
        // Open a printable window (simplified)
        const printableHtml = buildPrintableHtml(order);
        const w = window.open('', '_blank', 'toolbar=0,location=0,menubar=0,width=900,height=1100');
        if (!w) { alert('Please allow popups to print.'); return; }
        w.document.open();
        w.document.write(printableHtml);
        w.document.close();
        w.focus();
        setTimeout(() => { try { w.print(); } catch (e) { console.warn(e); } }, 300);
      } catch (err) { console.error(err); alert('Print failed'); }
    });

    // show modal on load if flag present
    try {
      const showFlag = localStorage.getItem('wrap_show_confirmation');
      if (showFlag === '1') {
        const raw = localStorage.getItem('wrap_last_order');
        const order = raw ? JSON.parse(raw) : null;
        setTimeout(() => showModal(order), 220);
      }
    } catch (e) { console.warn('order confirm show error', e); }

    function buildPrintableHtml(order) {
      const escape = escapeHtml;
      const lines = Array.isArray(order.cart) ? order.cart : [];
      let linesHtml = '';
      let computedSubtotal = 0;
      if (!lines.length) {
        linesHtml = '<tr><td colspan="4" style="text-align:center;padding:12px 0;color:#666">No line items recorded.</td></tr>';
      } else {
        lines.forEach((l) => {
          const qty = Number(l.qty || 1);
          const unit = Number(l.unitPrice || 0);
          const lineTotal = Math.round(qty * unit);
          computedSubtotal += lineTotal;
          const metaParts = [];
          if (l.meta) {
            if (Array.isArray(l.meta.addons) && l.meta.addons.length) metaParts.push('Extras: ' + l.meta.addons.map(a => escape(a.label || a.key || a)).join(', '));
            Object.keys(l.meta).forEach(k => {
              if (k === 'addons') return;
              const v = l.meta[k];
              if (!v) return;
              if (typeof v === 'object') {
                if (v.text) metaParts.push(`${escape(k)}: ${escape(v.text)}`);
                else if (v.label) metaParts.push(`${escape(k)}: ${escape(v.label)}`);
                else metaParts.push(`${escape(k)}: ${escape(JSON.stringify(v))}`);
              } else metaParts.push(`${escape(k)}: ${escape(String(v))}`);
            });
          }
          const metaHtml = metaParts.length ? `<div style="font-size:12px;color:#444;margin-top:6px;">${metaParts.join(' • ')}</div>` : '';
          linesHtml += `<tr><td style="padding:10px 8px; vertical-align:top; border-bottom:1px solid #eee;"><strong>${escape(l.title || 'Item')}</strong>${metaHtml}</td><td style="padding:10px 8px; vertical-align:top; border-bottom:1px solid #eee; text-align:center;">${qty}</td><td style="padding:10px 8px; vertical-align:top; border-bottom:1px solid #eee; text-align:right;">GHC ${Number(unit).toFixed(0)}</td><td style="padding:10px 8px; vertical-align:top; border-bottom:1px solid #eee; text-align:right;">GHC ${lineTotal.toFixed(0)}</td></tr>`;
        });
      }

      const totals = order.totals || {};
      const subtotal = (typeof totals.subtotal !== 'undefined') ? Number(totals.subtotal) : computedSubtotal;
      const delivery = (typeof totals.delivery !== 'undefined') ? Number(totals.delivery || 0) : Number(totals.delivery || 0);
      const promoDiscount = (typeof totals.promo !== 'undefined') ? Number(totals.promo || 0) : Number(totals.promoDiscount || 0);
      const total = (typeof totals.total !== 'undefined') ? Number(totals.total) : Math.max(0, subtotal - (promoDiscount || 0) + (delivery || 0));

      const printable = `<!doctype html><html><head><meta charset="utf-8" /><title>Wrap District — Invoice ${escape(order.reference||'')}</title><style>body{font-family:Arial,Helvetica,sans-serif;color:#222;padding:18px}table{width:100%;border-collapse:collapse}th,td{padding:8px;border-bottom:1px solid #eee}th{text-align:left}</style></head><body><div style="display:flex;align-items:center;gap:12px"><div style="background:linear-gradient(135deg,#FF6A00,#ff8c2b);color:#111;padding:6px 10px;border-radius:8px;font-weight:900">WRAP</div><div><h2 style="margin:0">Wrap District</h2><div style="color:#666">Fresh · Hot · Fast — Tema Community 25</div></div></div><div style="margin-top:12px;display:flex;justify-content:space-between"><div><strong>Customer</strong><div>${escape(order.name||'')}</div><div>${escape(order.phone||'')}</div></div><div><strong>Order</strong><div>Ref: ${escape(order.reference||'')}</div><div>Placed: ${escape(new Date(order.ts||Date.now()).toLocaleString())}</div></div></div><table aria-label="Order lines" style="margin-top:14px"><thead><tr><th style="width:60%">Item & options</th><th style="width:10%;text-align:center">Qty</th><th style="width:15%;text-align:right">Unit</th><th style="width:15%;text-align:right">Line</th></tr></thead><tbody>${linesHtml}</tbody></table><div style="max-width:420px;margin-left:auto;margin-top:12px"><div style="display:flex;justify-content:space-between"><div>Subtotal</div><div>GHC ${Number(subtotal).toFixed(0)}</div></div><div style="display:flex;justify-content:space-between"><div>Delivery</div><div>GHC ${Number(delivery||0).toFixed(0)}</div></div><div style="display:flex;justify-content:space-between"><div>Promo</div><div>-GHC ${Number(promoDiscount||0).toFixed(0)}</div></div><div style="display:flex;justify-content:space-between;font-weight:900;margin-top:8px"><div>Total</div><div>GHC ${Number(total).toFixed(0)}</div></div></div></body></html>`;
      return printable;
    }
  }

  /* -------------------------
     Promo carousel (bottom promo section)
  ------------------------- */
  function setupPromoCarousel() {
    const pcSlides = qsa('.pc-slide');
    const pcDots = qsa('.pc-dot');
    const prevBtn = qs('.promo-controls .slide-prev');
    const nextBtn = qs('.promo-controls .slide-next');
    if (!pcSlides.length) return;
    let current = 0;
    let autoTimer = null;
    const AUTO_DELAY = 6000;

    function showSlide(idx) {
      idx = (idx + pcSlides.length) % pcSlides.length;
      pcSlides.forEach((s, i) => {
        s.classList.toggle('is-active', i === idx);
        s.setAttribute('aria-hidden', i === idx ? 'false' : 'true');
      });
      pcDots.forEach((d, i) => d.classList.toggle('is-active', i === idx));
      current = idx;
    }
    function nextSlide() { showSlide(current + 1); }
    function prevSlide() { showSlide(current - 1); }
    function startAuto() { stopAuto(); autoTimer = setInterval(nextSlide, AUTO_DELAY); }
    function stopAuto() { if (autoTimer) { clearInterval(autoTimer); autoTimer = null; } }

    nextBtn && nextBtn.addEventListener('click', (e) => { e.preventDefault(); nextSlide(); startAuto(); });
    prevBtn && prevBtn.addEventListener('click', (e) => { e.preventDefault(); prevSlide(); startAuto(); });
    pcDots.forEach(d => d.addEventListener('click', (e) => { e.preventDefault(); showSlide(Number(d.dataset.index || d.getAttribute('data-index'))); startAuto(); }));

    showSlide(0);
    startAuto();

    // promo detail toggles
    qsa('[data-action="promo-details"]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const target = btn.dataset.target;
        const more = qs('#promo-more');
        const moreContent = qs('#promo-more-content');
        if (!more || !moreContent) return;
        let text = '';
        if (target === 'shawarma') text = 'Buy 2 Shawarmas on Tuesdays and get the 3rd free. Add qualifying shawarmas to your cart and the discount will apply automatically at checkout.';
        else if (target === 'fries') text = 'Loaded Fries promotion: when you purchase qualifying Loaded Fries during promo hours, a free Coke will be added to your cart automatically.';
        else text = 'Promo details unavailable.';
        moreContent.innerText = text;
        more.classList.toggle('hidden');
        btn.setAttribute('aria-expanded', String(!more.classList.contains('hidden')));
      });
    });
  }

  /* -------------------------
     Small helpers & initial wiring
  ------------------------- */
  function setupMisc() {
    // footer order button: open cart if has items else scroll to menu
    const orderBtn = qs('#footer-order');
    const menuAnchor = qs('#menu');
    const cartToggle = qs('#cart-toggle');
    orderBtn && orderBtn.addEventListener('click', (e) => {
      try {
        const cartCount = Number((qs('#cart-count') || {}).innerText) || 0;
        if (cartCount > 0 && cartToggle) cartToggle.click();
        else if (menuAnchor) menuAnchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
        else window.location.hash = '#menu';
      } catch (err) {
        if (menuAnchor) menuAnchor.scrollIntoView({ behavior: 'smooth' });
      }
    });

    // footer locate button: scroll to contact
    const locBtn = qs('#footer-locate');
    locBtn && locBtn.addEventListener('click', () => {
      const contact = qs('#contact');
      if (contact) contact.scrollIntoView({ behavior: 'smooth' });
      else window.location.hash = '#contact';
    });

    // external WA link: ensure noopener noreferrer
    const wa = qs('#footer-wa');
    if (wa) wa.setAttribute('rel', 'noopener noreferrer');

    // hamburger mobile nav wiring
    setupMobileNav();

    // Menu tabs wiring
    setupMenuTabs();

    // cart drawer
    setupCartDrawer();

    // add buttons
    setupMenuAddButtons();

    // product modal
    setupProductModal();

    // promo countdown + apply
    setupPromoCountdown();

    // Preorder modal
    setupPreorderModal();

    // checkout
    setupCheckoutPage();

    // promo carousel (if present)
    setupPromoCarousel();

    // order confirmation modal
    setupOrderConfirmationModal();

    // render persisted cart
    loadCart();
    renderCart();
  }

  /* -------------------------
     On DOM ready initialize everything
  ------------------------- */
  document.addEventListener('DOMContentLoaded', () => {
    try {
      setupMisc();
    } catch (err) {
      console.error('Initialization error', err);
    }
  });

  /* -------------------------
     Expose a few utilities onto window for compatibility with other inline code
  ------------------------- */
  window.openPreorderModal = openPreorderModal;
  window.openCheckoutPage = openCheckoutPage;
  window.renderCart = renderCart;
  window.computeCartTotals = computeCartTotals;
  window.addToCart = addToCart;

})(); 
</script>

  
</html>
  
